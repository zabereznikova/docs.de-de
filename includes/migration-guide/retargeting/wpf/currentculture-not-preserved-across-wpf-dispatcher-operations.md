---
ms.openlocfilehash: bd656478a55856e676853e57f3e7386ea0aa0211
ms.sourcegitcommit: e02d17b2cf9c1258dadda4810a5e6072a0089aee
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 07/01/2020
ms.locfileid: "85614546"
---
### <a name="currentculture-is-not-preserved-across-wpf-dispatcher-operations"></a><span data-ttu-id="470d0-101">CurrentCulture wird zwischen WPF-Dispatcher-Vorgängen nicht beibehalten</span><span class="sxs-lookup"><span data-stu-id="470d0-101">CurrentCulture is not preserved across WPF Dispatcher operations</span></span>

#### <a name="details"></a><span data-ttu-id="470d0-102">Details</span><span class="sxs-lookup"><span data-stu-id="470d0-102">Details</span></span>

<span data-ttu-id="470d0-103">Ab .NET Framework 4.6 gehen Änderungen an <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> oder <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName>, die innerhalb eines <xref:System.Windows.Threading.Dispatcher?displayProperty=fullName>-Elements vorgenommen werden, am Ende des Verteilungsvorgangs verloren.</span><span class="sxs-lookup"><span data-stu-id="470d0-103">Beginning in the .NET Framework 4.6, changes to <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> or <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> made within a <xref:System.Windows.Threading.Dispatcher?displayProperty=fullName> will be lost at the end of that dispatcher operation.</span></span> <span data-ttu-id="470d0-104">Auf ähnliche Weise werden Änderungen an <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> oder <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> außerhalb eines Verteilungsvorgangs möglicherweise nicht übernommen, wenn der Vorgang ausgeführt wird. In der Praxis bedeutet dies, dass Änderungen an <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> und <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> möglicherweise zwischen Rückrufen der WPF-Benutzeroberfläche und anderem Code in einer WPF-Anwendung nicht übertragen werden. Der Grund dafür ist eine Änderung in <xref:System.Threading.ExecutionContext?displayProperty=fullName>, durch die <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> und <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> im Ausführungskontext gespeichert werden. Diese Änderung betrifft Apps mit der Zielplattform .NET Framework 4.6 und höher.</span><span class="sxs-lookup"><span data-stu-id="470d0-104">Similarly, changes to <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> or <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> made outside of a Dispatcher operation may not be reflected when that operation executes.Practically speaking, this means that <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> changes may not flow between WPF UI callbacks and other code in a WPF application.This is due to a change in <xref:System.Threading.ExecutionContext?displayProperty=fullName> that causes <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> to be stored in the execution context beginning with apps targeting the .NET Framework 4.6.</span></span> <span data-ttu-id="470d0-105">WPF-Verteilungsvorgänge speichern den Ausführungskontext, der dazu verwendet wurde, um den Vorgang zu beginnen und stellen den vorherigen Kontext wieder her, wenn der Vorgang abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="470d0-105">WPF dispatcher operations store the execution context used to begin the operation and restore the previous context when the operation is completed.</span></span> <span data-ttu-id="470d0-106">Da <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> und <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> jetzt Bestandteil dieses Kontexts sind, bleiben innerhalb eines Dispatchervorgangs an ihnen vorgenommene Änderungen außerhalb des Vorgangs nicht erhalten.</span><span class="sxs-lookup"><span data-stu-id="470d0-106">Because <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> are now part of that context, changes to them within a dispatcher operation are not persisted outside of the operation.</span></span>

#### <a name="suggestion"></a><span data-ttu-id="470d0-107">Vorschlag</span><span class="sxs-lookup"><span data-stu-id="470d0-107">Suggestion</span></span>

<span data-ttu-id="470d0-108">Von dieser Änderung betroffene Apps können dieses Problem möglicherweise umgehen, indem das gewünschte <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName>- oder <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName>-Element in einem Feld gespeichert wird und für alle Vorgangstexte der Verteilung (einschließlich der Rückrufereignishandler für Benutzeroberflächenereignisse) geprüft wird, ob das richtige <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName>- und <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName>-Element festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="470d0-108">Apps affected by this change may work around it by storing the desired <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> or <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> in a field and checking in all Dispatcher operation bodies (including UI event callback handlers) that the correct <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName> and <xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName> are set.</span></span> <span data-ttu-id="470d0-109">Da die ExecutionContext-Änderung, die dieser WPF-Änderung zugrunde liegt, nur Apps betrifft, die auf .NET Framework 4.6 oder höher ausgerichtet sind, kann dieser Fehler alternativ vermieden werden, indem .NET Framework 4.5.2 als Zielplattform verwendet wird. Apps mit der Zielplattform .NET Framework 4.6 oder höher können dieses Problem ebenfalls umgehen, indem die folgende Kompatibilitätsoption festgelegt wird:</span><span class="sxs-lookup"><span data-stu-id="470d0-109">Alternatively, because the ExecutionContext change underlying this WPF change only affects apps targeting the .NET Framework 4.6 or newer, this break can be avoided by targeting the .NET Framework 4.5.2.Apps that target .NET Framework 4.6 or later can also work around this by setting the following compatibility switch:</span></span>

<pre><code class="lang-csharp">AppContext.SetSwitch(&quot;Switch.System.Globalization.NoAsyncCurrentCulture&quot;, true);&#13;&#10;</code></pre>

<span data-ttu-id="470d0-110">Dieses Problem wurde von WPF in .NET Framework 4.6.2 behoben.</span><span class="sxs-lookup"><span data-stu-id="470d0-110">This issue has been fixed by WPF in .NET Framework 4.6.2.</span></span> <span data-ttu-id="470d0-111">Es wurde ebenfalls in .NET Framework 4.6 und 4.6.1 durch [KB 3139549](https://support.microsoft.com/kb/3139549) behoben.</span><span class="sxs-lookup"><span data-stu-id="470d0-111">It has also been fixed in .NET Frameworks 4.6, 4.6.1 through [KB 3139549](https://support.microsoft.com/kb/3139549).</span></span> <span data-ttu-id="470d0-112">Apps mit der Zielplattform .NET Framework 4.6 oder höher erhalten automatisch das richtige Verhalten in WPF-Anwendungen (<xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName>/<xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName>), das über Dispatcher-Vorgänge hinweg beibehalten werden würde.</span><span class="sxs-lookup"><span data-stu-id="470d0-112">Applications targeting .NET Framework 4.6 or later will automatically get the right behavior in WPF applications - <xref:System.Globalization.CultureInfo.CurrentCulture?displayProperty=fullName>/<xref:System.Globalization.CultureInfo.CurrentUICulture?displayProperty=fullName>) would be preserved across Dispatcher operations.</span></span>

| <span data-ttu-id="470d0-113">name</span><span class="sxs-lookup"><span data-stu-id="470d0-113">Name</span></span>    | <span data-ttu-id="470d0-114">Wert</span><span class="sxs-lookup"><span data-stu-id="470d0-114">Value</span></span>       |
|:--------|:------------|
| <span data-ttu-id="470d0-115">Bereich</span><span class="sxs-lookup"><span data-stu-id="470d0-115">Scope</span></span>   | <span data-ttu-id="470d0-116">Gering</span><span class="sxs-lookup"><span data-stu-id="470d0-116">Minor</span></span>       |
| <span data-ttu-id="470d0-117">Version</span><span class="sxs-lookup"><span data-stu-id="470d0-117">Version</span></span> | <span data-ttu-id="470d0-118">4.6</span><span class="sxs-lookup"><span data-stu-id="470d0-118">4.6</span></span>         |
| <span data-ttu-id="470d0-119">Typ</span><span class="sxs-lookup"><span data-stu-id="470d0-119">Type</span></span>    | <span data-ttu-id="470d0-120">Neuzuweisung</span><span class="sxs-lookup"><span data-stu-id="470d0-120">Retargeting</span></span> |
