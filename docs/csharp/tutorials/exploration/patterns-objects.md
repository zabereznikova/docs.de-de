---
title: 'Verwenden von Mustern in Objekten: Tutorial zu C#'
description: In diesem Tutorial lernen Sie Techniken zur Verwendung des Musterabgleichs in Klassenmembern kennen, um bessere Modelle für das Objektverhalten zu erstellen.
ms.date: 11/05/2020
ms.openlocfilehash: 072f6f57696504c2d691473e3a43c1cda53f227f
ms.sourcegitcommit: 6bef8abde346c59771a35f4f76bf037ff61c5ba3
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/06/2020
ms.locfileid: "94332174"
---
# <a name="use-pattern-matching-to-build-your-class-behavior-for-better-code"></a><span data-ttu-id="9cb3e-103">Verwenden des Musterabgleichs zum Gestalten des Verhaltens von Klassen für besseren Code</span><span class="sxs-lookup"><span data-stu-id="9cb3e-103">Use pattern matching to build your class behavior for better code</span></span>

<span data-ttu-id="9cb3e-104">Die Features für den Musterabgleich in C# stellen die Syntax zum Ausdrücken Ihrer Algorithmen bereit.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-104">The pattern matching features in C# provide syntax to express your algorithms.</span></span> <span data-ttu-id="9cb3e-105">Mithilfe dieser Techniken können Sie das Verhalten in Ihren Klassen implementieren.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-105">You can use these techniques to implement the behavior in your classes.</span></span> <span data-ttu-id="9cb3e-106">Sie können einen objektorientierten Klassenentwurf mit einer datenorientierten Implementierung kombinieren, um bei der Modellierung von Objekten aus der realen Welt präzisen Code bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-106">You can combine object-oriented class design with a data-oriented implementation to provide concise code while modeling real-world objects.</span></span>

<span data-ttu-id="9cb3e-107">In diesem Tutorial lernen Sie Folgendes:</span><span class="sxs-lookup"><span data-stu-id="9cb3e-107">In this tutorial, you'll learn how to:</span></span>

> [!div class="checklist"]
>
> - <span data-ttu-id="9cb3e-108">Ausdrücken Ihrer objektorientierten Klassen mithilfe von Datenmustern</span><span class="sxs-lookup"><span data-stu-id="9cb3e-108">Express your object oriented classes using data patterns.</span></span>
> - <span data-ttu-id="9cb3e-109">Implementieren dieser Muster mithilfe der C#-Features zum Musterabgleich</span><span class="sxs-lookup"><span data-stu-id="9cb3e-109">Implement those patterns using C#'s pattern matching features.</span></span>
> - <span data-ttu-id="9cb3e-110">Nutzen der Compilerdiagnose zum Überprüfen Ihrer Implementierung</span><span class="sxs-lookup"><span data-stu-id="9cb3e-110">Leverage compiler diagnostics to validate your implementation.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="9cb3e-111">Voraussetzungen</span><span class="sxs-lookup"><span data-stu-id="9cb3e-111">Prerequisites</span></span>

<span data-ttu-id="9cb3e-112">Sie müssen Ihren Computer zur Ausführung von .NET 5 einrichten, einschließlich des C# 9.0-Compilers.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-112">You’ll need to set up your machine to run .NET 5, including the C# 9.0 compiler.</span></span> <span data-ttu-id="9cb3e-113">Der C# 9.0-Compiler steht ab [Visual Studio 2019 Version 16.8 Preview](https://visualstudio.microsoft.com/vs/preview/) oder [.NET 5.0 SDK Preview](https://dotnet.microsoft.com/download/dotnet/5.0) zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-113">The C# 9.0 compiler is available starting with [Visual Studio 2019 version 16.8 preview](https://visualstudio.microsoft.com/vs/preview/) or the [.NET 5.0 SDK preview](https://dotnet.microsoft.com/download/dotnet/5.0).</span></span>

## <a name="build-a-simulation-of-a-canal-lock"></a><span data-ttu-id="9cb3e-114">Erstellen einer Simulation einer Kanalschleuse</span><span class="sxs-lookup"><span data-stu-id="9cb3e-114">Build a simulation of a canal lock</span></span>

<span data-ttu-id="9cb3e-115">In diesem Tutorial erstellen Sie eine C#-Klasse, die eine [Kanalschleuse](https://en.wikipedia.org/wiki/Lock_(water_navigation)) simuliert.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-115">In this tutorial, you'll build a C# class that simulates a [canal lock](https://en.wikipedia.org/wiki/Lock_(water_navigation)).</span></span> <span data-ttu-id="9cb3e-116">Eine Kanalschleuse ist, kurz gesagt, eine Anlage, die Schiffe hebt und senkt, wenn sie sich zwischen zwei unterschiedlich hohen Wasserständen bewegen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-116">Briefly, a canal lock is a device that raises and lowers boats as they travel between two stretches of water at different levels.</span></span> <span data-ttu-id="9cb3e-117">Eine Schleuse hat zwei Tore und einen Mechanismus zur Änderung des Wasserstands.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-117">A lock has two gates and some mechanism to change the water level.</span></span>

<span data-ttu-id="9cb3e-118">Im Normalbetrieb fährt ein Schiff in eines der Tore ein, wenn der Wasserstand in der Schleuse dem Wasserstand auf der Seite entspricht, auf der das Schiff hineinfährt.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-118">In its normal operation, a boat enters one of the gates while the water level in the lock matches the water level on the side the boat enters.</span></span> <span data-ttu-id="9cb3e-119">Einmal in der Schleuse wird der Wasserstand entsprechend dem Wasserstand geändert, bei dem das Boot die Schleuse verlässt.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-119">Once in the lock, the water level is changed to match the water level where the boat will leave the lock.</span></span> <span data-ttu-id="9cb3e-120">Sobald der Wasserstand mit dieser Seite übereinstimmt, öffnet sich das Tor auf der Ausfahrtseite.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-120">Once the water level matches that side, the gate on the exit side opens.</span></span> <span data-ttu-id="9cb3e-121">Sicherheitsmaßnahmen stellen sicher, dass ein Schiffsführer keine gefährliche Situation im Kanal herbeiführen kann.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-121">Safety measures make sure an operator can't create a dangerous situation in the canal.</span></span> <span data-ttu-id="9cb3e-122">Der Wasserstand kann nur geändert werden, wenn beide Tore geschlossen sind.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-122">The water level can be changed only when both gates are closed.</span></span> <span data-ttu-id="9cb3e-123">Es darf höchstens ein Tor geöffnet sein.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-123">At most one gate can be open.</span></span> <span data-ttu-id="9cb3e-124">Um ein Tor zu öffnen, muss der Wasserstand in der Schleuse mit dem Wasserstand außerhalb des zu öffnenden Tores übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-124">To open a gate, the water level in the lock must match the water level outside the gate being opened.</span></span>

<span data-ttu-id="9cb3e-125">Sie können eine C#-Klasse erstellen, um dieses Verhalten zu modellieren.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-125">You can build a C# class to model this behavior.</span></span> <span data-ttu-id="9cb3e-126">Eine `CanalLock`-Klasse muss Befehle zum Öffnen oder Schließen eines der Tore bieten.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-126">A `CanalLock` class would support commands to open or close either gate.</span></span> <span data-ttu-id="9cb3e-127">Sie muss andere Befehle aufweisen, mit denen sich der Wasserstand heben oder senken lässt.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-127">It would have other commands to raise or lower the water.</span></span> <span data-ttu-id="9cb3e-128">Die Klasse muss auch Eigenschaften zum Lesen der aktuellen Stellung der beiden Tore und des Wasserstands unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-128">The class should also support properties to read the current state of both gates and the water level.</span></span> <span data-ttu-id="9cb3e-129">Sicherheitsmaßnahmen werden mithilfe Ihrer Methoden implementiert.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-129">Your methods implement the safety measures.</span></span>

## <a name="define-a-class"></a><span data-ttu-id="9cb3e-130">Definieren einer Klasse</span><span class="sxs-lookup"><span data-stu-id="9cb3e-130">Define a class</span></span>

<span data-ttu-id="9cb3e-131">Sie erstellen eine Konsolenanwendung, um Ihre `CanalLock`-Klasse zu testen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-131">You'll build a console application to test your `CanalLock` class.</span></span> <span data-ttu-id="9cb3e-132">Erstellen Sie entweder in Visual Studio oder mit der .NET CLI ein neues Konsolenprojekt für .NET 5.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-132">Create a new console project for .NET 5 using either Visual Studio or the .NET CLI.</span></span> <span data-ttu-id="9cb3e-133">Fügen Sie dann eine neue Klasse hinzu, und nennen Sie sie `CanalLock`.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-133">Then, add a new class and name it `CanalLock`.</span></span> <span data-ttu-id="9cb3e-134">Als Nächstes entwerfen Sie Ihre öffentliche API, ohne jedoch die Methoden zu implementieren:</span><span class="sxs-lookup"><span data-stu-id="9cb3e-134">Next, design your public API, but leave the methods not implemented:</span></span>

:::code language="csharp" source="snippets/pattern-objects/InterimSteps.cs" ID="APIDesign":::

<span data-ttu-id="9cb3e-135">Der vorstehende Code initialisiert das Objekt so, dass beide Tore geschlossen sind und der Wasserstand niedrig ist.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-135">The preceding code initializes the object so both gates are closed, and the water level is low.</span></span> <span data-ttu-id="9cb3e-136">Schreiben Sie als Nächstes den folgenden Testcode in Ihre `Main`-Methode, um Sie bei der Erstellung einer ersten Implementierung der Klasse zu leiten:</span><span class="sxs-lookup"><span data-stu-id="9cb3e-136">Next, write the following test code in your `Main` method to guide you as you create a first implementation of the class:</span></span>

:::code language="csharp" source="snippets/pattern-objects/Program.cs" ID="HappyTests":::

<span data-ttu-id="9cb3e-137">Fügen Sie als Nächstes der `CanalLock`-Klasse eine erste Implementierung jeder Methode hinzu.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-137">Next, add a first implementation of each method in the `CanalLock` class.</span></span> <span data-ttu-id="9cb3e-138">Der folgende Code implementiert die Methoden der Klasse, ohne dass die Sicherheitsregeln berücksichtigt werden.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-138">The following code implements the methods of the class without concern to the safety rules.</span></span> <span data-ttu-id="9cb3e-139">Sicherheitstests fügen Sie später hinzu:</span><span class="sxs-lookup"><span data-stu-id="9cb3e-139">You'll add safety tests later:</span></span>

:::code language="csharp" source="snippets/pattern-objects/InterimSteps.cs" ID="FirstImplementation":::

<span data-ttu-id="9cb3e-140">Die Tests, die Sie bisher geschrieben haben, werden bestanden.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-140">The tests you've written so far pass.</span></span> <span data-ttu-id="9cb3e-141">Sie haben die Grundlagen implementiert.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-141">You've implemented the basics.</span></span> <span data-ttu-id="9cb3e-142">Schreiben Sie nun einen Test für die erste Fehlerbedingung.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-142">Now, write a test for the first failure condition.</span></span> <span data-ttu-id="9cb3e-143">Am Ende der vorherigen Tests sind beide Tore geschlossen, und der Wasserstand ist auf niedrig festgelegt.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-143">At the end of the previous tests, both gates are closed, and the water level is set to low.</span></span> <span data-ttu-id="9cb3e-144">Fügen Sie einen Test hinzu, um zu versuchen, das obere Tor zu öffnen:</span><span class="sxs-lookup"><span data-stu-id="9cb3e-144">Add a test to try opening the upper gate:</span></span>

:::code language="csharp" source="snippets/pattern-objects/Program.cs" ID="HighGateSafetyTest":::

<span data-ttu-id="9cb3e-145">Dieser Test schlägt fehl, da das Tor geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-145">This test fails because the gate opens.</span></span> <span data-ttu-id="9cb3e-146">Als erste Implementierung können Sie dies mit dem folgendem Code beheben:</span><span class="sxs-lookup"><span data-stu-id="9cb3e-146">As a first implementation, you could fix it with the following code:</span></span>

:::code language="csharp" source="snippets/pattern-objects/InterimSteps.cs" ID="SecondImplementation":::

<span data-ttu-id="9cb3e-147">Die Tests werden bestanden.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-147">Your tests pass.</span></span> <span data-ttu-id="9cb3e-148">Aber je mehr Tests Sie hinzufügen, desto mehr `if`-Klauseln werden Sie hinzufügen und verschiedene Eigenschaften testen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-148">But, as you add more tests, you'll add more and more `if` clauses and test different properties.</span></span> <span data-ttu-id="9cb3e-149">Schon bald werden diese Methoden zu kompliziert, je mehr Bedingungen Sie hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-149">Soon, these methods will get too complicated as you add more conditionals.</span></span>

## <a name="implement-the-commands-with-patterns"></a><span data-ttu-id="9cb3e-150">Implementieren der Befehle mit Mustern</span><span class="sxs-lookup"><span data-stu-id="9cb3e-150">Implement the commands with patterns</span></span>

<span data-ttu-id="9cb3e-151">Eine bessere Möglichkeit bieten *Muster* , um festzustellen, ob sich das Objekt in einem gültigen Zustand zur Ausführung eines Befehls befindet.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-151">A better way is to use *patterns* to determine if the object is in a valid state to execute a command.</span></span> <span data-ttu-id="9cb3e-152">Sie können ausdrücken, ob ein Befehl in Abhängigkeit von drei Variablen erlaubt ist: Stellung des Tores, Wasserstand und die neue Einstellung:</span><span class="sxs-lookup"><span data-stu-id="9cb3e-152">You can express if a command is allowed as a function of three variables: the state of the gate, the level of the water, and the new setting:</span></span>

| <span data-ttu-id="9cb3e-153">Neue Einstellung</span><span class="sxs-lookup"><span data-stu-id="9cb3e-153">New setting</span></span> | <span data-ttu-id="9cb3e-154">Stellung des Tores</span><span class="sxs-lookup"><span data-stu-id="9cb3e-154">Gate state</span></span> | <span data-ttu-id="9cb3e-155">Wasserstand</span><span class="sxs-lookup"><span data-stu-id="9cb3e-155">Water Level</span></span> | <span data-ttu-id="9cb3e-156">Ergebnis</span><span class="sxs-lookup"><span data-stu-id="9cb3e-156">Result</span></span>             |
| ----------- | ---------- | ----------- | ------------------ |
| <span data-ttu-id="9cb3e-157">Geschlossen</span><span class="sxs-lookup"><span data-stu-id="9cb3e-157">Closed</span></span>      | <span data-ttu-id="9cb3e-158">Geschlossen</span><span class="sxs-lookup"><span data-stu-id="9cb3e-158">Closed</span></span>     | <span data-ttu-id="9cb3e-159">Hoch</span><span class="sxs-lookup"><span data-stu-id="9cb3e-159">High</span></span>        | <span data-ttu-id="9cb3e-160">Geschlossen</span><span class="sxs-lookup"><span data-stu-id="9cb3e-160">Closed</span></span>             |
| <span data-ttu-id="9cb3e-161">Geschlossen</span><span class="sxs-lookup"><span data-stu-id="9cb3e-161">Closed</span></span>      | <span data-ttu-id="9cb3e-162">Geschlossen</span><span class="sxs-lookup"><span data-stu-id="9cb3e-162">Closed</span></span>     | <span data-ttu-id="9cb3e-163">Niedrig</span><span class="sxs-lookup"><span data-stu-id="9cb3e-163">Low</span></span>         | <span data-ttu-id="9cb3e-164">Geschlossen</span><span class="sxs-lookup"><span data-stu-id="9cb3e-164">Closed</span></span>             |
| <span data-ttu-id="9cb3e-165">Geschlossen</span><span class="sxs-lookup"><span data-stu-id="9cb3e-165">Closed</span></span>      | <span data-ttu-id="9cb3e-166">Geöffnet</span><span class="sxs-lookup"><span data-stu-id="9cb3e-166">Open</span></span>       | <span data-ttu-id="9cb3e-167">Hoch</span><span class="sxs-lookup"><span data-stu-id="9cb3e-167">High</span></span>        | <span data-ttu-id="9cb3e-168">Geöffnet</span><span class="sxs-lookup"><span data-stu-id="9cb3e-168">Open</span></span>               |
| <span data-ttu-id="9cb3e-169">~~Geschlossen~~</span><span class="sxs-lookup"><span data-stu-id="9cb3e-169">~~Closed~~</span></span>  | <span data-ttu-id="9cb3e-170">~~Geöffnet~~</span><span class="sxs-lookup"><span data-stu-id="9cb3e-170">~~Open~~</span></span>   | <span data-ttu-id="9cb3e-171">~~Niedrig~~</span><span class="sxs-lookup"><span data-stu-id="9cb3e-171">~~Low~~</span></span>     | <span data-ttu-id="9cb3e-172">~~Geschlossen~~</span><span class="sxs-lookup"><span data-stu-id="9cb3e-172">~~Closed~~</span></span>         |
| <span data-ttu-id="9cb3e-173">Öffnen</span><span class="sxs-lookup"><span data-stu-id="9cb3e-173">Open</span></span>        | <span data-ttu-id="9cb3e-174">Geschlossen</span><span class="sxs-lookup"><span data-stu-id="9cb3e-174">Closed</span></span>     | <span data-ttu-id="9cb3e-175">Hoch</span><span class="sxs-lookup"><span data-stu-id="9cb3e-175">High</span></span>        | <span data-ttu-id="9cb3e-176">Geöffnet</span><span class="sxs-lookup"><span data-stu-id="9cb3e-176">Open</span></span>               |
| <span data-ttu-id="9cb3e-177">Geöffnet</span><span class="sxs-lookup"><span data-stu-id="9cb3e-177">Open</span></span>        | <span data-ttu-id="9cb3e-178">Geschlossen</span><span class="sxs-lookup"><span data-stu-id="9cb3e-178">Closed</span></span>     | <span data-ttu-id="9cb3e-179">Niedrig</span><span class="sxs-lookup"><span data-stu-id="9cb3e-179">Low</span></span>         | <span data-ttu-id="9cb3e-180">Geschlossen (Fehler)</span><span class="sxs-lookup"><span data-stu-id="9cb3e-180">Closed (Error)</span></span>     |
| <span data-ttu-id="9cb3e-181">Geöffnet</span><span class="sxs-lookup"><span data-stu-id="9cb3e-181">Open</span></span>        | <span data-ttu-id="9cb3e-182">Geöffnet</span><span class="sxs-lookup"><span data-stu-id="9cb3e-182">Open</span></span>       | <span data-ttu-id="9cb3e-183">Hoch</span><span class="sxs-lookup"><span data-stu-id="9cb3e-183">High</span></span>        | <span data-ttu-id="9cb3e-184">Geöffnet</span><span class="sxs-lookup"><span data-stu-id="9cb3e-184">Open</span></span>               |
| <span data-ttu-id="9cb3e-185">~~Geöffnet~~</span><span class="sxs-lookup"><span data-stu-id="9cb3e-185">~~Open~~</span></span>    | <span data-ttu-id="9cb3e-186">~~Geöffnet~~</span><span class="sxs-lookup"><span data-stu-id="9cb3e-186">~~Open~~</span></span>   | <span data-ttu-id="9cb3e-187">~~Niedrig~~</span><span class="sxs-lookup"><span data-stu-id="9cb3e-187">~~Low~~</span></span>     | <span data-ttu-id="9cb3e-188">~~Geschlossen (Fehler)~~</span><span class="sxs-lookup"><span data-stu-id="9cb3e-188">~~Closed (Error)~~</span></span> |

<span data-ttu-id="9cb3e-189">In der vierten und letzten Zeile der Tabelle ist der Text durchgestrichen, weil sie ungültig ist.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-189">The fourth and last rows in the table have strike through text because they're invalid.</span></span> <span data-ttu-id="9cb3e-190">Der Code, den Sie jetzt hinzufügen, muss sicherstellen, dass das Hochwassertor niemals bei niedrigem Wasserstand geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-190">The code you're adding now should make sure the high water gate is never opened when the water is low.</span></span>  <span data-ttu-id="9cb3e-191">Diese Zustände können als ein einziger Switch-Ausdruck programmiert werden (denken Sie daran, dass `false` „Geschlossen“ bedeutet):</span><span class="sxs-lookup"><span data-stu-id="9cb3e-191">Those states can be coded as a single switch expression (remember that `false` indicates "Closed"):</span></span>

:::code language="csharp" source="snippets/pattern-objects/InterimSteps.cs" ID="ThirdImplementation":::

<span data-ttu-id="9cb3e-192">Versuchen Sie diese Version.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-192">Try this version.</span></span> <span data-ttu-id="9cb3e-193">Die Tests werden bestanden und der Code bestätigt.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-193">Your tests pass, validating the code.</span></span> <span data-ttu-id="9cb3e-194">Die vollständige Tabelle zeigt die möglichen Kombinationen von Eingaben und Ergebnissen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-194">The full table shows the possible combinations of inputs and results.</span></span> <span data-ttu-id="9cb3e-195">Das bedeutet, dass Sie und andere Entwickler schnell einen Blick auf die Tabelle werfen können, um festzustellen, dass Sie alle möglichen Eingaben abgedeckt haben.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-195">That means you and other developers can quickly look at the table and see that you've covered all the possible inputs.</span></span> <span data-ttu-id="9cb3e-196">Zur Vereinfachung kann auch der Compiler beitragen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-196">Even easier, the compiler can help as well.</span></span> <span data-ttu-id="9cb3e-197">Nachdem Sie den vorherigen Code hinzugefügt haben, sehen Sie, dass der Compiler eine Warnung generiert: *CS8524* bedeutet, dass der Switch-Ausdruck nicht alle möglichen Eingaben abdeckt.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-197">After you add the previous code, you can see that the compiler generates a warning: *CS8524* indicates the switch expression doesn't cover all possible inputs.</span></span> <span data-ttu-id="9cb3e-198">Der Grund für diese Warnung ist, dass eine der Eingaben den Typ `enum` hat.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-198">The reason for that warning is that one of the inputs is an `enum` type.</span></span> <span data-ttu-id="9cb3e-199">Der Compiler interpretiert „alle möglichen Eingaben“ als alle Eingaben des zugrunde liegenden Typs, typischerweise `int`.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-199">The compiler interprets "all possible inputs" as all inputs from the underlying type, typically an `int`.</span></span> <span data-ttu-id="9cb3e-200">Dieser `switch`-Ausdruck prüft nur die in `enum` deklarierten Werte.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-200">This `switch` expression only checks the values declared in the `enum`.</span></span> <span data-ttu-id="9cb3e-201">Um die Warnung zu entfernen, können Sie für den letzten Teil des Ausdrucks ein Muster des Typs „Alle abfangen und entsorgen“ hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-201">To remove the warning, you can add a catch-all discard pattern for the last arm of the expression.</span></span> <span data-ttu-id="9cb3e-202">Diese Bedingung löst eine Ausnahme aus, da sie eine ungültige Eingabe angibt:</span><span class="sxs-lookup"><span data-stu-id="9cb3e-202">This condition throws an exception, because it indicates invalid input:</span></span>

```csharp
_  => throw new InvalidOperationException("Invalid internal state"),
```

<span data-ttu-id="9cb3e-203">Der vorherige Switch-Arm muss der letzte in Ihrem `switch`-Ausdruck sein, da er mit allen Eingaben übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-203">The preceding switch arm must be last in your `switch` expression because it matches all inputs.</span></span> <span data-ttu-id="9cb3e-204">Experimentieren Sie, indem Sie ihn in der Reihenfolge nach vorn verschieben.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-204">Experiment by moving it earlier in the order.</span></span> <span data-ttu-id="9cb3e-205">Dies verursacht den Compilerfehler *CS8510* für nicht erreichbaren Code in einem Muster.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-205">That causes a compiler error *CS8510* for unreachable code in a pattern.</span></span>  <span data-ttu-id="9cb3e-206">Die natürliche Struktur von Switch-Ausdrücken ermöglicht es dem Compiler, Fehler und Warnungen für mögliche Fehlersituationen zu generieren.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-206">The natural structure of switch expressions enables the compiler to generate errors and warnings for possible mistakes.</span></span> <span data-ttu-id="9cb3e-207">Das „Sicherheitsnetz“ des Compilers erleichtert Ihnen, fehlerfreien Code in weniger Iterationen zu erstellen, und bietet Ihnen die Möglichkeit, Switch-Arme mit Platzhaltern frei zu kombinieren.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-207">The compiler "safety net" makes it easier for you to create correct code in fewer iterations, and the freedom to combine switch arms with wildcards.</span></span> <span data-ttu-id="9cb3e-208">Der Compiler löst Fehler aus, wenn Ihre Kombination zu unerreichbaren Armen führt, mit denen Sie nicht gerechnet haben, und Warnungen, wenn Sie einen benötigten Arm entfernen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-208">The compiler will issue errors if your combination results in unreachable arms you didn't expect, and warnings if you remove an arm that's needed.</span></span>

<span data-ttu-id="9cb3e-209">Die erste Änderung besteht darin, alle Arme zu kombinieren, bei denen der Befehl lautet, das Tor zu schließen. Das ist stets erlaubt.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-209">The first change is to combine all the arms where the command is to close the gate; that's always allowed.</span></span> <span data-ttu-id="9cb3e-210">Fügen Sie den folgenden Code als ersten Arm in den Switch-Ausdruck ein:</span><span class="sxs-lookup"><span data-stu-id="9cb3e-210">Add the following code as the first arm in your switch expression:</span></span>

```csharp
(false, _, _) => false,
```

<span data-ttu-id="9cb3e-211">Nachdem Sie den vorherigen Switch-Arm hinzugefügt haben, erhalten Sie vier Compilerfehler, einen in jedem der Arme, in denen der Befehl `false` ist.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-211">After you add the previous switch arm, you'll get four compiler errors, one on each of the arms where the command is `false`.</span></span> <span data-ttu-id="9cb3e-212">Diese Arme sind bereits durch den neu hinzugefügten Arm abgedeckt.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-212">Those arms are already covered by the newly added arm.</span></span> <span data-ttu-id="9cb3e-213">Sie können diese vier Zeilen sicher entfernen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-213">You can safely remove those four lines.</span></span> <span data-ttu-id="9cb3e-214">Sie wollten mit diesem neuen Switch-Arm diese Bedingungen ersetzen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-214">You intended this new switch arm to replace those conditions.</span></span>

<span data-ttu-id="9cb3e-215">Als Nächstes können Sie die vier Arme vereinfachen, bei denen der Befehl lautet, das Tor zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-215">Next, you can simplify the four arms where the command is to open the gate.</span></span> <span data-ttu-id="9cb3e-216">In beiden Fällen, in denen der Wasserstand hoch ist, kann das Tor geöffnet werden.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-216">In both cases where the water level is high, the gate can be opened.</span></span> <span data-ttu-id="9cb3e-217">(In einem ist es bereits geöffnet.) Ein Fall, in dem der Wasserstand niedrig ist, löst eine Ausnahme aus, der andere darf nicht passieren.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-217">(In one, it's already open.) One case where the water level is low throws an exception, and the other shouldn't happen.</span></span> <span data-ttu-id="9cb3e-218">Es sollte sicher sein, die gleiche Ausnahme auszulösen, wenn sich die Schleuse bereits in einer ungültigen Stellung befindet.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-218">It should be safe to throw the same exception if the water lock is already in an invalid state.</span></span> <span data-ttu-id="9cb3e-219">Sie können die folgenden Vereinfachungen für diese Arme vornehmen:</span><span class="sxs-lookup"><span data-stu-id="9cb3e-219">You can make the following simplifications for those arms:</span></span>

```csharp
(true, _, WaterLevel.High) => true,
(true, false, WaterLevel.Low) => throw new InvalidOperationException("Cannot open high gate when the water is low"),
_ => throw new InvalidOperationException("Invalid internal state"),
```

<span data-ttu-id="9cb3e-220">Führen Sie die Tests erneut aus, die bestanden werden.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-220">Run your tests again, and they pass.</span></span> <span data-ttu-id="9cb3e-221">Hier ist die endgültige Version der `SetHighGate`-Methode:</span><span class="sxs-lookup"><span data-stu-id="9cb3e-221">Here's the final version of the `SetHighGate` method:</span></span>

:::code language="csharp" source="snippets/pattern-objects/CanalLock.cs" ID="FinalImplementaton":::

## <a name="implement-patterns-yourself"></a><span data-ttu-id="9cb3e-222">Eigenständiges Implementieren der Muster</span><span class="sxs-lookup"><span data-stu-id="9cb3e-222">Implement patterns yourself</span></span>

<span data-ttu-id="9cb3e-223">Nachdem Sie die Technik kennengelernt haben, füllen Sie die Methoden `SetLowGate` und `SetWaterLevel` selbst aus.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-223">Now that you've seen the technique, fill in the `SetLowGate` and `SetWaterLevel` methods yourself.</span></span>  <span data-ttu-id="9cb3e-224">Beginnen Sie mit dem Hinzufügen des folgenden Codes, um ungültige Vorgänge in diesen Methoden zu testen:</span><span class="sxs-lookup"><span data-stu-id="9cb3e-224">Start by adding the following code to test invalid operations on those methods:</span></span>

:::code language="csharp" source="snippets/pattern-objects/Program.cs" ID="FinalTestCode":::

<span data-ttu-id="9cb3e-225">Führen Sie Ihre Anwendung erneut aus.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-225">Run your application again.</span></span> <span data-ttu-id="9cb3e-226">Sie erleben, wie die neuen Tests fehlschlagen und die Kanalschleuse in einen ungültigen Zustand gerät.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-226">You can see the new tests fail, and the canal lock gets into an invalid state.</span></span> <span data-ttu-id="9cb3e-227">Versuchen Sie, die restlichen Methoden selbst zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-227">Try to implement the remaining methods yourself.</span></span> <span data-ttu-id="9cb3e-228">Die Methode zur Festlegung des unteren Tores sollte ähnlich wie die Methode zur Festlegung des oberen Tores sein.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-228">The method to set the lower gate should be similar to the method to set the upper gate.</span></span> <span data-ttu-id="9cb3e-229">Die Methode zum Ändern des Wasserstands hat unterschiedliche Prüfungen, sollte aber eine ähnliche Struktur aufweisen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-229">The method that changes the water level has different checks, but should follow a similar structure.</span></span> <span data-ttu-id="9cb3e-230">Möglicherweise finden Sie es hilfreich, dasselbe Verfahren auch für die Methode zu verwenden, mit der der Wasserstand festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-230">You may find it helpful to use the same process for the method that sets the water level.</span></span> <span data-ttu-id="9cb3e-231">Beginnen Sie mit allen vier Eingaben: Stellung der beiden Tore, aktueller Wasserstand und geforderter neuer Wasserstand.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-231">Start with all four inputs: The state of both gates, the current state of the water level, and the requested new water level.</span></span> <span data-ttu-id="9cb3e-232">Der Switch-Ausdruck sollte wie folgt beginnen:</span><span class="sxs-lookup"><span data-stu-id="9cb3e-232">The switch expression should start with:</span></span>

```csharp
CanalLockWaterLevel = (newLevel, CanalLockWaterLevel, LowWaterGateOpen, HighWaterGateOpen) switch
{
    // elided
};
```

<span data-ttu-id="9cb3e-233">Es gibt insgesamt 16 auszufüllende Switch-Arme.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-233">You'll have 16 total switch arms to fill in.</span></span> <span data-ttu-id="9cb3e-234">Testen und vereinfachen Sie das Ganze im Anschluss.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-234">Then, test and simplify.</span></span>

<span data-ttu-id="9cb3e-235">Haben Sie Methoden in etwa wie folgt gestaltet?</span><span class="sxs-lookup"><span data-stu-id="9cb3e-235">Did you make methods something like this?</span></span>

:::code language="csharp" source="snippets/pattern-objects/CanalLock.cs" ID="FinalExercise":::

<span data-ttu-id="9cb3e-236">Die Tests sollten bestanden werden, und die Schleuse sollte sicher betrieben werden.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-236">Your tests should pass, and the canal lock should operate safely.</span></span>

## <a name="summary"></a><span data-ttu-id="9cb3e-237">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="9cb3e-237">Summary</span></span>

<span data-ttu-id="9cb3e-238">In diesem Tutorial haben Sie gelernt, mithilfe eines Musterabgleichs den internen Zustand eines Objekts zu überprüfen, ehe Änderungen an diesem Zustand vorgenommen werden.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-238">In this tutorial, you learned to use pattern matching to check the internal state of an object before applying any changes to that state.</span></span> <span data-ttu-id="9cb3e-239">Sie können Kombinationen von Eigenschaften überprüfen.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-239">You can check combinations of properties.</span></span> <span data-ttu-id="9cb3e-240">Sobald Sie Tabellen für beliebige dieser Übergänge erstellt haben, testen Sie Ihren Code, und vereinfachen ihn dann hinsichtlich Lesbarkeit und Wartbarkeit.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-240">Once you've built tables for any of those transitions, you test your code, then simplify for readability and maintainability.</span></span> <span data-ttu-id="9cb3e-241">Aus diesen anfänglichen Refactorings können sich weitere Refactorings ergeben, die den internen Zustand validieren oder andere API-Änderungen verwalten.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-241">These initial refactorings may suggest further refactorings that validate internal state or manage other API changes.</span></span> <span data-ttu-id="9cb3e-242">In diesem Tutorial wurden Klassen und Objekte mit einem eher datenorientierten, musterbasierten Ansatz kombiniert, um diese Klassen zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="9cb3e-242">This tutorial combined classes and objects with a more data-oriented, pattern-based approach to implement those classes.</span></span>
