---
title: 'Reservierte C#-Attribute: Statische Analysen, die NULL-Werte zulassen'
ms.date: 04/14/2020
description: Diese Attribute werden vom Compiler interpretiert, um eine bessere statische Analyse für Nullable- und Non-Nullable-Verweistypen zu liefern.
ms.openlocfilehash: 6678cd21de23d4ed391eff089e33939b5adff0fa
ms.sourcegitcommit: b59237ca4ec763969a0dd775a3f8f39f8c59fe24
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 10/12/2020
ms.locfileid: "91955602"
---
# <a name="reserved-attributes-contribute-to-the-compilers-null-state-static-analysis"></a><span data-ttu-id="efc77-103">Reservierte Attribute zur Unterstützung der statischen NULL-Zustandsanalyse des Compilers</span><span class="sxs-lookup"><span data-stu-id="efc77-103">Reserved attributes contribute to the compiler's null state static analysis</span></span>

<span data-ttu-id="efc77-104">In einem Nullable-Kontext führt der Compiler eine statische Analyse des Codes durch, um den NULL-Zustand aller Verweistypvariablen zu bestimmen:</span><span class="sxs-lookup"><span data-stu-id="efc77-104">In a nullable context, the compiler performs static analysis of code to determine the null state of all reference type variables:</span></span>

- <span data-ttu-id="efc77-105">*Nicht NULL*: Die statische Analyse bestimmt, dass einer Variable ein Nicht-NULL-Wert zugewiesen wird.</span><span class="sxs-lookup"><span data-stu-id="efc77-105">*not null*: Static analysis determines that a variable is assigned a non-null value.</span></span>
- <span data-ttu-id="efc77-106">*Möglicherweise NULL*: Die statische Analyse kann nicht bestimmen, ob einer Variable ein Nicht-NULL-Wert zugewiesen ist.</span><span class="sxs-lookup"><span data-stu-id="efc77-106">*maybe null*: Static analysis cannot determine that a variable is assigned a non-null value.</span></span>

<span data-ttu-id="efc77-107">Sie können verschiedene Attribute anwenden, die dem Compiler Informationen zur Semantik Ihrer APIs liefern.</span><span class="sxs-lookup"><span data-stu-id="efc77-107">You can apply a number of attributes that provide information to the compiler about the semantics of your APIs.</span></span> <span data-ttu-id="efc77-108">Diese Informationen unterstützen den Compiler dabei, eine statische Analyse durchzuführen und zu bestimmen, wann eine Variable ungleich NULL ist.</span><span class="sxs-lookup"><span data-stu-id="efc77-108">That information helps the compiler perform static analysis and determine when a variable is not null.</span></span> <span data-ttu-id="efc77-109">Im vorliegenden Artikel werden jedes dieser Attribute und seine Verwendung kurz beschrieben.</span><span class="sxs-lookup"><span data-stu-id="efc77-109">This article provides a brief description of each of those attributes and how to use them.</span></span> <span data-ttu-id="efc77-110">Alle Beispiele gehen von C# 8.0 oder höher aus, und der Code steht in einem Nullable-Kontext.</span><span class="sxs-lookup"><span data-stu-id="efc77-110">All the examples assume C# 8.0 or newer, and the code is in a nullable context.</span></span>

<span data-ttu-id="efc77-111">Beginnen wir mit einem bekannten Beispiel.</span><span class="sxs-lookup"><span data-stu-id="efc77-111">Let's start with a familiar example.</span></span> <span data-ttu-id="efc77-112">Angenommen, Ihre Bibliothek verfügt über die folgende API zum Abrufen einer Ressourcenzeichenfolge:</span><span class="sxs-lookup"><span data-stu-id="efc77-112">Imagine your library has the following API to retrieve a resource string:</span></span>

```csharp
bool TryGetMessage(string key, out string message)
```

<span data-ttu-id="efc77-113">Das vorstehende Beispiel folgt dem bekannten `Try*`-Muster in .NET.</span><span class="sxs-lookup"><span data-stu-id="efc77-113">The preceding example follows the familiar `Try*` pattern in .NET.</span></span> <span data-ttu-id="efc77-114">Es sind zwei Verweisargumente für diese API vorhanden: die Parameter `key` und `message`.</span><span class="sxs-lookup"><span data-stu-id="efc77-114">There are two reference arguments for this API: the `key` and the `message` parameter.</span></span> <span data-ttu-id="efc77-115">Diese API umfasst die folgenden Regeln in Bezug auf die NULL-Zulässigkeit dieser Argumente:</span><span class="sxs-lookup"><span data-stu-id="efc77-115">This API has the following rules relating to the nullness of these arguments:</span></span>

- <span data-ttu-id="efc77-116">Aufrufer dürfen nicht `null` als Argument für `key` übergeben.</span><span class="sxs-lookup"><span data-stu-id="efc77-116">Callers shouldn't pass `null` as the argument for `key`.</span></span>
- <span data-ttu-id="efc77-117">Aufrufer können eine Variable übergeben, deren Wert `null` als Argument für `message` lautet.</span><span class="sxs-lookup"><span data-stu-id="efc77-117">Callers can pass a variable whose value is `null` as the argument for `message`.</span></span>
- <span data-ttu-id="efc77-118">Wenn die Methode `TryGetMessage` den Wert `true` zurückgibt, ist der Wert von `message` ungleich NULL.</span><span class="sxs-lookup"><span data-stu-id="efc77-118">If the `TryGetMessage` method returns `true`, the value of `message` isn't null.</span></span> <span data-ttu-id="efc77-119">Wenn der Rückgabewert `false,` lautet, ist der Wert von `message` (und der zugehörige NULL-Zustand) NULL.</span><span class="sxs-lookup"><span data-stu-id="efc77-119">If the return value is `false,` the value of `message` (and its null state) is null.</span></span>

<span data-ttu-id="efc77-120">Die Regel für `key` kann durch den Variablentyp ausgedrückt werden: `key` muss ein Non-Nullable-Verweistyp sein.</span><span class="sxs-lookup"><span data-stu-id="efc77-120">The rule for `key` can be expressed by the variable type: `key` should be a non-nullable reference type.</span></span> <span data-ttu-id="efc77-121">Der Parameter `message` ist komplexer.</span><span class="sxs-lookup"><span data-stu-id="efc77-121">The `message` parameter is more complex.</span></span> <span data-ttu-id="efc77-122">Er lässt `null` als Argument zu, aber garantiert bei einem erfolgreichen Vorgang, dass das `out`-Argument nicht NULL ist.</span><span class="sxs-lookup"><span data-stu-id="efc77-122">It allows `null` as the argument, but guarantees that, on success, that `out` argument isn't null.</span></span> <span data-ttu-id="efc77-123">Für diese Szenarien ist ein umfangreicheres Vokabular zum Beschreiben der Erwartungen erforderlich.</span><span class="sxs-lookup"><span data-stu-id="efc77-123">For these scenarios, you need a richer vocabulary to describe the expectations.</span></span>

<span data-ttu-id="efc77-124">Es wurden mehrere Attribute hinzugefügt, um zusätzliche Informationen über den NULL-Zustand von Variablen auszudrücken.</span><span class="sxs-lookup"><span data-stu-id="efc77-124">Several attributes have been added to express additional information about the null state of variables.</span></span> <span data-ttu-id="efc77-125">In jeglichem Code, der vor C# 8.0 und der Einführung von Nullable-Verweistypen geschrieben wurde, wurden *NULL-Werte nicht beachtet*.</span><span class="sxs-lookup"><span data-stu-id="efc77-125">All code you wrote before C# 8 introduced nullable reference types was *null oblivious*.</span></span> <span data-ttu-id="efc77-126">Dies bedeutet, dass eine Verweistypvariable NULL sein konnte, aber NULL-Überprüfungen nicht erforderlich waren.</span><span class="sxs-lookup"><span data-stu-id="efc77-126">That means any reference type variable may be null, but null checks aren't required.</span></span> <span data-ttu-id="efc77-127">Sobald Ihr Code *Nullable-fähig* ist, ändern sich diese Regeln.</span><span class="sxs-lookup"><span data-stu-id="efc77-127">Once your code is *nullable aware*, those rules change.</span></span> <span data-ttu-id="efc77-128">Verweistypen dürfen nie den Wert `null` aufweisen, und Nullable-Verweistypen müssen auf `null` überprüft werden, bevor sie dereferenziert werden können.</span><span class="sxs-lookup"><span data-stu-id="efc77-128">Reference types should never be the `null` value, and nullable reference types must be checked against `null` before being dereferenced.</span></span>

<span data-ttu-id="efc77-129">Die Regeln für Ihre APIs sind wahrscheinlich komplizierter, wie im `TryGetValue`-API-Szenario deutlich geworden ist.</span><span class="sxs-lookup"><span data-stu-id="efc77-129">The rules for your APIs are likely more complicated, as you saw with the `TryGetValue` API scenario.</span></span> <span data-ttu-id="efc77-130">Viele Ihrer APIs umfassen komplexere Regeln in Bezug darauf, wann Variablen den Wert `null` annehmen können oder nicht.</span><span class="sxs-lookup"><span data-stu-id="efc77-130">Many of your APIs have more complex rules for when variables can or can't be `null`.</span></span> <span data-ttu-id="efc77-131">In diesen Fällen verwenden Sie eines der folgenden Attribute zum Ausdrücken dieser Regeln:</span><span class="sxs-lookup"><span data-stu-id="efc77-131">In these cases, you'll use one of the following attributes to express those rules:</span></span>

- <span data-ttu-id="efc77-132">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): Ein Non-Nullable-Eingabeargument darf NULL sein.</span><span class="sxs-lookup"><span data-stu-id="efc77-132">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="efc77-133">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): Ein Nullable-Eingabeargument darf nie NULL sein.</span><span class="sxs-lookup"><span data-stu-id="efc77-133">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>
- <span data-ttu-id="efc77-134">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): Ein Non-Nullable-Rückgabewert darf NULL sein.</span><span class="sxs-lookup"><span data-stu-id="efc77-134">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="efc77-135">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): Ein Nullable-Rückgabetyp ist niemals NULL.</span><span class="sxs-lookup"><span data-stu-id="efc77-135">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>
- <span data-ttu-id="efc77-136">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): Ein Non-Nullable-Eingabeargument darf NULL sein, wenn die Methode den angegebenen `bool`-Wert zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="efc77-136">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="efc77-137">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): Ein Nullable-Eingabeargument ist nicht NULL, wenn die Methode den angegebenen `bool`-Wert zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="efc77-137">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument will not be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="efc77-138">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): Ein Rückgabewert ist nicht NULL, wenn das Argument für den angegebenen Parameter nicht NULL ist.</span><span class="sxs-lookup"><span data-stu-id="efc77-138">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the argument for the specified parameter isn't null.</span></span>
- <span data-ttu-id="efc77-139">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): Die Methode gibt niemals ein Ergebnis zurück.</span><span class="sxs-lookup"><span data-stu-id="efc77-139">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): A method never returns.</span></span> <span data-ttu-id="efc77-140">Anders ausgedrückt: Die Methode löst immer eine Ausnahme aus.</span><span class="sxs-lookup"><span data-stu-id="efc77-140">In other words, it always throws an exception.</span></span>
- <span data-ttu-id="efc77-141">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): Die Methode gibt niemals ein Ergebnis zurück, wenn der zugeordnete Parameter `bool` einen angegebenen Wert aufweist.</span><span class="sxs-lookup"><span data-stu-id="efc77-141">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): This method never returns if the associated `bool` parameter has the specified value.</span></span>

<span data-ttu-id="efc77-142">Die vorherigen Beschreibungen sind eine kurze Referenz zur Funktionsweise jedes Attributs.</span><span class="sxs-lookup"><span data-stu-id="efc77-142">The preceding descriptions are a quick reference to what each attribute does.</span></span> <span data-ttu-id="efc77-143">In den folgenden Abschnitten werden das Verhalten und die Bedeutung der Attribute näher beschrieben.</span><span class="sxs-lookup"><span data-stu-id="efc77-143">Each following section describes the behavior and meaning more thoroughly.</span></span>

<span data-ttu-id="efc77-144">Durch das Hinzufügen dieser Attribute erhält der Compiler mehr Informationen über die Regeln für Ihre API.</span><span class="sxs-lookup"><span data-stu-id="efc77-144">Adding these attributes gives the compiler more information about the rules for your API.</span></span> <span data-ttu-id="efc77-145">Wenn Aufrufcode in einem Nullable-aktivierten Kontext kompiliert wird, warnt der Compiler Aufrufer, wenn sie diese Regeln verletzen.</span><span class="sxs-lookup"><span data-stu-id="efc77-145">When calling code is compiled in a nullable enabled context, the compiler will warn callers when they violate those rules.</span></span> <span data-ttu-id="efc77-146">Diese Attribute aktivieren keine zusätzlichen Überprüfungen für Ihre Implementierung.</span><span class="sxs-lookup"><span data-stu-id="efc77-146">These attributes don't enable additional checks on your implementation.</span></span>

## <a name="specify-preconditions-allownull-and-disallownull"></a><span data-ttu-id="efc77-147">Angeben von Vorbedingungen: `AllowNull` und `DisallowNull`</span><span class="sxs-lookup"><span data-stu-id="efc77-147">Specify preconditions: `AllowNull` and `DisallowNull`</span></span>

<span data-ttu-id="efc77-148">Betrachten Sie eine Eigenschaft mit Lese-/Schreibzugriff, die niemals `null` zurückgibt, weil sie einen angemessen Standardwert aufweist.</span><span class="sxs-lookup"><span data-stu-id="efc77-148">Consider a read/write property that never returns `null` because it has a reasonable default value.</span></span> <span data-ttu-id="efc77-149">Aufrufer übergeben `null` an die set-Zugriffsmethode, wenn diese auf den Standardwert festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="efc77-149">Callers pass `null` to the set accessor when setting it to that default value.</span></span> <span data-ttu-id="efc77-150">Denken Sie zum Beispiel an ein Messagingsystem, das in einem Livechat nach einem Benutzernamen fragt.</span><span class="sxs-lookup"><span data-stu-id="efc77-150">For example, consider a messaging system that asks for a screen name in a chat room.</span></span> <span data-ttu-id="efc77-151">Wenn kein Name angegeben wird, erzeugt das System einen zufälligen Namen:</span><span class="sxs-lookup"><span data-stu-id="efc77-151">If none is provided, the system generates a random name:</span></span>

```csharp
public string ScreenName
{
   get => _screenName;
   set => _screenName = value ?? GenerateRandomScreenName();
}
private string _screenName;
```

<span data-ttu-id="efc77-152">Wenn Sie den vorstehenden Code in einem Kontext ohne Nullable-Beachtung kompilieren, ist alles in Ordnung.</span><span class="sxs-lookup"><span data-stu-id="efc77-152">When you compile the preceding code in a nullable oblivious context, everything is fine.</span></span> <span data-ttu-id="efc77-153">Sobald Sie Nullable-Verweistypen aktivieren, wird die `ScreenName`-Eigenschaft zu einem Non-Nullable-Verweis.</span><span class="sxs-lookup"><span data-stu-id="efc77-153">Once you enable nullable reference types, the `ScreenName` property becomes a non-nullable reference.</span></span> <span data-ttu-id="efc77-154">Dies ist für die `get`-Zugriffsmethode korrekt: sie gibt nie `null` zurück.</span><span class="sxs-lookup"><span data-stu-id="efc77-154">That's correct for the `get` accessor: it never returns `null`.</span></span> <span data-ttu-id="efc77-155">Aufrufer müssen die zurückgegebene Eigenschaft für `null` nicht überprüfen.</span><span class="sxs-lookup"><span data-stu-id="efc77-155">Callers don't need to check the returned property for `null`.</span></span> <span data-ttu-id="efc77-156">Aber bei Festlegung der Eigenschaft auf `null` wird jetzt eine Warnung generiert.</span><span class="sxs-lookup"><span data-stu-id="efc77-156">But now setting the property to `null` generates a warning.</span></span> <span data-ttu-id="efc77-157">Um diese Art von Code weiterhin zu unterstützen, fügen Sie der Eigenschaft das Attribut <xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute?displayProperty=nameWithType> hinzu, wie im folgenden Code gezeigt:</span><span class="sxs-lookup"><span data-stu-id="efc77-157">In order to continue to support this type of code, you add the <xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute?displayProperty=nameWithType> attribute to the property, as shown in the following code:</span></span>

```csharp
[AllowNull]
public string ScreenName
{
   get => _screenName;
   set => _screenName = value ?? GenerateRandomScreenName();
}
private string _screenName = GenerateRandomScreenName();
```

<span data-ttu-id="efc77-158">Sie müssen möglicherweise eine `using`-Direktive für <xref:System.Diagnostics.CodeAnalysis> hinzufügen, um diese und weitere Attribute zu verwenden, die in diesem Artikel besprochen werden.</span><span class="sxs-lookup"><span data-stu-id="efc77-158">You may need to add a `using` directive for <xref:System.Diagnostics.CodeAnalysis> to use this and other attributes discussed in this article.</span></span> <span data-ttu-id="efc77-159">Das Attribut wird auf die Eigenschaft angewendet, nicht auf die `set`-Zugriffsmethode.</span><span class="sxs-lookup"><span data-stu-id="efc77-159">The attribute is applied to the property, not the `set` accessor.</span></span> <span data-ttu-id="efc77-160">Das `AllowNull`-Attribut gibt *Vorbedingungen* an und wird nur auf Eingaben angewendet.</span><span class="sxs-lookup"><span data-stu-id="efc77-160">The `AllowNull` attribute specifies *pre-conditions*, and only applies to inputs.</span></span> <span data-ttu-id="efc77-161">Die `get`-Zugriffsmethode umfasst einen Rückgabewert, aber keine Eingabeargumente.</span><span class="sxs-lookup"><span data-stu-id="efc77-161">The `get` accessor has a return value, but no input arguments.</span></span> <span data-ttu-id="efc77-162">Deshalb gilt das `AllowNull`-Attribut nur für die `set`-Zugriffsmethode.</span><span class="sxs-lookup"><span data-stu-id="efc77-162">Therefore, the `AllowNull` attribute only applies to the `set` accessor.</span></span>

<span data-ttu-id="efc77-163">Das vorangehende Beispiel veranschaulicht, wonach beim Hinzufügen des `AllowNull`-Attributs für ein Argument gesucht werden muss:</span><span class="sxs-lookup"><span data-stu-id="efc77-163">The preceding example demonstrates what to look for when adding the `AllowNull` attribute on an argument:</span></span>

1. <span data-ttu-id="efc77-164">Der allgemeine Vertrag für diese Variable sieht vor, dass sie nicht `null` sein darf, deshalb wird ein Non-Nullable-Verweistyp benötigt.</span><span class="sxs-lookup"><span data-stu-id="efc77-164">The general contract for that variable is that it shouldn't be `null`, so you want a non-nullable reference type.</span></span>
1. <span data-ttu-id="efc77-165">Es gibt Szenarien, in denen die Eingabevariable den Wert `null` annimmt, obwohl dies nicht häufig der Fall ist.</span><span class="sxs-lookup"><span data-stu-id="efc77-165">There are scenarios for the input variable to be `null`, though they aren't the most common usage.</span></span>

<span data-ttu-id="efc77-166">In den meisten Fällen verwenden Sie dieses Attribut für Eigenschaften oder `in`-, `out`- und `ref`-Argumente.</span><span class="sxs-lookup"><span data-stu-id="efc77-166">Most often you'll need this attribute for properties, or `in`, `out`, and `ref` arguments.</span></span> <span data-ttu-id="efc77-167">Das `AllowNull`-Attribut stellt die beste Wahl dar, wenn eine Variable typischerweise ungleich NULL ist, Sie aber `null` als Vorbedingung zulassen müssen.</span><span class="sxs-lookup"><span data-stu-id="efc77-167">The `AllowNull` attribute is the best choice when a variable is typically non-null, but you need to allow `null` as a precondition.</span></span>

<span data-ttu-id="efc77-168">Vergleichen Sie dies mit Szenarien für die Verwendung von `DisallowNull`: Mit diesem Attribut legen Sie fest, dass eine Eingabevariable eines Nullable-Verweistyps nicht `null` sein darf.</span><span class="sxs-lookup"><span data-stu-id="efc77-168">Contrast that with scenarios for using `DisallowNull`: You use this attribute to specify that an input variable of a nullable reference type shouldn't be `null`.</span></span> <span data-ttu-id="efc77-169">Nehmen wir als Beispiel eine Eigenschaft, bei der `null` der Standardwert ist und Clients die Eigenschaft nur auf einen Wert ungleich NULL festlegen können.</span><span class="sxs-lookup"><span data-stu-id="efc77-169">Consider a property where `null` is the default value, but clients can only set it to a non-null value.</span></span> <span data-ttu-id="efc77-170">Betrachten Sie folgenden Code:</span><span class="sxs-lookup"><span data-stu-id="efc77-170">Consider the following code:</span></span>

```csharp
public string ReviewComment
{
    get => _comment;
    set => _comment = value ?? throw new ArgumentNullException(nameof(value), "Cannot set to null");
}
string _comment;
```

<span data-ttu-id="efc77-171">Der vorstehende Code ist der beste Weg, um in Ihrem Entwurf auszudrücken, dass `ReviewComment` den Wert `null` annehmen könnte, aber nicht auf `null` festgelegt werden kann.</span><span class="sxs-lookup"><span data-stu-id="efc77-171">The preceding code is the best way to express your design that the `ReviewComment` could be `null`, but can't be set to `null`.</span></span> <span data-ttu-id="efc77-172">Sobald dieser Code Nullable-fähig ist, können Sie dieses Konzept für Aufrufer mit <xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute?displayProperty=nameWithType> klarer ausdrücken:</span><span class="sxs-lookup"><span data-stu-id="efc77-172">Once this code is nullable aware, you can express this concept more clearly to callers using the <xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute?displayProperty=nameWithType>:</span></span>

```csharp
[DisallowNull]
public string? ReviewComment
{
    get => _comment;
    set => _comment = value ?? throw new ArgumentNullException(nameof(value), "Cannot set to null");
}
string? _comment;
```

<span data-ttu-id="efc77-173">In einem Nullable-Kontext kann die `get`-Zugriffsmethode von `ReviewComment` den Standardwert `null` zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="efc77-173">In a nullable context, the `ReviewComment` `get` accessor could return the default value of `null`.</span></span> <span data-ttu-id="efc77-174">Der Compiler gibt eine Warnung aus, dass vor dem Zugriff eine Überprüfung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="efc77-174">The compiler warns that it must be checked before access.</span></span> <span data-ttu-id="efc77-175">Darüber hinaus werden Aufrufer gewarnt, dass der Wert `null` zwar möglich ist, Aufrufer aber den Wert `null` nicht explizit festlegen sollten.</span><span class="sxs-lookup"><span data-stu-id="efc77-175">Furthermore, it warns callers that, even though it could be `null`, callers shouldn't explicitly set it to `null`.</span></span> <span data-ttu-id="efc77-176">Das `DisallowNull`-Attribut gibt ebenfalls eine *Vorbedingung* an, es hat keine Auswirkung auf die `get`-Zugriffsmethode.</span><span class="sxs-lookup"><span data-stu-id="efc77-176">The `DisallowNull` attribute also specifies a *pre-condition*, it does not affect the `get` accessor.</span></span> <span data-ttu-id="efc77-177">Sie verwenden das `DisallowNull`-Attribut, wenn folgende Punkte zutreffen:</span><span class="sxs-lookup"><span data-stu-id="efc77-177">You use the `DisallowNull` attribute when you observe these characteristics about:</span></span>

1. <span data-ttu-id="efc77-178">Die Variable könnte in wichtigen Szenarien den Wert `null` annehmen, häufig bei der ersten Instanziierung.</span><span class="sxs-lookup"><span data-stu-id="efc77-178">The variable could be `null` in core scenarios, often when first instantiated.</span></span>
1. <span data-ttu-id="efc77-179">Die Variable darf nicht explizit auf `null` festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="efc77-179">The variable shouldn't be explicitly set to `null`.</span></span>

<span data-ttu-id="efc77-180">Diese Situationen sind häufig in Code anzutreffen, in dem *NULL-Werte ursprünglich nicht beachtet wurden*.</span><span class="sxs-lookup"><span data-stu-id="efc77-180">These situations are common in code that was originally *null oblivious*.</span></span> <span data-ttu-id="efc77-181">Es kann vorkommen, dass Objekteigenschaften in zwei unterschiedlichen Initialisierungsvorgängen festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="efc77-181">It may be that object properties are set in two distinct initialization operations.</span></span> <span data-ttu-id="efc77-182">Einige Eigenschaften werden nur festgelegt, nachdem einige asynchrone Vorgänge ausgeführt wurden.</span><span class="sxs-lookup"><span data-stu-id="efc77-182">It may be that some properties are set only after some asynchronous work has completed.</span></span>

<span data-ttu-id="efc77-183">Mit den Attributen `AllowNull` und `DisallowNull` können Sie festlegen, dass Vorbedingungen für Variablen nicht den Nullable-Anmerkungen für diese Variablen entsprechen dürfen.</span><span class="sxs-lookup"><span data-stu-id="efc77-183">The `AllowNull` and `DisallowNull` attributes enable you to specify that preconditions on variables may not match the nullable annotations on those variables.</span></span> <span data-ttu-id="efc77-184">Sie liefern zusätzliche Informationen zu den Merkmalen Ihrer API.</span><span class="sxs-lookup"><span data-stu-id="efc77-184">These provide more detail about the characteristics of your API.</span></span> <span data-ttu-id="efc77-185">Diese zusätzlichen Informationen helfen Aufrufern, Ihre API korrekt zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="efc77-185">This additional information helps callers use your API correctly.</span></span> <span data-ttu-id="efc77-186">Wie bereits erwähnt, geben Sie Vorbedingungen mit den folgenden Attributen an:</span><span class="sxs-lookup"><span data-stu-id="efc77-186">Remember you specify preconditions using the following attributes:</span></span>

- <span data-ttu-id="efc77-187">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): Ein Non-Nullable-Eingabeargument darf NULL sein.</span><span class="sxs-lookup"><span data-stu-id="efc77-187">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="efc77-188">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): Ein Nullable-Eingabeargument darf nie NULL sein.</span><span class="sxs-lookup"><span data-stu-id="efc77-188">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>

## <a name="specify-post-conditions-maybenull-and-notnull"></a><span data-ttu-id="efc77-189">Angeben von Nachbedingungen: `MaybeNull` und `NotNull`</span><span class="sxs-lookup"><span data-stu-id="efc77-189">Specify post-conditions: `MaybeNull` and `NotNull`</span></span>

<span data-ttu-id="efc77-190">Angenommen, Sie verfügen über eine Methode mit der folgenden Signatur:</span><span class="sxs-lookup"><span data-stu-id="efc77-190">Suppose you have a method with the following signature:</span></span>

```csharp
public Customer FindCustomer(string lastName, string firstName)
```

<span data-ttu-id="efc77-191">Sie haben wahrscheinlich schon eine Methode wie diese geschrieben, um `null` zurückzugeben, wenn ein gesuchter Name nicht gefunden wurde.</span><span class="sxs-lookup"><span data-stu-id="efc77-191">You've likely written a method like this to return `null` when the name sought wasn't found.</span></span> <span data-ttu-id="efc77-192">Durch den Wert `null` wird klar ausgedrückt, dass der Datensatz nicht gefunden wurde.</span><span class="sxs-lookup"><span data-stu-id="efc77-192">The `null` clearly indicates that the record wasn't found.</span></span> <span data-ttu-id="efc77-193">In diesem Beispiel ändern Sie den Rückgabetyp wahrscheinlich von `Customer` in `Customer?`.</span><span class="sxs-lookup"><span data-stu-id="efc77-193">In this example, you'd likely change the return type from `Customer` to `Customer?`.</span></span> <span data-ttu-id="efc77-194">Durch das Deklarieren des Rückgabetyps als Nullable-Verweistyp wird die Absicht dieser API klar ausgedrückt.</span><span class="sxs-lookup"><span data-stu-id="efc77-194">Declaring the return value as a nullable reference type specifies the intent of this API clearly.</span></span>

<span data-ttu-id="efc77-195">Aus Gründen, die unter [Generische Definitionen und NULL-Zulässigkeit](../../nullable-migration-strategies.md#generic-definitions-and-nullability) erläutert werden, funktioniert diese Technik nicht bei generischen Methoden.</span><span class="sxs-lookup"><span data-stu-id="efc77-195">For reasons covered under [Generic definitions and nullability](../../nullable-migration-strategies.md#generic-definitions-and-nullability) that technique does not work with generic methods.</span></span> <span data-ttu-id="efc77-196">Angenommen, Sie verfügen über eine generische Methode, die einem ähnlichen Muster folgt:</span><span class="sxs-lookup"><span data-stu-id="efc77-196">You may have a generic method that follows a similar pattern:</span></span>

```csharp
public T Find<T>(IEnumerable<T> sequence, Func<T, bool> predicate)
```

<span data-ttu-id="efc77-197">Sie können nicht angeben, dass der Rückgabewert `T?` lautet.</span><span class="sxs-lookup"><span data-stu-id="efc77-197">You can't specify that the return value is `T?`.</span></span> <span data-ttu-id="efc77-198">Die Methode gibt `null` zurück, wenn das gesuchte Element nicht gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="efc77-198">The method returns `null` when the sought item isn't found.</span></span> <span data-ttu-id="efc77-199">Da es nicht möglich ist, `T?` als Rückgabetyp zu deklarieren, fügen Sie die `MaybeNull`-Anmerkung zur Methodenrückgabe hinzu:</span><span class="sxs-lookup"><span data-stu-id="efc77-199">Since you can't declare a `T?` return type, you add the `MaybeNull` annotation to the method return:</span></span>

```csharp
[return: MaybeNull]
public T Find<T>(IEnumerable<T> sequence, Func<T, bool> predicate)
```

<span data-ttu-id="efc77-200">Der Code oben informiert Aufrufer darüber, dass der Vertrag einen Non-Nullable-Typ vorsieht, aber der Rückgabewert tatsächlich NULL sein *darf*.</span><span class="sxs-lookup"><span data-stu-id="efc77-200">The preceding code informs callers that the contract implies a non-nullable type, but the return value *may* actually be null.</span></span>  <span data-ttu-id="efc77-201">Verwenden Sie das `MaybeNull`-Attribut, wenn Ihre API einen Non-Nullable-Typ verwenden soll – in der Regel einen generischen Typparameter –, aber in bestimmten Fällen `null` zurückgegeben werden kann.</span><span class="sxs-lookup"><span data-stu-id="efc77-201">Use the `MaybeNull` attribute when your API should be a non-nullable type, typically a generic type parameter, but there may be instances where `null` would be returned.</span></span>

<span data-ttu-id="efc77-202">Sie können auch angeben, dass ein Rückgabewert oder ein `out`- oder `ref`-Argument nicht NULL sein darf, obwohl der Typ ein Nullable-Verweistyp ist.</span><span class="sxs-lookup"><span data-stu-id="efc77-202">You can also specify that a return value or an `out` or `ref` argument isn't null even though the type is a nullable reference type.</span></span> <span data-ttu-id="efc77-203">Betrachten wir eine Methode, die sicherstellt, dass ein Array lang genug ist, um eine Anzahl von Elementen zu speichern.</span><span class="sxs-lookup"><span data-stu-id="efc77-203">Consider a method that ensures an array is large enough to hold a number of elements.</span></span> <span data-ttu-id="efc77-204">Wenn das Eingabeargument keine Kapazität aufweist, ordnet die Routine ein neues Array zu und kopiert alle vorhandenen Elemente in das Array.</span><span class="sxs-lookup"><span data-stu-id="efc77-204">If the input argument doesn't have capacity, the routine would allocate a new array and copy all the existing elements into it.</span></span> <span data-ttu-id="efc77-205">Wenn das Eingabeargument `null` lautet, ordnet die Routine neuen Speicher zu.</span><span class="sxs-lookup"><span data-stu-id="efc77-205">If the input argument is `null`, the routine would allocate new storage.</span></span> <span data-ttu-id="efc77-206">Ist ausreichend Kapazität vorhanden, hat die Routine keine Auswirkungen:</span><span class="sxs-lookup"><span data-stu-id="efc77-206">If there's sufficient capacity, the routine does nothing:</span></span>

```csharp
public void EnsureCapacity<T>(ref T[] storage, int size)
```

<span data-ttu-id="efc77-207">Sie können diese Routine folgendermaßen aufrufen:</span><span class="sxs-lookup"><span data-stu-id="efc77-207">You could call this routine as follows:</span></span>

```csharp
// messages has the default value (null) when EnsureCapacity is called:
EnsureCapacity<string>(ref messages, 10);
// messages is not null.
EnsureCapacity<string>(messages, 50);
```

<span data-ttu-id="efc77-208">Nach dem Aktivieren von NULL-Verweistypen möchten Sie sicherstellen, dass der vorstehende Code ohne Warnungen kompiliert wird.</span><span class="sxs-lookup"><span data-stu-id="efc77-208">After enabling null reference types, you want to ensure that the preceding code compiles without warnings.</span></span> <span data-ttu-id="efc77-209">Wenn die Methode ein Ergebnis zurückgibt, wird garantiert, dass das `storage`-Argument ungleich NULL ist.</span><span class="sxs-lookup"><span data-stu-id="efc77-209">When the method returns, the `storage` argument is guaranteed to be not null.</span></span> <span data-ttu-id="efc77-210">Es ist jedoch weiterhin zulässig, `EnsureCapacity` mit einem NULL-Verweis aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="efc77-210">However, it's acceptable to call `EnsureCapacity` with a null reference.</span></span> <span data-ttu-id="efc77-211">Sie können `storage` als Nullable-Verweistyp festlegen und die Nachbedingung `NotNull` zur Parameterdeklaration hinzufügen:</span><span class="sxs-lookup"><span data-stu-id="efc77-211">You can make `storage` a nullable reference type, and add the `NotNull` post-condition to the parameter declaration:</span></span>

```csharp
public void EnsureCapacity<T>([NotNull] ref T[]? storage, int size)
```

<span data-ttu-id="efc77-212">Der vorangehende Code drückt den vorhanden Vertrag klar aus: Aufrufer können eine Variable mit dem Wert `null` übergeben, aber es wird garantiert, dass der Rückgabewert nie NULL ist.</span><span class="sxs-lookup"><span data-stu-id="efc77-212">The preceding code expresses the existing contract clearly: Callers can pass a variable with the `null` value, but the return value is guaranteed to never be null.</span></span> <span data-ttu-id="efc77-213">Das `NotNull`-Attribut ist besonders nützlich für `ref`- und `out`-Argumente, bei denen `null` als Argument übergeben werden kann, aber das Argument garantiert ungleich NULL ist, wenn die Methode ein Ergebnis zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="efc77-213">The `NotNull` attribute is most useful for `ref` and `out` arguments where `null` may be passed as an argument, but that argument is guaranteed to be not null when the method returns.</span></span>

<span data-ttu-id="efc77-214">Sie geben nicht bedingte Nachbedingungen mit den folgenden Attributen an:</span><span class="sxs-lookup"><span data-stu-id="efc77-214">You specify unconditional postconditions using the following attributes:</span></span>

- <span data-ttu-id="efc77-215">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): Ein Non-Nullable-Rückgabewert darf NULL sein.</span><span class="sxs-lookup"><span data-stu-id="efc77-215">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="efc77-216">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): Ein Nullable-Rückgabetyp ist niemals NULL.</span><span class="sxs-lookup"><span data-stu-id="efc77-216">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>

## <a name="specify-conditional-post-conditions-notnullwhen-maybenullwhen-and-notnullifnotnull"></a><span data-ttu-id="efc77-217">Angeben von bedingten Nachbedingungen: `NotNullWhen`, `MaybeNullWhen` und `NotNullIfNotNull`</span><span class="sxs-lookup"><span data-stu-id="efc77-217">Specify conditional post-conditions: `NotNullWhen`, `MaybeNullWhen`, and `NotNullIfNotNull`</span></span>

<span data-ttu-id="efc77-218">Ihnen ist die `string`-Methode <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType> wahrscheinlich vertraut.</span><span class="sxs-lookup"><span data-stu-id="efc77-218">You're likely familiar with the `string` method <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType>.</span></span> <span data-ttu-id="efc77-219">Diese Methode gibt `true` zurück, wenn das Argument NULL oder eine leere Zeichenfolge ist.</span><span class="sxs-lookup"><span data-stu-id="efc77-219">This method returns `true` when the argument is null or an empty string.</span></span> <span data-ttu-id="efc77-220">Die Methode ist eine Form der NULL-Überprüfung: Aufrufer müssen eine NULL-Überprüfung des Arguments durchführen, wenn die Methode `false` zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="efc77-220">It's a form of null-check: Callers don't need to null-check the argument if the method returns `false`.</span></span> <span data-ttu-id="efc77-221">Um eine Methode wie diese NULL-fähig zu machen, legen Sie das Argument auf einen Nullable-Verweistyp fest und fügen das `NotNullWhen`-Attribut hinzu:</span><span class="sxs-lookup"><span data-stu-id="efc77-221">To make a method like this nullable aware, you'd set the argument to a nullable reference type, and add the `NotNullWhen` attribute:</span></span>

```csharp
bool IsNullOrEmpty([NotNullWhen(false)] string? value);
```

<span data-ttu-id="efc77-222">Auf diese Weise wird der Compiler darüber informiert, dass jeglicher Code mit Rückgabewert `false` nicht auf NULL überprüft werden muss.</span><span class="sxs-lookup"><span data-stu-id="efc77-222">That informs the compiler that any code where the return value is `false` need not be null-checked.</span></span> <span data-ttu-id="efc77-223">Durch das Hinzufügen des Attributs wird die statische Analyse des Compilers darüber informiert, dass `IsNullOrEmpty` die erforderliche NULL-Überprüfung durchführt: bei Rückgabe von `false` ist das Eingabeargument nicht `null`.</span><span class="sxs-lookup"><span data-stu-id="efc77-223">The addition of the attribute informs the compiler's static analysis that `IsNullOrEmpty` performs the necessary null check: when it returns `false`, the input argument is not `null`.</span></span>

```csharp
string? userInput = GetUserInput();
if (!string.IsNullOrEmpty(userInput))
{
   int messageLength = userInput.Length; // no null check needed.
}
// null check needed on userInput here.
```

<span data-ttu-id="efc77-224">Die <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType>-Methode wird für .NET Core 3.0 wie oben gezeigt mit Anmerkungen versehen.</span><span class="sxs-lookup"><span data-stu-id="efc77-224">The <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType> method will be annotated as shown above for .NET Core 3.0.</span></span> <span data-ttu-id="efc77-225">Sie verwenden möglicherweise ähnliche Methoden in Ihrer Codebasis, die den Zustand von Objekten auf NULL-Werte überprüfen.</span><span class="sxs-lookup"><span data-stu-id="efc77-225">You may have similar methods in your codebase that check the state of objects for null values.</span></span> <span data-ttu-id="efc77-226">Der Compiler erkennt keine benutzerdefinierten Methoden für die NULL-Überprüfung, und Sie müssen die Anmerkungen selbst hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="efc77-226">The compiler won't recognize custom null check methods, and you'll need to add the annotations yourself.</span></span> <span data-ttu-id="efc77-227">Wenn Sie das Attribut hinzufügen, hat die statische Analyse des Compilers Kenntnis darüber, wann die getestete Variable auf NULL-Werte überprüft wurde.</span><span class="sxs-lookup"><span data-stu-id="efc77-227">When you add the attribute, the compiler's static analysis knows when the tested variable has been null checked.</span></span>

<span data-ttu-id="efc77-228">Eine weitere Verwendung für diese Attribute ist das `Try*`-Muster.</span><span class="sxs-lookup"><span data-stu-id="efc77-228">Another use for these attributes is the `Try*` pattern.</span></span> <span data-ttu-id="efc77-229">Die Nachbedingungen für `ref`- und `out`-Variablen werden über den Rückgabewert kommuniziert.</span><span class="sxs-lookup"><span data-stu-id="efc77-229">The postconditions for `ref` and `out` variables are communicated through the return value.</span></span> <span data-ttu-id="efc77-230">Betrachten Sie die zuvor gezeigte Methode:</span><span class="sxs-lookup"><span data-stu-id="efc77-230">Consider this method shown earlier:</span></span>

```csharp
bool TryGetMessage(string key, out string message)
```

<span data-ttu-id="efc77-231">Die vorstehende Methode folgt einem typischen .NET-Idiom: Der Rückgabewert gibt an, ob `message` auf den gefunden Wert oder – falls „message“ nicht gefunden wird – auf den Standardwert festgelegt wurde.</span><span class="sxs-lookup"><span data-stu-id="efc77-231">The preceding method follows a typical .NET idiom: the return value indicates if `message` was set to the found value or, if no message is found, to the default value.</span></span> <span data-ttu-id="efc77-232">Wenn die Methode `true` zurückgibt, ist der Wert von `message` ungleich NULL. Andernfalls legt die Methode `message` auf NULL fest.</span><span class="sxs-lookup"><span data-stu-id="efc77-232">If the method returns `true`, the value of `message` isn't null; otherwise, the method sets `message` to null.</span></span>

<span data-ttu-id="efc77-233">Sie können dieses Idiom mithilfe des `NotNullWhen`-Attributs kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="efc77-233">You can communicate that idiom using the `NotNullWhen` attribute.</span></span> <span data-ttu-id="efc77-234">Wenn Sie die Signatur für Nullable-Verweistypen aktualisieren, ändern Sie `message` in `string?`, und fügen Sie ein Attribut hinzu:</span><span class="sxs-lookup"><span data-stu-id="efc77-234">When you update the signature for nullable reference types, make `message` a `string?` and add an attribute:</span></span>

```csharp
bool TryGetMessage(string key, [NotNullWhen(true)] out string? message)
```

<span data-ttu-id="efc77-235">Im vorstehenden Beispiel ist der Wert von `message` bekanntermaßen ungleich NULL, wenn `TryGetMessage` den Wert `true` zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="efc77-235">In the preceding example, the value of `message` is known to be not null when `TryGetMessage` returns `true`.</span></span> <span data-ttu-id="efc77-236">Sie sollten ähnliche Methoden in Ihrer Codebasis in gleicher Weise mit Anmerkungen versehen: Die Argumente könnten `null` sein und sind bekanntermaßen ungleich NULL, wenn die Methode `true` zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="efc77-236">You should annotate similar methods in your codebase in the same way: the arguments could be `null`, and are known to be not null when the method returns `true`.</span></span>

<span data-ttu-id="efc77-237">Es gibt ein letztes Attribut, das Sie möglicherweise ebenfalls benötigen.</span><span class="sxs-lookup"><span data-stu-id="efc77-237">There's one final attribute you may also need.</span></span> <span data-ttu-id="efc77-238">Gelegentlich hängt der NULL-Zustand eines Rückgabewerts vom NULL-Zustand von mindestens einem Eingabeargument ab.</span><span class="sxs-lookup"><span data-stu-id="efc77-238">Sometimes the null state of a return value depends on the null state of one or more input arguments.</span></span> <span data-ttu-id="efc77-239">Diese Methoden geben einen Nicht-NULL-Wert zurück, wenn bestimmt Eingabeargumente nicht `null` sind.</span><span class="sxs-lookup"><span data-stu-id="efc77-239">These methods will return a non-null value whenever certain input arguments aren't `null`.</span></span> <span data-ttu-id="efc77-240">Um diese Methoden korrekt mit Anmerkungen zu versehen, verwenden Sie das `NotNullIfNotNull`-Attribut.</span><span class="sxs-lookup"><span data-stu-id="efc77-240">To correctly annotate these methods, you use the `NotNullIfNotNull` attribute.</span></span> <span data-ttu-id="efc77-241">Sehen Sie sich die folgende Methode an:</span><span class="sxs-lookup"><span data-stu-id="efc77-241">Consider the following method:</span></span>

```csharp
string GetTopLevelDomainFromFullUrl(string url);
```

<span data-ttu-id="efc77-242">Wenn das `url`-Argument ungleich NULL ist, ist die Ausgabe nicht `null`.</span><span class="sxs-lookup"><span data-stu-id="efc77-242">If the `url` argument isn't null, the output isn't `null`.</span></span> <span data-ttu-id="efc77-243">Sobald Nullable-Verweise aktiviert werden, funktioniert diese Signatur ordnungsgemäß, sofern Ihre API keine NULL-Eingabe akzeptiert.</span><span class="sxs-lookup"><span data-stu-id="efc77-243">Once nullable references are enabled, that signature works correctly, provided your API never accepts a null input.</span></span> <span data-ttu-id="efc77-244">Wenn die Eingabe jedoch NULL sein darf, kann auch der Rückgabewert NULL sein.</span><span class="sxs-lookup"><span data-stu-id="efc77-244">However, if the input could be null, then return value could also be null.</span></span> <span data-ttu-id="efc77-245">Deshalb könnten Sie die Signatur in den folgenden Code ändern:</span><span class="sxs-lookup"><span data-stu-id="efc77-245">Therefore, you could change the signature to the following code:</span></span>

```csharp
string? GetTopLevelDomainFromFullUrl(string? url);
```

<span data-ttu-id="efc77-246">Dies funktioniert ebenfalls, zwingt die Aufrufer aber häufig dazu, zusätzliche `null`-Überprüfungen zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="efc77-246">That also works, but will often force callers to implement extra `null` checks.</span></span> <span data-ttu-id="efc77-247">Der Vertrag sieht vor, dass der Rückgabewert nur dann `null` lautet, wenn das Eingabeargument `url` den Wert `null` aufweist.</span><span class="sxs-lookup"><span data-stu-id="efc77-247">The contract is that the return value would be `null` only when the input argument `url` is `null`.</span></span> <span data-ttu-id="efc77-248">Um diesen Vertrag auszudrücken, versehen Sie die Methode wie im folgenden Code gezeigt mit Anmerkungen:</span><span class="sxs-lookup"><span data-stu-id="efc77-248">To express that contract, you would annotate this method as shown in the following code:</span></span>

```csharp
[return: NotNullIfNotNull("url")]
string? GetTopLevelDomainFromFullUrl(string? url);
```

<span data-ttu-id="efc77-249">Der Rückgabewert und das Argument wurden beide um `?` ergänzt, um darauf hinzuweisen, dass beide den Wert `null` annehmen können.</span><span class="sxs-lookup"><span data-stu-id="efc77-249">The return value and the argument have both been annotated with the `?` indicating that either could be `null`.</span></span> <span data-ttu-id="efc77-250">Das Attribut verdeutlicht außerdem, dass der Rückgabewert ungleich NULL ist, wenn das `url`-Argument ungleich `null` ist.</span><span class="sxs-lookup"><span data-stu-id="efc77-250">The attribute further clarifies that the return value won't be null when the `url` argument isn't `null`.</span></span>

<span data-ttu-id="efc77-251">Sie geben bedingte Nachbedingungen mit diesen Attributen an:</span><span class="sxs-lookup"><span data-stu-id="efc77-251">You specify conditional postconditions using these attributes:</span></span>

- <span data-ttu-id="efc77-252">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): Ein Non-Nullable-Eingabeargument darf NULL sein, wenn die Methode den angegebenen `bool`-Wert zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="efc77-252">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="efc77-253">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): Ein Nullable-Eingabeargument ist nicht NULL, wenn die Methode den angegebenen `bool`-Wert zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="efc77-253">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument will not be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="efc77-254">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): Ein Rückgabewert ist nicht NULL, wenn das Eingabeargument für den angegebenen Parameter nicht NULL ist.</span><span class="sxs-lookup"><span data-stu-id="efc77-254">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the input argument for the specified parameter isn't null.</span></span>

## <a name="verify-unreachable-code"></a><span data-ttu-id="efc77-255">Überprüfen von unerreichbarem Code</span><span class="sxs-lookup"><span data-stu-id="efc77-255">Verify unreachable code</span></span>

<span data-ttu-id="efc77-256">Einige Methoden, typischerweise Ausnahmehilfsmethoden oder andere Hilfsmethoden, werden immer mit Ausgabe einer Ausnahme beendet.</span><span class="sxs-lookup"><span data-stu-id="efc77-256">Some methods, typically exception helpers or other utility methods, always exit by throwing an exception.</span></span> <span data-ttu-id="efc77-257">Eine Hilfsmethode kann eine Ausnahme basierend auf dem Wert eines booleschen Arguments auslösen.</span><span class="sxs-lookup"><span data-stu-id="efc77-257">Or, a helper may throw an exception based on the value of a Boolean argument.</span></span>

<span data-ttu-id="efc77-258">Im ersten Fall können Sie das `DoesNotReturn`-Attribut zur Methodendeklaration hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="efc77-258">In the first case, you can add the `DoesNotReturn` attribute to the method declaration.</span></span> <span data-ttu-id="efc77-259">Der Compiler unterstützt Sie auf drei Arten.</span><span class="sxs-lookup"><span data-stu-id="efc77-259">The compiler helps you in three ways.</span></span> <span data-ttu-id="efc77-260">1\. Der Compiler gibt eine Warnung aus, wenn die Methode beendet werden kann, ohne eine Ausnahme auszulösen.</span><span class="sxs-lookup"><span data-stu-id="efc77-260">First, the compiler issues a warning if there is a path where the method can exit without throwing an exception.</span></span> <span data-ttu-id="efc77-261">2\. Der Compiler markiert Code nach einem Aufruf dieser Methode als *unerreichbar*, bis eine geeignete `catch`-Klausel gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="efc77-261">Second, the compiler marks any code after a call to that method as *unreachable*, until an appropriate `catch` clause is encountered.</span></span> <span data-ttu-id="efc77-262">3\. Der unerreichbare Code hat keine Auswirkung auf NULL-Zustände.</span><span class="sxs-lookup"><span data-stu-id="efc77-262">Third, the unreachable code won't affect any null states.</span></span> <span data-ttu-id="efc77-263">Betrachten Sie diese Methode:</span><span class="sxs-lookup"><span data-stu-id="efc77-263">Consider this method:</span></span>

```csharp
[DoesNotReturn]
private void FailFast()
{
    throw new InvalidOperationException();
}

public void SetState(object containedField)
{
    if (!isInitialized)
    {
        FailFast();
    }

    // unreachable code:
    _field = containedField;
}
```

<span data-ttu-id="efc77-264">Im zweiten Fall fügen Sie das `DoesNotReturnIf`-Attribut einem booleschen Parameter der Methode hinzu.</span><span class="sxs-lookup"><span data-stu-id="efc77-264">In the second case, you add the `DoesNotReturnIf` attribute to a Boolean parameter of the method.</span></span> <span data-ttu-id="efc77-265">Sie können das vorherige Beispiel folgendermaßen abändern:</span><span class="sxs-lookup"><span data-stu-id="efc77-265">You can modify the previous example as follows:</span></span>

```csharp
private void FailFast([DoesNotReturnIf(false)] bool isValid)
{
    if (!isValid)
    {
        throw new InvalidOperationException();
    }
}

public void SetState(object containedField)
{
    FailFast(isInitialized);

    // unreachable code when "isInitialized" is false:
    _field = containedField;
}
```

## <a name="summary"></a><span data-ttu-id="efc77-266">Zusammenfassung</span><span class="sxs-lookup"><span data-stu-id="efc77-266">Summary</span></span>

[!INCLUDE [C# version alert](../../includes/csharp-version-alert.md)]

<span data-ttu-id="efc77-267">Das Hinzufügen von Nullable-Verweistypen ermöglicht eine Beschreibung der Erwartungen für Ihre APIs für Variablen, die den Wert `null` annehmen könnten.</span><span class="sxs-lookup"><span data-stu-id="efc77-267">Adding nullable reference types provides an initial vocabulary to describe your APIs expectations for variables that could be `null`.</span></span> <span data-ttu-id="efc77-268">Die zusätzlichen Attribute erweitern die Möglichkeiten zur Beschreibung des NULL-Zustands von Variablen als Vor- und Nachbedingungen.</span><span class="sxs-lookup"><span data-stu-id="efc77-268">The additional attributes provide a richer vocabulary to describe the null state of variables as preconditions and postconditions.</span></span> <span data-ttu-id="efc77-269">Durch diese Attribute werden Ihre Erwartungen klarer beschrieben und verbessern das Benutzererlebnis für Entwickler, die Ihre APIs nutzen.</span><span class="sxs-lookup"><span data-stu-id="efc77-269">These attributes more clearly describe your expectations and provide a better experience for the developers using your APIs.</span></span>

<span data-ttu-id="efc77-270">Wenn Sie Bibliotheken für einen Nullable-Kontext aktualisieren, fügen Sie diese Attribute hinzu, um Benutzer bei der richtigen Verwendung Ihrer APIs zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="efc77-270">As you update libraries for a nullable context, add these attributes to guide users of your APIs to the correct usage.</span></span> <span data-ttu-id="efc77-271">Die Attribute unterstützen Sie bei der vollständigen Beschreibung des NULL-Zustands von Eingabeargumenten und Rückgabewerten:</span><span class="sxs-lookup"><span data-stu-id="efc77-271">These attributes help you fully describe the null-state of input arguments and return values:</span></span>

- <span data-ttu-id="efc77-272">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): Ein Non-Nullable-Eingabeargument darf NULL sein.</span><span class="sxs-lookup"><span data-stu-id="efc77-272">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="efc77-273">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): Ein Nullable-Eingabeargument darf nie NULL sein.</span><span class="sxs-lookup"><span data-stu-id="efc77-273">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>
- <span data-ttu-id="efc77-274">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): Ein Non-Nullable-Rückgabewert darf NULL sein.</span><span class="sxs-lookup"><span data-stu-id="efc77-274">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="efc77-275">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): Ein Nullable-Rückgabetyp ist niemals NULL.</span><span class="sxs-lookup"><span data-stu-id="efc77-275">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>
- <span data-ttu-id="efc77-276">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): Ein Non-Nullable-Eingabeargument darf NULL sein, wenn die Methode den angegebenen `bool`-Wert zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="efc77-276">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="efc77-277">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): Ein Nullable-Eingabeargument ist nicht NULL, wenn die Methode den angegebenen `bool`-Wert zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="efc77-277">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument will not be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="efc77-278">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): Ein Rückgabewert ist nicht NULL, wenn das Eingabeargument für den angegebenen Parameter nicht NULL ist.</span><span class="sxs-lookup"><span data-stu-id="efc77-278">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the input argument for the specified parameter isn't null.</span></span>
- <span data-ttu-id="efc77-279">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): Die Methode gibt niemals ein Ergebnis zurück.</span><span class="sxs-lookup"><span data-stu-id="efc77-279">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): A method never returns.</span></span> <span data-ttu-id="efc77-280">Anders ausgedrückt: Die Methode löst immer eine Ausnahme aus.</span><span class="sxs-lookup"><span data-stu-id="efc77-280">In other words, it always throws an exception.</span></span>
- <span data-ttu-id="efc77-281">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): Die Methode gibt niemals ein Ergebnis zurück, wenn der zugeordnete Parameter `bool` einen angegebenen Wert aufweist.</span><span class="sxs-lookup"><span data-stu-id="efc77-281">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): This method never returns if the associated `bool` parameter has the specified value.</span></span>
