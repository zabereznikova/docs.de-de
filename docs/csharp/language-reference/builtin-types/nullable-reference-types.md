---
title: 'Nullable-Verweistypen: C#-Referenz'
description: Informationen zu Nullable-Verweistypen in C# und deren Verwendung
ms.date: 04/06/2020
ms.openlocfilehash: cbc7397ac76b43b79a4168f4c61fe2c631b4a46b
ms.sourcegitcommit: 2b3b2d684259463ddfc76ad680e5e09fdc1984d2
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/08/2020
ms.locfileid: "80888287"
---
# <a name="nullable-reference-types-c-reference"></a><span data-ttu-id="d1e61-103">Nullable-Verweistypen (C#-Referenz)</span><span class="sxs-lookup"><span data-stu-id="d1e61-103">Nullable reference types (C# reference)</span></span>

> [!NOTE]
> <span data-ttu-id="d1e61-104">Dieser Artikel behandelt Nullable-Verweistypen.</span><span class="sxs-lookup"><span data-stu-id="d1e61-104">This article covers nullable reference types.</span></span> <span data-ttu-id="d1e61-105">Sie können auch [Nullable-Werttypen](nullable-value-types.md) deklarieren.</span><span class="sxs-lookup"><span data-stu-id="d1e61-105">You can also declare [nullable value types](nullable-value-types.md).</span></span>

<span data-ttu-id="d1e61-106">Nullable-Verweistypen sind ab C# 8.0 verfügbar, sofern der Code für *NULL-kompatiblen Kontext* aktiviert wurde.</span><span class="sxs-lookup"><span data-stu-id="d1e61-106">Nullable reference types are available beginning with C# 8.0, in code that has opted in to a *nullable aware context*.</span></span> <span data-ttu-id="d1e61-107">Nullable-Verweistypen, Warnungen bei statischer Analyse des NULL-Status und der [NULL-tolerante Operator](../operators/null-forgiving.md) sind optionale Sprachfeatures.</span><span class="sxs-lookup"><span data-stu-id="d1e61-107">Nullable reference types, the null static analysis warnings, and the [null-forgiving operator](../operators/null-forgiving.md) are optional language features.</span></span> <span data-ttu-id="d1e61-108">Alle sind standardmäßig deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="d1e61-108">All are turned off by default.</span></span> <span data-ttu-id="d1e61-109">Ein *NULL-kompatibler Kontext* wird auf Projektebene mithilfe von Buildeinstellungen oder im Code mithilfe von Pragmas festgelegt.</span><span class="sxs-lookup"><span data-stu-id="d1e61-109">A *nullable context* is controlled at the project level using build settings, or in code using pragmas.</span></span>

 <span data-ttu-id="d1e61-110">In einem NULL-kompatiblen Kontext gilt Folgendes:</span><span class="sxs-lookup"><span data-stu-id="d1e61-110">In a nullable aware context:</span></span>

- <span data-ttu-id="d1e61-111">Eine Variable mit dem Verweistyp `T` muss ohne NULL-Werte initialisiert werden, und ihr darf kein Wert zugewiesen werden, der `null` sein kann.</span><span class="sxs-lookup"><span data-stu-id="d1e61-111">A variable of a reference type `T` must be initialized with non-null, and may never be assigned a value that may be `null`.</span></span>
- <span data-ttu-id="d1e61-112">Eine Variable mit dem Verweistyp `T?` kann mit `null` initialisiert oder `null` zugewiesen werden, muss jedoch vor der Dereferenzierung auf `null` geprüft werden.</span><span class="sxs-lookup"><span data-stu-id="d1e61-112">A variable of a reference type `T?` may be initialized with `null` or assigned `null`, but is required to be checked against `null` before de-referencing.</span></span>
- <span data-ttu-id="d1e61-113">Eine `m`-Variable vom Typ `T?` wird als ungleich NULL betrachtet, wenn Sie den NULL-toleranten Operator wie in `m!` anwenden.</span><span class="sxs-lookup"><span data-stu-id="d1e61-113">A variable `m` of type `T?` is considered to be non-null when you apply the null-forgiving operator, as in `m!`.</span></span>

<span data-ttu-id="d1e61-114">Die Unterschiede zwischen dem Non-Nullable-Verweistyp `T` und dem Nullable-Verweistyp `T?` werden so erzwungen, wie der Compiler die vorhergehenden Regeln interpretiert.</span><span class="sxs-lookup"><span data-stu-id="d1e61-114">The distinctions between a non-nullable reference type `T` and a nullable reference type `T?` are enforced by the compiler's interpretation of the preceding rules.</span></span> <span data-ttu-id="d1e61-115">Eine Variable vom Typ `T` und eine Variable vom Typ `T?` werden durch denselben .NET-Typ dargestellt.</span><span class="sxs-lookup"><span data-stu-id="d1e61-115">A variable of type `T` and a variable of type `T?` are represented by the same .NET type.</span></span> <span data-ttu-id="d1e61-116">Im folgenden Beispiel werden eine Non-Nullable-Zeichenfolge und eine Nullable-Zeichenfolge deklariert. Anschließend wird der NULL-tolerante Operator verwendet, um einer Non-Nullable-Zeichenfolge einen Wert zuzuweisen:</span><span class="sxs-lookup"><span data-stu-id="d1e61-116">The following example declares a non-nullable string and a nullable string, and then uses the null-forgiving operator to assign a value to a non-nullable string:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetCoreSyntax":::

<span data-ttu-id="d1e61-117">Die Variablen `notNull` und `nullable` werden beide durch den <xref:System.String>-Typ dargestellt.</span><span class="sxs-lookup"><span data-stu-id="d1e61-117">The variables `notNull` and `nullable` are both represented by the <xref:System.String> type.</span></span> <span data-ttu-id="d1e61-118">Da Non-Nullable- und Nullable-Typen als derselbe Typ gespeichert werden, gibt es mehrere Speicherorte, an denen Nullable-Verweistypen nicht verwendet werden dürfen.</span><span class="sxs-lookup"><span data-stu-id="d1e61-118">Because the non-nullable and nullable types are both stored as the same type, there are several locations where using a nullable reference type isn't allowed.</span></span> <span data-ttu-id="d1e61-119">Ein Nullable-Verweistyp kann generell nicht als Basisklasse oder implementierte Schnittstelle verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d1e61-119">In general, a nullable reference type can't be used as a base class or implemented interface.</span></span> <span data-ttu-id="d1e61-120">Ein Nullable-Verweistyp kann nicht in Ausdrücken für Objekterstellung oder Typtests verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d1e61-120">A nullable reference type can't be used in any object creation or type testing expression.</span></span> <span data-ttu-id="d1e61-121">Ein Nullable-Verweistyp kann nicht der Typ eines Memberzugriffsausdrucks sein.</span><span class="sxs-lookup"><span data-stu-id="d1e61-121">A nullable reference type can't be the type of a member access expression.</span></span> <span data-ttu-id="d1e61-122">In den folgenden Beispielen werden diese Konstrukte veranschaulicht:</span><span class="sxs-lookup"><span data-stu-id="d1e61-122">The following examples show these constructs:</span></span>

```csharp
public MyClass : System.Object? // not allowed
{
}

var nullEmpty = System.String?.Empty; // Not allowed
var maybeObject = new object?(); // Not allowed
try
{
    if (thing is string? nullableString) // not allowed
        Console.WriteLine(nullableString);
} catch (Exception? e) // Not Allowed
{
    Console.WriteLine("error");
}
```

## <a name="nullable-references-and-static-analysis"></a><span data-ttu-id="d1e61-123">Nullable-Verweise und statische Analyse</span><span class="sxs-lookup"><span data-stu-id="d1e61-123">Nullable references and static analysis</span></span>

<span data-ttu-id="d1e61-124">Die Beispiele im vorherigen Abschnitt veranschaulichen den Charakter von Nullable-Verweistypen.</span><span class="sxs-lookup"><span data-stu-id="d1e61-124">The examples in the previous section illustrate the nature of nullable reference types.</span></span> <span data-ttu-id="d1e61-125">Nullable-Verweistypen sind keine neuen Klassentypen, sondern eher Annotationen zu vorhandenen Verweistypen.</span><span class="sxs-lookup"><span data-stu-id="d1e61-125">Nullable reference types aren't new class types, but rather annotations on existing reference types.</span></span> <span data-ttu-id="d1e61-126">Der Compiler verwendet diese Annotationen, um potenzielle NULL-Verweisfehler in Ihrem Code zu finden.</span><span class="sxs-lookup"><span data-stu-id="d1e61-126">The compiler uses those annotations to help you find potential null reference errors in your code.</span></span> <span data-ttu-id="d1e61-127">Für Non-Nullable-Verweistypen und Nullable-Verweistypen werden keine unterschiedlichen Runtimes verwendet.</span><span class="sxs-lookup"><span data-stu-id="d1e61-127">There's no runtime difference between a non-nullable reference type and a nullable reference type.</span></span> <span data-ttu-id="d1e61-128">Der Compiler fügt keine Runtime hinzu, die auf Non-Nullable-Verweistypen prüft.</span><span class="sxs-lookup"><span data-stu-id="d1e61-128">The compiler doesn't add any runtime checking for non-nullable reference types.</span></span> <span data-ttu-id="d1e61-129">Die Vorteile liegen in der Analyse zur Kompilierzeit.</span><span class="sxs-lookup"><span data-stu-id="d1e61-129">The benefits are in the compile-time analysis.</span></span> <span data-ttu-id="d1e61-130">Der Compiler generiert Warnungen, die Ihnen helfen, potenzielle NULL-Fehler in Ihrem Code zu finden und zu beheben.</span><span class="sxs-lookup"><span data-stu-id="d1e61-130">The compiler generates warnings that help you find and fix potential null errors in your code.</span></span> <span data-ttu-id="d1e61-131">Sie deklarieren Ihre Absicht, und der Compiler warnt Sie, wenn Ihr Code gegen diese Absicht verstößt.</span><span class="sxs-lookup"><span data-stu-id="d1e61-131">You declare your intent, and the compiler warns you when your code violates that intent.</span></span>

<span data-ttu-id="d1e61-132">In NULL-kompatiblem Kontext führt der Compiler eine statische Analyse für Variablen für Nullable- und Non-Nullable-Verweistypen durch.</span><span class="sxs-lookup"><span data-stu-id="d1e61-132">In a nullable enabled context, the compiler performs static analysis on variables of any reference type, both nullable and non-nullable.</span></span> <span data-ttu-id="d1e61-133">Der Compiler erfasst den NULL-Status jeder Verweisvariablen entweder als *not null* (nicht NULL) oder als *maybe null* (vielleicht NULL).</span><span class="sxs-lookup"><span data-stu-id="d1e61-133">The compiler tracks the null state of each reference variable as either *not null* or *maybe null*.</span></span> <span data-ttu-id="d1e61-134">Der Standardstatus eines Non-Nullable-Verweises ist *not null* (nicht NULL).</span><span class="sxs-lookup"><span data-stu-id="d1e61-134">The default state of a non-nullable reference is *not null*.</span></span> <span data-ttu-id="d1e61-135">Der Standardstatus eines Nullable-Verweises ist *maybe null* (vielleicht NULL).</span><span class="sxs-lookup"><span data-stu-id="d1e61-135">The default state of a nullable reference is *maybe null*.</span></span>

<span data-ttu-id="d1e61-136">Non-Nullable-Verweistypen können immer sicher dereferenziert werden, da ihr NULL-Status *not null* (nicht NULL) ist.</span><span class="sxs-lookup"><span data-stu-id="d1e61-136">Non-nullable reference types should always be safe to dereference because their null state is *not null*.</span></span> <span data-ttu-id="d1e61-137">Der Compiler erzwingt diese Regel, indem Warnungen ausgegeben werden, wenn ein Non-Nullable-Verweistyp nicht in einen Wert ungleich NULL initialisiert wird.</span><span class="sxs-lookup"><span data-stu-id="d1e61-137">To enforce that rule, the compiler issues warnings if a non-nullable reference type isn't initialized to a non-null value.</span></span> <span data-ttu-id="d1e61-138">Lokale Variablen müssen dort zugewiesen werden, wo sie auch deklariert werden.</span><span class="sxs-lookup"><span data-stu-id="d1e61-138">Local variables must be assigned where they're declared.</span></span> <span data-ttu-id="d1e61-139">Jeder Konstruktor muss jedes Feld im Textkörper, in einem aufgerufenen Konstruktor oder mithilfe eines Feldinitialisierers zuweisen.</span><span class="sxs-lookup"><span data-stu-id="d1e61-139">Every constructor must assign every field, either in its body, a called constructor, or using a field initializer.</span></span> <span data-ttu-id="d1e61-140">Der Compiler gibt Warnungen aus, wenn ein Non-Nullable-Verweis einem Verweis zugeordnet wird, dessen Status *maybe null* (vielleicht NULL) ist.</span><span class="sxs-lookup"><span data-stu-id="d1e61-140">The compiler issues warnings if a non-nullable reference is assigned to a reference whose state is *maybe null*.</span></span> <span data-ttu-id="d1e61-141">Da ein Non-Nullable-Verweis jedoch den Status *not null* (nicht NULL) hat, werden keine Warnungen ausgegeben, wenn diese Variablen dereferenziert werden.</span><span class="sxs-lookup"><span data-stu-id="d1e61-141">However, because a non-nullable reference is *not null*, no warnings are issued when those variables are de-referenced.</span></span>

<span data-ttu-id="d1e61-142">Nullable-Verweistypen können initialisiert oder `null` zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="d1e61-142">Nullable reference types may be initialized or assigned to `null`.</span></span> <span data-ttu-id="d1e61-143">Daher muss bei der statischen Analyse bestätigt werden, dass eine Variable *not null* (nicht NULL) ist, bevor sie dereferenziert wird.</span><span class="sxs-lookup"><span data-stu-id="d1e61-143">Therefore, static analysis must determine that a variable is *not null* before it's dereferenced.</span></span> <span data-ttu-id="d1e61-144">Wenn feststeht wird, dass ein Nullable-Verweis *maybe null* (vielleicht NULL) ist, kann dieser keiner Non-Nullable-Verweisvariable zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="d1e61-144">If a nullable reference is determined to be *maybe null*, it can't be assigned to a non-nullable reference variable.</span></span> <span data-ttu-id="d1e61-145">In der folgenden Klasse werden Beispiele für diese Warnungen veranschaulicht:</span><span class="sxs-lookup"><span data-stu-id="d1e61-145">The following class shows examples of these warnings:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetClassWithNullable":::

<span data-ttu-id="d1e61-146">Im folgenden Codeausschnitt sehen Sie, an welcher Stelle der Compiler bei Verwendung dieser Klasse Warnungen ausgibt:</span><span class="sxs-lookup"><span data-stu-id="d1e61-146">The following snippet shows where the compiler emits warnings when using this class:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetLocalWarnings":::

<span data-ttu-id="d1e61-147">In den vorangehenden Beispielen wird die statische Analyse des Compilers veranschaulicht, mit der der NULL-Status von Verweisvariablen bestimmt wird.</span><span class="sxs-lookup"><span data-stu-id="d1e61-147">The preceding examples demonstrate the compiler's static analysis to determine the null state of reference variables.</span></span> <span data-ttu-id="d1e61-148">Der Compiler wendet Sprachregeln auf NULL-Prüfungen und -Zuweisungen an, um die Analyse mit Informationen zu versorgen.</span><span class="sxs-lookup"><span data-stu-id="d1e61-148">The compiler applies language rules for null checks and assignments to inform its analysis.</span></span>  <span data-ttu-id="d1e61-149">Der Compiler kann keine Annahmen zur Semantik von Methoden oder Eigenschaften treffen.</span><span class="sxs-lookup"><span data-stu-id="d1e61-149">The compiler can't make assumptions about the semantics of methods or properties.</span></span> <span data-ttu-id="d1e61-150">Wenn Sie Methoden aufzurufen, die NULL-Prüfungen durchführen, kann der Compiler nicht wissen, welche Methoden den NULL-Status einer Variablen beeinflussen.</span><span class="sxs-lookup"><span data-stu-id="d1e61-150">If you call methods that perform null checks, the compiler can't know those methods affect a variable's null state.</span></span> <span data-ttu-id="d1e61-151">Es gibt einige Attribute, die Sie Ihren APIs hinzufügen können, um den Compiler über die Semantik von Argumenten und Rückgabewerten in Kenntnis zu setzen.</span><span class="sxs-lookup"><span data-stu-id="d1e61-151">There are a number of attributes you can add to your APIs to inform the compiler about the semantics of arguments and return values.</span></span> <span data-ttu-id="d1e61-152">Diese Attribute wurden auf viele gängige APIs in den .NET Core-Bibliotheken angewendet.</span><span class="sxs-lookup"><span data-stu-id="d1e61-152">These attributes have been applied to many common APIs in the .NET Core libraries.</span></span> <span data-ttu-id="d1e61-153">Beispielsweise wurde <xref:System.String.IsNullOrEmpty%2A> aktualisiert, und der Compiler interpretiert diese Methode ordnungsgemäß als NULL-Prüfung.</span><span class="sxs-lookup"><span data-stu-id="d1e61-153">For example, <xref:System.String.IsNullOrEmpty%2A> has been updated, and the compiler correctly interprets that method as a null check.</span></span> <span data-ttu-id="d1e61-154">Weitere Informationen zu den Attributen, die für die statische Analyse des NULL-Status gelten, finden Sie im Artikel zu [Nullable-Attributen](../../nullable-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="d1e61-154">For more information about the attributes that apply to null state static analysis, see the article on [Nullable attributes](../../nullable-attributes.md).</span></span>

## <a name="setting-the-nullable-context"></a><span data-ttu-id="d1e61-155">Festlegen des NULL-kompatiblen Kontexts</span><span class="sxs-lookup"><span data-stu-id="d1e61-155">Setting the nullable context</span></span>

<span data-ttu-id="d1e61-156">Es gibt zwei Möglichkeiten, den NULL-kompatiblen Kontext festzulegen.</span><span class="sxs-lookup"><span data-stu-id="d1e61-156">There are two ways to control the nullable context.</span></span> <span data-ttu-id="d1e61-157">Auf Projektebene können Sie die Projekteinstellung `<Nullable>enable</Nullable>` hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="d1e61-157">At the project level, you can add the `<Nullable>enable</Nullable>` project setting.</span></span> <span data-ttu-id="d1e61-158">In einer einzelnen C#-Quelldatei können Sie das `#nullable enable`-Pragma hinzufügen, um den NULL-kompatiblen Kontext zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="d1e61-158">In a single C# source file, you can add the `#nullable enable` pragma to enable the nullable context.</span></span> <span data-ttu-id="d1e61-159">Weitere Informationen finden Sie im Artikel zum [Festlegen einer NULL-kompatiblen Strategie](../../nullable-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="d1e61-159">See the article on [setting a nullable strategy](../../nullable-attributes.md).</span></span>

## <a name="c-language-specification"></a><span data-ttu-id="d1e61-160">C#-Sprachspezifikation</span><span class="sxs-lookup"><span data-stu-id="d1e61-160">C# language specification</span></span>

<span data-ttu-id="d1e61-161">Weitere Informationen finden Sie in den folgenden Vorschlägen für die [C#-Sprachspezifikation](~/_csharplang/spec/introduction.md):</span><span class="sxs-lookup"><span data-stu-id="d1e61-161">For more information, see the following proposals for the [C# language specification](~/_csharplang/spec/introduction.md):</span></span>

- [<span data-ttu-id="d1e61-162">Nullwerte zulassende Verweistypen</span><span class="sxs-lookup"><span data-stu-id="d1e61-162">Nullable reference types</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types.md)
- [<span data-ttu-id="d1e61-163">Entwurf der Spezifikation für Nullable-Verweistypen</span><span class="sxs-lookup"><span data-stu-id="d1e61-163">Draft nullable reference types specification</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types-specification.md)

## <a name="see-also"></a><span data-ttu-id="d1e61-164">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="d1e61-164">See also</span></span>

- [<span data-ttu-id="d1e61-165">C#-Referenz</span><span class="sxs-lookup"><span data-stu-id="d1e61-165">C# reference</span></span>](../index.md)
- [<span data-ttu-id="d1e61-166">Auf NULL festlegbare Werttypen</span><span class="sxs-lookup"><span data-stu-id="d1e61-166">Nullable value types</span></span>](nullable-value-types.md)
