---
title: On Error-Anweisung (Visual Basic)
ms.date: 07/20/2015
f1_keywords:
- vb.OnError
helpviewer_keywords:
- Visual Basic code, control flow
- Resume Next statement [Visual Basic]
- errors [Visual Basic], trapping
- error handling, On Error statement
- Next statement [Visual Basic], On Error
- control flow [Visual Basic], branching
- Error keyword [Visual Basic]
- execution [Visual Basic], conditional
- Resume statement [Visual Basic], and On Error statement
- Error statement [Visual Basic], and On Error statement
- GoTo statement [Visual Basic], and On Error statement
- branching [Visual Basic], on error
- conditional statements [Visual Basic], On Error
- On Error statement [Visual Basic], syntax
- On keyword [Visual Basic]
- run-time errors [Visual Basic], handling
- On Error statement [Visual Basic]
ms.assetid: ff947930-fb84-40cf-bd66-1ea219561d5c
ms.openlocfilehash: 9916c7197b260436a447a84b22df9b76dc5af4cd
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/23/2019
ms.locfileid: "54654883"
---
# <a name="on-error-statement-visual-basic"></a><span data-ttu-id="608d9-102">On Error-Anweisung (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="608d9-102">On Error Statement (Visual Basic)</span></span>
<span data-ttu-id="608d9-103">Aktiviert eine Fehlerbehandlungsroutine und gibt den Speicherort der Routine in einer Prozedur an. kann auch verwendet werden, um eine Fehlerbehandlungsroutine zu deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="608d9-103">Enables an error-handling routine and specifies the location of the routine within a procedure; can also be used to disable an error-handling routine.</span></span>  
  
 <span data-ttu-id="608d9-104">Ohne Fehlerbehandlung wird alle Laufzeitfehler, das auftritt, schwerwiegender: eine Fehlermeldung angezeigt wird, und die Ausführung beendet.</span><span class="sxs-lookup"><span data-stu-id="608d9-104">Without error handling, any run-time error that occurs is fatal: an error message is displayed, and execution stops.</span></span>  
  
 <span data-ttu-id="608d9-105">Wann immer möglich, sollten Sie Sie strukturierte Ausnahmen behandeln, die in Ihrem Code statt mit der unstrukturierten Ausnahmebehandlung verwenden und die `On Error` Anweisung.</span><span class="sxs-lookup"><span data-stu-id="608d9-105">Whenever possible, we suggest you use structured exception handling in your code, rather than using unstructured exception handling and the `On Error` statement.</span></span> <span data-ttu-id="608d9-106">Weitere Informationen finden Sie unter [Try...Catch...Finally-Anweisung](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md).</span><span class="sxs-lookup"><span data-stu-id="608d9-106">For more information, see [Try...Catch...Finally Statement](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="608d9-107">Die `Error` -Schlüsselwort wird auch verwendet, der [Error-Anweisung](../../../visual-basic/language-reference/statements/error-statement.md), dies wird für Abwärtskompatibilität unterstützt.</span><span class="sxs-lookup"><span data-stu-id="608d9-107">The `Error` keyword is also used in the [Error Statement](../../../visual-basic/language-reference/statements/error-statement.md), which is supported for backward compatibility.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="608d9-108">Syntax</span><span class="sxs-lookup"><span data-stu-id="608d9-108">Syntax</span></span>  
  
```  
On Error { GoTo [ line | 0 | -1 ] | Resume Next }  
```  
  
## <a name="parts"></a><span data-ttu-id="608d9-109">Teile</span><span class="sxs-lookup"><span data-stu-id="608d9-109">Parts</span></span>  
  
|<span data-ttu-id="608d9-110">Begriff</span><span class="sxs-lookup"><span data-stu-id="608d9-110">Term</span></span>|<span data-ttu-id="608d9-111">Definition</span><span class="sxs-lookup"><span data-stu-id="608d9-111">Definition</span></span>|  
|---|---|  
|<span data-ttu-id="608d9-112">`GoTo` `line`</span><span class="sxs-lookup"><span data-stu-id="608d9-112">`GoTo` `line`</span></span>|<span data-ttu-id="608d9-113">Aktiviert die Fehlerbehandlungsroutine, die in der Zeile, die in die erforderlichen angegebenen beginnt `line` Argument.</span><span class="sxs-lookup"><span data-stu-id="608d9-113">Enables the error-handling routine that starts at the line specified in the required `line` argument.</span></span> <span data-ttu-id="608d9-114">Die `line` Argument ist zeilenbezeichnung oder Zeilennummer.</span><span class="sxs-lookup"><span data-stu-id="608d9-114">The `line` argument is any line label or line number.</span></span> <span data-ttu-id="608d9-115">Wenn ein Laufzeitfehler auftritt, steuern Sie Branches in die angegebene Zeile, die den Fehlerhandler aktivieren.</span><span class="sxs-lookup"><span data-stu-id="608d9-115">If a run-time error occurs, control branches to the specified line, making the error handler active.</span></span> <span data-ttu-id="608d9-116">Die angegebene Zeile muss in der gleichen Prozedur wie die `On Error` -Anweisung oder ein Fehler während der Kompilierung erfolgt.</span><span class="sxs-lookup"><span data-stu-id="608d9-116">The specified line must be in the same procedure as the `On Error` statement, or a compile-time error will occur.</span></span>|  
|<span data-ttu-id="608d9-117">`GoTo` 0</span><span class="sxs-lookup"><span data-stu-id="608d9-117">`GoTo` 0</span></span>|<span data-ttu-id="608d9-118">Aktivierte Fehlerhandler in der aktuellen Prozedur deaktiviert und setzt es `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="608d9-118">Disables enabled error handler in the current procedure and resets it to `Nothing`.</span></span>|  
|<span data-ttu-id="608d9-119">`GoTo` -1</span><span class="sxs-lookup"><span data-stu-id="608d9-119">`GoTo` -1</span></span>|<span data-ttu-id="608d9-120">Deaktiviert die aktivierte Ausnahme in der aktuellen Prozedur und setzt es `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="608d9-120">Disables enabled exception in the current procedure and resets it to `Nothing`.</span></span>|  
|`Resume Next`|<span data-ttu-id="608d9-121">Gibt an, tritt ein Laufzeitfehler auf, wird die Kontrolle an die Anweisung sofort nach der Anweisung, in dem der Fehler aufgetreten ist, und die Ausführung wird fortgeführt, von diesem Punkt.</span><span class="sxs-lookup"><span data-stu-id="608d9-121">Specifies that when a run-time error occurs, control goes to the statement immediately following the statement where the error occurred, and execution continues from that point.</span></span> <span data-ttu-id="608d9-122">Verwenden Sie dieses Formular statt `On Error GoTo` beim Zugriff auf Objekte.</span><span class="sxs-lookup"><span data-stu-id="608d9-122">Use this form rather than `On Error GoTo` when accessing objects.</span></span>|  
  
## <a name="remarks"></a><span data-ttu-id="608d9-123">Hinweise</span><span class="sxs-lookup"><span data-stu-id="608d9-123">Remarks</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="608d9-124">Es wird empfohlen, dass Sie die strukturierte Ausnahmebehandlung im Code nach Möglichkeit anstelle der Verwendung nicht strukturierte Ausnahmebehandlung verwenden und die `On Error` Anweisung.</span><span class="sxs-lookup"><span data-stu-id="608d9-124">We recommend that you use structured exception handling in your code whenever possible, rather than using unstructured exception handling and the `On Error` statement.</span></span> <span data-ttu-id="608d9-125">Weitere Informationen finden Sie unter [Try...Catch...Finally-Anweisung](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md).</span><span class="sxs-lookup"><span data-stu-id="608d9-125">For more information, see [Try...Catch...Finally Statement](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md).</span></span>  
  
 <span data-ttu-id="608d9-126">Ein "enabled" Fehlerhandler ist ein, die aktiviert ist ein `On Error` Anweisung.</span><span class="sxs-lookup"><span data-stu-id="608d9-126">An "enabled" error handler is one that is turned on by an `On Error` statement.</span></span> <span data-ttu-id="608d9-127">Ein "aktiven" Error-Handler ist ein aktivierter Handler, der bei der Verarbeitung eines Fehlers ist.</span><span class="sxs-lookup"><span data-stu-id="608d9-127">An "active" error handler is an enabled handler that is in the process of handling an error.</span></span>  
  
 <span data-ttu-id="608d9-128">Wenn ein Fehler auftritt, während ein fehlerhandlers aktiv ist (zwischen dem Auftreten des Fehlers und einer `Resume`, `Exit Sub`, `Exit Function`, oder `Exit Property` Anweisung), kann nicht die aktuelle Prozedur Fehlerhandler den Fehler zu behandeln.</span><span class="sxs-lookup"><span data-stu-id="608d9-128">If an error occurs while an error handler is active (between the occurrence of the error and a `Resume`, `Exit Sub`, `Exit Function`, or `Exit Property` statement), the current procedure's error handler cannot handle the error.</span></span> <span data-ttu-id="608d9-129">Steuerung, die an die aufrufende Prozedur zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="608d9-129">Control returns to the calling procedure.</span></span>  
  
 <span data-ttu-id="608d9-130">Wenn die aufrufende Prozedur über eine aktivierte Fehlerhandler verfügt, wird es aktiviert, um den Fehler zu behandeln.</span><span class="sxs-lookup"><span data-stu-id="608d9-130">If the calling procedure has an enabled error handler, it is activated to handle the error.</span></span> <span data-ttu-id="608d9-131">Wenn die aufrufende Prozedur Fehlerhandler auch aktiv ist, übergibt die Steuerung zurück durch vorherigen Aufruf Prozeduren bis ein aktiviert, aber inaktive, Error-Handler gefunden wird.</span><span class="sxs-lookup"><span data-stu-id="608d9-131">If the calling procedure's error handler is also active, control passes back through previous calling procedures until an enabled, but inactive, error handler is found.</span></span> <span data-ttu-id="608d9-132">Wenn kein solcher Fehlerhandler gefunden wird, ist der Fehler Schwerwiegender, an dem Punkt, an dem er tatsächlich aufgetreten ist.</span><span class="sxs-lookup"><span data-stu-id="608d9-132">If no such error handler is found, the error is fatal at the point at which it actually occurred.</span></span>  
  
 <span data-ttu-id="608d9-133">Jedes Mal, wenn der Fehlerhandler zurück an die aufrufende Prozedur, wird die Steuerung wird diese Prozedur der aktuellen Prozedur.</span><span class="sxs-lookup"><span data-stu-id="608d9-133">Each time the error handler passes control back to a calling procedure, that procedure becomes the current procedure.</span></span> <span data-ttu-id="608d9-134">Sobald ein Fehler durch einen Fehlerhandler in einer beliebigen Prozedur behandelt wurde, Ausführung fortgesetzt wird, in der aktuellen Prozedur, die zum Zeitpunkt der vom angegebenen die `Resume` Anweisung.</span><span class="sxs-lookup"><span data-stu-id="608d9-134">Once an error is handled by an error handler in any procedure, execution resumes in the current procedure at the point designated by the `Resume` statement.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="608d9-135">Eine Fehlerbehandlungsroutine ist keiner `Sub` Prozedur oder ein `Function` Verfahren.</span><span class="sxs-lookup"><span data-stu-id="608d9-135">An error-handling routine is not a `Sub` procedure or a `Function` procedure.</span></span> <span data-ttu-id="608d9-136">Es ist ein Codeabschnitt, die durch eine zeilenbezeichnung oder Zeilennummer gekennzeichnet.</span><span class="sxs-lookup"><span data-stu-id="608d9-136">It is a section of code marked by a line label or a line number.</span></span>  
  
## <a name="number-property"></a><span data-ttu-id="608d9-137">Number-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="608d9-137">Number Property</span></span>  
 <span data-ttu-id="608d9-138">Routinen zur Fehlerbehandlung ist abhängig von den Wert in der `Number` Eigenschaft der `Err` Objekt, das die Ursache des Fehlers zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="608d9-138">Error-handling routines rely on the value in the `Number` property of the `Err` object to determine the cause of the error.</span></span> <span data-ttu-id="608d9-139">Die Routine testen sollten, oder speichern Sie relevante Eigenschaftswerte in die `Err` -Objekt, bevor ein anderer Fehler auftreten kann, oder bevor eine Prozedur, die dazu führen, dass möglicherweise ein Fehler aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="608d9-139">The routine should test or save relevant property values in the `Err` object before any other error can occur or before a procedure that might cause an error is called.</span></span> <span data-ttu-id="608d9-140">Die Eigenschaftswerte die `Err` Objekt entsprechen nur den zuletzt aufgetretene Fehler.</span><span class="sxs-lookup"><span data-stu-id="608d9-140">The property values in the `Err` object reflect only the most recent error.</span></span> <span data-ttu-id="608d9-141">Die Fehlermeldung zugeordnet `Err.Number` befindet sich im `Err.Description`.</span><span class="sxs-lookup"><span data-stu-id="608d9-141">The error message associated with `Err.Number` is contained in `Err.Description`.</span></span>  
  
## <a name="throw-statement"></a><span data-ttu-id="608d9-142">Throw-Anweisung</span><span class="sxs-lookup"><span data-stu-id="608d9-142">Throw Statement</span></span>  
 <span data-ttu-id="608d9-143">Fehler, die ausgelöst wird, mit der `Err.Raise` Methode legt die `Exception` Eigenschaft, um eine neu erstellte Instanz von der <xref:System.Exception> Klasse.</span><span class="sxs-lookup"><span data-stu-id="608d9-143">An error that is raised with the `Err.Raise` method sets the `Exception` property to a newly created instance of the <xref:System.Exception> class.</span></span> <span data-ttu-id="608d9-144">Um das Auslösen von Ausnahmen, die von abgeleiteten Typen, eine `Throw` -Anweisung wird in der Sprache unterstützt.</span><span class="sxs-lookup"><span data-stu-id="608d9-144">In order to support the raising of exceptions of derived exception types, a `Throw` statement is supported in the language.</span></span> <span data-ttu-id="608d9-145">Dies nimmt einen einzelnen Parameter, der die Ausnahmeinstanz ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="608d9-145">This takes a single parameter that is the exception instance to be thrown.</span></span> <span data-ttu-id="608d9-146">Das folgende Beispiel zeigt, wie diese Funktionen mit dem vorhandenen Unterstützung für Ausnahmebehandlung verwendet werden können:</span><span class="sxs-lookup"><span data-stu-id="608d9-146">The following example shows how these features can be used with the existing exception handling support:</span></span>  
  
 [!code-vb[VbVbalrErrorHandling#17](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_1.vb)]  
  
 <span data-ttu-id="608d9-147">Beachten Sie, dass die `On Error GoTo` Anweisung fängt alle Fehler, unabhängig von der Ausnahmeklasse.</span><span class="sxs-lookup"><span data-stu-id="608d9-147">Notice that the `On Error GoTo` statement traps all errors, regardless of the exception class.</span></span>  
  
## <a name="on-error-resume-next"></a><span data-ttu-id="608d9-148">On Error Resume Next</span><span class="sxs-lookup"><span data-stu-id="608d9-148">On Error Resume Next</span></span>  
 <span data-ttu-id="608d9-149">`On Error Resume Next` wird die Ausführung fortgesetzt wird, mit der Anweisung unmittelbar nach der Anweisung, die den Laufzeit-Fehler verursacht hat, oder rufen Sie mit der Anweisung sofort nach der letzten aus die Prozedur mit der `On Error Resume Next` Anweisung.</span><span class="sxs-lookup"><span data-stu-id="608d9-149">`On Error Resume Next` causes execution to continue with the statement immediately following the statement that caused the run-time error, or with the statement immediately following the most recent call out of the procedure containing the `On Error Resume Next` statement.</span></span> <span data-ttu-id="608d9-150">Mit dieser Anweisung können die Ausführung fort, obwohl ein Laufzeitfehler ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="608d9-150">This statement allows execution to continue despite a run-time error.</span></span> <span data-ttu-id="608d9-151">Sie können platzieren, die Steuerung an eine andere Position innerhalb der Prozedur übertragen, anstatt die Fehlerbehandlungsroutine, wo der Fehler auftreten würden.</span><span class="sxs-lookup"><span data-stu-id="608d9-151">You can place the error-handling routine where the error would occur rather than transferring control to another location within the procedure.</span></span> <span data-ttu-id="608d9-152">Ein `On Error Resume Next` Anweisung wird inaktiv, wenn eine andere Prozedur aufgerufen wird, damit Sie ausgeführt werden soll, ein `On Error Resume Next` Anweisung in den einzelnen Routine aufgerufen, wenn es sich bei Inline-Fehlerbehandlung innerhalb dieser Routine werden sollen.</span><span class="sxs-lookup"><span data-stu-id="608d9-152">An `On Error Resume Next` statement becomes inactive when another procedure is called, so you should execute an `On Error Resume Next` statement in each called routine if you want inline error handling within that routine.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="608d9-153">Die `On Error Resume Next` Konstrukt möglicherweise besser, `On Error GoTo` bei der Behandlung von Fehlern, die beim Zugriff auf andere Objekte generiert.</span><span class="sxs-lookup"><span data-stu-id="608d9-153">The `On Error Resume Next` construct may be preferable to `On Error GoTo` when handling errors generated during access to other objects.</span></span> <span data-ttu-id="608d9-154">Überprüfung `Err` nach jeder Interaktion mit einem Objekt darüber, welche Objekt, indem der Code zugegriffen wurde.</span><span class="sxs-lookup"><span data-stu-id="608d9-154">Checking `Err` after each interaction with an object removes ambiguity about which object was accessed by the code.</span></span> <span data-ttu-id="608d9-155">Sie können Sie sicher, dass welches Objekt den Fehlercode in platziert werden `Err.Number`, und welches Objekt den Fehler ursprünglich generiert hat (das Objekt, das im angegebenen `Err.Source`).</span><span class="sxs-lookup"><span data-stu-id="608d9-155">You can be sure which object placed the error code in `Err.Number`, as well as which object originally generated the error (the object specified in `Err.Source`).</span></span>  
  
## <a name="on-error-goto-0"></a><span data-ttu-id="608d9-156">On Error GoTo 0</span><span class="sxs-lookup"><span data-stu-id="608d9-156">On Error GoTo 0</span></span>  
 <span data-ttu-id="608d9-157">`On Error GoTo 0` wird für die Fehlerbehandlung in der aktuellen Prozedur deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="608d9-157">`On Error GoTo 0` disables error handling in the current procedure.</span></span> <span data-ttu-id="608d9-158">Es angeben nicht Line 0 wird als Ausgangspunkt des Codes für die Fehlerbehandlung, auch wenn die Prozedur eine Zeile 0 enthält.</span><span class="sxs-lookup"><span data-stu-id="608d9-158">It doesn't specify line 0 as the start of the error-handling code, even if the procedure contains a line numbered 0.</span></span> <span data-ttu-id="608d9-159">Ohne eine `On Error GoTo 0` -Anweisung, einen Fehlerhandler wird automatisch deaktiviert, wenn eine Prozedur beendet wird.</span><span class="sxs-lookup"><span data-stu-id="608d9-159">Without an `On Error GoTo 0` statement, an error handler is automatically disabled when a procedure is exited.</span></span>  
  
## <a name="on-error-goto--1"></a><span data-ttu-id="608d9-160">On Error GoTo -1</span><span class="sxs-lookup"><span data-stu-id="608d9-160">On Error GoTo -1</span></span>  
 <span data-ttu-id="608d9-161">`On Error GoTo -1` wird die Ausnahme in der aktuellen Prozedur deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="608d9-161">`On Error GoTo -1` disables the exception in the current procedure.</span></span> <span data-ttu-id="608d9-162">Es gibt keine Zeile-1 als Ausgangspunkt des Codes für die Fehlerbehandlung an, selbst wenn die Prozedur eine Zeile mit der Nummer 1, enthält.</span><span class="sxs-lookup"><span data-stu-id="608d9-162">It does not specify line -1 as the start of the error-handling code, even if the procedure contains a line numbered -1.</span></span> <span data-ttu-id="608d9-163">Ohne eine `On Error GoTo -1` -Anweisung, eine Ausnahme wird automatisch deaktiviert, wenn eine Prozedur beendet wird.</span><span class="sxs-lookup"><span data-stu-id="608d9-163">Without an `On Error GoTo -1` statement, an exception is automatically disabled when a procedure is exited.</span></span>  
  
 <span data-ttu-id="608d9-164">Um zu verhindern, dass Fehlerbehandlungscode ausgeführt, wenn kein Fehler aufgetreten ist, platzieren ein `Exit Sub`, `Exit Function`, oder `Exit Property` Anweisung unmittelbar vor der Fehlerbehandlungsroutine, wie das folgende Fragment:</span><span class="sxs-lookup"><span data-stu-id="608d9-164">To prevent error-handling code from running when no error has occurred, place an `Exit Sub`, `Exit Function`, or `Exit Property` statement immediately before the error-handling routine, as in the following fragment:</span></span>  
  
 [!code-vb[VbVbalrErrorHandling#18](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_2.vb)]  
  
 <span data-ttu-id="608d9-165">Hier ist der Fehlerbehandlungscode folgt die `Exit Sub` Anweisung und wird vor dem die `End Sub` Anweisung für die Trennung der Ablauf der Prozedur.</span><span class="sxs-lookup"><span data-stu-id="608d9-165">Here, the error-handling code follows the `Exit Sub` statement and precedes the `End Sub` statement to separate it from the procedure flow.</span></span> <span data-ttu-id="608d9-166">Sie können Fehlerbehandlungscode in einer Prozedur an einer beliebigen Stelle platzieren.</span><span class="sxs-lookup"><span data-stu-id="608d9-166">You can place error-handling code anywhere in a procedure.</span></span>  
  
## <a name="untrapped-errors"></a><span data-ttu-id="608d9-167">Nicht abgefangene Fehler</span><span class="sxs-lookup"><span data-stu-id="608d9-167">Untrapped Errors</span></span>  
 <span data-ttu-id="608d9-168">Nicht abgefangene Fehler in Objekten werden an die steuernde Anwendung zurückgegeben, wenn das Objekt als eine ausführbare Datei ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="608d9-168">Untrapped errors in objects are returned to the controlling application when the object is running as an executable file.</span></span> <span data-ttu-id="608d9-169">Nicht abgefangene Fehler werden in der Entwicklungsumgebung der Anwendung steuern zurückgegeben, nur, wenn die entsprechenden Optionen festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="608d9-169">Within the development environment, untrapped errors are returned to the controlling application only if the proper options are set.</span></span> <span data-ttu-id="608d9-170">Finden Sie in der hostanwendung Dokumentation eine Beschreibung der Optionen liegen Gruppe während des Debuggens, wie diese festgelegt und gibt an, ob der Host Klassen erstellen kann.</span><span class="sxs-lookup"><span data-stu-id="608d9-170">See your host application's documentation for a description of which options should be set during debugging, how to set them, and whether the host can create classes.</span></span>  
  
 <span data-ttu-id="608d9-171">Wenn Sie ein Objekt, die auf andere Objekte zugreift erstellen, sollten Sie nicht behandelte Fehler zu behandeln, die sie zurück zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="608d9-171">If you create an object that accesses other objects, you should try to handle any unhandled errors they pass back.</span></span> <span data-ttu-id="608d9-172">Wenn Sie die Fehlercodes in zugeordnet sind, nicht möglich ist, `Err.Number` eines eigenen Fehler und übergeben Sie sie an den Aufrufer des Objekts zurück.</span><span class="sxs-lookup"><span data-stu-id="608d9-172">If you cannot, map the error codes in `Err.Number` to one of your own errors and then pass them back to the caller of your object.</span></span> <span data-ttu-id="608d9-173">Sie sollten den Fehler angeben, indem Sie den Fehlercode zum Hinzufügen der `VbObjectError` Konstanten.</span><span class="sxs-lookup"><span data-stu-id="608d9-173">You should specify your error by adding your error code to the `VbObjectError` constant.</span></span> <span data-ttu-id="608d9-174">Beispielsweise ist der Fehlercode 1052, weisen Sie ihn wie folgt:</span><span class="sxs-lookup"><span data-stu-id="608d9-174">For example, if your error code is 1052, assign it as follows:</span></span>  
  
 [!code-vb[VbVbalrErrorHandling#19](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_3.vb)]  
  
> [!CAUTION]
>  <span data-ttu-id="608d9-175">Systemfehler beim Aufrufen von Windows-Dynamic Link Libraries (DLLs) keine Ausnahmen auslösen und können nicht mit Visual Basic das Abfangen von Fehlern nicht abgefangen werden.</span><span class="sxs-lookup"><span data-stu-id="608d9-175">System errors during calls to Windows dynamic-link libraries (DLLs) do not raise exceptions and cannot be trapped with Visual Basic error trapping.</span></span> <span data-ttu-id="608d9-176">Beim Aufrufen von DLL-Funktionen, überprüfen Sie jeden Rückgabewert für den Erfolg oder Misserfolg (gemäß der API-Spezifikationen), und ein Fehler auftritt, überprüfen Sie den Wert der `Err` des Objekts `LastDLLError` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="608d9-176">When calling DLL functions, you should check each return value for success or failure (according to the API specifications), and in the event of a failure, check the value in the `Err` object's `LastDLLError` property.</span></span>  
  
## <a name="example"></a><span data-ttu-id="608d9-177">Beispiel</span><span class="sxs-lookup"><span data-stu-id="608d9-177">Example</span></span>  
 <span data-ttu-id="608d9-178">In diesem Beispiel verwendet zuerst die `On Error GoTo` Anweisung, um den Speicherort einer Routine für die Fehlerbehandlung in einer Prozedur anzugeben.</span><span class="sxs-lookup"><span data-stu-id="608d9-178">This example first uses the `On Error GoTo` statement to specify the location of an error-handling routine within a procedure.</span></span> <span data-ttu-id="608d9-179">Im Beispiel führt der Versuch Division durch 0 (null) Fehlernummer 6.</span><span class="sxs-lookup"><span data-stu-id="608d9-179">In the example, an attempt to divide by zero generates error number 6.</span></span> <span data-ttu-id="608d9-180">Der Fehler wird in der Fehlerbehandlung Routine behandelt, und die Steuerung dann wieder an die Anweisung, die den Fehler verursacht hat.</span><span class="sxs-lookup"><span data-stu-id="608d9-180">The error is handled in the error-handling routine, and control is then returned to the statement that caused the error.</span></span> <span data-ttu-id="608d9-181">Die `On Error GoTo 0` Anweisung deaktiviert das Abfangen von Fehlern.</span><span class="sxs-lookup"><span data-stu-id="608d9-181">The `On Error GoTo 0` statement turns off error trapping.</span></span> <span data-ttu-id="608d9-182">Die `On Error Resume Next` -Anweisung verwendet, um zurückstellen Fehler abfangen, damit der Kontext für den Fehler generiert, indem Sie die nächste Anweisung für bestimmte bekannt sein kann.</span><span class="sxs-lookup"><span data-stu-id="608d9-182">Then the `On Error Resume Next` statement is used to defer error trapping so that the context for the error generated by the next statement can be known for certain.</span></span> <span data-ttu-id="608d9-183">Beachten Sie, dass `Err.Clear` dient zum Löschen der `Err` Eigenschaften des Objekts, nachdem der Fehler behandelt wird.</span><span class="sxs-lookup"><span data-stu-id="608d9-183">Note that `Err.Clear` is used to clear the `Err` object's properties after the error is handled.</span></span>  
  
 [!code-vb[VbVbalrErrorHandling#20](../../../visual-basic/language-reference/statements/codesnippet/VisualBasic/on-error-statement_4.vb)]  
  
## <a name="requirements"></a><span data-ttu-id="608d9-184">Anforderungen</span><span class="sxs-lookup"><span data-stu-id="608d9-184">Requirements</span></span>  
 <span data-ttu-id="608d9-185">**Namespace:** [Microsoft.VisualBasic](../../../visual-basic/language-reference/runtime-library-members.md)</span><span class="sxs-lookup"><span data-stu-id="608d9-185">**Namespace:** [Microsoft.VisualBasic](../../../visual-basic/language-reference/runtime-library-members.md)</span></span>  
  
 <span data-ttu-id="608d9-186">**Assembly:** Visual Basic Runtime Library (in Microsoft.VisualBasic.dll)</span><span class="sxs-lookup"><span data-stu-id="608d9-186">**Assembly:** Visual Basic Runtime Library (in Microsoft.VisualBasic.dll)</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="608d9-187">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="608d9-187">See also</span></span>
- <xref:Microsoft.VisualBasic.Information.Err%2A>
- <xref:Microsoft.VisualBasic.ErrObject.Number%2A>
- <xref:Microsoft.VisualBasic.ErrObject.Description%2A>
- <xref:Microsoft.VisualBasic.ErrObject.LastDllError%2A>
- [<span data-ttu-id="608d9-188">End-Anweisung</span><span class="sxs-lookup"><span data-stu-id="608d9-188">End Statement</span></span>](../../../visual-basic/language-reference/statements/end-statement.md)
- [<span data-ttu-id="608d9-189">Exit-Anweisung</span><span class="sxs-lookup"><span data-stu-id="608d9-189">Exit Statement</span></span>](../../../visual-basic/language-reference/statements/exit-statement.md)
- [<span data-ttu-id="608d9-190">Resume-Anweisung</span><span class="sxs-lookup"><span data-stu-id="608d9-190">Resume Statement</span></span>](../../../visual-basic/language-reference/statements/resume-statement.md)
- [<span data-ttu-id="608d9-191">Fehlermeldungen</span><span class="sxs-lookup"><span data-stu-id="608d9-191">Error Messages</span></span>](../../../visual-basic/language-reference/error-messages/index.md)
- [<span data-ttu-id="608d9-192">Try...Catch...Finally-Anweisung</span><span class="sxs-lookup"><span data-stu-id="608d9-192">Try...Catch...Finally Statement</span></span>](../../../visual-basic/language-reference/statements/try-catch-finally-statement.md)
