---
title: Sicheres Speichern von Anwendungsgeheimnissen während der Entwicklung
description: 'Sicherheit in .NET-Microservices und Webanwendungen: Speichern Sie Ihre Anwendungsgeheimnisse wie Kennwörter, Verbindungszeichenfolgen oder API-Schlüssel nicht in der Quellcodeverwaltung, und informieren Sie sich über die Optionen, die Sie in ASP.NET Core verwenden können, insbesondere müssen Sie wissen, wie „Benutzergeheimnisse“ behandelt werden.'
author: mjrousos
ms.date: 01/30/2020
ms.openlocfilehash: 1ef2246746b9165f1564fa7be64ff7eb28eb1d32
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 03/14/2020
ms.locfileid: "77501796"
---
# <a name="store-application-secrets-safely-during-development"></a><span data-ttu-id="9fc6f-103">Sicheres Speichern von Anwendungsgeheimnissen während der Entwicklung</span><span class="sxs-lookup"><span data-stu-id="9fc6f-103">Store application secrets safely during development</span></span>

<span data-ttu-id="9fc6f-104">Zum Verbinden mit geschützten Ressourcen und anderen Diensten benötigen ASP.NET Core-Anwendungen in der Regel Verbindungszeichenfolgen, Kennwörter oder andere Anmeldeinformationen, die vertrauliche Informationen enthalten.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-104">To connect with protected resources and other services, ASP.NET Core applications typically need to use connection strings, passwords, or other credentials that contain sensitive information.</span></span> <span data-ttu-id="9fc6f-105">Diese vertraulichen Informationen werden *Geheimnisse* genannt.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-105">These sensitive pieces of information are called *secrets*.</span></span> <span data-ttu-id="9fc6f-106">Es ist eine bewährte Methode, Geheimnisse nicht in den Quellcode einzufügen und auf keinen Fall in der Quellcodeverwaltung zu speichern.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-106">It's a best practice to not include secrets in source code and making sure not to store secrets in source control.</span></span> <span data-ttu-id="9fc6f-107">Stattdessen sollten Sie das Konfigurationsmodell von ASP.NET Core verwenden, um Geheimnisse aus sichereren Speicherorten zu lesen.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-107">Instead, you should use the ASP.NET Core configuration model to read the secrets from more secure locations.</span></span>

<span data-ttu-id="9fc6f-108">Sie müssen die Geheimnisse für den Zugriff auf Entwicklungs- und Stagingressourcen von denen trennen, die für den Zugriff auf Produktionsressourcen verwendet werden, da verschiedene Personen Zugriff auf diese verschiedenen Geheimnisse benötigen.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-108">You must separate the secrets for accessing development and staging resources from the ones used for accessing production resources, because different individuals will need access to those different sets of secrets.</span></span> <span data-ttu-id="9fc6f-109">Beim Speichern von Geheimnissen, die während der Entwicklung genutzt werden, ist es gebräuchlich, diese entweder in Umgebungsvariablen oder mithilfe des Secret Manager-Tools von ASP.NET Core zu speichern.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-109">To store secrets used during development, common approaches are to either store secrets in environment variables or by using the ASP.NET Core Secret Manager tool.</span></span> <span data-ttu-id="9fc6f-110">Für eine sicherere Speicherung in Produktionsumgebungen können Microservices Geheimnisse in Azure Key Vault speichern.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-110">For more secure storage in production environments, microservices can store secrets in an Azure Key Vault.</span></span>

## <a name="store-secrets-in-environment-variables"></a><span data-ttu-id="9fc6f-111">Speichern von Geheimnissen in Umgebungsvariablen</span><span class="sxs-lookup"><span data-stu-id="9fc6f-111">Store secrets in environment variables</span></span>

<span data-ttu-id="9fc6f-112">Eine Möglichkeit, um Geheimnisse aus dem Quellcode fernzuhalten, besteht darin, dass Entwickler zeichenfolgenbasierte Geheimnisse als [Umgebungsvariablen](/aspnet/core/security/app-secrets#environment-variables) auf Ihren Entwicklungscomputern festlegen können.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-112">One way to keep secrets out of source code is for developers to set string-based secrets as [environment variables](/aspnet/core/security/app-secrets#environment-variables) on their development machines.</span></span> <span data-ttu-id="9fc6f-113">Wenn Sie Umgebungsvariablen zum Speichern von Geheimnissen mit hierarchischen Namen verwenden, etwa die in den Konfigurationsabschnitten geschachtelten, müssen Sie die Variablen benennen, um die vollständige, mit Doppelpunkten (:) getrennte Hierarchie der Abschnitte einzubeziehen.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-113">When you use environment variables to store secrets with hierarchical names, such as the ones nested in configuration sections, you must name the variables to include the complete hierarchy of its sections, delimited with colons (:).</span></span>

<span data-ttu-id="9fc6f-114">Zum Beispiel würde das Festlegen der Umgebungsvariablen `Logging:LogLevel:Default` auf `Debug` einem Konfigurationswert der folgenden JSON-Datei entsprechen:</span><span class="sxs-lookup"><span data-stu-id="9fc6f-114">For example, setting an environment variable `Logging:LogLevel:Default` to `Debug` value would be equivalent to a configuration value from the following JSON file:</span></span>

```json
{
    "Logging": {
        "LogLevel": {
            "Default": "Debug"
        }
    }
}
```

<span data-ttu-id="9fc6f-115">Die Anwendung muss beim Erstellen eines IConfigurationRoot-Objekts nur „AddEnvironmentVariables“ in ihrer ConfigurationBuilder-Klasse aufrufen, um auf diese Werte von Umgebungsvariablen zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-115">To access these values from environment variables, the application just needs to call AddEnvironmentVariables on its ConfigurationBuilder when constructing an IConfigurationRoot object.</span></span>

<span data-ttu-id="9fc6f-116">Beachten Sie, dass Umgebungsvariablen in der Regel als Nur-Text gespeichert werden, wenn der Computer oder der Prozess mit den Umgebungsvariablen also gefährdet ist, sind die Werte der Umgebungsvariablen sichtbar.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-116">Note that environment variables are commonly stored as plain text, so if the machine or process with the environment variables is compromised, the environment variable values will be visible.</span></span>

## <a name="store-secrets-with-the-aspnet-core-secret-manager"></a><span data-ttu-id="9fc6f-117">Speichern von Geheimnissen mit Secret Manager von ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="9fc6f-117">Store secrets with the ASP.NET Core Secret Manager</span></span>

<span data-ttu-id="9fc6f-118">Das ASP.NET Core-Tool [Secret Manager](/aspnet/core/security/app-secrets#secret-manager) stellt eine weitere Methode bereit, um **während der Entwicklung** Geheimnisse aus dem Quellcode fernzuhalten.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-118">The ASP.NET Core [Secret Manager](/aspnet/core/security/app-secrets#secret-manager) tool provides another method of keeping secrets out of source code **during development**.</span></span> <span data-ttu-id="9fc6f-119">Um das Secret Manager-Tool verwenden zu können, installieren Sie das Paket **Microsoft.Extensions.Configuration.SecretManager** in Ihrer Projektdatei.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-119">To use the Secret Manager tool, install the package **Microsoft.Extensions.Configuration.SecretManager** in your project file.</span></span> <span data-ttu-id="9fc6f-120">Sobald diese Abhängigkeit vorhanden ist und wiederhergestellt wurde, kann der Befehl `dotnet user-secrets` verwendet werden, um den Wert der Geheimnisse über die Befehlszeile festzulegen.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-120">Once that dependency is present and has been restored, the `dotnet user-secrets` command can be used to set the value of secrets from the command line.</span></span> <span data-ttu-id="9fc6f-121">Diese Geheimnisse werden außerhalb vom Quellcode in einer JSON-Datei im Verzeichnis des Profils vom Benutzer (Details variieren je nach Betriebssystem) gespeichert.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-121">These secrets will be stored in a JSON file in the user’s profile directory (details vary by OS), away from source code.</span></span>

<span data-ttu-id="9fc6f-122">Geheimnisse, die durch das Secret Manager-Tool festgelegt wurden, werden von der Eigenschaft `UserSecretsId` des Projekts organisiert, das die Geheimnisse verwendet.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-122">Secrets set by the Secret Manager tool are organized by the `UserSecretsId` property of the project that's using the secrets.</span></span> <span data-ttu-id="9fc6f-123">Aus diesem Grund sollten Sie sicherstellen, dass Sie die Eigenschaft UserSecretsId, wie im folgenden Codeausschnitt gezeigt wird, in Ihrer Projektdatei festlegen.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-123">Therefore, you must be sure to set the UserSecretsId property in your project file, as shown in the snippet below.</span></span> <span data-ttu-id="9fc6f-124">Der Standardwert ist eine von Visual Studio zugewiesene GUID, aber die tatsächliche Zeichenfolge ist nicht wichtig, solange sie auf dem Computer eindeutig ist.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-124">The default value is a GUID assigned by Visual Studio, but the actual string is not important as long as it's unique in your computer.</span></span>

```xml
<PropertyGroup>
    <UserSecretsId>UniqueIdentifyingString</UserSecretsId>
</PropertyGroup>
```

<span data-ttu-id="9fc6f-125">Sie können mit Secret Manager gespeicherte Geheimnisse in einer Anwendung verwenden, indem Sie `AddUserSecrets<T>` auf der Instanz ConfigurationBuilder aufrufen, um Geheimnisse für die Anwendung in der Konfiguration einzubeziehen.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-125">Using secrets stored with Secret Manager in an application is accomplished by calling `AddUserSecrets<T>` on the ConfigurationBuilder instance to include secrets for the application in its configuration.</span></span> <span data-ttu-id="9fc6f-126">Der generische Parameter „T“ sollte ein Typ aus der Assembly sein, auf die „UserSecretId“ angewendet wurde.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-126">The generic parameter T should be a type from the assembly that the UserSecretId was applied to.</span></span> <span data-ttu-id="9fc6f-127">In der Regel ist die Verwendung von `AddUserSecrets<Startup>` in Ordnung.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-127">Usually using `AddUserSecrets<Startup>` is fine.</span></span>

<span data-ttu-id="9fc6f-128">`AddUserSecrets<Startup>()` wird bei Verwendung der Standardoptionen für die Entwicklungsumgebung einbezogen, wenn die `CreateDefaultBuilder`-Methode in *Program.cs* verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9fc6f-128">The `AddUserSecrets<Startup>()` is included in the default options for the Development environment when using the `CreateDefaultBuilder` method in *Program.cs*.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="9fc6f-129">[Zurück](authorization-net-microservices-web-applications.md)
>[Weiter](azure-key-vault-protects-secrets.md)</span><span class="sxs-lookup"><span data-stu-id="9fc6f-129">[Previous](authorization-net-microservices-web-applications.md)
[Next](azure-key-vault-protects-secrets.md)</span></span>
