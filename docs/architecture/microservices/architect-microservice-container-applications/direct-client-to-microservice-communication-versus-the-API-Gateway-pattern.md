---
title: Das API-Gatewaymuster im Vergleich zur direkten Kommunikation zwischen Client und Microservice
description: Dieser Artikel hilft Ihnen, die Unterschiede und die Verwendungsmöglichkeiten des API-Gatewaymusters und der direkten Kommunikation zwischen Client und Microservice zu verstehen.
ms.date: 01/07/2019
ms.openlocfilehash: 88cea3b7c2fdd09bec605431308df8783c343332
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/26/2020
ms.locfileid: "96240601"
---
# <a name="the-api-gateway-pattern-versus-the-direct-client-to-microservice-communication"></a><span data-ttu-id="b49d1-103">Das API-Gatewaymuster im Vergleich zur direkten Kommunikation zwischen Client und Microservice</span><span class="sxs-lookup"><span data-stu-id="b49d1-103">The API gateway pattern versus the Direct client-to-microservice communication</span></span>

<span data-ttu-id="b49d1-104">In einer Microservicearchitektur stellt jeder Microservice (in der Regel) mehrere differenzierte Endpunkte zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="b49d1-104">In a microservices architecture, each microservice exposes a set of (typically) fine-grained endpoints.</span></span> <span data-ttu-id="b49d1-105">Dies kann wie in diesem Abschnitt beschrieben Auswirkungen auf die Kommunikation zwischen Client und Microservice haben.</span><span class="sxs-lookup"><span data-stu-id="b49d1-105">This fact can impact the client-to-microservice communication, as explained in this section.</span></span>

## <a name="direct-client-to-microservice-communication"></a><span data-ttu-id="b49d1-106">Direkte Kommunikation zwischen Client und Microservice</span><span class="sxs-lookup"><span data-stu-id="b49d1-106">Direct client-to-microservice communication</span></span>

<span data-ttu-id="b49d1-107">Es ist möglich, eine Architektur zur direkten Kommunikation zwischen Client und Microservice zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-107">A possible approach is to use a direct client-to-microservice communication architecture.</span></span> <span data-ttu-id="b49d1-108">Dabei kann eine Client-App, wie in Abbildung 4-12 dargestellt, auf direktem Weg Anforderungen an einige der Microservices senden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-108">In this approach, a client app can make requests directly to some of the microservices, as shown in Figure 4-12.</span></span>

![Das Diagramm zeigt die Architektur für die Kommunikation zwischen Client und Microservice.](./media/direct-client-to-microservice-communication.png)

<span data-ttu-id="b49d1-110">**Abbildung 4-12.**</span><span class="sxs-lookup"><span data-stu-id="b49d1-110">**Figure 4-12**.</span></span> <span data-ttu-id="b49d1-111">Verwenden einer Architektur zur direkten Kommunikation zwischen Client und Microservice</span><span class="sxs-lookup"><span data-stu-id="b49d1-111">Using a direct client-to-microservice communication architecture</span></span>

<span data-ttu-id="b49d1-112">In diesem Ansatz verfügt jeder Microservice über einen öffentlichen Endpunkt. Dabei kann es sein, dass jeder Microservice auf einem anderen TCP-Port ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="b49d1-112">In this approach, each microservice has a public endpoint, sometimes with a different TCP port for each microservice.</span></span> <span data-ttu-id="b49d1-113">In Azure kann die URL eines bestimmten Diensts z.B. wie folgt lauten:</span><span class="sxs-lookup"><span data-stu-id="b49d1-113">An example of a URL for a particular service could be the following URL in Azure:</span></span>

`http://eshoponcontainers.westus.cloudapp.azure.com:88/`

<span data-ttu-id="b49d1-114">In einer Produktionsumgebung, die auf einem Cluster basiert, wird diese URL dem im Cluster verwendeten Load Balancer zugeordnet, der dann wiederum die Anforderungen an die Microservices weiterleitet.</span><span class="sxs-lookup"><span data-stu-id="b49d1-114">In a production environment based on a cluster, that URL would map to the load balancer used in the cluster, which in turn distributes the requests across the microservices.</span></span> <span data-ttu-id="b49d1-115">In Produktionsumgebungen kann es sein, dass zwischen Ihren Microservices und dem Internet ein Application Delivery Controller (ADC) wie [Azure Application Gateway](/azure/application-gateway/application-gateway-introduction) steht.</span><span class="sxs-lookup"><span data-stu-id="b49d1-115">In production environments, you could have an Application Delivery Controller (ADC) like [Azure Application Gateway](/azure/application-gateway/application-gateway-introduction) between your microservices and the Internet.</span></span> <span data-ttu-id="b49d1-116">Dieser Controller fungiert als transparente Ebene, die nicht nur einen Lastenausgleich ausführt, sondern auch Ihre Dienste sichert, indem sie das Beenden von SSL ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="b49d1-116">This acts as a transparent tier that not only performs load balancing, but secures your services by offering SSL termination.</span></span> <span data-ttu-id="b49d1-117">Dadurch wird das Laden Ihrer Hosts verbessert, denn das Beenden von SSL, das zu einer hohen CPU-Auslastung führt, und andere Pflichten zur Weiterleitung an das Azure Application Gateway werden abgeladen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-117">This improves the load of your hosts by offloading CPU-intensive SSL termination and other routing duties to the Azure Application Gateway.</span></span> <span data-ttu-id="b49d1-118">In jedem Fall sind Lastenausgleich und ADC im Hinblick auf die logische Anwendungsarchitektur transparent.</span><span class="sxs-lookup"><span data-stu-id="b49d1-118">In any case, a load balancer and ADC are transparent from a logical application architecture point of view.</span></span>

<span data-ttu-id="b49d1-119">Eine Architektur zur direkten Kommunikation zwischen Client und Microservice kann sich gut für eine kleine auf einem Microservice basierende Anwendung eignen, insbesondere wenn es sich bei der Client-App um eine Webanwendung auf Serverseite handelt (z.B. eine ASP.NET-MVC-App).</span><span class="sxs-lookup"><span data-stu-id="b49d1-119">A direct client-to-microservice communication architecture could be good enough for a small microservice-based application, especially if the client app is a server-side web application like an ASP.NET MVC app.</span></span> <span data-ttu-id="b49d1-120">Wenn Sie allerdings eine große und komplexe auf einem Microservice basierende Anwendung erstellen (z.B. wenn Sie mit dutzenden Microservicetypen arbeiten), und vor allem wenn es sich bei den Client-Apps um mobile Remote-Apps oder SPA-Webanwendungen handelt, kann dieser Ansatz zu einigen Problemen führen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-120">However, when you build large and complex microservice-based applications (for example, when handling dozens of microservice types), and especially when the client apps are remote mobile apps or SPA web applications, that approach faces a few issues.</span></span>

<span data-ttu-id="b49d1-121">Beachten Sie die folgenden Fragen, wenn Sie eine große Anwendung erstellen, die auf Microservices basiert:</span><span class="sxs-lookup"><span data-stu-id="b49d1-121">Consider the following questions when developing a large application based on microservices:</span></span>

- <span data-ttu-id="b49d1-122">*Wie können Client-Apps die Anzahl von Anforderungen an das Back-End minimieren und umfangreiche Kommunikation mit mehreren Microservices reduzieren?*</span><span class="sxs-lookup"><span data-stu-id="b49d1-122">*How can client apps minimize the number of requests to the back end and reduce chatty communication to multiple microservices?*</span></span>

<span data-ttu-id="b49d1-123">Wenn zum Erstellen einer einzigen Benutzeroberflächenanzeige mit mehreren Microservices interagiert wird, steigt die Anzahl von Roundtrips im Internet.</span><span class="sxs-lookup"><span data-stu-id="b49d1-123">Interacting with multiple microservices to build a single UI screen increases the number of round trips across the Internet.</span></span> <span data-ttu-id="b49d1-124">Dadurch wird die Wartezeit und die Komplexität auf Benutzeroberflächenseite verringert.</span><span class="sxs-lookup"><span data-stu-id="b49d1-124">This increases latency and complexity on the UI side.</span></span> <span data-ttu-id="b49d1-125">Idealerweise sollten Antworten auf Serverseite effizient aggregiert werden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-125">Ideally, responses should be efficiently aggregated in the server side.</span></span> <span data-ttu-id="b49d1-126">Dadurch wird die Latenz verringert, da mehrere Daten gleichzeitig zurückgegeben werden und ein Teil der Benutzeroberfläche die Daten anzeigen kann, sobald sie verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="b49d1-126">This reduces latency, since multiple pieces of data come back in parallel and some UI can show data as soon as it's ready.</span></span>

- <span data-ttu-id="b49d1-127">*Wie können übergreifende Aspekte wie die Autorisierung, Datentransformationen und die dynamische Weiterleitung von Anforderungen gehandhabt werden?*</span><span class="sxs-lookup"><span data-stu-id="b49d1-127">*How can you handle cross-cutting concerns such as authorization, data transformations, and dynamic request dispatching?*</span></span>

<span data-ttu-id="b49d1-128">Wenn Sie übergreifende Aspekte wie Sicherheit und Autorisierung in jeden Microservice implementieren, ist unter Umständen ein hohes Maß an Entwicklungsarbeit erforderlich.</span><span class="sxs-lookup"><span data-stu-id="b49d1-128">Implementing security and cross-cutting concerns like security and authorization on every microservice can require significant development effort.</span></span> <span data-ttu-id="b49d1-129">Dies können Sie vermeiden, indem Sie diese Dienste im Docker-Host oder internen Cluster speichern, um den Direktzugriff von außen einzuschränken und diese übergreifenden Aspekte an zentraler Stelle zu implementieren (z.B. in einem API-Gateway).</span><span class="sxs-lookup"><span data-stu-id="b49d1-129">A possible approach is to have those services within the Docker host or internal cluster to restrict direct access to them from the outside, and to implement those cross-cutting concerns in a centralized place, like an API Gateway.</span></span>

- <span data-ttu-id="b49d1-130">*Wie können Client-Apps mit Diensten kommunizieren, die Protokolle verwenden, die nicht für das Internet geeignet sind?*</span><span class="sxs-lookup"><span data-stu-id="b49d1-130">*How can client apps communicate with services that use non-Internet-friendly protocols?*</span></span>

<span data-ttu-id="b49d1-131">Protokolle, die auf Serverseite verwendet werden (wie AMQP oder Binärprotokolle), werden in der Regel in Client-Apps nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="b49d1-131">Protocols used on the server side (like AMQP or binary protocols) are usually not supported in client apps.</span></span> <span data-ttu-id="b49d1-132">Aus diesem Grund müssen Anforderungen über Protokolle wie HTTP/HTTPS ausgeführt und anschließend in die anderen Protokolle übersetzt werden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-132">Therefore, requests must be performed through protocols like HTTP/HTTPS and translated to the other protocols afterwards.</span></span> <span data-ttu-id="b49d1-133">In diesem Fall kann der *Man-in-the-Middle*-Ansatz zur Lösung des Problems verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-133">A *man-in-the-middle* approach can help in this situation.</span></span>

- <span data-ttu-id="b49d1-134">*Wie kann eine Fassade angepasst werden, die speziell für mobile Apps erstellt wurde?*</span><span class="sxs-lookup"><span data-stu-id="b49d1-134">*How can you shape a facade especially made for mobile apps?*</span></span>

<span data-ttu-id="b49d1-135">Es kann sein, dass die API für mehrere Microservices nicht an die Anforderungen verschiedener Client-Anwendungen angepasst wurde.</span><span class="sxs-lookup"><span data-stu-id="b49d1-135">The API of multiple microservices might not be well designed for the needs of different client applications.</span></span> <span data-ttu-id="b49d1-136">Beispielweise unterscheiden sich die Anforderungen für mobile Apps von denen für Web-Apps.</span><span class="sxs-lookup"><span data-stu-id="b49d1-136">For instance, the needs of a mobile app might be different than the needs of a web app.</span></span> <span data-ttu-id="b49d1-137">Für mobile Apps müssen Sie möglicherweise weitere Anpassungen zur Optimierung vornehmen, damit Datenantworten effizienter ausfallen können.</span><span class="sxs-lookup"><span data-stu-id="b49d1-137">For mobile apps, you might need to optimize even further so that data responses can be more efficient.</span></span> <span data-ttu-id="b49d1-138">Diese Anpassungen können Sie vornehmen, indem Sie Daten aus mehreren Microservices aggregieren und einen einzelnen Datensatz zurückgeben oder indem Sie jegliche Daten aus der Antwort löschen, die für die mobile App nicht benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-138">You might do this by aggregating data from multiple microservices and returning a single set of data, and sometimes eliminating any data in the response that isn't needed by the mobile app.</span></span> <span data-ttu-id="b49d1-139">Außerdem können Sie natürlich die Daten komprimieren.</span><span class="sxs-lookup"><span data-stu-id="b49d1-139">And, of course, you might compress that data.</span></span> <span data-ttu-id="b49d1-140">Auch in diesem Szenario kann eine Fassade oder eine API zwischen der mobilen App und den Microservices hilfreich sein.</span><span class="sxs-lookup"><span data-stu-id="b49d1-140">Again, a facade or API in between the mobile app and the microservices can be convenient for this scenario.</span></span>

## <a name="why-consider-api-gateways-instead-of-direct-client-to-microservice-communication"></a><span data-ttu-id="b49d1-141">Gründe für die Verwendung von API-Gateways anstatt der direkten Kommunikation zwischen Client und Microservice</span><span class="sxs-lookup"><span data-stu-id="b49d1-141">Why consider API Gateways instead of direct client-to-microservice communication</span></span>

<span data-ttu-id="b49d1-142">In einer Microservicesarchitektur müssen die Client-Apps in der Regel die Funktionalität mehrerer Microservices nutzen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-142">In a microservices architecture, the client apps usually need to consume functionality from more than one microservice.</span></span> <span data-ttu-id="b49d1-143">Wenn diese Nutzung direkt erfolgt, muss der Client mehrere Aufrufe von Microservicesendpunkten verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="b49d1-143">If that consumption is performed directly, the client needs to handle multiple calls to microservice endpoints.</span></span> <span data-ttu-id="b49d1-144">Was passiert, wenn die Anwendung weiterentwickelt wird und neue Microservices eingeführt oder vorhandene Microservices aktualisiert werden?</span><span class="sxs-lookup"><span data-stu-id="b49d1-144">What happens when the application evolves and new microservices are introduced or existing microservices are updated?</span></span> <span data-ttu-id="b49d1-145">Wenn Ihre Anwendung sehr viele Microservices nutzt, kann die Verarbeitung dieser großen Zahl von Endpunkten in den Client-Apps ein echter Albtraum sein.</span><span class="sxs-lookup"><span data-stu-id="b49d1-145">If your application has many microservices, handling so many endpoints from the client apps can be a nightmare.</span></span> <span data-ttu-id="b49d1-146">Da die Client-App mit diesen internen Endpunkten gekoppelt wird, kann sich eine spätere Weiterentwicklung der Microservices massiv auf die Client-Apps auswirken.</span><span class="sxs-lookup"><span data-stu-id="b49d1-146">Since the client app would be coupled to those internal endpoints, evolving the microservices in the future can cause high impact for the client apps.</span></span>

<span data-ttu-id="b49d1-147">Daher kann es sehr praktisch sein, für microservicebasierte Anwendungen eine Zwischenebene der Dereferenzierung (Gateway) einzurichten.</span><span class="sxs-lookup"><span data-stu-id="b49d1-147">Therefore, having an intermediate level or tier of indirection (Gateway) can be very convenient for microservice-based applications.</span></span> <span data-ttu-id="b49d1-148">Wenn Sie keine API-Gateways verwenden, muss die Client-App Anforderungen direkt an die Microservices senden. Das kann u.a. zu folgenden Problemen führen:</span><span class="sxs-lookup"><span data-stu-id="b49d1-148">If you don't have API Gateways, the client apps must send requests directly to the microservices and that raises problems, such as the following issues:</span></span>

- <span data-ttu-id="b49d1-149">**Kopplung**: Ohne das API-Gatewaymuster werden die Client-Apps an die internen Microservices gekoppelt.</span><span class="sxs-lookup"><span data-stu-id="b49d1-149">**Coupling**: Without the API Gateway pattern, the client apps are coupled to the internal microservices.</span></span> <span data-ttu-id="b49d1-150">Die Client-Apps müssen wissen, wie die vielen verschiedenen Bereiche der Anwendung in Microservices zerlegt sind.</span><span class="sxs-lookup"><span data-stu-id="b49d1-150">The client apps need to know how the multiple areas of the application are decomposed in microservices.</span></span> <span data-ttu-id="b49d1-151">Wenn die internen Microservices weiterentwickelt und umgestaltet werden, kann dies aufgrund der direkten Verweise auf diese Microservices zu Breaking Changes bei den Client-Apps führen, was sich auf die Wartung auswirken kann.</span><span class="sxs-lookup"><span data-stu-id="b49d1-151">When evolving and refactoring the internal microservices, those actions impact maintenance because they cause breaking changes to the client apps due to the direct reference to the internal microservices from the client apps.</span></span> <span data-ttu-id="b49d1-152">Client-Apps müssen häufig aktualisiert, wodurch die Entwicklung der Lösung noch schwieriger wird.</span><span class="sxs-lookup"><span data-stu-id="b49d1-152">Client apps need to be updated frequently, making the solution harder to evolve.</span></span>

- <span data-ttu-id="b49d1-153">**Zu viele Roundtrips**: Eine einzige Seite in der Client-App erfordert möglicherweise mehrere Aufrufe für mehrere Diensten.</span><span class="sxs-lookup"><span data-stu-id="b49d1-153">**Too many round trips**: A single page/screen in the client app might require several calls to multiple services.</span></span> <span data-ttu-id="b49d1-154">Dies kann zu mehreren Netzwerkroundtrips zwischen dem Client und dem Server führen, was eine erheblich höhere Latenz nach sich zieht.</span><span class="sxs-lookup"><span data-stu-id="b49d1-154">That can result in multiple network round trips between the client and the server, adding significant latency.</span></span> <span data-ttu-id="b49d1-155">Eine Aggregierung auf einer Zwischenebene kann die Leistung und Benutzerfreundlichkeit für die Client-App verbessern.</span><span class="sxs-lookup"><span data-stu-id="b49d1-155">Aggregation handled in an intermediate level could improve the performance and user experience for the client app.</span></span>

- <span data-ttu-id="b49d1-156">**Sicherheitsprobleme**: Ohne ein Gateway müssen alle Microservices für die „Außenwelt“ verfügbar gemacht werden. Dadurch bieten sie eine größere Angriffsfläche als verborgene interne Microservices, die nicht direkt von den Client-Apps verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-156">**Security issues**: Without a gateway, all the microservices must be exposed to the "external world", making the attack surface larger than if you hide internal microservices that aren't directly used by the client apps.</span></span> <span data-ttu-id="b49d1-157">Je kleiner die Angriffsfläche ist, desto sicherer kann Ihre Anwendung sein.</span><span class="sxs-lookup"><span data-stu-id="b49d1-157">The smaller the attack surface is, the more secure your application can be.</span></span>

- <span data-ttu-id="b49d1-158">**Übergreifende Aspekte**: Für jeden öffentlich verfügbaren Microservice müssen Aspekte wie Autorisierung und SSL berücksichtigt werden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-158">**Cross-cutting concerns**: Each publicly published microservice must handle concerns such as authorization and SSL.</span></span> <span data-ttu-id="b49d1-159">In vielen Situationen können diese Aspekte auf einer einzigen Ebene verarbeitet werden, sodass die internen Microservices vereinfacht werden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-159">In many situations, those concerns could be handled in a single tier so the internal microservices are simplified.</span></span>

## <a name="what-is-the-api-gateway-pattern"></a><span data-ttu-id="b49d1-160">Was ist das API-Gatewaymuster?</span><span class="sxs-lookup"><span data-stu-id="b49d1-160">What is the API Gateway pattern?</span></span>

<span data-ttu-id="b49d1-161">Wenn Sie große bzw. komplexe auf einem Microservice basierende Anwendungen mit mehreren Client-Apps entwerfen und erstellen, sollten Sie darüber nachdenken, ob ein [API-Gateway](https://microservices.io/patterns/apigateway.html) hilfreich sein kann.</span><span class="sxs-lookup"><span data-stu-id="b49d1-161">When you design and build large or complex microservice-based applications with multiple client apps, a good approach to consider can be an [API Gateway](https://microservices.io/patterns/apigateway.html).</span></span> <span data-ttu-id="b49d1-162">Dabei handelt es sich um einen Dienst, der einen einzigen Einstiegspunkt für bestimmte Gruppen von Microservices bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="b49d1-162">This is a service that provides a single-entry point for certain groups of microservices.</span></span> <span data-ttu-id="b49d1-163">Dieser Dienst ähnelt zwar dem [Fassadenmuster](https://en.wikipedia.org/wiki/Facade_pattern) aus dem objektorientierten Design, ist in diesem Fall aber Teil eines verteilten Systems.</span><span class="sxs-lookup"><span data-stu-id="b49d1-163">It's similar to the [Facade pattern](https://en.wikipedia.org/wiki/Facade_pattern) from object-oriented design, but in this case, it's part of a distributed system.</span></span> <span data-ttu-id="b49d1-164">Das API-Gatewaymuster ist außerdem unter der Bezeichnung „Back-End für Front-End“ (Backend for Frontend, [BFF](https://samnewman.io/patterns/architectural/bff/)) bekannt, da Sie es erstellen, während Sie entscheiden, welche Anforderungen die Client-App haben soll.</span><span class="sxs-lookup"><span data-stu-id="b49d1-164">The API Gateway pattern is also sometimes known as the "backend for frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) because you build it while thinking about the needs of the client app.</span></span>

<span data-ttu-id="b49d1-165">Daher befindet sich das API-Gateway zwischen den Client-Apps und den Microservices.</span><span class="sxs-lookup"><span data-stu-id="b49d1-165">Therefore, the API gateway sits between the client apps and the microservices.</span></span> <span data-ttu-id="b49d1-166">Es fungiert als Reverseproxy und leitet Anforderungen von Clients an Dienste weiter.</span><span class="sxs-lookup"><span data-stu-id="b49d1-166">It acts as a reverse proxy, routing requests from clients to services.</span></span> <span data-ttu-id="b49d1-167">Es kann auch zusätzliche übergreifende Funktionen wie Authentifizierung, SSL-Terminierung und Cache bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-167">It can also provide additional cross-cutting features such as authentication, SSL termination, and cache.</span></span>

<span data-ttu-id="b49d1-168">Abbildung 4-13 zeigt, wie ein benutzerdefiniertes API-Gateway in eine vereinfachte microservicebasierte Architektur mit einigen wenigen Microservices passt.</span><span class="sxs-lookup"><span data-stu-id="b49d1-168">Figure 4-13 shows how a custom API Gateway can fit into a simplified microservice-based architecture with just a few microservices.</span></span>

![Das Diagramm zeigt ein API-Gateway, das als benutzerdefinierter Dienst implementiert ist.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/custom-service-api-gateway.png)

<span data-ttu-id="b49d1-170">**Abbildung 4-13.**</span><span class="sxs-lookup"><span data-stu-id="b49d1-170">**Figure 4-13**.</span></span> <span data-ttu-id="b49d1-171">Verwenden eines als benutzerdefinierter Dienst implementierten API-Gateways</span><span class="sxs-lookup"><span data-stu-id="b49d1-171">Using an API Gateway implemented as a custom service</span></span>

<span data-ttu-id="b49d1-172">Apps stellen eine Verbindung mit einem einzigen Endpunkt her, dem API-Gateway, das für die Weiterleitung von Anforderungen an einzelne Microservices konfiguriert wurde.</span><span class="sxs-lookup"><span data-stu-id="b49d1-172">Apps connect to a single endpoint, the API Gateway, that's configured to forward requests to individual microservices.</span></span> <span data-ttu-id="b49d1-173">In diesem Beispiel wird das API-Gateway als benutzerdefinierter ASP.NET Core WebHost-Dienst implementiert, der als Container ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="b49d1-173">In this example, the API Gateway would be implemented as a custom ASP.NET Core WebHost service running as a container.</span></span>

<span data-ttu-id="b49d1-174">Es sollte hervorgehoben werden, dass in diesem Diagramm ein einziger benutzerdefinierter API-Gatewaydienst verwendet wird, der auf mehrere verschiedene Client-Apps ausgerichtet ist.</span><span class="sxs-lookup"><span data-stu-id="b49d1-174">It's important to highlight that in that diagram, you would be using a single custom API Gateway service facing multiple and different client apps.</span></span> <span data-ttu-id="b49d1-175">Dies kann ein wichtiges Risiko darstellen, da ihr API-Gatewaydienst anhand vieler verschiedener Anforderungen aus den Client-Apps größer und weiterentwickelt wird.</span><span class="sxs-lookup"><span data-stu-id="b49d1-175">That fact can be an important risk because your API Gateway service will be growing and evolving based on many different requirements from the client apps.</span></span> <span data-ttu-id="b49d1-176">Aufgrund dieser verschiedenen Anforderungen kann es zu einer Überfrachtung kommen, und letztendlich kann dies einer monolithischen Anwendung oder einem monolithischen Dienst ähneln.</span><span class="sxs-lookup"><span data-stu-id="b49d1-176">Eventually, it will be bloated because of those different needs and effectively it could be similar to a monolithic application or monolithic service.</span></span> <span data-ttu-id="b49d1-177">Daher wird dringend empfohlen, das API-Gateway in mehrere Dienste oder mehrere kleinere API-Gateways aufzuteilen, z.B. eins pro Client-App-Formfaktor.</span><span class="sxs-lookup"><span data-stu-id="b49d1-177">That's why it's very much recommended to split the API Gateway in multiple services or multiple smaller API Gateways, one per client app form-factor type, for instance.</span></span>

<span data-ttu-id="b49d1-178">Beim Implementieren des API-Gatewaymusters müssen Sie Vorsicht walten lassen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-178">You need to be careful when implementing the API Gateway pattern.</span></span> <span data-ttu-id="b49d1-179">In der Regel sollte nicht ein einzelnes API-Gateway alle internen Microservices Ihrer Anwendung aggregieren.</span><span class="sxs-lookup"><span data-stu-id="b49d1-179">Usually it isn't a good idea to have a single API Gateway aggregating all the internal microservices of your application.</span></span> <span data-ttu-id="b49d1-180">Wenn dies trotzdem der Fall ist, agiert dieses als monolithischer Aggregator oder Orchestrator und beeinträchtig die Autonomie des Microservices, indem alle Microservices aneinander gekoppelt werden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-180">If it does, it acts as a monolithic aggregator or orchestrator and violates microservice autonomy by coupling all the microservices.</span></span>

<span data-ttu-id="b49d1-181">Aus diesem Grund sollten die API-Gateways basierend auf Geschäftsbereichsgrenzen aufgeteilt werden, und es sollte nicht ein einzelnes Gateway als Aggregator für alle internen Microservices agieren.</span><span class="sxs-lookup"><span data-stu-id="b49d1-181">Therefore, the API Gateways should be segregated based on business boundaries and the client apps and not act as a single aggregator for all the internal microservices.</span></span>

<span data-ttu-id="b49d1-182">Wenn Ihre Anwendung über mehrere Client-Apps verfügt und die API-Gateway-Ebene in mehrere API-Gateways aufgeteilt wird, kann dies ein Hauptaspekt beim Ermitteln der verschiedenen API-Gatewaytypen sein, sodass Sie für die Anforderungen jeder Client-App eine andere Fassade einrichten können.</span><span class="sxs-lookup"><span data-stu-id="b49d1-182">When splitting the API Gateway tier into multiple API Gateways, if your application has multiple client apps, that can be a primary pivot when identifying the multiple API Gateways types, so that you can have a different facade for the needs of each client app.</span></span> <span data-ttu-id="b49d1-183">Hier handelt es sich um ein Muster namens „Backend for Frontend“ ([BFF](https://samnewman.io/patterns/architectural/bff/)), in dem jedes API-Gateway eine andere API bereitstellen kann, die auf den jeweiligen Client-App-Typ zugeschnitten ist und möglicherweise sogar auf dem Formfaktor des Clients basiert. Das Muster implementiert einen bestimmten Adaptercode, der im Hintergrund mehrere interne Microservices aufruft, wie in der folgenden Abbildung dargestellt:</span><span class="sxs-lookup"><span data-stu-id="b49d1-183">This case is a pattern named "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) where each API Gateway can provide a different API tailored for each client app type, possibly even based on the client form factor by implementing specific adapter code which underneath calls multiple internal microservices, as shown in the following image:</span></span>

![Das Diagramm zeigt mehrere benutzerdefinierte API-Gateways.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/multiple-custom-api-gateways.png)

<span data-ttu-id="b49d1-185">**Abbildung 4-13.1**.</span><span class="sxs-lookup"><span data-stu-id="b49d1-185">**Figure 4-13.1**.</span></span> <span data-ttu-id="b49d1-186">Verwenden von mehreren benutzerdefinierten API-Gateways</span><span class="sxs-lookup"><span data-stu-id="b49d1-186">Using multiple custom API Gateways</span></span>

<span data-ttu-id="b49d1-187">Abbildung 4-13.1 zeigt API-Gateways, die nach Clienttyp getrennt sind: eines für mobile Clients und eines für Webclients.</span><span class="sxs-lookup"><span data-stu-id="b49d1-187">Figure 4-13.1 shows API Gateways that are segregated by client type; one for mobile clients and one for web clients.</span></span> <span data-ttu-id="b49d1-188">Eine herkömmliche Web-App stellt eine Verbindung mit einem MVC-Microservice her, der das Web-API-Gateway verwendet.</span><span class="sxs-lookup"><span data-stu-id="b49d1-188">A traditional web app connects to an MVC microservice that uses the web API Gateway.</span></span> <span data-ttu-id="b49d1-189">Das Beispiel zeigt eine vereinfachte Architektur mit mehreren differenzierten API-Gateways.</span><span class="sxs-lookup"><span data-stu-id="b49d1-189">The example depicts a simplified architecture with multiple fine-grained API Gateways.</span></span> <span data-ttu-id="b49d1-190">In diesem Fall basieren die Grenzen, die für jedes API-Gateway ermittelt werden, allein auf dem Muster „Backend for Frontend“ ([BFF](https://samnewman.io/patterns/architectural/bff/)) und damit genau auf der API, die pro Client-App benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="b49d1-190">In this case, the boundaries identified for each API Gateway are based purely on the "Backend for Frontend" ([BFF](https://samnewman.io/patterns/architectural/bff/)) pattern, hence based just on the API needed per client app.</span></span> <span data-ttu-id="b49d1-191">In größeren Anwendungen sollten Sie jedoch einen Schritt weiter gehen zusätzliche API-Gateways erstellen. Dabei verwenden Sie Geschäftsbereichsgrenzen als zweiten Dreh- und Angelpunkt für den Entwurf.</span><span class="sxs-lookup"><span data-stu-id="b49d1-191">But in larger applications you should also go further and create additional API Gateways based on business boundaries as a second design pivot.</span></span>

## <a name="main-features-in-the-api-gateway-pattern"></a><span data-ttu-id="b49d1-192">Die wichtigsten Funktionen im API-Gatewaymuster</span><span class="sxs-lookup"><span data-stu-id="b49d1-192">Main features in the API Gateway pattern</span></span>

<span data-ttu-id="b49d1-193">Ein API-Gateway kann mehrere Funktionen bieten.</span><span class="sxs-lookup"><span data-stu-id="b49d1-193">An API Gateway can offer multiple features.</span></span> <span data-ttu-id="b49d1-194">Je nach Produkt stehen umfangreichere oder einfachere Funktionen zur Verfügung. Die wichtigsten und grundlegendsten Funktionen für jedes API-Gateway sind jedoch die folgenden Entwurfsmuster:</span><span class="sxs-lookup"><span data-stu-id="b49d1-194">Depending on the product it might offer richer or simpler features, however, the most important and foundational features for any API Gateway are the following design patterns:</span></span>

<span data-ttu-id="b49d1-195">**Reverseproxy- oder Gatewayrouting.**</span><span class="sxs-lookup"><span data-stu-id="b49d1-195">**Reverse proxy or gateway routing.**</span></span> <span data-ttu-id="b49d1-196">Das API-Gateway bietet einen Reverseproxy, um Anforderungen an die Endpunkte der internen Microservices umzuleiten (Layer-7-Routing, in der Regel HTTP-Anforderungen).</span><span class="sxs-lookup"><span data-stu-id="b49d1-196">The API Gateway offers a reverse proxy to redirect or route requests (layer 7 routing, usually HTTP requests) to the endpoints of the internal microservices.</span></span> <span data-ttu-id="b49d1-197">Das Gateway stellt einen einzigen Endpunkt bzw. eine einzige URL für die Client-Apps bereit und ordnet die Anforderungen intern einer Gruppe von internen Microservices zu.</span><span class="sxs-lookup"><span data-stu-id="b49d1-197">The gateway provides a single endpoint or URL for the client apps and then internally maps the requests to a group of internal microservices.</span></span> <span data-ttu-id="b49d1-198">Dieses Routingfeature hilft dabei, die Client-Apps von den Microservices zu entkoppeln, ist aber auch dann praktisch, wenn eine monolithische API modernisiert werden soll: Indem Sie das API-Gateway zwischen die monolithische API und die Client-Apps platzieren, können Sie neue APIs als neue Microservices hinzufügen und dennoch weiterhin die ältere monolithische API verwenden, bis diese zu einem späteren Zeitpunkt in mehrere Microservices aufgeteilt wird.</span><span class="sxs-lookup"><span data-stu-id="b49d1-198">This routing feature helps to decouple the client apps from the microservices but it's also convenient when modernizing a monolithic API by sitting the API Gateway in between the monolithic API and the client apps, then you can add new APIs as new microservices while still using the legacy monolithic API until it's split into many microservices in the future.</span></span> <span data-ttu-id="b49d1-199">Durch das API-Gateway wissen die Client-Apps nicht, ob die verwendeten APIs als interne Microservices oder monolithische API implementiert sind. Viel wichtiger noch: Wenn eine monolithische API weiterentwickelt und in Microservices umgestaltet wird, wirken sich URI-Änderungen dank des API-Gatewayroutings nicht auf Client-Apps aus.</span><span class="sxs-lookup"><span data-stu-id="b49d1-199">Because of the API Gateway, the client apps won't notice if the APIs being used are implemented as internal microservices or a monolithic API and more importantly, when evolving and refactoring the monolithic API into microservices, thanks to the API Gateway routing, client apps won't be impacted with any URI change.</span></span>

<span data-ttu-id="b49d1-200">Weitere Informationen finden Sie unter [Muster „Gatewayrouting“](/azure/architecture/patterns/gateway-routing).</span><span class="sxs-lookup"><span data-stu-id="b49d1-200">For more information, see [Gateway routing pattern](/azure/architecture/patterns/gateway-routing).</span></span>

<span data-ttu-id="b49d1-201">**Aggregierung von Anforderungen.**</span><span class="sxs-lookup"><span data-stu-id="b49d1-201">**Requests aggregation.**</span></span> <span data-ttu-id="b49d1-202">Im Rahmen des Gatewaymusters können Sie mehrere Clientanforderungen (in der Regel HTTP-Anforderungen) für mehrere interne Microservices in eine einzige Clientanforderung aggregieren.</span><span class="sxs-lookup"><span data-stu-id="b49d1-202">As part of the gateway pattern you can aggregate multiple client requests (usually HTTP requests) targeting multiple internal microservices into a single client request.</span></span> <span data-ttu-id="b49d1-203">Dieses Muster ist besonders praktisch, wenn eine Clientseite Informationen aus mehreren Microservices benötigt.</span><span class="sxs-lookup"><span data-stu-id="b49d1-203">This pattern is especially convenient when a client page/screen needs information from several microservices.</span></span> <span data-ttu-id="b49d1-204">Bei diesem Ansatz sendet die Client-App eine einzelne Anforderung an das API-Gateway, das mehrere Anforderungen an die internen Microservices sendet, die Ergebnisse dann aggregiert und alles an die Client-App zurücksendet.</span><span class="sxs-lookup"><span data-stu-id="b49d1-204">With this approach, the client app sends a single request to the API Gateway that dispatches several requests to the internal microservices and then aggregates the results and sends everything back to the client app.</span></span> <span data-ttu-id="b49d1-205">Hauptziel und auch der wichtigste Vorteil dieses Entwurfsmusters ist, dass die Kommunikation zwischen den Client-Apps und der Back-End-API reduziert wird. Dies ist insbesondere bei Remote-Apps von Bedeutung, die sich nicht in dem Rechenzentrum befinden, in dem die Microservices bereitgestellt sind – z.B. bei mobilen Apps oder Anforderungen von SPA-Apps, die von JavaScript in Clientremotebrowsern gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-205">The main benefit and goal of this design pattern is to reduce chattiness between the client apps and the backend API, which is especially important for remote apps out of the datacenter where the microservices live, like mobile apps or requests coming from SPA apps that come from JavaScript in client remote browsers.</span></span> <span data-ttu-id="b49d1-206">Bei regulären Web-Apps, die die Anforderungen in der Serverumgebung ausführen (z.B. eine ASP.NET Core MVC-Web-App), ist dieses Muster nicht so wichtig, weil die Latenz wesentlich geringer ist als bei Remoteclient-Apps.</span><span class="sxs-lookup"><span data-stu-id="b49d1-206">For regular web apps performing the requests in the server environment (like an ASP.NET Core MVC web app), this pattern is not so important as the latency is very much smaller than for remote client apps.</span></span>

<span data-ttu-id="b49d1-207">Je nachdem, welches API-Gatewayprodukt Sie einsetzen, ist dieses möglicherweise in der Lage, diese Aggregierung durchzuführen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-207">Depending on the API Gateway product you use, it might be able to perform this aggregation.</span></span> <span data-ttu-id="b49d1-208">In vielen Fällen ist es aber ein flexiblerer Ansatz, Microservices zur Aggregierung im Bereich des API-Gateways zu erstellen, sodass Sie die Aggregierung im Code (genauer gesagt C#-Code) definieren können.</span><span class="sxs-lookup"><span data-stu-id="b49d1-208">However, in many cases it's more flexible to create aggregation microservices under the scope of the API Gateway, so you define the aggregation in code (that is, C# code):</span></span>

<span data-ttu-id="b49d1-209">Weitere Informationen finden Sie unter [Muster „Gatewayaggregation“](/azure/architecture/patterns/gateway-aggregation).</span><span class="sxs-lookup"><span data-stu-id="b49d1-209">For more information, see [Gateway aggregation pattern](/azure/architecture/patterns/gateway-aggregation).</span></span>

<span data-ttu-id="b49d1-210">**Übergreifende Aspekte oder Gatewayabladung.**</span><span class="sxs-lookup"><span data-stu-id="b49d1-210">**Cross-cutting concerns or gateway offloading.**</span></span> <span data-ttu-id="b49d1-211">Je nachdem, welche Features von den verschiedenen API-Gatewayprodukten angeboten werden, können Sie einen Teil der Funktionalität von den einzelnen Microservice auf das Gateway abladen. Dadurch vereinfachen Sie die Implementierung jedes Microservice, da übergreifende Aspekte auf eine einzige Ebene konsolidiert werden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-211">Depending on the features offered by each API Gateway product, you can offload functionality from individual microservices to the gateway, which simplifies the implementation of each microservice by consolidating cross-cutting concerns into one tier.</span></span> <span data-ttu-id="b49d1-212">Dies ist besonders nützlich für spezielle Funktionen, deren richtige Implementierung in jeden internen Microservice eine sehr komplexe Angelegenheit sein kann. Hier einige Beispiele:</span><span class="sxs-lookup"><span data-stu-id="b49d1-212">This is especially convenient for specialized features that can be complex to implement properly in every internal microservice, such as the following functionality:</span></span>

- <span data-ttu-id="b49d1-213">Authentifizierung und Autorisierung</span><span class="sxs-lookup"><span data-stu-id="b49d1-213">Authentication and authorization</span></span>
- <span data-ttu-id="b49d1-214">Integration der Dienstermittlung</span><span class="sxs-lookup"><span data-stu-id="b49d1-214">Service discovery integration</span></span>
- <span data-ttu-id="b49d1-215">Zwischenspeichern von Antworten</span><span class="sxs-lookup"><span data-stu-id="b49d1-215">Response caching</span></span>
- <span data-ttu-id="b49d1-216">Wiederholungsrichtlinien, Leitungstrennung, QoS</span><span class="sxs-lookup"><span data-stu-id="b49d1-216">Retry policies, circuit breaker, and QoS</span></span>
- <span data-ttu-id="b49d1-217">Ratenbegrenzung und -drosselung</span><span class="sxs-lookup"><span data-stu-id="b49d1-217">Rate limiting and throttling</span></span>
- <span data-ttu-id="b49d1-218">Lastenausgleich</span><span class="sxs-lookup"><span data-stu-id="b49d1-218">Load balancing</span></span>
- <span data-ttu-id="b49d1-219">Protokollierung, Ablaufverfolgung, Korrelation</span><span class="sxs-lookup"><span data-stu-id="b49d1-219">Logging, tracing, correlation</span></span>
- <span data-ttu-id="b49d1-220">Header, Abfragezeichenfolgen und Anspruchstransformation</span><span class="sxs-lookup"><span data-stu-id="b49d1-220">Headers, query strings, and claims transformation</span></span>
- <span data-ttu-id="b49d1-221">Setzen von IP-Adressen auf die Positivliste</span><span class="sxs-lookup"><span data-stu-id="b49d1-221">IP allowlisting</span></span>

<span data-ttu-id="b49d1-222">Weitere Informationen finden Sie unter [Muster „Gatewayabladung“](/azure/architecture/patterns/gateway-offloading).</span><span class="sxs-lookup"><span data-stu-id="b49d1-222">For more information, see [Gateway offloading pattern](/azure/architecture/patterns/gateway-offloading).</span></span>

## <a name="using-products-with-api-gateway-features"></a><span data-ttu-id="b49d1-223">Verwenden von Produkten mit API-Gatewayfeatures</span><span class="sxs-lookup"><span data-stu-id="b49d1-223">Using products with API Gateway features</span></span>

<span data-ttu-id="b49d1-224">Je nach Implementierung bedienen verschiedene API-Gatewayprodukte viele weitere übergreifende Aspekte.</span><span class="sxs-lookup"><span data-stu-id="b49d1-224">There can be many more cross-cutting concerns offered by the API Gateways products depending on each implementation.</span></span> <span data-ttu-id="b49d1-225">Hier werden wir Folgendes erkunden:</span><span class="sxs-lookup"><span data-stu-id="b49d1-225">We'll explore here:</span></span>

- [<span data-ttu-id="b49d1-226">Azure API Management</span><span class="sxs-lookup"><span data-stu-id="b49d1-226">Azure API Management</span></span>](https://azure.microsoft.com/services/api-management/)
- [<span data-ttu-id="b49d1-227">Ocelot</span><span class="sxs-lookup"><span data-stu-id="b49d1-227">Ocelot</span></span>](https://github.com/ThreeMammals/Ocelot)

### <a name="azure-api-management"></a><span data-ttu-id="b49d1-228">Azure API Management</span><span class="sxs-lookup"><span data-stu-id="b49d1-228">Azure API Management</span></span>

<span data-ttu-id="b49d1-229">[Azure API Management](https://azure.microsoft.com/services/api-management/) (wie in Abbildung 4-14 gezeigt) erfüllt nicht nur die Anforderungen Ihres API-Gateways, sondern bietet auch Features wie das Sammeln von Erkenntnissen aus Ihren APIs.</span><span class="sxs-lookup"><span data-stu-id="b49d1-229">[Azure API Management](https://azure.microsoft.com/services/api-management/) (as shown in Figure 4-14) not only solves your API Gateway needs but provides features like gathering insights from your APIs.</span></span> <span data-ttu-id="b49d1-230">Wenn Sie eine API-Verwaltungslösung verwenden, macht das API-Gateway nur einen Teil der gesamten Lösung aus.</span><span class="sxs-lookup"><span data-stu-id="b49d1-230">If you're using an API management solution, an API Gateway is only a component within that full API management solution.</span></span>

![Das Diagramm zeigt die Verwendung von Azure API Management als API-Gateway.](./media/direct-client-to-microservice-communication-versus-the-API-Gateway-pattern/api-gateway-azure-api-management.png)

<span data-ttu-id="b49d1-232">**Abbildung 4-14.**</span><span class="sxs-lookup"><span data-stu-id="b49d1-232">**Figure 4-14**.</span></span> <span data-ttu-id="b49d1-233">Verwenden von Azure API Management für das API-Gateway</span><span class="sxs-lookup"><span data-stu-id="b49d1-233">Using Azure API Management for your API Gateway</span></span>

<span data-ttu-id="b49d1-234">Azure API Management löst die Anforderungen von API-Gateway und Management wie Protokollierung, Sicherheit, Messung usw. In diesem Fall ist es nicht so riskant, wenn Sie nur über ein API-Gateway verfügen und Sie ein Produkt wie Azure API Management verwenden, da diese API-Gateway „dünner“ sind. Sie implementieren also keinen benutzerdefinierten C#-Code, der in eine monolithische Komponente umgewandelt werden könnte.</span><span class="sxs-lookup"><span data-stu-id="b49d1-234">Azure API Management solves both your API Gateway and Management needs like logging, security, metering, etc. In this case, when using a product like Azure API Management, the fact that you might have a single API Gateway is not so risky because these kinds of API Gateways are "thinner", meaning that you don't implement custom C# code that could evolve towards a monolithic component.</span></span>

<span data-ttu-id="b49d1-235">Die API-Gatewayprodukte fungieren in der Regel wie ein Reverseproxy für die eingehende Kommunikation – hier können Sie auch die APIs der internen Microservices filtern und Autorisierungsfunktionen auf die veröffentlichten APIs auf dieser einzelnen Ebene anwenden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-235">The API Gateway products usually act like a reverse proxy for ingress communication, where you can also filter the APIs from the internal microservices plus apply authorization to the published APIs in this single tier.</span></span>

<span data-ttu-id="b49d1-236">Mithilfe der Informationen, die ein API Management-System bereitstellt, erhalten Sie einen Überblick über die Verwendung und die Leistung Ihrer APIs.</span><span class="sxs-lookup"><span data-stu-id="b49d1-236">The insights available from an API Management system help you get an understanding of how your APIs are being used and how they are performing.</span></span> <span data-ttu-id="b49d1-237">Sie erhalten nahezu in Echtzeit Analyseberichte, und es werden Trends ermittelt, die Auswirkungen auf Ihr Unternehmen haben könnten.</span><span class="sxs-lookup"><span data-stu-id="b49d1-237">They do this by letting you view near real-time analytics reports and identifying trends that might impact your business.</span></span> <span data-ttu-id="b49d1-238">Außerdem erhalten Sie Protokolle zu Anforderungen und zur Antwortaktivität für weitere Online- und Offlineanalysen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-238">Plus, you can have logs about request and response activity for further online and offline analysis.</span></span>

<span data-ttu-id="b49d1-239">Mit Azure API Management können Sie Ihre APIs mit einem Schlüssel, einem Token und mit IP-Filtern sichern.</span><span class="sxs-lookup"><span data-stu-id="b49d1-239">With Azure API Management, you can secure your APIs using a key, a token, and IP filtering.</span></span> <span data-ttu-id="b49d1-240">Über dieses Feature können Sie flexible und präzise Kontingente erzwingen und Einschränkungen beurteilen, die Form und das Verhalten Ihrer APIs verändern, die Richtlinien verwenden, und die Leistung über das Speichern von Antworten verbessern.</span><span class="sxs-lookup"><span data-stu-id="b49d1-240">These features let you enforce flexible and fine-grained quotas and rate limits, modify the shape and behavior of your APIs using policies, and improve performance with response caching.</span></span>

<span data-ttu-id="b49d1-241">In diesem Leitfaden und in der Referenzbeispielanwendung (eShopOnContainers) ist die Architektur auf eine einfachere und benutzerdefinierte Containerarchitektur beschränkt, um den Fokus auf einfache Container zu legen, ohne PaaS-Produkte wie Azure API Management zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-241">In this guide and the reference sample application (eShopOnContainers), the architecture is limited to a simpler and custom-made containerized architecture in order to focus on plain containers without using PaaS products like Azure API Management.</span></span> <span data-ttu-id="b49d1-242">Für große microservicebasierte Anwendungen, die in Microsoft Azure bereitgestellt werden, empfehlen wir Ihnen jedoch, Azure API Management als Basis für Ihre API-Gateways in der Produktion in Betracht zu ziehen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-242">But for large microservice-based applications that are deployed into Microsoft Azure, we encourage you to evaluate Azure API Management as the base for your API Gateways in production.</span></span>

### <a name="ocelot"></a><span data-ttu-id="b49d1-243">Ocelot</span><span class="sxs-lookup"><span data-stu-id="b49d1-243">Ocelot</span></span>

<span data-ttu-id="b49d1-244">[Ocelot](https://github.com/ThreeMammals/Ocelot) ist ein einfaches API-Gateway, das sich für weniger komplexe Anforderungen empfiehlt.</span><span class="sxs-lookup"><span data-stu-id="b49d1-244">[Ocelot](https://github.com/ThreeMammals/Ocelot) is a lightweight API Gateway, recommended for simpler approaches.</span></span> <span data-ttu-id="b49d1-245">Ocelot ist ein .NET Core-basiertes Open Source-API-Gateway, das speziell für Microservicearchitekturen entwickelt wurde, für die einheitliche Eintrittspunkte in deren Systeme benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="b49d1-245">Ocelot is an Open Source .NET Core-based API Gateway especially made for microservices architectures that need unified points of entry into their systems.</span></span> <span data-ttu-id="b49d1-246">Das Gateway ist schlank, schnell und skalierbar und bietet Routing und Authentifizierung sowie viele weitere Funktionen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-246">It's lightweight, fast, and scalable and provides routing and authentication among many other features.</span></span>

<span data-ttu-id="b49d1-247">Der Hauptgrund Ocelot für Auswählen der [referenzanwendung eShopOnContainers](https://github.com/dotnet-architecture/eShopOnContainers) ist, da Ocelot eine einfache API-Gateway von .NET Core, die Sie in der gleichen Anwendung bereitstellungsumgebung bereitstellen können ist, in denen Sie bereitstellen, Ihre Microservices /-Container, z. B. ein Docker-Host, Kubernetes usw. Und da es auf .NET Core basiert, funktioniert es plattformübergreifend, sodass Sie Ihre Anwendung sowohl unter Linux als auch unter Windows bereitstellen können.</span><span class="sxs-lookup"><span data-stu-id="b49d1-247">The main reason to choose Ocelot for the [eShopOnContainers reference application](https://github.com/dotnet-architecture/eShopOnContainers) is because Ocelot is a .NET Core lightweight API Gateway that you can deploy into the same application deployment environment where you're deploying your microservices/containers, such as a Docker Host, Kubernetes, etc. And since it's based on .NET Core, it's cross-platform allowing you to deploy on Linux or Windows.</span></span>

<span data-ttu-id="b49d1-248">Die Diagramme oben zeigen benutzerdefinierte API-Gateways, die in Containern ausgeführt werden – genau so können Sie auch Ocelot in einer container- und microservicebasierten Anwendung ausführen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-248">The previous diagrams showing custom API Gateways running in containers are precisely how you can also run Ocelot in a container and microservice-based application.</span></span>

<span data-ttu-id="b49d1-249">Darüber gibt es viele weitere Produkte auf dem Markt, die API-Gatewayfeatures anbieten, wie z.B. Apigee, Kong, MuleSoft und WSO2 sowie weitere Produkte wie Linkerd und Istio mit weiteren Controllerfunktionen für eingehenden Datenverkehr in das Dienstmesh.</span><span class="sxs-lookup"><span data-stu-id="b49d1-249">In addition, there are many other products in the market offering API Gateways features, such as Apigee, Kong, MuleSoft, WSO2, and other products like Linkerd and Istio for service mesh ingress controller features.</span></span>

<span data-ttu-id="b49d1-250">Nachdem wir Architektur und Muster beschrieben haben, wird in den nächsten Abschnitten erläutert, wie Sie API-Gateways mit [Ocelot](https://github.com/ThreeMammals/Ocelot) implementieren.</span><span class="sxs-lookup"><span data-stu-id="b49d1-250">After the initial architecture and patterns explanation sections, the next sections explain how to implement API Gateways with [Ocelot](https://github.com/ThreeMammals/Ocelot).</span></span>

## <a name="drawbacks-of-the-api-gateway-pattern"></a><span data-ttu-id="b49d1-251">Nachteile des API-Gatewaymusters</span><span class="sxs-lookup"><span data-stu-id="b49d1-251">Drawbacks of the API Gateway pattern</span></span>

- <span data-ttu-id="b49d1-252">Der größte Nachteil besteht darin, dass Sie bei der Implementierung eines API-Gateways diese Ebene an die internen Microservices koppeln.</span><span class="sxs-lookup"><span data-stu-id="b49d1-252">The most important drawback is that when you implement an API Gateway, you're coupling that tier with the internal microservices.</span></span> <span data-ttu-id="b49d1-253">Eine solche Kopplung kann schwerwiegende Folgen für Ihre Anwendung haben.</span><span class="sxs-lookup"><span data-stu-id="b49d1-253">Coupling like this might introduce serious difficulties for your application.</span></span> <span data-ttu-id="b49d1-254">Clemens Vaster, Architekt im Azure Service Bus-Team, nannte dies in seinem Vortrag [Messaging and Microservices (Messaging und Microservices)](https://www.youtube.com/watch?v=rXi5CLjIQ9k) auf der GOTO 2016 den „neuen ESB“ (Enterprise Service Bus).</span><span class="sxs-lookup"><span data-stu-id="b49d1-254">Clemens Vaster, architect at the Azure Service Bus team, refers to this potential difficulty as "the new ESB" in the "[Messaging and Microservices](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" session at GOTO 2016.</span></span>

- <span data-ttu-id="b49d1-255">Wenn ein Microservices-API-Gateway verwendet wird, wird möglicherweise ein zusätzlicher Single Point of Failure erstellt.</span><span class="sxs-lookup"><span data-stu-id="b49d1-255">Using a microservices API Gateway creates an additional possible single point of failure.</span></span>

- <span data-ttu-id="b49d1-256">Durch ein API-Gateway können aufgrund des zusätzlichen Netzwerkaufrufs längere Antwortzeiten entstehen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-256">An API Gateway can introduce increased response time due to the additional network call.</span></span> <span data-ttu-id="b49d1-257">Dieser zusätzliche Aufruf hat jedoch in der Regel weniger Auswirkungen als die Verwendung einer Clientschnittstelle, die zu ausführlich ist und die internen Microservices direkt aufruft.</span><span class="sxs-lookup"><span data-stu-id="b49d1-257">However, this extra call usually has less impact than having a client interface that's too chatty directly calling the internal microservices.</span></span>

- <span data-ttu-id="b49d1-258">Wenn das API-Gateway nicht ordnungsgemäß hochskaliert wird, kann das API-Gateway zu Engpässen führen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-258">If not scaled out properly, the API Gateway can become a bottleneck.</span></span>

- <span data-ttu-id="b49d1-259">Durch API-Gateways entstehen zusätzliche Kosten. Außerdem müssen sie verwaltet werden, wenn sie benutzerdefinierte Logik und Datenaggregation enthalten.</span><span class="sxs-lookup"><span data-stu-id="b49d1-259">An API Gateway requires additional development cost and future maintenance if it includes custom logic and data aggregation.</span></span> <span data-ttu-id="b49d1-260">Entwickler müssen das API-Gateway aktualisieren, um die Endpunkte aller Microservices verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-260">Developers must update the API Gateway in order to expose each microservice's endpoints.</span></span> <span data-ttu-id="b49d1-261">Außerdem kann es zu Codeveränderungen auf der API-Gatewayebene kommen, wenn sich die Implementierung in den internen Microservices ändert.</span><span class="sxs-lookup"><span data-stu-id="b49d1-261">Moreover, implementation changes in the internal microservices might cause code changes at the API Gateway level.</span></span> <span data-ttu-id="b49d1-262">Wenn das API-Gateway allerdings nur die Sicherheit, Protokollierung und Versionsverwaltung anwendet (wie bei der Verwendung von Azure API Management), sollten keine zusätzlichen Kosten entstehen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-262">However, if the API Gateway is just applying security, logging, and versioning (as when using Azure API Management), this additional development cost might not apply.</span></span>

- <span data-ttu-id="b49d1-263">Wenn das API-Gateway von nur einem Team entwickelt wird, kann es zu Engpässen bei der Entwicklung kommen.</span><span class="sxs-lookup"><span data-stu-id="b49d1-263">If the API Gateway is developed by a single team, there can be a development bottleneck.</span></span> <span data-ttu-id="b49d1-264">Dies stellt einen weiteren Grund dar, warum es besser ist, über mehrere präzise API-Gateways zu verfügen, die auf die verschiedenen Clientanforderungen antworten.</span><span class="sxs-lookup"><span data-stu-id="b49d1-264">This is another reason why a better approach is to have several fined-grained API Gateways that respond to different client needs.</span></span> <span data-ttu-id="b49d1-265">Sie können ebenfalls das API-Gateway intern in mehrere Bereiche oder Ebenen aufteilen, die die verschiedenen Teams besitzen, die an den internen Microservices arbeiten.</span><span class="sxs-lookup"><span data-stu-id="b49d1-265">You could also segregate the API Gateway internally into multiple areas or layers that are owned by the different teams working on the internal microservices.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="b49d1-266">Zusätzliche Ressourcen</span><span class="sxs-lookup"><span data-stu-id="b49d1-266">Additional resources</span></span>

- <span data-ttu-id="b49d1-267">**Chris Richardson. Pattern: API Gateway / Backend for Frontend (Muster: API-Gateway/Back-End für Front-End)**  </span><span class="sxs-lookup"><span data-stu-id="b49d1-267">**Chris Richardson. Pattern: API Gateway / Backend for Front-End** </span></span>\
  <https://microservices.io/patterns/apigateway.html>

- <span data-ttu-id="b49d1-268">**API-Gatewaymuster** </span><span class="sxs-lookup"><span data-stu-id="b49d1-268">**API Gateway pattern** </span></span>\
  <https://docs.microsoft.com/azure/architecture/microservices/gateway>

- <span data-ttu-id="b49d1-269">**Aggregation and composition pattern (Aggregations- und Kompositionsmuster)**  </span><span class="sxs-lookup"><span data-stu-id="b49d1-269">**Aggregation and composition pattern** </span></span>\
  <https://microservices.io/patterns/data/api-composition.html>

- <span data-ttu-id="b49d1-270">**Azure API Management** </span><span class="sxs-lookup"><span data-stu-id="b49d1-270">**Azure API Management** </span></span>\
  <https://azure.microsoft.com/services/api-management/>

- <span data-ttu-id="b49d1-271">**Udi Dahan. Service Oriented Composition (Dienstorientierte Komposition)**  </span><span class="sxs-lookup"><span data-stu-id="b49d1-271">**Udi Dahan. Service Oriented Composition** </span></span>\
  <https://udidahan.com/2014/07/30/service-oriented-composition-with-video/>

- <span data-ttu-id="b49d1-272">**Clemens Vasters. Messaging and Microservices at GOTO 2016 (Video) (Messaging und Microservices auf der GOTO 2016)**  </span><span class="sxs-lookup"><span data-stu-id="b49d1-272">**Clemens Vasters. Messaging and Microservices at GOTO 2016 (video)** </span></span>\
  <https://www.youtube.com/watch?v=rXi5CLjIQ9k>

- <span data-ttu-id="b49d1-273">**API Gateway in a Nutshell (API-Gateway in aller Kürze)** (ASP.NET Core API Gateway Tutorial Series (ASP.NET Core API-Gateway-Tutorial-Reihe)) </span><span class="sxs-lookup"><span data-stu-id="b49d1-273">**API Gateway in a Nutshell** (ASP.NET Core API Gateway Tutorial Series) </span></span>\
  <https://www.pogsdotnet.com/2018/08/api-gateway-in-nutshell.html>

>[!div class="step-by-step"]
><span data-ttu-id="b49d1-274">[Zurück](identify-microservice-domain-model-boundaries.md)
>[Weiter](communication-in-microservice-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="b49d1-274">[Previous](identify-microservice-domain-model-boundaries.md)
[Next](communication-in-microservice-architecture.md)</span></span>
