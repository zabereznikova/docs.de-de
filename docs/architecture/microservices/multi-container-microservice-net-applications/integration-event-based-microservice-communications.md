---
title: Implementieren ereignisbasierter Kommunikation zwischen Microservices (Integrationsereignisse)
description: .NET-Microservicearchitektur für .NET-Containeranwendungen | Übersicht über Integrationsereignisse zum Implementieren ereignisbasierter Kommunikation zwischen Microservices
ms.date: 01/13/2021
ms.openlocfilehash: 65c0414184fdd1bccfbc61ef4df8fdcb88284ebe
ms.sourcegitcommit: a4cecb7389f02c27e412b743f9189bd2a6dea4d6
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 01/14/2021
ms.locfileid: "98188204"
---
# <a name="implementing-event-based-communication-between-microservices-integration-events"></a><span data-ttu-id="86ca9-103">Implementieren ereignisbasierter Kommunikation zwischen Microservices (Integrationsereignisse)</span><span class="sxs-lookup"><span data-stu-id="86ca9-103">Implementing event-based communication between microservices (integration events)</span></span>

<span data-ttu-id="86ca9-104">Wie bereits erwähnt, veröffentlicht ein Microservice bei Verwendung ereignisbasierter Kommunikation ein Ereignis, wenn etwas Nennenswertes geschieht, beispielsweise wenn eine Geschäftseinheit aktualisiert wird.</span><span class="sxs-lookup"><span data-stu-id="86ca9-104">As described earlier, when you use event-based communication, a microservice publishes an event when something notable happens, such as when it updates a business entity.</span></span> <span data-ttu-id="86ca9-105">Andere Microservices abonnieren diese Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="86ca9-105">Other microservices subscribe to those events.</span></span> <span data-ttu-id="86ca9-106">Wenn ein Microservice ein Ereignis empfängt, kann er die eigenen Geschäftseinheiten aktualisieren, was dazu führen kann, dass weitere Ereignisse veröffentlicht werden.</span><span class="sxs-lookup"><span data-stu-id="86ca9-106">When a microservice receives an event, it can update its own business entities, which might lead to more events being published.</span></span> <span data-ttu-id="86ca9-107">Das ist die Grundidee des Konzepts der letztlichen Konsistenz.</span><span class="sxs-lookup"><span data-stu-id="86ca9-107">This is the essence of the eventual consistency concept.</span></span> <span data-ttu-id="86ca9-108">Dieses System des Veröffentlichens/Abonnierens erfolgt in der Regel über die Implementierung eines Ereignisbusses.</span><span class="sxs-lookup"><span data-stu-id="86ca9-108">This publish/subscribe system is usually performed by using an implementation of an event bus.</span></span> <span data-ttu-id="86ca9-109">Der Ereignisbus kann als Schnittstelle ausgelegt sein, die die API enthält, die zum Abonnieren von Ereignissen, zum Kündigen des Abonnements von Ereignissen sowie zum Veröffentlichen von Ereignissen erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="86ca9-109">The event bus can be designed as an interface with the API needed to subscribe and unsubscribe to events and to publish events.</span></span> <span data-ttu-id="86ca9-110">Er kann auch über eine oder mehrere Implementierungen verfügen, die auf prozessübergreifender Kommunikation oder Messaging-Kommunikation beruhen. Beispiele hierfür sind Nachrichtenwarteschlangen oder Service Busse, die die asynchrone Kommunikation und ein auf Veröffentlichen/Abonnieren basierendes Modell unterstützen.</span><span class="sxs-lookup"><span data-stu-id="86ca9-110">It can also have one or more implementations based on any inter-process or messaging communication, such as a messaging queue or a service bus that supports asynchronous communication and a publish/subscribe model.</span></span>

<span data-ttu-id="86ca9-111">Sie können Ereignisse verwenden, um Geschäftstransaktionen zu implementieren, die sich über mehrere Dienste erstrecken. Dadurch werden diese Dienste im Laufe der Zeit konsistent.</span><span class="sxs-lookup"><span data-stu-id="86ca9-111">You can use events to implement business transactions that span multiple services, which give you eventual consistency between those services.</span></span> <span data-ttu-id="86ca9-112">Eine letztendlich konsistente Transaktion besteht aus einer Reihe von verteilten Aktionen.</span><span class="sxs-lookup"><span data-stu-id="86ca9-112">An eventually consistent transaction consists of a series of distributed actions.</span></span> <span data-ttu-id="86ca9-113">Bei jeder Aktion aktualisiert der Microservice eine Geschäftseinheit und veröffentlicht ein Ereignis, das die nächste Aktion auslöst.</span><span class="sxs-lookup"><span data-stu-id="86ca9-113">At each action, the microservice updates a business entity and publishes an event that triggers the next action.</span></span> <span data-ttu-id="86ca9-114">In Abbildung 6-18 unten wird ein PriceUpdated-Ereignis gezeigt, das über einen Ereignisbus veröffentlicht wurde, sodass die Preisaktualisierung in den Warenkorb und an andere Microservices weitergegeben wird.</span><span class="sxs-lookup"><span data-stu-id="86ca9-114">Figure 6-18 below, shows a PriceUpdated event published through an event bus, so the price update is propagated to the Basket and other microservices.</span></span>

![Diagramm der asynchronen, ereignisgesteuerten Kommunikation mit einem Ereignisbus.](./media/integration-event-based-microservice-communications/event-driven-communication.png)

<span data-ttu-id="86ca9-116">**Abbildung 6-18**.</span><span class="sxs-lookup"><span data-stu-id="86ca9-116">**Figure 6-18**.</span></span> <span data-ttu-id="86ca9-117">Ereignisgesteuerte Kommunikation basierend auf einem Ereignisbus</span><span class="sxs-lookup"><span data-stu-id="86ca9-117">Event-driven communication based on an event bus</span></span>

<span data-ttu-id="86ca9-118">In diesem Abschnitt wird beschrieben, wie Sie diese Art von Kommunikation mit .NET mithilfe einer generischen Ereignisbusschnittstelle implementieren können (siehe Abbildung 6-18).</span><span class="sxs-lookup"><span data-stu-id="86ca9-118">This section describes how you can implement this type of communication with .NET by using a generic event bus interface, as shown in Figure 6-18.</span></span> <span data-ttu-id="86ca9-119">Es gibt mehrere mögliche Implementierungen, bei denen jeweils eine andere Technologie oder Infrastruktur wie RabbitMQ, Azure Service Bus oder ein anderer Drittanbieter-Open Source- oder kommerzieller Servicebus zum Einsatz kommt.</span><span class="sxs-lookup"><span data-stu-id="86ca9-119">There are multiple potential implementations, each using a different technology or infrastructure such as RabbitMQ, Azure Service Bus, or any other third-party open-source or commercial service bus.</span></span>

## <a name="using-message-brokers-and-services-buses-for-production-systems"></a><span data-ttu-id="86ca9-120">Verwendung von Nachrichtenbrokern und Dienstbussen für Produktionssysteme</span><span class="sxs-lookup"><span data-stu-id="86ca9-120">Using message brokers and services buses for production systems</span></span>

<span data-ttu-id="86ca9-121">Wie im Abschnitt über die Architektur bereits erwähnt, haben Sie bei der Implementierung des abstrakten Ereignisbusses die Wahl zwischen verschiedenen Messaging-Technologien.</span><span class="sxs-lookup"><span data-stu-id="86ca9-121">As noted in the architecture section, you can choose from multiple messaging technologies for implementing your abstract event bus.</span></span> <span data-ttu-id="86ca9-122">Diese Technologien werden jedoch auf unterschiedlichen Ebenen eingesetzt.</span><span class="sxs-lookup"><span data-stu-id="86ca9-122">But these technologies are at different levels.</span></span> <span data-ttu-id="86ca9-123">So setzt der Nachrichtenbrokertransport RabbitMQ beispielsweise im Vergleich zu kommerziellen Produkten wie Azure Service Bus, NServiceBus, MassTransit oder Brighter auf einer unteren Ebene an.</span><span class="sxs-lookup"><span data-stu-id="86ca9-123">For instance, RabbitMQ, a messaging broker transport, is at a lower level than commercial products like Azure Service Bus, NServiceBus, MassTransit, or Brighter.</span></span> <span data-ttu-id="86ca9-124">Die meisten dieser Produkte können zusätzlich zu RabbitMQ oder Azure Service Bus verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="86ca9-124">Most of these products can work on top of either RabbitMQ or Azure Service Bus.</span></span> <span data-ttu-id="86ca9-125">Die Auswahl des Produkts hängt davon ab, wie viele Features und wie viel standardmäßige Skalierbarkeit Sie für Ihre Anwendung benötigen.</span><span class="sxs-lookup"><span data-stu-id="86ca9-125">Your choice of product depends on how many features and how much out-of-the-box scalability you need for your application.</span></span>

<span data-ttu-id="86ca9-126">Für die Implementierung von nur einem Ereignisbus-Proof-of-Concepts für die Entwicklungsumgebung wie im eShopOnContainers-Beispiel ist eine einfache Implementierung zusätzlich zu einer als Container ausgeführten RabbitMQ-Installation möglicherweise ausreichend.</span><span class="sxs-lookup"><span data-stu-id="86ca9-126">For implementing just an event bus proof-of-concept for your development environment, as in the eShopOnContainers sample, a simple implementation on top of RabbitMQ running as a container might be enough.</span></span> <span data-ttu-id="86ca9-127">Für unternehmenskritische Systeme und Produktionssysteme, für die eine hohe Skalierbarkeit erforderlich ist, sollten Sie jedoch Azure Service Bus testen und verwenden.</span><span class="sxs-lookup"><span data-stu-id="86ca9-127">But for mission-critical and production systems that need high scalability, you might want to evaluate and use Azure Service Bus.</span></span>

<span data-ttu-id="86ca9-128">Wenn Sie allgemeine Abstraktionen und umfangreichere Features wie [Sagas](https://docs.particular.net/nservicebus/sagas/) für Prozesse mit langer Ausführungsdauer benötigen, die eine verteilte Entwicklung erleichtern, lohnt es sich, andere kommerzielle und Open-Source-Service Busse wie NServiceBus, MassTransit und Brighter zu testen.</span><span class="sxs-lookup"><span data-stu-id="86ca9-128">If you require high-level abstractions and richer features like [Sagas](https://docs.particular.net/nservicebus/sagas/) for long-running processes that make distributed development easier, other commercial and open-source service buses like NServiceBus, MassTransit, and Brighter are worth evaluating.</span></span> <span data-ttu-id="86ca9-129">In diesem Fall sind die zu verwendenden Abstraktionen und die zu verwendende API diejenigen, die von diesen allgemeinen Service Bussen bereitgestellt werden, und nicht Ihre eigenen Abstraktionen (wie die [unter eShopOnContainers bereitgestellten einfachen Ereignisbusabstraktionen](https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/BuildingBlocks/EventBus/EventBus/Abstractions/IEventBus.cs)).</span><span class="sxs-lookup"><span data-stu-id="86ca9-129">In this case, the abstractions and API to use would usually be directly the ones provided by those high-level service buses instead of your own abstractions (like the [simple event bus abstractions provided at eShopOnContainers](https://github.com/dotnet-architecture/eShopOnContainers/blob/dev/src/BuildingBlocks/EventBus/EventBus/Abstractions/IEventBus.cs)).</span></span> <span data-ttu-id="86ca9-130">Zu diesem Zweck können Sie die [geforkten eShopOnContainers mithilfe von NServiceBus](https://go.particular.net/eShopOnContainers) (zusätzliches abgeleitetes Beispiel, durch Particular Software implementiert) untersuchen.</span><span class="sxs-lookup"><span data-stu-id="86ca9-130">For that matter, you can research the [forked eShopOnContainers using NServiceBus](https://go.particular.net/eShopOnContainers) (additional derived sample implemented by Particular Software).</span></span>

<span data-ttu-id="86ca9-131">Natürlich können Sie auch Ihre eigenen Service Bus-Features auf Grundlage spezifischer Technologien wie RabbitMQ und Docker erstellen. Der hierzu erforderliche Mehraufwand ist für benutzerdefinierte Unternehmensanwendungen wahrscheinlich zu kostspielig.</span><span class="sxs-lookup"><span data-stu-id="86ca9-131">Of course, you could always build your own service bus features on top of lower-level technologies like RabbitMQ and Docker, but the work needed to "reinvent the wheel" might be too costly for a custom enterprise application.</span></span>

<span data-ttu-id="86ca9-132">Als Erinnerung: Die im eShopOnContainers-Beispiel vorgestellten Beispielereignisbus-Abstraktionen und -Implementierungen sind nur als Proof of Concept zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="86ca9-132">To reiterate: the sample event bus abstractions and implementation showcased in the eShopOnContainers sample are intended to be used only as a proof of concept.</span></span> <span data-ttu-id="86ca9-133">Wenn Sie sich für eine asynchrone und ereignisgesteuerte Kommunikation entschieden haben, wählen Sie (wie in diesem Abschnitt erläutert) das Servicebusprodukt aus, das Ihren Anforderungen an die Produktion am besten entspricht.</span><span class="sxs-lookup"><span data-stu-id="86ca9-133">Once you have decided that you want to have asynchronous and event-driven communication, as explained in the current section, you should choose the service bus product that best fits your needs for production.</span></span>

## <a name="integration-events"></a><span data-ttu-id="86ca9-134">Integrationsereignisse</span><span class="sxs-lookup"><span data-stu-id="86ca9-134">Integration events</span></span>

<span data-ttu-id="86ca9-135">Integrationsereignisse werden zum Synchronisieren des Domänenstatus über mehrere Microservices oder externe Systeme hinweg verwendet.</span><span class="sxs-lookup"><span data-stu-id="86ca9-135">Integration events are used for bringing domain state in sync across multiple microservices or external systems.</span></span> <span data-ttu-id="86ca9-136">Für diese Funktionalität werden Integrationsereignisse außerhalb des Microservices veröffentlicht.</span><span class="sxs-lookup"><span data-stu-id="86ca9-136">This functionality is done by publishing integration events outside the microservice.</span></span> <span data-ttu-id="86ca9-137">Wenn ein Ereignis bei mehreren Empfängermicroservices (bei allen Microservices, die das Integrationsereignis abonniert haben) veröffentlicht wird, wird das Ereignis vom entsprechenden Ereignishandler des jeweiligen Empfängermicroservices verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="86ca9-137">When an event is published to multiple receiver microservices (to as many microservices as are subscribed to the integration event), the appropriate event handler in each receiver microservice handles the event.</span></span>

<span data-ttu-id="86ca9-138">Bei einem Integrationsereignis handelt es sich im Wesentlichen um eine Klasse zum Speichern von Daten wie im folgenden Beispiel:</span><span class="sxs-lookup"><span data-stu-id="86ca9-138">An integration event is basically a data-holding class, as in the following example:</span></span>

```csharp
public class ProductPriceChangedIntegrationEvent : IntegrationEvent
{
    public int ProductId { get; private set; }
    public decimal NewPrice { get; private set; }
    public decimal OldPrice { get; private set; }

    public ProductPriceChangedIntegrationEvent(int productId, decimal newPrice,
        decimal oldPrice)
    {
        ProductId = productId;
        NewPrice = newPrice;
        OldPrice = oldPrice;
    }
}
```

<span data-ttu-id="86ca9-139">Die Integrationsereignisse können auf der Anwendungsebene eines Microservices definiert werden, sodass sie von anderen Microservices entkoppelt sind. Dies ist in gewisser Weise mit der Definition von ViewModels im Server und im Client vergleichbar.</span><span class="sxs-lookup"><span data-stu-id="86ca9-139">The integration events can be defined at the application level of each microservice, so they are decoupled from other microservices, in a way comparable to how ViewModels are defined in the server and client.</span></span> <span data-ttu-id="86ca9-140">Es wird davon abgeraten, eine Bibliothek mit Integrationsereignissen in mehreren Microservices zu nutzen, da dadurch diese Microservices mit einer Datenbibliothek mit Einzelereignisdefinitionen gekoppelt werden.</span><span class="sxs-lookup"><span data-stu-id="86ca9-140">What is not recommended is sharing a common integration events library across multiple microservices; doing that would be coupling those microservices with a single event definition data library.</span></span> <span data-ttu-id="86ca9-141">Das sollten Sie aus demselben Grund vermeiden, aus dem Sie auch nicht ein Domänenmodell in mehreren Microservices nutzen: Microservices müssen absolut autonom sein.</span><span class="sxs-lookup"><span data-stu-id="86ca9-141">You do not want to do that for the same reasons that you do not want to share a common domain model across multiple microservices: microservices must be completely autonomous.</span></span>

<span data-ttu-id="86ca9-142">Es gibt nur sehr wenige Arten von Bibliotheken, die Sie in mehreren Microservices nutzen können.</span><span class="sxs-lookup"><span data-stu-id="86ca9-142">There are only a few kinds of libraries you should share across microservices.</span></span> <span data-ttu-id="86ca9-143">Eine Art sind Bibliotheken, bei denen es sich wie bei der [Ereignisbusclient-API](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/BuildingBlocks/EventBus) wie in eShopOnContainers um endgültige Anwendungsblöcke handelt.</span><span class="sxs-lookup"><span data-stu-id="86ca9-143">One is libraries that are final application blocks, like the [Event Bus client API](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/BuildingBlocks/EventBus), as in eShopOnContainers.</span></span> <span data-ttu-id="86ca9-144">Eine andere Art sind Bibliotheken, die Tools bilden, die auch als NuGet-Komponenten gemeinsam genutzt werden können wie etwa JSON-Serialisierungsmodule.</span><span class="sxs-lookup"><span data-stu-id="86ca9-144">Another is libraries that constitute tools that could also be shared as NuGet components, like JSON serializers.</span></span>

## <a name="the-event-bus"></a><span data-ttu-id="86ca9-145">Der Ereignisbus</span><span class="sxs-lookup"><span data-stu-id="86ca9-145">The event bus</span></span>

<span data-ttu-id="86ca9-146">Ein Ereignisbus ermöglicht eine auf Veröffentlichen/Abonnieren basierende Kommunikation zwischen Microservices, ohne dass sich die Komponenten ausdrücklich berücksichtigen müssen (siehe Abbildung 6-19).</span><span class="sxs-lookup"><span data-stu-id="86ca9-146">An event bus allows publish/subscribe-style communication between microservices without requiring the components to explicitly be aware of each other, as shown in Figure 6-19.</span></span>

![Ein Diagramm, das das grundlegende Veröffentlichen/Abonnieren-Muster zeigt.](./media/integration-event-based-microservice-communications/publish-subscribe-basics.png)

<span data-ttu-id="86ca9-148">**Abbildung 6-19**.</span><span class="sxs-lookup"><span data-stu-id="86ca9-148">**Figure 6-19**.</span></span> <span data-ttu-id="86ca9-149">Veröffentlichen/Abonnieren mit einem Ereignisbus</span><span class="sxs-lookup"><span data-stu-id="86ca9-149">Publish/subscribe basics with an event bus</span></span>

<span data-ttu-id="86ca9-150">Das obige Diagramm zeigt, dass Microservice A ein Ereignis im Ereignisbus veröffentlicht, der dieses an die abonnierenden Microservices B und C verteilt, ohne dass der Herausgeber die Abonnenten kennen muss.</span><span class="sxs-lookup"><span data-stu-id="86ca9-150">The above diagram shows that microservice A publishes to Event Bus, which distributes to subscribing microservices B and C, without the publisher needing to know the subscribers.</span></span> <span data-ttu-id="86ca9-151">Der Ereignisbus steht in Zusammenhang mit dem Observer-Muster und dem Publish-Subscribe-Muster.</span><span class="sxs-lookup"><span data-stu-id="86ca9-151">The event bus is related to the Observer pattern and the publish-subscribe pattern.</span></span>

### <a name="observer-pattern"></a><span data-ttu-id="86ca9-152">Observer-Muster</span><span class="sxs-lookup"><span data-stu-id="86ca9-152">Observer pattern</span></span>

<span data-ttu-id="86ca9-153">Beim [Observer-Muster](https://en.wikipedia.org/wiki/Observer_pattern) versorgt das primäre Objekt (als „Observable“ bezeichnet) andere interessierte Objekte (als „Observer“ bezeichnet) mit wichtigen Informationen (Ereignissen).</span><span class="sxs-lookup"><span data-stu-id="86ca9-153">In the [Observer pattern](https://en.wikipedia.org/wiki/Observer_pattern), your primary object (known as the Observable) notifies other interested objects (known as Observers) with relevant information (events).</span></span>

### <a name="publishsubscribe-pubsub-pattern"></a><span data-ttu-id="86ca9-154">Muster „Veröffentlichen/Abonnieren“</span><span class="sxs-lookup"><span data-stu-id="86ca9-154">Publish/Subscribe (Pub/Sub) pattern</span></span>

<span data-ttu-id="86ca9-155">Das [Muster „Veröffentlichen/Abonnieren“](/previous-versions/msp-n-p/ff649664(v=pandp.10)) dient demselben Zweck wie das Beobachtermuster: andere Dienste sollen über bestimmte Ereignisse informiert werden.</span><span class="sxs-lookup"><span data-stu-id="86ca9-155">The purpose of the [Publish/Subscribe pattern](/previous-versions/msp-n-p/ff649664(v=pandp.10)) is the same as the Observer pattern: you want to notify other services when certain events take place.</span></span> <span data-ttu-id="86ca9-156">Es gibt jedoch einen wichtigen Unterschied zwischen dem Observer-Muster und dem Pub/Sub-Muster.</span><span class="sxs-lookup"><span data-stu-id="86ca9-156">But there is an important difference between the Observer and Pub/Sub patterns.</span></span> <span data-ttu-id="86ca9-157">Beim Beobachtermuster erfolgt die Übertragung direkt vom Beobachtbaren an die Beobachter, d. h. sie „kennen“ sich.</span><span class="sxs-lookup"><span data-stu-id="86ca9-157">In the observer pattern, the broadcast is performed directly from the observable to the observers, so they "know" each other.</span></span> <span data-ttu-id="86ca9-158">Beim Pub/Sub-Muster gibt es jedoch eine dritte Komponente: den Broker/Nachrichtenbroker bzw. Ereignisbus, den sowohl der Herausgeber als auch der Abonnent kennt.</span><span class="sxs-lookup"><span data-stu-id="86ca9-158">But when using a Pub/Sub pattern, there is a third component, called broker, or message broker or event bus, which is known by both the publisher and subscriber.</span></span> <span data-ttu-id="86ca9-159">Wenn Sie also das Pub/Sub-Muster verwenden, sind Herausgeber und Abonnenten dank dem erwähnten Ereignisbus oder Nachrichtenbroker präzise entkoppelt.</span><span class="sxs-lookup"><span data-stu-id="86ca9-159">Therefore, when using the Pub/Sub pattern the publisher and the subscribers are precisely decoupled thanks to the mentioned event bus or message broker.</span></span>

### <a name="the-middleman-or-event-bus"></a><span data-ttu-id="86ca9-160">Der Vermittler oder Ereignisbus</span><span class="sxs-lookup"><span data-stu-id="86ca9-160">The middleman or event bus</span></span>

<span data-ttu-id="86ca9-161">Wie erzielen Sie Anonymität zwischen Herausgeber und Abonnent?</span><span class="sxs-lookup"><span data-stu-id="86ca9-161">How do you achieve anonymity between publisher and subscriber?</span></span> <span data-ttu-id="86ca9-162">Eine einfache Möglichkeit besteht darin, die gesamte Kommunikation einem Vermittler zu überlassen.</span><span class="sxs-lookup"><span data-stu-id="86ca9-162">An easy way is let a middleman take care of all the communication.</span></span> <span data-ttu-id="86ca9-163">Ein Ereignisbus ist ein solcher Vermittler.</span><span class="sxs-lookup"><span data-stu-id="86ca9-163">An event bus is one such middleman.</span></span>

<span data-ttu-id="86ca9-164">Ein Ereignisbus besteht in der Regel aus zwei Teilen:</span><span class="sxs-lookup"><span data-stu-id="86ca9-164">An event bus is typically composed of two parts:</span></span>

- <span data-ttu-id="86ca9-165">aus der Abstraktion oder Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="86ca9-165">The abstraction or interface.</span></span>

- <span data-ttu-id="86ca9-166">aus einer oder mehreren Implementierungen</span><span class="sxs-lookup"><span data-stu-id="86ca9-166">One or more implementations.</span></span>

<span data-ttu-id="86ca9-167">In Abbildung 6-19 wird deutlich, dass der Ereignisbus aus der Sicht der Anwendung lediglich einen Veröffentlichen/Abonnieren-Kanal darstellt.</span><span class="sxs-lookup"><span data-stu-id="86ca9-167">In Figure 6-19 you can see how, from an application point of view, the event bus is nothing more than a Pub/Sub channel.</span></span> <span data-ttu-id="86ca9-168">Sie können diesen asynchronen Code auf verschiedene Weisen implementieren.</span><span class="sxs-lookup"><span data-stu-id="86ca9-168">The way you implement this asynchronous communication can vary.</span></span> <span data-ttu-id="86ca9-169">Er kann mehrere Implementierungen aufweisen, sodass je nach Umgebungsanforderungen (z.B. Produktions- oder Entwicklungsumgebung) zwischen diesen gewechselt werden kann.</span><span class="sxs-lookup"><span data-stu-id="86ca9-169">It can have multiple implementations so that you can swap between them, depending on the environment requirements (for example, production versus development environments).</span></span>

<span data-ttu-id="86ca9-170">In Abbildung 6-20 ist eine Abstraktion eines Ereignisbusses mit mehreren Implementierungen basierend auf Infrastrukturmessagingtechnologien wie RabbitMQ, Azure Service Bus oder andere Ereignis-/Nachrichtenbroker dargestellt.</span><span class="sxs-lookup"><span data-stu-id="86ca9-170">In Figure 6-20, you can see an abstraction of an event bus with multiple implementations based on infrastructure messaging technologies like RabbitMQ, Azure Service Bus, or another event/message broker.</span></span>

![Diagramm, das das Hinzufügen einer Ereignisbus-Abstraktionsschicht zeigt.](./media/integration-event-based-microservice-communications/multiple-implementations-event-bus.png)

<span data-ttu-id="86ca9-172">**Abbildung 6-20**.</span><span class="sxs-lookup"><span data-stu-id="86ca9-172">**Figure 6- 20.**</span></span> <span data-ttu-id="86ca9-173">Mehrere Implementierungen eines Ereignisbusses</span><span class="sxs-lookup"><span data-stu-id="86ca9-173">Multiple implementations of an event bus</span></span>

<span data-ttu-id="86ca9-174">Es wird empfohlen, den Ereignisbus über eine Schnittstelle zu definieren, damit er mit verschiedenen Technologien wie RabbitMQ Azure Service Bus usw. implementiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="86ca9-174">It's good to have the event bus defined through an interface so it can be implemented with several technologies, like RabbitMQ Azure Service bus or others.</span></span> <span data-ttu-id="86ca9-175">Wie bereits erwähnt sollten Sie eine eigene Abstraktion (die Ereignisbusschnittstelle) jedoch nur verwenden, wenn Sie grundlegende Ereignisbusfunktionen benötigen, die von Ihren Abstraktionen unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="86ca9-175">However, and as mentioned previously, using your own abstractions (the event bus interface) is good only if you need basic event bus features supported by your abstractions.</span></span> <span data-ttu-id="86ca9-176">Wenn Sie umfangreichere Service Bus-Features benötigen, sollten Sie anstelle der eigenen Abstraktionen die API und die Abstraktionen verwenden, die von Ihrem bevorzugten kommerziellen Service Bus bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="86ca9-176">If you need richer service bus features, you should probably use the API and abstractions provided by your preferred commercial service bus instead of your own abstractions.</span></span>

### <a name="defining-an-event-bus-interface"></a><span data-ttu-id="86ca9-177">Definieren einer Ereignisbusschnittstelle</span><span class="sxs-lookup"><span data-stu-id="86ca9-177">Defining an event bus interface</span></span>

<span data-ttu-id="86ca9-178">Zunächst werden Implementierungscode für die Ereignisbusschnittstelle und mögliche Implementierungen zu Untersuchungszwecken veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="86ca9-178">Let's start with some implementation code for the event bus interface and possible implementations for exploration purposes.</span></span> <span data-ttu-id="86ca9-179">Die Schnittstelle sollte wie die folgende Schnittstelle allgemein und einfach gehalten sein.</span><span class="sxs-lookup"><span data-stu-id="86ca9-179">The interface should be generic and straightforward, as in the following interface.</span></span>

```csharp
public interface IEventBus
{
    void Publish(IntegrationEvent @event);

    void Subscribe<T, TH>()
        where T : IntegrationEvent
        where TH : IIntegrationEventHandler<T>;

    void SubscribeDynamic<TH>(string eventName)
        where TH : IDynamicIntegrationEventHandler;

    void UnsubscribeDynamic<TH>(string eventName)
        where TH : IDynamicIntegrationEventHandler;

    void Unsubscribe<T, TH>()
        where TH : IIntegrationEventHandler<T>
        where T : IntegrationEvent;
}
```

<span data-ttu-id="86ca9-180">Die `Publish`-Methode ist einfach.</span><span class="sxs-lookup"><span data-stu-id="86ca9-180">The `Publish` method is straightforward.</span></span> <span data-ttu-id="86ca9-181">Der Ereignisbus sendet das an ihn weitergeleitete Integrationsereignis an alle Microservices oder auch an externe Anwendungen, die dieses Ereignis abonniert haben.</span><span class="sxs-lookup"><span data-stu-id="86ca9-181">The event bus will broadcast the integration event passed to it to any microservice, or even an external application, subscribed to that event.</span></span> <span data-ttu-id="86ca9-182">Diese Methode wird von dem Microservice verwendet, der das Ereignis veröffentlicht.</span><span class="sxs-lookup"><span data-stu-id="86ca9-182">This method is used by the microservice that is publishing the event.</span></span>

<span data-ttu-id="86ca9-183">Die `Subscribe`-Methoden (abhängig von den Argumenten können mehrere Implementierungen verwendet werden) werden von den Microservices verwendet, die Ereignisse empfangen möchten.</span><span class="sxs-lookup"><span data-stu-id="86ca9-183">The `Subscribe` methods (you can have several implementations depending on the arguments) are used by the microservices that want to receive events.</span></span> <span data-ttu-id="86ca9-184">Diese Methode weist zwei Argumente auf.</span><span class="sxs-lookup"><span data-stu-id="86ca9-184">This method has two arguments.</span></span> <span data-ttu-id="86ca9-185">Beim ersten Argument handelt es sich um das Integrationsereignis, das abonniert werden kann (`IntegrationEvent`).</span><span class="sxs-lookup"><span data-stu-id="86ca9-185">The first is the integration event to subscribe to (`IntegrationEvent`).</span></span> <span data-ttu-id="86ca9-186">Beim zweiten Argument handelt es sich um den Integrationsereignishandler (oder die Rückrufmethode) mit dem Namen `IIntegrationEventHandler<T>`. Dieses Argument wird ausgeführt, wenn der Empfängermicroservice diese Integrationsereignisnachricht empfängt.</span><span class="sxs-lookup"><span data-stu-id="86ca9-186">The second argument is the integration event handler (or callback method), named `IIntegrationEventHandler<T>`, to be executed when the receiver microservice gets that integration event message.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="86ca9-187">Zusätzliche Ressourcen</span><span class="sxs-lookup"><span data-stu-id="86ca9-187">Additional resources</span></span>

<span data-ttu-id="86ca9-188">Einige Messaginglösungen, die bereit für die Produktion sind:</span><span class="sxs-lookup"><span data-stu-id="86ca9-188">Some production-ready messaging solutions:</span></span>

- <span data-ttu-id="86ca9-189">**Azure Service Bus** </span><span class="sxs-lookup"><span data-stu-id="86ca9-189">**Azure Service Bus** </span></span>\
  <https://docs.microsoft.com/azure/service-bus-messaging/>
  
- <span data-ttu-id="86ca9-190">**NServiceBus** </span><span class="sxs-lookup"><span data-stu-id="86ca9-190">**NServiceBus** </span></span>\
  <https://particular.net/nservicebus>
  
- <span data-ttu-id="86ca9-191">**MassTransit** </span><span class="sxs-lookup"><span data-stu-id="86ca9-191">**MassTransit** </span></span>\
  <https://masstransit-project.com/>

> [!div class="step-by-step"]
> <span data-ttu-id="86ca9-192">[Zurück](database-server-container.md)
> [Weiter](rabbitmq-event-bus-development-test-environment.md)</span><span class="sxs-lookup"><span data-stu-id="86ca9-192">[Previous](database-server-container.md)
[Next](rabbitmq-event-bus-development-test-environment.md)</span></span>
