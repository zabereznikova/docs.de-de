---
title: Erstellen robuster Clouddienste. Beheben vorübergehender Fehler in der Cloud
description: Modernisieren vorhandener .NET-Anwendungen mit Azure Cloud und Windows-Containern | Erstellen robuster Clouddienste. Beheben vorübergehender Fehler in der Cloud
ms.date: 12/21/2020
ms.openlocfilehash: 4d592a5761cdf696f3e57516d747cbd770512053
ms.sourcegitcommit: 5d9cee27d9ffe8f5670e5f663434511e81b8ac38
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 01/08/2021
ms.locfileid: "98025328"
---
# <a name="build-resilient-services-ready-for-the-cloud-embrace-transient-failures-in-the-cloud"></a><span data-ttu-id="ef398-105">Erstellen robuster Clouddienste: Beheben vorübergehender Fehler in der Cloud</span><span class="sxs-lookup"><span data-stu-id="ef398-105">Build resilient services ready for the cloud: Embrace transient failures in the cloud</span></span>

<span data-ttu-id="ef398-106">Als Stabilität wird die Fähigkeit zum Wiederherstellen nach Fehlern und zum Fortsetzen der Funktionsweise bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="ef398-106">Resiliency is the ability to recover from failures and continue to function.</span></span> <span data-ttu-id="ef398-107">Bei Stabilität geht es nicht um das Vermeiden von Fehlern, sondern um das Akzeptieren der Tatsache, dass Fehler passieren und um eine angemessene Reaktion auf diese, um Ausfallzeiten und Datenverluste zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="ef398-107">Resiliency is not about avoiding failures, but accepting the fact that failures will occur, and then responding to them in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="ef398-108">Das Ziel der Stabilität ist, die Anwendung nach einem Fehler wieder in einen voll funktionsfähigen Zustand zu versetzen.</span><span class="sxs-lookup"><span data-stu-id="ef398-108">The goal of resiliency is to return the application to a fully functioning state after a failure.</span></span>

<span data-ttu-id="ef398-109">Ihre Anwendung ist für die Cloud bereit, wenn sie mindestens ein softwarebasiertes Modell für Stabilität (Resilienz) implementiert, anstatt ein hardwarebasiertes Modell.</span><span class="sxs-lookup"><span data-stu-id="ef398-109">Your application is ready for the cloud when, at a minimum, it implements a software-based model of resiliency, rather than a hardware-based model.</span></span> <span data-ttu-id="ef398-110">Ihre Cloudanwendung muss die Teilfehler umfassen, die sicher auftreten werden.</span><span class="sxs-lookup"><span data-stu-id="ef398-110">Your cloud application must embrace the partial failures that will certainly occur.</span></span> <span data-ttu-id="ef398-111">Entwerfen oder gestalten Sie ihre Anwendung teilweise um, um Resilienz gegenüber erwarteten Teilfehlern zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="ef398-111">Design or partially refactor your application to achieve resiliency with expected partial failures.</span></span> <span data-ttu-id="ef398-112">Sie sollte dafür entworfen sein, mit Teilfehlern wie vorübergehenden Netzwerkausfällen und Knoten oder virtuellen Computern, die in der Cloud abstürzen, umzugehen.</span><span class="sxs-lookup"><span data-stu-id="ef398-112">It should be designed to cope with partial failures, like transient network outages and nodes, or VMs crashing in the cloud.</span></span> <span data-ttu-id="ef398-113">Sogar Container, die innerhalb eines Orchestratorclusters auf einen anderen Knoten verschoben werden, können zeitweilig kurze Fehler in der Anwendung verursachen.</span><span class="sxs-lookup"><span data-stu-id="ef398-113">Even containers being moved to a different node within an orchestrator cluster can cause intermittent short failures within the application.</span></span>

## <a name="handling-partial-failure"></a><span data-ttu-id="ef398-114">Behandeln von Teilfehlern</span><span class="sxs-lookup"><span data-stu-id="ef398-114">Handling partial failure</span></span>

<span data-ttu-id="ef398-115">In einer cloudbasierten Anwendung gibt es ein allgegenwärtiges Risiko für Teilfehler.</span><span class="sxs-lookup"><span data-stu-id="ef398-115">In a cloud-based application, there's an ever-present risk of partial failure.</span></span> <span data-ttu-id="ef398-116">Beispielsweise können eine einzelne Websiteinstanz oder ein Container fehlschlagen, oder sie/er ist möglicherweise für kurze Zeit nicht verfügbar oder reagiert nicht.</span><span class="sxs-lookup"><span data-stu-id="ef398-116">For instance, a single website instance or a container might fail, or it might be unavailable or unresponsive for a short time.</span></span> <span data-ttu-id="ef398-117">Oder ein einzelner virtueller Computer oder Server kann abstürzen.</span><span class="sxs-lookup"><span data-stu-id="ef398-117">Or, a single VM or server might crash.</span></span>

<span data-ttu-id="ef398-118">Da Clients und Dienste separate Vorgänge sind, kann ein Dienst möglicherweise nicht schnell genug auf die Anforderung eines Clients reagieren.</span><span class="sxs-lookup"><span data-stu-id="ef398-118">Because clients and services are separate processes, a service might not be able to respond in a timely manner to a client's request.</span></span> <span data-ttu-id="ef398-119">Der Dienst ist möglicherweise überlastet und antwortet langsam auf Anforderungen, oder er ist aufgrund von Netzwerkproblemen vorübergehend nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="ef398-119">The service might be overloaded and respond slowly to requests, or it might not be accessible for a short time because of network issues.</span></span>

<span data-ttu-id="ef398-120">Stellen Sie sich beispielsweise eine monolithische .NET-Anwendung vor, die auf eine Datenbank in Azure SQL-Datenbank zugreift.</span><span class="sxs-lookup"><span data-stu-id="ef398-120">For example, consider a monolithic .NET application that accesses a database in Azure SQL Database.</span></span> <span data-ttu-id="ef398-121">Wenn die Azure SQL-Datenbank oder ein anderer Drittanbieterdienst für einen kurzen Zeitraum nicht reagiert (eine Azure SQL-Datenbank wird möglicherweise auf einen anderen Knoten oder Server verschoben, und reagiert einige Sekunden lang nicht), wenn der Benutzer versucht, eine Aktion durchzuführen, stürzt die Anwendung möglicherweise ab und gibt gleichzeitig eine Ausnahme aus.</span><span class="sxs-lookup"><span data-stu-id="ef398-121">If the Azure SQL database or any other third-party service is unresponsive for a brief time (an Azure SQL database might be moved to a different node or server, and be unresponsive for a few seconds), when the user tries to do any action, the application might crash and show an exception at the same moment.</span></span>

<span data-ttu-id="ef398-122">Ein ähnliches Szenario kann in einer App auftreten, die HTTP-Dienste nutzt.</span><span class="sxs-lookup"><span data-stu-id="ef398-122">A similar scenario might occur in an app that consumes HTTP services.</span></span> <span data-ttu-id="ef398-123">Das Netzwerk oder der Dienst selbst ist möglicherweise während eines kurzen vorübergehenden Fehlers in der Cloud nicht verfügbar.</span><span class="sxs-lookup"><span data-stu-id="ef398-123">The network or the service itself might not be available in the cloud during a short, transient failure.</span></span>

<span data-ttu-id="ef398-124">Eine robuste Anwendung, wie die in Abbildung 4-9 gezeigte, sollte Verfahren wie „Wiederholungsversuche mit exponentiellem Backoff“ implementieren, um der Anwendung die Möglichkeit zu geben, vorübergehende Fehler in Ressourcen zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="ef398-124">A resilient application like the one shown in Figure 4-9 should implement techniques like "retries with exponential backoff" to give the application an opportunity to handle transient failures in resources.</span></span> <span data-ttu-id="ef398-125">Sie sollten auch „Trennschalter“ in Ihren Anwendungen verwenden.</span><span class="sxs-lookup"><span data-stu-id="ef398-125">You also should use "circuit breakers" in your applications.</span></span> <span data-ttu-id="ef398-126">Ein Trennschalter beendet die Versuche einer Anwendung, auf eine Ressource zuzugreifen, wenn es sich tatsächlich um einen langfristigen Fehler handelt.</span><span class="sxs-lookup"><span data-stu-id="ef398-126">A circuit breaker stops an application from trying to access a resource when it's actually a long-term failure.</span></span> <span data-ttu-id="ef398-127">Durch die Verwendung eines Trennschalters vermeidet die Anwendung einen Denial-of-Service-Angriff auf sich selbst.</span><span class="sxs-lookup"><span data-stu-id="ef398-127">By using a circuit breaker, the application avoids provoking a denial of service to itself.</span></span>

![Diagramm der von Wiederholungsversuchen mit exponentiellem Backoff behandelten Teilfehler.](./media/retry-partial-failures.png)

<span data-ttu-id="ef398-129">**Abbildung 4–9.**</span><span class="sxs-lookup"><span data-stu-id="ef398-129">**Figure 4-9.**</span></span> <span data-ttu-id="ef398-130">Von Wiederholungsversuchen mit exponentiellem Backoff behandelte Teilfehler</span><span class="sxs-lookup"><span data-stu-id="ef398-130">Partial failures handled by retries with exponential backoff</span></span>

<span data-ttu-id="ef398-131">Sie können diese Verfahren sowohl in HTTP-Ressourcen als auch in Datenbankressourcen verwenden.</span><span class="sxs-lookup"><span data-stu-id="ef398-131">You can use these techniques both in HTTP resources and in database resources.</span></span> <span data-ttu-id="ef398-132">In Abbildung 4-9 basiert die Anwendung auf einer 3-schichtigen Architektur, sodass Sie diese Verfahren auf der Dienstebene (HTPP) und auf der Datenschichtebene (TCP) benötigen.</span><span class="sxs-lookup"><span data-stu-id="ef398-132">In Figure 4-9, the application is based on a 3-tier architecture, so you need these techniques at the services level (HTTP) and at the data tier level (TCP).</span></span> <span data-ttu-id="ef398-133">In einer monolithischen Anwendung, die zusätzlich zur Datenbank nur eine einzelne App-Ebene verwendet (keine zusätzlichen Dienste oder Microservices), kann das behandeln vorübergehender Fehler auf Datenbankverbindungsebene ausreichen.</span><span class="sxs-lookup"><span data-stu-id="ef398-133">In a monolithic application that uses only a single app tier in addition to the database (no additional services or microservices), handling transient failures at the database connection level might be enough.</span></span> <span data-ttu-id="ef398-134">In diesem Szenario ist nur eine bestimmte Konfiguration der Datenbankverbindung erforderlich.</span><span class="sxs-lookup"><span data-stu-id="ef398-134">In that scenario, just a particular configuration of the database connection is required.</span></span>

<span data-ttu-id="ef398-135">Bei der Implementierung robuster Kommunikationen, die auf die Datenbank zugreifen, kann dies je nach verwendeter .NET-Version unkompliziert sein (z. B. [mit Entity Framework 6 oder höher](/ef/ef6/fundamentals/connection-resiliency/retry-logic).</span><span class="sxs-lookup"><span data-stu-id="ef398-135">When implementing resilient communications that access the database, depending on the version of .NET you are using, it can be straightforward (for example, [with Entity Framework 6 or later](/ef/ef6/fundamentals/connection-resiliency/retry-logic).</span></span> <span data-ttu-id="ef398-136">Es ist nur eine Frage der Konfiguration der Datenbankverbindung.).</span><span class="sxs-lookup"><span data-stu-id="ef398-136">It's just a matter of configuring the database connection).</span></span> <span data-ttu-id="ef398-137">Oder Sie müssen möglicherweise zusätzliche Bibliotheken verwenden, wie z. B. den [Anwendungsblock zur Handhabung von vorübergehenden Fehlern](/previous-versions/msp-n-p/hh680934(v=pandp.50)) (Transient Fault Handling Application Block; für frühere Versionen von .NET), oder sogar Ihre eigene Bibliothek implementieren.</span><span class="sxs-lookup"><span data-stu-id="ef398-137">Or, you might need to use additional libraries like the [Transient Fault Handling Application Block](/previous-versions/msp-n-p/hh680934(v=pandp.50)) (for earlier versions of .NET), or even implement your own library.</span></span>

<span data-ttu-id="ef398-138">Bei der Implementierung von HTTP-Wiederholungen und Sicherungen (Circuit Breakers) wird von .NET die Verwendung der [Polly](https://github.com/App-vNext/Polly)-Bibliothek empfohlen, die auf .NET Standard 1.1 (deckt .NET Core 1.0, Mono, Xamarin, UWP sowie WP8.1 und höher ab) und .NET Standard 2.0 und höher (deckt .NET Core 2.0 und höher, .NET Core 3.0 und höhere Mono-, Xamarin- und UWP-Ziele ab) ausgerichtet ist.</span><span class="sxs-lookup"><span data-stu-id="ef398-138">When implementing HTTP retries and circuit breakers, the recommendation for .NET is to use the [Polly](https://github.com/App-vNext/Polly) library, which targets .NET Standard 1.1 (coverage: .NET Core 1.0, Mono, Xamarin, UWP, WP8.1+) and .NET Standard 2.0+ (coverage: .NET Core 2.0+, .NET Core 3.0, and later Mono, Xamarin and UWP targets).</span></span> <span data-ttu-id="ef398-139">Das NuGet-Paket umfasst auch direkte Ziele für .NET Framework 4.6.1 und 4.7.2.</span><span class="sxs-lookup"><span data-stu-id="ef398-139">The nuget package also includes direct targets for .NET Framework 4.6.1 and 4.7.2.</span></span>

<span data-ttu-id="ef398-140">Informationen zum Implementieren von Strategien für die Handhabung von Teilfehlern in der Cloud finden Sie in den folgenden Referenzen.</span><span class="sxs-lookup"><span data-stu-id="ef398-140">To learn how to implement strategies for handling partial failures in the cloud, see the following references.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="ef398-141">Zusätzliche Ressourcen</span><span class="sxs-lookup"><span data-stu-id="ef398-141">Additional resources</span></span>

- <span data-ttu-id="ef398-142">**Implementieren robuster Kommunikation zur Handhabung von Teilfehlern**</span><span class="sxs-lookup"><span data-stu-id="ef398-142">**Implementing resilient communication to handle partial failure**</span></span>

    [https://docs.microsoft.com/dotnet/architecture/microservices/implement-resilient-applications/partial-failure-strategies](../../microservices/implement-resilient-applications/partial-failure-strategies.md)

- <span data-ttu-id="ef398-143">**Entity Framework-Verbindungsresilienz und -wiederholungslogik (Version 6 und höher)**</span><span class="sxs-lookup"><span data-stu-id="ef398-143">**Entity Framework connection resiliency and retry logic (version 6 and later)**</span></span>

    [https://docs.microsoft.com/ef/ef6/fundamentals/connection-resiliency/retry-logic](/ef/ef6/fundamentals/connection-resiliency/retry-logic)

- <span data-ttu-id="ef398-144">**Anwendungsblock zum Behandeln vorübergehender Fehler**</span><span class="sxs-lookup"><span data-stu-id="ef398-144">**The Transient Fault Handling Application Block**</span></span>

- <https://docs.microsoft.com/previous-versions/msp-n-p/hh680934(v=pandp.50)>

- <span data-ttu-id="ef398-145">**Polly-Bibliothek für robuste HTTP-Kommunikation**</span><span class="sxs-lookup"><span data-stu-id="ef398-145">**Polly library for resilient HTTP communication**</span></span>

    <https://github.com/App-vNext/Polly>

>[!div class="step-by-step"]
><span data-ttu-id="ef398-146">[Zurück](when-to-deploy-windows-containers-to-azure-container-service-kubernetes.md)
>[Weiter](modernize-your-apps-with-monitoring-and-telemetry.md)</span><span class="sxs-lookup"><span data-stu-id="ef398-146">[Previous](when-to-deploy-windows-containers-to-azure-container-service-kubernetes.md)
[Next](modernize-your-apps-with-monitoring-and-telemetry.md)</span></span>
