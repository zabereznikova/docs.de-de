---
title: Grundlegendes zu AssemblyLoadContext – .NET Core
description: Wichtige Konzepte für ein besseres Verständnis von Zweck und Verhalten von AssemblyLoadContext in .NET Core.
ms.date: 08/09/2019
author: sdmaclea
ms.author: stmaclea
ms.openlocfilehash: 4d3f0e50e7c336469bd9af4d1589427388684434
ms.sourcegitcommit: dfcbc096ad7908cd58a5f0aeabd2256f05266bac
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 10/21/2020
ms.locfileid: "92332821"
---
# <a name="understanding-systemruntimeloaderassemblyloadcontext"></a><span data-ttu-id="0583d-103">Grundlegendes zu System.Runtime.Loader.AssemblyLoadContext</span><span class="sxs-lookup"><span data-stu-id="0583d-103">Understanding System.Runtime.Loader.AssemblyLoadContext</span></span>

<span data-ttu-id="0583d-104">Die <xref:System.Runtime.Loader.AssemblyLoadContext>-Klasse ist einzigartig in .NET Core.</span><span class="sxs-lookup"><span data-stu-id="0583d-104">The <xref:System.Runtime.Loader.AssemblyLoadContext> class is unique to .NET Core.</span></span> <span data-ttu-id="0583d-105">In diesem Artikel wird versucht, die Dokumentation der <xref:System.Runtime.Loader.AssemblyLoadContext>-API um konzeptionelle Informationen zu ergänzen.</span><span class="sxs-lookup"><span data-stu-id="0583d-105">This article attempts to supplement the <xref:System.Runtime.Loader.AssemblyLoadContext> API documentation with conceptual information.</span></span>

<span data-ttu-id="0583d-106">Dieser Artikel richtet sich an Entwickler, die dynamisches Laden implementieren, insbesondere an Entwickler, die Frameworks dynamisch laden.</span><span class="sxs-lookup"><span data-stu-id="0583d-106">This article is relevant to developers implementing dynamic loading, especially dynamic loading framework developers.</span></span>

## <a name="what-is-the-assemblyloadcontext"></a><span data-ttu-id="0583d-107">Was ist der AssemblyLoadContext?</span><span class="sxs-lookup"><span data-stu-id="0583d-107">What is the AssemblyLoadContext?</span></span>

<span data-ttu-id="0583d-108">Jede .NET Core-Anwendung verwendet implizit den <xref:System.Runtime.Loader.AssemblyLoadContext>.</span><span class="sxs-lookup"><span data-stu-id="0583d-108">Every .NET Core application implicitly uses the <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span>
<span data-ttu-id="0583d-109">Er stellt den Laufzeitanbieter zum Suchen und Laden von Abhängigkeiten dar.</span><span class="sxs-lookup"><span data-stu-id="0583d-109">It's the runtime's provider for locating and loading dependencies.</span></span> <span data-ttu-id="0583d-110">Wenn eine Abhängigkeit geladen wird, wird eine <xref:System.Runtime.Loader.AssemblyLoadContext>-Instanz aufgerufen, um sie zu suchen.</span><span class="sxs-lookup"><span data-stu-id="0583d-110">Whenever a dependency is loaded, an <xref:System.Runtime.Loader.AssemblyLoadContext> instance is invoked to locate it.</span></span>

- <span data-ttu-id="0583d-111">Er stellt einen Dienst zum Suchen, Laden und Zwischenspeichern von verwalteten Assemblys und anderen Abhängigkeiten bereit.</span><span class="sxs-lookup"><span data-stu-id="0583d-111">It provides a service of locating, loading, and caching managed assemblies and other dependencies.</span></span>

- <span data-ttu-id="0583d-112">Um das dynamische Laden und Entladen von Code zu unterstützen, erstellt er einen isolierten Kontext für das Laden von Code und dessen zugehörigen Abhängigkeiten in einer eigenen <xref:System.Runtime.Loader.AssemblyLoadContext>-Instanz.</span><span class="sxs-lookup"><span data-stu-id="0583d-112">To support dynamic code loading and unloading, it creates an isolated context for loading code and its dependencies in their own <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span>

## <a name="when-do-you-need-multiple-assemblyloadcontext-instances"></a><span data-ttu-id="0583d-113">Wann benötigen Sie mehrere AssemblyLoadContext-Instanzen?</span><span class="sxs-lookup"><span data-stu-id="0583d-113">When do you need multiple AssemblyLoadContext instances?</span></span>

<span data-ttu-id="0583d-114">Eine einzelne <xref:System.Runtime.Loader.AssemblyLoadContext>-Instanz ist auf das Laden genau einer Version einer <xref:System.Reflection.Assembly> für jeweils einen einfachen Assemblynamen (<xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>) beschränkt.</span><span class="sxs-lookup"><span data-stu-id="0583d-114">A single <xref:System.Runtime.Loader.AssemblyLoadContext> instance is limited to loading exactly one version of an <xref:System.Reflection.Assembly> per simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="0583d-115">Diese Einschränkung kann problematisch werden, wenn Codemodule dynamisch geladen werden.</span><span class="sxs-lookup"><span data-stu-id="0583d-115">This restriction can become a problem when loading code modules dynamically.</span></span> <span data-ttu-id="0583d-116">Jedes Modul wird unabhängig kompiliert und kann von verschiedenen Versionen einer <xref:System.Reflection.Assembly> abhängen.</span><span class="sxs-lookup"><span data-stu-id="0583d-116">Each module is independently compiled and may depend on different versions of an <xref:System.Reflection.Assembly>.</span></span> <span data-ttu-id="0583d-117">Dieses Problem tritt häufig auf, wenn verschiedene Module von unterschiedlichen Versionen einer häufig verwendeten Bibliothek abhängen.</span><span class="sxs-lookup"><span data-stu-id="0583d-117">This problem commonly occurs when different modules depend on different versions of a commonly used library.</span></span>

<span data-ttu-id="0583d-118">Um das dynamische Laden von Code zu unterstützen, ermöglicht die <xref:System.Runtime.Loader.AssemblyLoadContext>-API das Laden von in Konflikt stehenden Versionen einer <xref:System.Reflection.Assembly> in derselben Anwendung.</span><span class="sxs-lookup"><span data-stu-id="0583d-118">To support dynamically loading code, the <xref:System.Runtime.Loader.AssemblyLoadContext> API provides for loading conflicting versions of an <xref:System.Reflection.Assembly> in the same application.</span></span> <span data-ttu-id="0583d-119">Jede <xref:System.Runtime.Loader.AssemblyLoadContext>-Instanz stellt eine eindeutige Wörterbuchzuordnung für jede <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> einer bestimmten <xref:System.Reflection.Assembly>-Instanz bereit.</span><span class="sxs-lookup"><span data-stu-id="0583d-119">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance provides a unique dictionary mapping each <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> to a specific <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="0583d-120">Außerdem bietet sie einen einfachen Mechanismus zum Gruppieren von Abhängigkeiten eines Codemoduls für das spätere Entladen.</span><span class="sxs-lookup"><span data-stu-id="0583d-120">It also provides a convenient mechanism for grouping dependencies related to a code module for later unload.</span></span>

## <a name="what-is-special-about-the-assemblyloadcontextdefault-instance"></a><span data-ttu-id="0583d-121">Was ist das Besondere an der AssemblyLoadContext.Default-Instanz?</span><span class="sxs-lookup"><span data-stu-id="0583d-121">What is special about the AssemblyLoadContext.Default instance?</span></span>

<span data-ttu-id="0583d-122">Die <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>-Instanz wird beim Start automatisch von der Runtime aufgefüllt.</span><span class="sxs-lookup"><span data-stu-id="0583d-122">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance is automatically populated by the runtime at startup.</span></span>  <span data-ttu-id="0583d-123">Sie verwendet [Standardüberprüfungen](default-probing.md), um alle statischen Abhängigkeiten zu finden.</span><span class="sxs-lookup"><span data-stu-id="0583d-123">It uses [default probing](default-probing.md) to locate and find all static dependencies.</span></span>

<span data-ttu-id="0583d-124">Damit werden die gängigsten Szenarien zum Laden von Abhängigkeiten gelöst.</span><span class="sxs-lookup"><span data-stu-id="0583d-124">It solves the most common dependency loading scenarios.</span></span>

## <a name="how-does-assemblyloadcontext-support-dynamic-dependencies"></a><span data-ttu-id="0583d-125">Wie unterstützt AssemblyLoadContext dynamische Abhängigkeiten?</span><span class="sxs-lookup"><span data-stu-id="0583d-125">How does AssemblyLoadContext support dynamic dependencies?</span></span>

<span data-ttu-id="0583d-126"><xref:System.Runtime.Loader.AssemblyLoadContext> verfügt über verschiedene Ereignisse und virtuelle Funktionen, die überschrieben werden können.</span><span class="sxs-lookup"><span data-stu-id="0583d-126"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span>

<span data-ttu-id="0583d-127">Die <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>-Instanz unterstützt nur das Überschreiben der Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="0583d-127">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance only supports overriding the events.</span></span>

<span data-ttu-id="0583d-128">In den Artikeln [Ladealgorithmus für verwaltete Assemblys](loading-managed.md), [Ladealgorithmus für Satellitenassemblys](loading-resources.md) und [Ladealgorithmus für nicht verwaltete (native) Bibliotheken](loading-unmanaged.md) werden alle verfügbaren Ereignisse und virtuellen Funktionen beschrieben.</span><span class="sxs-lookup"><span data-stu-id="0583d-128">The articles [Managed assembly loading algorithm](loading-managed.md), [Satellite assembly loading algorithm](loading-resources.md), and [Unmanaged (native) library loading algorithm](loading-unmanaged.md) refer to all the available events and virtual functions.</span></span>  <span data-ttu-id="0583d-129">In den Artikeln werden die relativen Positionen der einzelnen Ereignisse und Funktionen in den Ladealgorithmen veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="0583d-129">The articles show each event and function's relative position in the loading algorithms.</span></span> <span data-ttu-id="0583d-130">Diese Informationen werden in diesem Artikel nicht wiederholt.</span><span class="sxs-lookup"><span data-stu-id="0583d-130">This article doesn't reproduce that information.</span></span>

<span data-ttu-id="0583d-131">In diesem Abschnitt werden die allgemeinen Prinzipien der relevanten Ereignisse und Funktionen behandelt.</span><span class="sxs-lookup"><span data-stu-id="0583d-131">This section covers the general principles for the relevant events and functions.</span></span>

- <span data-ttu-id="0583d-132">**Wiederholbarkeit** .</span><span class="sxs-lookup"><span data-stu-id="0583d-132">**Be repeatable** .</span></span> <span data-ttu-id="0583d-133">Eine Abfrage für eine bestimmte Abhängigkeit muss immer zu derselben Antwort führen.</span><span class="sxs-lookup"><span data-stu-id="0583d-133">A query for a specific dependency must always result in the same response.</span></span> <span data-ttu-id="0583d-134">Es muss dieselbe geladene Abhängigkeitsinstanz zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="0583d-134">The same loaded dependency instance must be returned.</span></span> <span data-ttu-id="0583d-135">Diese Anforderung ist grundlegend für die Cachekonsistenz.</span><span class="sxs-lookup"><span data-stu-id="0583d-135">This requirement is fundamental  for cache consistency.</span></span> <span data-ttu-id="0583d-136">Für verwaltete Assemblys wurde eigens ein <xref:System.Reflection.Assembly>-Cache erstellt.</span><span class="sxs-lookup"><span data-stu-id="0583d-136">For managed assemblies in particular, we're creating an <xref:System.Reflection.Assembly> cache.</span></span> <span data-ttu-id="0583d-137">Der Cacheschlüssel ist ein einfacher Assemblyname: <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="0583d-137">The cache key is a simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="0583d-138">**Normalerweise keine Fehlerauslösung** .</span><span class="sxs-lookup"><span data-stu-id="0583d-138">**Typically don't throw** .</span></span>  <span data-ttu-id="0583d-139">Es wird erwartet, dass diese Funktionen `null` zurückgeben, anstatt einen Fehler auszulösen, dass die angeforderte Abhängigkeit nicht gefunden werden kann.</span><span class="sxs-lookup"><span data-stu-id="0583d-139">It's expected that these functions return `null` rather than throw when unable to find the requested dependency.</span></span> <span data-ttu-id="0583d-140">Durch das Auslösen wird die Suche vorzeitig beendet und eine Ausnahme an den Aufrufer zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="0583d-140">Throwing will prematurely end the search and be propagate an exception to the caller.</span></span> <span data-ttu-id="0583d-141">Die Auslösung sollte auf unerwartete Fehler wie eine beschädigte Assembly oder Fälle mit nicht genügend Arbeitsspeicher beschränkt sein.</span><span class="sxs-lookup"><span data-stu-id="0583d-141">Throwing should be restricted to unexpected errors like a corrupted assembly or an out of memory condition.</span></span>
- <span data-ttu-id="0583d-142">**Vermeidung von Rekursion.**</span><span class="sxs-lookup"><span data-stu-id="0583d-142">**Avoid recursion** .</span></span> <span data-ttu-id="0583d-143">Beachten Sie, dass diese Funktionen und Handler die Laderegeln für die Suche nach Abhängigkeiten implementieren.</span><span class="sxs-lookup"><span data-stu-id="0583d-143">Be aware that these functions and handlers implement the loading rules for locating dependencies.</span></span> <span data-ttu-id="0583d-144">Ihre Implementierung sollte keine APIs aufrufen, die Rekursion auslösen.</span><span class="sxs-lookup"><span data-stu-id="0583d-144">Your implementation shouldn't call APIs that trigger recursion.</span></span> <span data-ttu-id="0583d-145">Ihr Code sollte in der Regel Ladefunktionen von **AssemblyLoadContext** aufrufen, die ein bestimmtes Pfad- oder Speicherverweisargument erfordern.</span><span class="sxs-lookup"><span data-stu-id="0583d-145">Your code should typically call **AssemblyLoadContext** load functions that require a specific path or memory reference argument.</span></span>
- <span data-ttu-id="0583d-146">**Laden in den richtigen AssemblyLoadContext.**</span><span class="sxs-lookup"><span data-stu-id="0583d-146">**Load into the correct AssemblyLoadContext** .</span></span> <span data-ttu-id="0583d-147">Die Wahl des richtigen Orts für das Laden von Abhängigkeiten ist anwendungsspezifisch.</span><span class="sxs-lookup"><span data-stu-id="0583d-147">The choice of where to load dependencies is application-specific.</span></span>  <span data-ttu-id="0583d-148">Die Auswahl wird durch diese Ereignisse und Funktionen implementiert.</span><span class="sxs-lookup"><span data-stu-id="0583d-148">The choice is implemented by these events and functions.</span></span> <span data-ttu-id="0583d-149">Wenn Ihr Code **AssemblyLoadContext** -Funktionen vom Typ „Laden nach Pfad“ aufruft, sollten Sie dafür die Instanz verwenden, in die der Code geladen werden soll.</span><span class="sxs-lookup"><span data-stu-id="0583d-149">When your code calls **AssemblyLoadContext** load-by-path functions call them on the instance where you want the code loaded.</span></span> <span data-ttu-id="0583d-150">In einigen Fällen besteht die einfachste Lösung darin, `null` zurückzugeben und das Laden <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> zu überlassen.</span><span class="sxs-lookup"><span data-stu-id="0583d-150">Sometime returning `null` and letting the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> handle the load may be the simplest option.</span></span>
- <span data-ttu-id="0583d-151">**Berücksichtigung von Thread-Races** .</span><span class="sxs-lookup"><span data-stu-id="0583d-151">**Be aware of thread races** .</span></span> <span data-ttu-id="0583d-152">Das Laden kann von mehreren Threads ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="0583d-152">Loading can be triggered by multiple threads.</span></span> <span data-ttu-id="0583d-153">Der AssemblyLoadContext verarbeitet Thread-Races, indem er die Assemblys einzeln im Cache hinzufügt.</span><span class="sxs-lookup"><span data-stu-id="0583d-153">The AssemblyLoadContext handles thread races by atomically adding assemblies to its cache.</span></span> <span data-ttu-id="0583d-154">Die Instanz des letztes Threads wird dann verworfen.</span><span class="sxs-lookup"><span data-stu-id="0583d-154">The race loser's instance is discarded.</span></span> <span data-ttu-id="0583d-155">Fügen Sie in Ihrer Implementierungslogik keine zusätzliche Logik hinzu, die nicht ordnungsgemäß mehrere Threads verarbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="0583d-155">In your implementation logic, don't add extra logic that doesn't handle multiple threads properly.</span></span>

## <a name="how-are-dynamic-dependencies-isolated"></a><span data-ttu-id="0583d-156">Wie werden dynamische Abhängigkeiten isoliert?</span><span class="sxs-lookup"><span data-stu-id="0583d-156">How are dynamic dependencies isolated?</span></span>

<span data-ttu-id="0583d-157">Jede <xref:System.Runtime.Loader.AssemblyLoadContext>-Instanz stellt einen eindeutigen Geltungsbereich für <xref:System.Reflection.Assembly>-Instanzen und <xref:System.Type>-Definitionen dar.</span><span class="sxs-lookup"><span data-stu-id="0583d-157">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance represents a unique scope for <xref:System.Reflection.Assembly> instances and <xref:System.Type> definitions.</span></span>

<span data-ttu-id="0583d-158">Es gibt keine binäre Isolation zwischen diesen Abhängigkeiten.</span><span class="sxs-lookup"><span data-stu-id="0583d-158">There's no binary isolation between these dependencies.</span></span> <span data-ttu-id="0583d-159">Sie werden nur isoliert, da sie sich gegenseitig nicht anhand des Namens finden können.</span><span class="sxs-lookup"><span data-stu-id="0583d-159">They're only isolated by not finding each other by name.</span></span>

<span data-ttu-id="0583d-160">In jedem <xref:System.Runtime.Loader.AssemblyLoadContext> gilt Folgendes:</span><span class="sxs-lookup"><span data-stu-id="0583d-160">In each <xref:System.Runtime.Loader.AssemblyLoadContext>:</span></span>

- <span data-ttu-id="0583d-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> kann auf eine andere <xref:System.Reflection.Assembly>-Instanz verweisen.</span><span class="sxs-lookup"><span data-stu-id="0583d-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> may refer to a different <xref:System.Reflection.Assembly> instance.</span></span>
- <span data-ttu-id="0583d-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType> gibt möglicherweise eine andere Typinstanz für denselben Typ-`name` zurück.</span><span class="sxs-lookup"><span data-stu-id="0583d-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType> may return a different type instance for the same type `name`.</span></span>

## <a name="how-are-dependencies-shared"></a><span data-ttu-id="0583d-163">Wie werden Abhängigkeiten gemeinsam genutzt?</span><span class="sxs-lookup"><span data-stu-id="0583d-163">How are dependencies shared?</span></span>

<span data-ttu-id="0583d-164">Abhängigkeiten können problemlos von mehreren <xref:System.Runtime.Loader.AssemblyLoadContext>-Instanzen gemeinsam genutzt werden.</span><span class="sxs-lookup"><span data-stu-id="0583d-164">Dependencies can easily be shared between <xref:System.Runtime.Loader.AssemblyLoadContext> instances.</span></span> <span data-ttu-id="0583d-165">Im allgemeinen Modell lädt ein <xref:System.Runtime.Loader.AssemblyLoadContext> eine Abhängigkeit.</span><span class="sxs-lookup"><span data-stu-id="0583d-165">The general model is for one <xref:System.Runtime.Loader.AssemblyLoadContext> to load a dependency.</span></span>  <span data-ttu-id="0583d-166">Der andere verwendet die Abhängigkeit über einen Verweis auf die geladene Assembly.</span><span class="sxs-lookup"><span data-stu-id="0583d-166">The other shares the dependency by using a reference to the loaded assembly.</span></span>

<span data-ttu-id="0583d-167">Diese Form der gemeinsamen Verwendung ist für die Runtimeassemblys erforderlich.</span><span class="sxs-lookup"><span data-stu-id="0583d-167">This sharing is required of the runtime assemblies.</span></span> <span data-ttu-id="0583d-168">Diese Assemblys können nur in den <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> geladen werden.</span><span class="sxs-lookup"><span data-stu-id="0583d-168">These assemblies can only be loaded into the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="0583d-169">Dasselbe gilt auch für Frameworks wie `ASP.NET`, `WPF` oder `WinForms`.</span><span class="sxs-lookup"><span data-stu-id="0583d-169">The same is required for frameworks like `ASP.NET`, `WPF`, or `WinForms`.</span></span>

<span data-ttu-id="0583d-170">Es wird empfohlen, gemeinsam genutzte Abhängigkeiten in <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> zu laden.</span><span class="sxs-lookup"><span data-stu-id="0583d-170">It's recommended that shared dependencies should be loaded into <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="0583d-171">Diese Form der gemeinsamen Nutzung ist das gängige Entwurfsmuster.</span><span class="sxs-lookup"><span data-stu-id="0583d-171">This sharing is the common design pattern.</span></span>

<span data-ttu-id="0583d-172">Die gemeinsame Nutzung wird im Code der benutzerdefinierten <xref:System.Runtime.Loader.AssemblyLoadContext>-Instanz implementiert.</span><span class="sxs-lookup"><span data-stu-id="0583d-172">Sharing is implemented in the coding of the custom <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span> <span data-ttu-id="0583d-173"><xref:System.Runtime.Loader.AssemblyLoadContext> verfügt über verschiedene Ereignisse und virtuelle Funktionen, die überschrieben werden können.</span><span class="sxs-lookup"><span data-stu-id="0583d-173"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span> <span data-ttu-id="0583d-174">Wenn eine dieser Funktionen einen Verweis auf eine <xref:System.Reflection.Assembly>-Instanz zurückgibt, die in einer anderen <xref:System.Runtime.Loader.AssemblyLoadContext>-Instanz geladen wurde, wird die <xref:System.Reflection.Assembly>-Instanz gemeinsam verwendet.</span><span class="sxs-lookup"><span data-stu-id="0583d-174">When any of these functions return a reference to an <xref:System.Reflection.Assembly> instance that was loaded in another <xref:System.Runtime.Loader.AssemblyLoadContext> instance, the <xref:System.Reflection.Assembly> instance is shared.</span></span> <span data-ttu-id="0583d-175">Der Standardladealgorithmus orientiert sich für das Laden am <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>, um das Muster für die gemeinsame Nutzung zu vereinfachen.</span><span class="sxs-lookup"><span data-stu-id="0583d-175">The standard load algorithm defers to <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> for loading to simplify the common sharing pattern.</span></span>  <span data-ttu-id="0583d-176">Weitere Informationen finden Sie unter [Ladealgorithmus für verwaltete Assemblys](loading-managed.md).</span><span class="sxs-lookup"><span data-stu-id="0583d-176">See [Managed assembly loading algorithm](loading-managed.md).</span></span>

## <a name="complications"></a><span data-ttu-id="0583d-177">Komplikationen</span><span class="sxs-lookup"><span data-stu-id="0583d-177">Complications</span></span>

### <a name="type-conversion-issues"></a><span data-ttu-id="0583d-178">Probleme bei der Typkonvertierung</span><span class="sxs-lookup"><span data-stu-id="0583d-178">Type conversion issues</span></span>

<span data-ttu-id="0583d-179">Wenn zwei <xref:System.Runtime.Loader.AssemblyLoadContext>-Instanzen Typdefinitionen mit demselben `name` enthalten, sind sie nicht vom selben Typ.</span><span class="sxs-lookup"><span data-stu-id="0583d-179">When two <xref:System.Runtime.Loader.AssemblyLoadContext> instances contain type definitions with the same `name`, they're not the same type.</span></span> <span data-ttu-id="0583d-180">Sie weisen nur dann denselben Typ auf, wenn sie von derselben <xref:System.Reflection.Assembly>-Instanz stammen.</span><span class="sxs-lookup"><span data-stu-id="0583d-180">They're the same type if and only if they come from the same <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="0583d-181">Noch komplizierter wird es, da die Meldungen zu Ausnahmen bei diesen nicht übereinstimmenden Typen verwirrend sein können.</span><span class="sxs-lookup"><span data-stu-id="0583d-181">To complicate matters, exception messages about these mismatched types can be confusing.</span></span> <span data-ttu-id="0583d-182">Auf die Typen wird in den Ausnahmemeldungen anhand ihrer einfachen Typnamen verwiesen.</span><span class="sxs-lookup"><span data-stu-id="0583d-182">The types are referred to in the exception messages by their simple type names.</span></span> <span data-ttu-id="0583d-183">In diesem Fall hat die allgemeine Ausnahmemeldung folgende Form:</span><span class="sxs-lookup"><span data-stu-id="0583d-183">The common exception message in this case would be of the form:</span></span>

> <span data-ttu-id="0583d-184">Ein Objekt vom Typ „IsolatedType“ kann nicht in den Typ „IsolatedType“ konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="0583d-184">Object of type 'IsolatedType' cannot be converted to type 'IsolatedType'.</span></span>

### <a name="debugging-type-conversion-issues"></a><span data-ttu-id="0583d-185">Probleme bei der Konvertierung des Debugtyps</span><span class="sxs-lookup"><span data-stu-id="0583d-185">Debugging type conversion issues</span></span>

<span data-ttu-id="0583d-186">Bei einem Paar nicht übereinstimmender Typen ist es darüber hinaus wichtig, Folgendes zu wissen:</span><span class="sxs-lookup"><span data-stu-id="0583d-186">Given a pair of mismatched types it's important to also know:</span></span>

- <span data-ttu-id="0583d-187">Die <xref:System.Type.Assembly?displayProperty=nameWithType> jedes Typs</span><span class="sxs-lookup"><span data-stu-id="0583d-187">Each type's <xref:System.Type.Assembly?displayProperty=nameWithType></span></span>
- <span data-ttu-id="0583d-188">Die <xref:System.Runtime.Loader.AssemblyLoadContext> jedes Typs, die über die <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType>-Funktion abgerufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="0583d-188">Each type's <xref:System.Runtime.Loader.AssemblyLoadContext>, which can be obtained via the <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType> function.</span></span>

<span data-ttu-id="0583d-189">Bei den beiden Objekten `a` und `b` ist die Auswertung der folgenden Informationen im Debugger hilfreich:</span><span class="sxs-lookup"><span data-stu-id="0583d-189">Given two objects `a` and `b`, evaluating the following in the debugger will be helpful:</span></span>

```csharp
// In debugger look at each assembly's instance, Location, and FullName
a.GetType().Assembly
b.GetType().Assembly
// In debugger look at each AssemblyLoadContext's instance and name
System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(a.GetType().Assembly)
System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(b.GetType().Assembly)
```

### <a name="resolving-type-conversion-issues"></a><span data-ttu-id="0583d-190">Beheben von Problemen bei der Typkonvertierung</span><span class="sxs-lookup"><span data-stu-id="0583d-190">Resolving type conversion issues</span></span>

<span data-ttu-id="0583d-191">Es gibt zwei Entwurfsmuster für das Beheben dieser Typkonvertierungsprobleme.</span><span class="sxs-lookup"><span data-stu-id="0583d-191">There are two design patterns for solving these type conversion issues.</span></span>

1. <span data-ttu-id="0583d-192">Verwenden Sie allgemeine freigegebene Typen.</span><span class="sxs-lookup"><span data-stu-id="0583d-192">Use common shared types.</span></span> <span data-ttu-id="0583d-193">Der jeweilige freigegebene Typ kann ein primitiver Runtimetyp sein, oder Sie können einen neuen freigegebenen Typ in einer freigegebenen Assembly erstellen.</span><span class="sxs-lookup"><span data-stu-id="0583d-193">This shared type can either be a primitive runtime type, or it can involve creating a new shared type in a shared assembly.</span></span>  <span data-ttu-id="0583d-194">Häufig handelt es sich bei dem freigegebenen Typ um eine [Schnittstelle](../../csharp/language-reference/keywords/interface.md), die in einer Anwendungsassembly definiert ist.</span><span class="sxs-lookup"><span data-stu-id="0583d-194">Often the shared type is an [interface](../../csharp/language-reference/keywords/interface.md) defined in an application assembly.</span></span> <span data-ttu-id="0583d-195">Siehe auch: [Wie werden Abhängigkeiten gemeinsam genutzt?](#how-are-dependencies-shared)</span><span class="sxs-lookup"><span data-stu-id="0583d-195">See also: [How are dependencies shared?](#how-are-dependencies-shared).</span></span>

2. <span data-ttu-id="0583d-196">Verwenden Sie Marshallingtechniken, um Typen zu konvertieren.</span><span class="sxs-lookup"><span data-stu-id="0583d-196">Use marshaling techniques to convert from one type to another.</span></span>
