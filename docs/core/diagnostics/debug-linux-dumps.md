---
title: Debuggen von Linux-Sicherungskopien
description: In diesem Artikel erfahren Sie, wie Sie Speicherabbilder aus Linux-Umgebungen erfassen und analysieren.
ms.date: 08/27/2020
ms.openlocfilehash: 94f923f2ec7b5fa20c2ebc9b83540094348dff03
ms.sourcegitcommit: 30e9e11dfd90112b8eec6406186ba3533f21eba1
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/21/2020
ms.locfileid: "95099145"
---
# <a name="debug-linux-dumps"></a><span data-ttu-id="f7d8f-103">Debuggen von Linux-Sicherungskopien</span><span class="sxs-lookup"><span data-stu-id="f7d8f-103">Debug Linux dumps</span></span>

<span data-ttu-id="f7d8f-104">**Dieser Artikel gilt für:** ✔️ .NET Core 3.0 SDK und neuere Versionen</span><span class="sxs-lookup"><span data-stu-id="f7d8f-104">**This article applies to: ✔️** .NET Core 3.0 SDK and later versions</span></span>

## <a name="collect-dumps-on-linux"></a><span data-ttu-id="f7d8f-105">Erfassen von Speicherabbildern unter Linux</span><span class="sxs-lookup"><span data-stu-id="f7d8f-105">Collect dumps on Linux</span></span>

<span data-ttu-id="f7d8f-106">Die beiden empfohlenen Methoden für das Erfassen von Speicherabbildern unter Linux sind die Tools [`dotnet-dump`](dotnet-dump.md) und [`createdump`](https://github.com/dotnet/runtime/blob/master/docs/design/coreclr/botr/xplat-minidump-generation.md).</span><span class="sxs-lookup"><span data-stu-id="f7d8f-106">The two recommended ways of collecting dumps on Linux are the [`dotnet-dump`](dotnet-dump.md) or [`createdump`](https://github.com/dotnet/runtime/blob/master/docs/design/coreclr/botr/xplat-minidump-generation.md) tools.</span></span>

### <a name="managed-dumps-with-dotnet-dump"></a><span data-ttu-id="f7d8f-107">Verwaltete Speicherabbilder mit `dotnet-dump`</span><span class="sxs-lookup"><span data-stu-id="f7d8f-107">Managed dumps with `dotnet-dump`</span></span>

<span data-ttu-id="f7d8f-108">Das Tool [`dotnet-dump`](dotnet-dump.md) ist einfach zu verwenden und hängt nicht von nativen Debuggern ab.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-108">The [`dotnet-dump`](dotnet-dump.md) tool is simple to use, and does not have a dependency on any native debuggers.</span></span> <span data-ttu-id="f7d8f-109">`dotnet-dump` funktioniert auf einer Vielzahl von Linux-Plattformen (z. B. Alpine oder ARM32/ARM64), für die möglicherweise keine herkömmlichen Debugtools verfügbar sind.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-109">`dotnet-dump` works on a wide variety of Linux platforms (like Alpine or ARM32/ARM64) where traditional debugging tools may not be available.</span></span> <span data-ttu-id="f7d8f-110">`dotnet-dump` erfasst jedoch nur den verwalteten Zustand und kann daher nicht zum Debuggen von Problemen in nativem Code verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-110">However, `dotnet-dump` only captures managed state so it can't be used for debugging issues in native code.</span></span> <span data-ttu-id="f7d8f-111">Die von `dotnet-dump` erfassten Speicherabbilder werden in einer Umgebung analysiert, die über das Betriebssystem und die Architektur verfügt, mit dem bzw. der auch das Speicherabbild erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-111">Dumps collected by `dotnet-dump` are analyzed in an environment with the same OS and architecture the dump was created on.</span></span> <span data-ttu-id="f7d8f-112">Alternativ kann das Tool [`dotnet-gcdump`](dotnet-gcdump.md) verwendet werden, das nur GC-Heapinformationen erfasst, aber Speicherabbilder erzeugt, die unter Windows analysiert werden können.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-112">The [`dotnet-gcdump`](dotnet-gcdump.md) tool can be used as an alternative that only captures GC heap information but produces dumps that can be analyzed on Windows.</span></span>

### <a name="core-dumps-with-createdump"></a><span data-ttu-id="f7d8f-113">Kernspeicherabbilder mit `createdump`</span><span class="sxs-lookup"><span data-stu-id="f7d8f-113">Core dumps with `createdump`</span></span>

<span data-ttu-id="f7d8f-114">Als Alternative zum Tool `dotnet-dump`, das nur verwaltete Speicherabbilder erstellt, können Sie das für die Erstellung von Kernspeicherabbildern unter Linux empfohlene Tool [`createdump`](https://github.com/dotnet/runtime/blob/master/docs/design/coreclr/botr/xplat-minidump-generation.md) verwenden, das sowohl native als auch verwaltete Informationen enthält.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-114">As an alternative to `dotnet-dump`, which creates managed-only dumps, [`createdump`](https://github.com/dotnet/runtime/blob/master/docs/design/coreclr/botr/xplat-minidump-generation.md) is the recommended tool for creating core dumps on Linux containing both native and managed information.</span></span> <span data-ttu-id="f7d8f-115">Andere Tools, z. B. gdb oder gcore, können ebenfalls zum Erstellen von Kernspeicherabbildern verwendet werden. Bei diesen fehlt allerdings möglicherweise der für das verwaltete Debuggen erforderliche Zustand, was bei der Analyse zu „UNKNOWN“ als Typen- oder Funktionsnamen führt.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-115">Other tools like gdb or gcore can also be used to create core dumps but may miss state needed for managed debugging, resulting in "UNKNOWN" type or function names during analysis.</span></span>

<span data-ttu-id="f7d8f-116">Das Tool `createdump` wird mit der .NET Core-Runtime installiert und befindet sich bei libcoreclr.so (in der Regel unter „/usr/share/dotnet/shared/Microsoft.NETCore.App/[Version]“).</span><span class="sxs-lookup"><span data-stu-id="f7d8f-116">The `createdump` tool is installed with the .NET Core runtime and can be found next to libcoreclr.so (typically in "/usr/share/dotnet/shared/Microsoft.NETCore.App/[version]").</span></span> <span data-ttu-id="f7d8f-117">Es verwendet als primäres Argument eine Prozess-ID, für die ein Speicherabbild erfasst wird, und kann auch optionale Parameter verwenden, die angeben, welche Art von Speicherabbild erfasst werden soll (die Standardeinstellung ist ein Minidump mit Heap).</span><span class="sxs-lookup"><span data-stu-id="f7d8f-117">The tool takes a process ID to collect a dump from as its primary argument and can also take optional parameters specifying what kind of dump to collect (a minidump with heap is the default).</span></span> <span data-ttu-id="f7d8f-118">Beispiele für Optionen:</span><span class="sxs-lookup"><span data-stu-id="f7d8f-118">Options include:</span></span>

- **`<input-filename>`**

  <span data-ttu-id="f7d8f-119">Die zu konvertierende Eingabe-Ablaufverfolgungsdatei.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-119">Input trace file to be converted.</span></span> <span data-ttu-id="f7d8f-120">Standard: *trace.nettrace*.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-120">Defaults to *trace.nettrace*.</span></span>

### <a name="options"></a><span data-ttu-id="f7d8f-121">Optionen</span><span class="sxs-lookup"><span data-stu-id="f7d8f-121">Options</span></span>

- **`-f|--name <output-filename>`**

  <span data-ttu-id="f7d8f-122">Hiermit wird die Datei angegeben, in die das Speicherabbild geschrieben werden soll.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-122">The file to write the dump to.</span></span> <span data-ttu-id="f7d8f-123">Der Standardwert ist „/tmp/coredump.%p“, wobei „%p“ die Prozess-ID des Zielprozesses ist.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-123">Default is '/tmp/coredump.%p' where %p is the process ID of the target process.</span></span>

- **`-n|--normal`**

  <span data-ttu-id="f7d8f-124">Erstellen eines Minidumps</span><span class="sxs-lookup"><span data-stu-id="f7d8f-124">Create a minidump.</span></span>

- **`-h|--withheap`**

  <span data-ttu-id="f7d8f-125">Erstellen eines Minidumps mit Heap (Standard)</span><span class="sxs-lookup"><span data-stu-id="f7d8f-125">Create a minidump with heap (default).</span></span>

- **`-t|--triage`**

  <span data-ttu-id="f7d8f-126">Erstellen eines Selektierungsminidumps</span><span class="sxs-lookup"><span data-stu-id="f7d8f-126">Create a triage minidump.</span></span>

- **`-u|--full`**

  <span data-ttu-id="f7d8f-127">Erstellen eines vollständigen Kernspeicherabbilds</span><span class="sxs-lookup"><span data-stu-id="f7d8f-127">Create a full core dump.</span></span>

- **`-d|--diag`**

  <span data-ttu-id="f7d8f-128">Aktivieren von Diagnosemeldungen</span><span class="sxs-lookup"><span data-stu-id="f7d8f-128">Enable diagnostic messages.</span></span>

<span data-ttu-id="f7d8f-129">Das Erfassen von Kernspeicherabbildern erfordert entweder die Funktion `SYS_PTRACE` oder das Ausführen von `createdump` mit sudo oder su.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-129">Collecting core dumps requires either the `SYS_PTRACE` capability or that `createdump` be run with sudo or su.</span></span>

## <a name="analyze-dumps-on-linux"></a><span data-ttu-id="f7d8f-130">Analysieren von Speicherabbildern unter Linux</span><span class="sxs-lookup"><span data-stu-id="f7d8f-130">Analyze dumps on Linux</span></span>

<span data-ttu-id="f7d8f-131">Sowohl verwaltete Speicherabbilder, die mit `dotnet-dump` erfasst wurden, als auch mit `createdump` erfasste Kernspeicherabbilder können mithilfe des Befehls `dotnet-dump analyze` mit dem Tool `dotnet-dump` analysiert werden.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-131">Both managed dumps collected with `dotnet-dump` and core dumps collected with `createdump` can be analyzed with the `dotnet-dump` tool using the `dotnet-dump analyze` command.</span></span> <span data-ttu-id="f7d8f-132">`dotnet dump` erfordert, dass die Umgebung, die das Speicherabbild analysiert, über das gleiche Betriebssystem und die gleiche Architektur verfügt wie die Umgebung, in der das Speicherabbild erfasst wurde.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-132">The `dotnet dump` requires that the environment analyzing the dump has the same OS and architecture as the environment the dump was captured in.</span></span>

<span data-ttu-id="f7d8f-133">Alternativ kann [LLDB](https://lldb.llvm.org/) zum Analysieren von Kernspeicherabbildern unter Linux verwendet werden, wobei sowohl verwaltete als auch native Frames analysiert werden können.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-133">Alternatively, [LLDB](https://lldb.llvm.org/) can be used to analyze core dumps on Linux, which allows analysis of both managed and native frames.</span></span> <span data-ttu-id="f7d8f-134">LLDB verwendet die SOS-Erweiterung zum Debuggen von verwaltetem Code.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-134">LLDB uses the SOS extension to debug managed code.</span></span> <span data-ttu-id="f7d8f-135">Das CLI-Tool [`dotnet-sos`](dotnet-sos.md) kann verwendet werden, um die SOS-Erweiterung zu installieren, die [viele nützliche Befehle](https://github.com/dotnet/diagnostics/blob/master/documentation/sos-debugging-extension.md) zum Debuggen von verwaltetem Code enthält.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-135">The [`dotnet-sos`](dotnet-sos.md) CLI tool can be used to install SOS, which has [many useful commands](https://github.com/dotnet/diagnostics/blob/master/documentation/sos-debugging-extension.md) for debugging managed code.</span></span> <span data-ttu-id="f7d8f-136">Zum Analysieren von .NET Core-Speicherabbildern benötigen LLDB und SOS die folgenden .NET Core-Binärdateien aus der Umgebung, in der das Speicherabbild erstellt wurde:</span><span class="sxs-lookup"><span data-stu-id="f7d8f-136">In order to analyze .NET Core dumps, LLDB and SOS require the following .NET Core binaries from the environment the dump was created in:</span></span>

1. <span data-ttu-id="f7d8f-137">libmscordaccore.so</span><span class="sxs-lookup"><span data-stu-id="f7d8f-137">libmscordaccore.so</span></span>
2. <span data-ttu-id="f7d8f-138">libcoreclr.so</span><span class="sxs-lookup"><span data-stu-id="f7d8f-138">libcoreclr.so</span></span>
3. <span data-ttu-id="f7d8f-139">dotnet (der Host, der zum Starten der App verwendet wird)</span><span class="sxs-lookup"><span data-stu-id="f7d8f-139">dotnet (the host used to launch the app)</span></span>

<span data-ttu-id="f7d8f-140">In den meisten Fällen können diese Binärdateien mit dem Tool [`dotnet-symbol`](dotnet-symbol.md) heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-140">In most cases, these binaries can be downloaded using the [`dotnet-symbol`](dotnet-symbol.md) tool.</span></span> <span data-ttu-id="f7d8f-141">Wenn die erforderlichen Binärdateien nicht mit `dotnet-symbol` heruntergeladen werden können (z. B. wenn eine vollständig selbst erstellte private Version von .NET Core verwendet wurde), müssen die oben aufgeführten Dateien möglicherweise aus der Umgebung kopiert werden, in der das Speicherabbild erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-141">If the necessary binaries can't be downloaded with `dotnet-symbol` (for example, if a private version of .NET Core built from source was in use), it may be necessary to copy the files listed above from the environment the dump was created in.</span></span> <span data-ttu-id="f7d8f-142">Wenn sich diese Dateien nicht am selben Ort wie die Speicherabbilddatei befinden, können Sie über den LLDB-/SOS-Befehl `setclrpath <path>` den Pfad festlegen, von dem sie geladen werden sollen, und über `setsymbolserver -directory <path>` den Pfad, unter dem nach Symboldateien gesucht werden soll.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-142">If the files aren't located next to the dump file, you can use the LLDB/SOS command `setclrpath <path>` to set the path they should be loaded from and `setsymbolserver -directory <path>` to set the path to look in for symbol files.</span></span>

<span data-ttu-id="f7d8f-143">Sobald die erforderlichen Dateien verfügbar sind, kann das Speicherabbild in LLDB geladen werden, indem der dotnet-Host als die zu debuggende ausführbare Datei angegeben wird:</span><span class="sxs-lookup"><span data-stu-id="f7d8f-143">Once the necessary files are available, the dump can be loaded in LLDB by specifying the dotnet host as the executable to debug:</span></span>

```console
lldb --core <dump-file> <host-program>
```

<span data-ttu-id="f7d8f-144">In der obigen Befehlszeile ist `<dump-file>` der Pfad des Speicherabbilds, das analysiert werden soll, und `<host-program>` das native Programm, das die .NET Core-Anwendung gestartet hat.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-144">In the above command line, `<dump-file>` is the path of the dump to analyze and `<host-program>` is the native program that started the .NET Core application.</span></span> <span data-ttu-id="f7d8f-145">Dabei handelt es sich in der Regel um die Binärdatei `dotnet`, außer die App ist eigenständig. In diesem Fall wird der Name der Anwendung ohne die Erweiterung „.dll“ angegeben.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-145">This is typically the `dotnet` binary unless the app is self-contained, in which case it is the name of the application without the dll extension.</span></span>

<span data-ttu-id="f7d8f-146">Nach dem Start von LLDB muss möglicherweise der Befehl `setsymbolserver` verwendet werden, um auf den richtigen Symbolspeicherort zu verweisen (`setsymbolserver -ms` für den Symbolserver von Microsoft oder `setsymbolserver -directory <path>` zum Angeben eines lokalen Pfads).</span><span class="sxs-lookup"><span data-stu-id="f7d8f-146">Once LLDB starts, it may be necessary to use the `setsymbolserver` command to point at the correct symbol location (`setsymbolserver -ms` to use Microsoft's symbol server or `setsymbolserver -directory <path>` to specify a local path).</span></span> <span data-ttu-id="f7d8f-147">Native Symbole können durch Ausführen von `loadsymbols` geladen werden.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-147">Native symbols can be loaded by running `loadsymbols`.</span></span> <span data-ttu-id="f7d8f-148">Nun können [SOS-Befehle](https://github.com/dotnet/diagnostics/blob/master/documentation/sos-debugging-extension.md) verwendet werden, um das Speicherabbild zu analysieren.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-148">At this point, [SOS commands](https://github.com/dotnet/diagnostics/blob/master/documentation/sos-debugging-extension.md) can be used to analyze the dump.</span></span>

## <a name="see-also"></a><span data-ttu-id="f7d8f-149">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="f7d8f-149">See also</span></span>

- <span data-ttu-id="f7d8f-150">Unter [dotnet-sos](dotnet-sos.md) finden Sie weitere Details zur Installation der SOS-Erweiterung.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-150">[dotnet-sos](dotnet-sos.md) for more details on installing the SOS extension.</span></span>
- <span data-ttu-id="f7d8f-151">Unter [dotnet-symbol](dotnet-symbol.md) finden Sie weitere Details zur Installation und Verwendung des Symboldownloadtools.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-151">[dotnet-symbol](dotnet-symbol.md) for more details on installing and using the symbol download tool.</span></span>
- <span data-ttu-id="f7d8f-152">Im [.NET Core-Diagnoserepository](https://github.com/dotnet/diagnostics/blob/master/documentation/) finden Sie weitere Details zum Debuggen, einschließlich hilfreicher häufig gestellter Fragen.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-152">[.NET Core diagnostics repo](https://github.com/dotnet/diagnostics/blob/master/documentation/) for more details on debugging, including a useful FAQ.</span></span>
- <span data-ttu-id="f7d8f-153">Unter [Installieren von LLDB](https://github.com/dotnet/diagnostics/blob/master/documentation/sos.md#getting-lldb) finden Sie Anleitungen zur Installation von LLDB für Linux oder Mac.</span><span class="sxs-lookup"><span data-stu-id="f7d8f-153">[Installing LLDB](https://github.com/dotnet/diagnostics/blob/master/documentation/sos.md#getting-lldb) for instructions on installing LLDB on Linux or Mac.</span></span>
