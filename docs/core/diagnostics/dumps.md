---
title: Speicherabbilder – .NET
description: Eine Einführung in Speicherabbilder in .NET
ms.date: 10/12/2020
ms.openlocfilehash: 7a4c7bf54b3e9ea43e685eafbd00b4a373326520
ms.sourcegitcommit: c0b803bffaf101e12f071faf94ca21b46d04ff30
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 12/24/2020
ms.locfileid: "97764941"
---
# <a name="dumps"></a><span data-ttu-id="be702-103">Dumps</span><span class="sxs-lookup"><span data-stu-id="be702-103">Dumps</span></span>

<span data-ttu-id="be702-104">Ein Speicherabbild ist eine Datei, die eine Momentaufnahme eines Prozesses zum Zeitpunkt der Erstellung enthält und zur Untersuchung des Zustands Ihrer Anwendung nützlich sein kann.</span><span class="sxs-lookup"><span data-stu-id="be702-104">A dump is a file that contains a snapshot of the process at the time it was created and can be useful for examining the state of your application.</span></span> <span data-ttu-id="be702-105">Mithilfe von Speicherabbildern können Sie Ihre .NET-Anwendung selbst dann debuggen, wenn sich das Anfügen eines Debuggers schwierig gestaltet, z. B. in Umgebungen für die Produktion oder für Continuous Integration.</span><span class="sxs-lookup"><span data-stu-id="be702-105">Dumps can be used to debug your .NET application when it is difficult to attach a debugger to it such as production or CI environments.</span></span> <span data-ttu-id="be702-106">Speicherabbilder ermöglichen es Ihnen, den Zustand des problematischen Prozesses zu erfassen und den Prozess zu untersuchen, ohne die Anwendung beenden zu müssen.</span><span class="sxs-lookup"><span data-stu-id="be702-106">Using dumps allows you to capture the state of the problematic process and examine it without having to stop the application.</span></span>

## <a name="collect-dumps"></a><span data-ttu-id="be702-107">Erfassen von Speicherabbildern</span><span class="sxs-lookup"><span data-stu-id="be702-107">Collect dumps</span></span>

<span data-ttu-id="be702-108">Je nachdem, auf welcher Plattform Sie Ihre App ausführen, können Speicherabbilder auf verschiedene Arten gesammelt werden.</span><span class="sxs-lookup"><span data-stu-id="be702-108">Dumps can be collected in a variety of ways depending on which platform you are running your app on.</span></span>

> [!NOTE]
> <span data-ttu-id="be702-109">Das Erfassen eines Speicherabbilds in einem Container erfordert die Funktion PTRACE, die über `--cap-add=SYS_PTRACE` oder `--privileged` hinzugefügt werden kann.</span><span class="sxs-lookup"><span data-stu-id="be702-109">Collecting a dump inside a container requires PTRACE capability, which can be added via `--cap-add=SYS_PTRACE` or `--privileged`.</span></span>

> [!NOTE]
> <span data-ttu-id="be702-110">Speicherabbilder können vertrauliche Informationen aufweisen, da sie die vollständigen Arbeitsspeicherdaten des laufenden Prozesses enthalten.</span><span class="sxs-lookup"><span data-stu-id="be702-110">Dumps may contain sensitive information because they can contain the full memory of the running process.</span></span> <span data-ttu-id="be702-111">Bedenken Sie beim Arbeiten mit Speicherabbildern alle Sicherheitseinschränkungen und -richtlinien.</span><span class="sxs-lookup"><span data-stu-id="be702-111">Handle them with any security restrictions and guidances in mind.</span></span>

### <a name="collecting-dumps-on-crash"></a><span data-ttu-id="be702-112">Erfassen von Speicherabbildern bei einem Absturz</span><span class="sxs-lookup"><span data-stu-id="be702-112">Collecting dumps on crash</span></span>

<span data-ttu-id="be702-113">Sie können Ihre Anwendung mithilfe von Umgebungsvariablen so konfigurieren, dass bei einem Absturz ein Speicherabbild erfasst wird.</span><span class="sxs-lookup"><span data-stu-id="be702-113">You can use environment variables to configure your application to collect a dump upon a crash.</span></span> <span data-ttu-id="be702-114">Dies ist hilfreich, wenn Sie der Ursache eines Absturzes auf den Grund gehen möchten.</span><span class="sxs-lookup"><span data-stu-id="be702-114">This is helpful when you want to get an understanding of why a crash happened.</span></span> <span data-ttu-id="be702-115">Das Erfassen eines Speicherabbilds beim Auslösen einer Ausnahme kann Ihnen z. B. helfen, ein Problem zu erkennen, indem Sie den Zustand der App zum Zeitpunkt des Absturzes untersuchen.</span><span class="sxs-lookup"><span data-stu-id="be702-115">For example, capturing a dump when an exception is thrown helps you identify an issue by examining the state of the app when it crashed.</span></span>

<span data-ttu-id="be702-116">In der folgenden Tabelle sind die Umgebungsvariablen aufgeführt, die Sie für die Erfassung von Speicherabbildern bei einem Absturz konfigurieren können.</span><span class="sxs-lookup"><span data-stu-id="be702-116">The following table shows the environment variables you can configure for collecting dumps on a crash.</span></span>

|<span data-ttu-id="be702-117">Umgebungsvariable</span><span class="sxs-lookup"><span data-stu-id="be702-117">Environment variable</span></span>|<span data-ttu-id="be702-118">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="be702-118">Description</span></span>|<span data-ttu-id="be702-119">Standardwert</span><span class="sxs-lookup"><span data-stu-id="be702-119">Default value</span></span>|
|-------|---------|---|
|`COMPlus_DbgEnableMiniDump`|<span data-ttu-id="be702-120">Wenn die Variable auf 1 festgelegt ist, wird ein Kernspeicherabbild erstellt.</span><span class="sxs-lookup"><span data-stu-id="be702-120">If set to 1, enable core dump generation.</span></span>|<span data-ttu-id="be702-121">0</span><span class="sxs-lookup"><span data-stu-id="be702-121">0</span></span>|
|`COMPlus_DbgMiniDumpType`|<span data-ttu-id="be702-122">Der Typ des zu erfassenden Speicherabbilds.</span><span class="sxs-lookup"><span data-stu-id="be702-122">Type of dump to be collected.</span></span> <span data-ttu-id="be702-123">Weitere Informationen finden Sie in der Tabelle weiter unten.</span><span class="sxs-lookup"><span data-stu-id="be702-123">For more information, see the table below</span></span>|<span data-ttu-id="be702-124">2 (`MiniDumpWithPrivateReadWriteMemory`)</span><span class="sxs-lookup"><span data-stu-id="be702-124">2 (`MiniDumpWithPrivateReadWriteMemory`)</span></span>|
|`COMPlus_DbgMiniDumpName`|<span data-ttu-id="be702-125">Pfad zu einer Datei, in die das Speicherabbild geschrieben werden soll</span><span class="sxs-lookup"><span data-stu-id="be702-125">Path to a file to write the dump to.</span></span>|`/tmp/coredump.<pid>`|
|`COMPlus_CreateDumpDiagnostics`|<span data-ttu-id="be702-126">Wenn die Variable auf 1 festgelegt ist, wird die Diagnoseprotokollierung des Speicherabbildprozesses aktiviert.</span><span class="sxs-lookup"><span data-stu-id="be702-126">If set to 1, enable diagnostic logging of dump process.</span></span>|<span data-ttu-id="be702-127">0</span><span class="sxs-lookup"><span data-stu-id="be702-127">0</span></span>|

<span data-ttu-id="be702-128">In der folgenden Tabelle sind alle Optionen aufgeführt, die Sie für die Variable `COMPlus_DbgMiniDumpType` verwenden können, die als Wert angegeben werden kann.</span><span class="sxs-lookup"><span data-stu-id="be702-128">The table below shows all the options you may use for `COMPlus_DbgMiniDumpType` which can be specified as a value.</span></span> <span data-ttu-id="be702-129">Wenn Sie `COMPlus_DbgMiniDumpType` z. B. auf 1 festlegen, wird ein Speicherabbild des Typs `MiniDumpNormal` bei einem Absturz erfasst.</span><span class="sxs-lookup"><span data-stu-id="be702-129">For example, setting `COMPlus_DbgMiniDumpType` to 1 means `MiniDumpNormal` type dump will be collected on a crash.</span></span>

|<span data-ttu-id="be702-130">Wert</span><span class="sxs-lookup"><span data-stu-id="be702-130">Value</span></span>|<span data-ttu-id="be702-131">Name</span><span class="sxs-lookup"><span data-stu-id="be702-131">Name</span></span>|<span data-ttu-id="be702-132">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="be702-132">Description</span></span>|
|-----|----|-----------|
|<span data-ttu-id="be702-133">1</span><span class="sxs-lookup"><span data-stu-id="be702-133">1</span></span>|`MiniDumpNormal`|<span data-ttu-id="be702-134">Es werden nur die Informationen aufgenommen, die zum Erfassen von Stapelüberwachungen für alle vorhandenen Threads in einem Prozess erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="be702-134">Include just the information necessary to capture stack traces for all existing threads in a process.</span></span> <span data-ttu-id="be702-135">Heaparbeitsspeicher und -informationen der GC sind eingeschränkt.</span><span class="sxs-lookup"><span data-stu-id="be702-135">Limited GC heap memory and information.</span></span>|
|<span data-ttu-id="be702-136">2</span><span class="sxs-lookup"><span data-stu-id="be702-136">2</span></span>|`MiniDumpWithPrivateReadWriteMemory`|<span data-ttu-id="be702-137">Es werden nur die GC-Heaps und -Informationen aufgenommen, die zum Erfassen von Stapelüberwachungen für alle vorhandenen Threads in einem Prozess erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="be702-137">Includes the GC heaps and information necessary to capture stack traces for all existing threads in a process.</span></span>|
|<span data-ttu-id="be702-138">3</span><span class="sxs-lookup"><span data-stu-id="be702-138">3</span></span>|`MiniDumpFilterTriage`|<span data-ttu-id="be702-139">Es werden nur die Informationen aufgenommen, die zum Erfassen von Stapelüberwachungen für alle vorhandenen Threads in einem Prozess erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="be702-139">Include just the information necessary to capture stack traces for all existing threads in a process.</span></span> <span data-ttu-id="be702-140">Heaparbeitsspeicher und -informationen der GC sind eingeschränkt.</span><span class="sxs-lookup"><span data-stu-id="be702-140">Limited GC heap memory and information.</span></span>|
|<span data-ttu-id="be702-141">4</span><span class="sxs-lookup"><span data-stu-id="be702-141">4</span></span>|`MiniDumpWithFullMemory`|<span data-ttu-id="be702-142">Es wird der gesamte verfügbare Arbeitsspeicher im Prozess aufgenommen.</span><span class="sxs-lookup"><span data-stu-id="be702-142">Include all accessible memory in the process.</span></span> <span data-ttu-id="be702-143">Die Rohdaten des Arbeitsspeichers sind am Ende enthalten, sodass die ursprünglichen Strukturen direkt ohne die unformatierten Arbeitsspeicherinformationen zugeordnet werden können.</span><span class="sxs-lookup"><span data-stu-id="be702-143">The raw memory data is included at the end, so that the initial structures can be mapped directly without the raw memory information.</span></span> <span data-ttu-id="be702-144">Diese Option kann zu einer sehr großen Datei führen.</span><span class="sxs-lookup"><span data-stu-id="be702-144">This option can result in a very large file.</span></span>|

### <a name="collecting-dumps-at-specific-point-in-time"></a><span data-ttu-id="be702-145">Sammeln von Speicherabbildern zu einem bestimmten Zeitpunkt</span><span class="sxs-lookup"><span data-stu-id="be702-145">Collecting dumps at specific point in time</span></span>

<span data-ttu-id="be702-146">Speicherabbilder sollten auch erfasst werden, wenn eine App noch nicht abgestürzt ist.</span><span class="sxs-lookup"><span data-stu-id="be702-146">You may want to collect a dump when the app hasn't crashed yet.</span></span> <span data-ttu-id="be702-147">Wenn Sie z. B. den Zustand einer Anwendung untersuchen möchten, die sich anscheinend in einem Deadlock befindet, ist es nicht hilfreich, Umgebungsvariablen zum Erfassen von Speicherabbildern bei einem Absturz zu konfigurieren, da die App noch immer ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="be702-147">For example, if you want to examine the state of an application that seems to be in a deadlock, configuring the environment variables to collect dumps on crash will not be helpful because the app is still running.</span></span>

<span data-ttu-id="be702-148">Zum Erfassen eines Speicherabbilds zu einem benutzerdefinierten Zeitpunkt können Sie `dotnet-dump` verwenden. Hierbei handelt es sich um ein CLI-Tool zum Erfassen und Analysieren von Speicherabbildern.</span><span class="sxs-lookup"><span data-stu-id="be702-148">To collect dump at your own request, you can use `dotnet-dump`, which is a CLI tool for collecting and analyzing dumps.</span></span> <span data-ttu-id="be702-149">Weitere Informationen zum Erfassen von Speicherabbildern mit `dotnet-dump` finden Sie unter [Hilfsprogramm zu Sammeln und Analysieren von Speicherabbildern](dotnet-dump.md).</span><span class="sxs-lookup"><span data-stu-id="be702-149">For more information on how to use it to collect dumps with `dotnet-dump`, see [Dump collection and analysis utility](dotnet-dump.md).</span></span>

## <a name="analyze-dumps"></a><span data-ttu-id="be702-150">Analysieren von Speicherabbildern</span><span class="sxs-lookup"><span data-stu-id="be702-150">Analyze dumps</span></span>

<span data-ttu-id="be702-151">Sie können Speicherabbilder mithilfe des CLI-Tools [`dotnet-dump`](dotnet-dump.md) oder mithilfe von [Visual Studio](https://docs.microsoft.com/visualstudio/debugger/using-dump-files) analysieren.</span><span class="sxs-lookup"><span data-stu-id="be702-151">You can anlayze dumps using the [`dotnet-dump`](dotnet-dump.md) CLI tool or with [Visual Studio](https://docs.microsoft.com/visualstudio/debugger/using-dump-files).</span></span>

> [!NOTE]
> <span data-ttu-id="be702-152">Mithilfe von Visual Studio, Version 16.8 und höher können Sie [Linux-Speicherabbilder öffnen](https://devblogs.microsoft.com/visualstudio/linux-managed-memory-dump-debugging/), die unter .NET Core 3.1.7 oder höher erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="be702-152">Visual Studio version 16.8 and later allows you to [open Linux dumps](https://devblogs.microsoft.com/visualstudio/linux-managed-memory-dump-debugging/) generated on .NET Core 3.1.7 or later.</span></span>  

> [!NOTE]
> <span data-ttu-id="be702-153">Wenn natives Debuggen erforderlich ist, kann die [SOS-Debuggererweiterung](sos-debugging-extension.md) mit [LLDB unter Linux und macOS](debug-linux-dumps.md#analyze-dumps-on-linux)verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="be702-153">If native debugging is necessary, the [SOS debugger extension](sos-debugging-extension.md) can be used with [LLDB on Linux and macOS](debug-linux-dumps.md#analyze-dumps-on-linux).</span></span> <span data-ttu-id="be702-154">SOS wird auch für [WinDbg/cdb](/windows-hardware/drivers/debugger/debugger-download-tools) unter Windows unterstützt, aber die Verwendung von Visual Studio wird empfohlen.</span><span class="sxs-lookup"><span data-stu-id="be702-154">SOS is also supported with [Windbg/cdb](/windows-hardware/drivers/debugger/debugger-download-tools) on Windows, although Visual Studio is recommended.</span></span>

## <a name="see-also"></a><span data-ttu-id="be702-155">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="be702-155">See also</span></span>

<span data-ttu-id="be702-156">Informieren Sie sich auch darüber, wie Sie mithilfe von Speicherabbildern Probleme in Ihrer .NET-Anwendung diagnostizieren können.</span><span class="sxs-lookup"><span data-stu-id="be702-156">Learn more about how you can leverage dumps to help diagnosing problems in your .NET application.</span></span>

* <span data-ttu-id="be702-157">Im Tutorial [Debuggen von Linux-Speicherabbildern](debug-linux-dumps.md) werden Sie durch das Debuggen eines unter Linux erfassten Speicherabbilds geführt.</span><span class="sxs-lookup"><span data-stu-id="be702-157">[Debug Linux dumps](debug-linux-dumps.md) tutorial walks you through how to debug a dump that was collected in Linux.</span></span>

* <span data-ttu-id="be702-158">Im Tutorial [Debuggen von Deadlocks](debug-deadlock.md) werden Sie durch das Debuggen eines Deadlocks in einer .NET-Anwendung mithilfe von Speicherabbildern geführt.</span><span class="sxs-lookup"><span data-stu-id="be702-158">[Debug deadlock](debug-deadlock.md) tutorial walks you through how to debug a deadlock in your .NET application using dumps.</span></span>
