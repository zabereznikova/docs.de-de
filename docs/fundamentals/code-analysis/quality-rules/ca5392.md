---
title: 'CA5392: Verwenden des defaultdllimportsearchpath-Attributs für P/Aufrufe (Code Analyse)'
description: Enthält Informationen über die Code Analyse Regel CA5392, einschließlich der Gründe, der Behebung von Verstößen und der Zeit, zu der Sie unterdrückt werden soll.
ms.date: 05/28/2020
ms.topic: reference
author: LLLXXXCCC
ms.author: linche
f1_keywords:
- CA5392
ms.openlocfilehash: de78778fa325f9e070d6708ad3a005c41fe5710e
ms.sourcegitcommit: 4f5f1855849cb02c3b610c7006ac21d7429f3348
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/15/2021
ms.locfileid: "98235429"
---
# <a name="ca5392-use-defaultdllimportsearchpaths-attribute-for-pinvokes"></a><span data-ttu-id="89bcd-103">CA5392: DefaultDllImportSearchPaths-Attribut für P/Invokes verwenden.</span><span class="sxs-lookup"><span data-stu-id="89bcd-103">CA5392: Use DefaultDllImportSearchPaths attribute for P/Invokes</span></span>

| | <span data-ttu-id="89bcd-104">Wert</span><span class="sxs-lookup"><span data-stu-id="89bcd-104">Value</span></span> |
|-|-|
| <span data-ttu-id="89bcd-105">**Regel-ID**</span><span class="sxs-lookup"><span data-stu-id="89bcd-105">**Rule ID**</span></span> |<span data-ttu-id="89bcd-106">CA5392</span><span class="sxs-lookup"><span data-stu-id="89bcd-106">CA5392</span></span>|
| <span data-ttu-id="89bcd-107">**Kategorie**</span><span class="sxs-lookup"><span data-stu-id="89bcd-107">**Category**</span></span> |<span data-ttu-id="89bcd-108">Microsoft.Security</span><span class="sxs-lookup"><span data-stu-id="89bcd-108">Microsoft.Security</span></span>|
| <span data-ttu-id="89bcd-109">**Behebung ist unterbrechend oder nicht unterbrechend**</span><span class="sxs-lookup"><span data-stu-id="89bcd-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="89bcd-110">Nicht unterbrechend</span><span class="sxs-lookup"><span data-stu-id="89bcd-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="89bcd-111">Ursache</span><span class="sxs-lookup"><span data-stu-id="89bcd-111">Cause</span></span>

<span data-ttu-id="89bcd-112">Der <xref:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute> ist für eine [Platt Form Aufruf Funktion (P/Aufruf)](../../../standard/native-interop/pinvoke.md) nicht angegeben.</span><span class="sxs-lookup"><span data-stu-id="89bcd-112">The <xref:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute> is not specified for a [Platform Invoke (P/Invoke)](../../../standard/native-interop/pinvoke.md) function.</span></span>

## <a name="rule-description"></a><span data-ttu-id="89bcd-113">Regelbeschreibung</span><span class="sxs-lookup"><span data-stu-id="89bcd-113">Rule description</span></span>

<span data-ttu-id="89bcd-114">Standardmäßig verwenden P/aufrufen Funktionen, indem Sie <xref:System.Runtime.InteropServices.DllImportAttribute> eine Reihe von Verzeichnissen testen, einschließlich des aktuellen Arbeitsverzeichnisses für die zu ladende Bibliothek.</span><span class="sxs-lookup"><span data-stu-id="89bcd-114">By default, P/Invoke functions using <xref:System.Runtime.InteropServices.DllImportAttribute> probe a number of directories, including the current working directory for the library to load.</span></span> <span data-ttu-id="89bcd-115">Dies kann ein Sicherheitsproblem für bestimmte Anwendungen sein, was zu einer DLL-Hijacking-Aktion führt.</span><span class="sxs-lookup"><span data-stu-id="89bcd-115">This can be a security issue for certain applications, leading to DLL hijacking.</span></span>

<span data-ttu-id="89bcd-116">Wenn z. b. eine böswillige dll mit dem gleichen Namen wie die importierte mit dem aktuellen Arbeitsverzeichnis platziert wird, das zuerst standardmäßig durchsucht wird, könnte die schädliche dll geladen werden.</span><span class="sxs-lookup"><span data-stu-id="89bcd-116">For example, if a malicious DLL with the same name as the imported one is placed under the current working directory, which will be searched firstly by default, then the malicious DLL could be loaded.</span></span>

<span data-ttu-id="89bcd-117">Weitere Informationen finden Sie unter [sicheres Laden der Bibliothek](https://msrc-blog.microsoft.com/2014/05/13/load-library-safely/).</span><span class="sxs-lookup"><span data-stu-id="89bcd-117">For more information, see [Load Library Safely](https://msrc-blog.microsoft.com/2014/05/13/load-library-safely/).</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="89bcd-118">Behandeln von Verstößen</span><span class="sxs-lookup"><span data-stu-id="89bcd-118">How to fix violations</span></span>

<span data-ttu-id="89bcd-119">Verwenden <xref:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute> Sie, um den dll-Suchpfad für die Assembly oder die Methode explizit anzugeben.</span><span class="sxs-lookup"><span data-stu-id="89bcd-119">Use <xref:System.Runtime.InteropServices.DefaultDllImportSearchPathsAttribute> to specify the DLL search path explicitly for the assembly or the method.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="89bcd-120">Wann sollten Warnungen unterdrückt werden?</span><span class="sxs-lookup"><span data-stu-id="89bcd-120">When to suppress warnings</span></span>

<span data-ttu-id="89bcd-121">Es ist sicher, diese Regel zu unterdrücken, wenn Folgendes gilt:</span><span class="sxs-lookup"><span data-stu-id="89bcd-121">It's safe to suppress this rule if:</span></span>

- <span data-ttu-id="89bcd-122">Sie sind sicher, dass die geladene Assembly die gewünschte ist.</span><span class="sxs-lookup"><span data-stu-id="89bcd-122">You're sure the loaded assembly is what you want.</span></span> <span data-ttu-id="89bcd-123">Beispielsweise wird Ihre Anwendung auf einem vertrauenswürdigen Server ausgeführt, und Sie vertrauen den Dateien vollständig.</span><span class="sxs-lookup"><span data-stu-id="89bcd-123">For example, your application runs on a trusted server and you completely trust the files.</span></span>
- <span data-ttu-id="89bcd-124">Die importierte Assembly ist eine häufig verwendete Systemassembly, wie z. b. user32.dll, und die Suchpfad-Strategie folgt dem [bekannten DLLs-Mechanismus](/archive/blogs/larryosterman/what-are-known-dlls-anyway).</span><span class="sxs-lookup"><span data-stu-id="89bcd-124">The imported assembly is a commonly used system assembly, like user32.dll, and the search path strategy follows the [Known DLLs mechanism](/archive/blogs/larryosterman/what-are-known-dlls-anyway).</span></span>

## <a name="pseudo-code-examples"></a><span data-ttu-id="89bcd-125">Pseudo Codebeispiele</span><span class="sxs-lookup"><span data-stu-id="89bcd-125">Pseudo-code examples</span></span>

```csharp
using System;
using System.Runtime.InteropServices;

class ExampleClass
{
    [DllImport("The3rdAssembly.dll")]
    public static extern int MessageBox(IntPtr hWnd, String text, String caption, uint type);

    public void ExampleMethod()
    {
        MessageBox(new IntPtr(0), "Hello World!", "Hello Dialog", 0);
    }
}
```

### <a name="solution"></a><span data-ttu-id="89bcd-126">Lösung</span><span class="sxs-lookup"><span data-stu-id="89bcd-126">Solution</span></span>

```csharp
using System;
using System.Runtime.InteropServices;

class ExampleClass
{
    [DllImport("The3rdAssembly.dll")]
    [DefaultDllImportSearchPaths(DllImportSearchPath.UserDirectories)]
    public static extern int MessageBox(IntPtr hWnd, String text, String caption, uint type);

    public void ExampleMethod()
    {
        MessageBox(new IntPtr(0), "Hello World!", "Hello Dialog", 0);
    }
}
```

## <a name="related-rules"></a><span data-ttu-id="89bcd-127">Verwandte Regeln</span><span class="sxs-lookup"><span data-stu-id="89bcd-127">Related rules</span></span>

[<span data-ttu-id="89bcd-128">CA5393: Keinen unsicheren DllImportSearchPath-Wert verwenden.</span><span class="sxs-lookup"><span data-stu-id="89bcd-128">CA5393: Do not use unsafe DllImportSearchPath value</span></span>](ca5393.md)
