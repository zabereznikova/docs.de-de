---
title: 'CA2213: Verwerfbare Felder müssen verworfen werden (Code Analyse)'
description: 'Weitere Informationen zur Code Analyse Regel CA2213: Verwerfbare Felder müssen verworfen werden'
ms.date: 05/14/2019
ms.topic: reference
f1_keywords:
- DisposableFieldsShouldBeDisposed
- CA2213
helpviewer_keywords:
- CA2213
- DisposableFieldsShouldBeDisposed
author: gewarren
ms.author: gewarren
ms.openlocfilehash: 8b5710424785c2279b05483c242635986fab8cb3
ms.sourcegitcommit: 636af37170ae75a11c4f7d1ecd770820e7dfe7bd
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/07/2020
ms.locfileid: "96591794"
---
# <a name="ca2213-disposable-fields-should-be-disposed"></a><span data-ttu-id="53396-103">CA2213: Verwerfbare Felder verwerfen.</span><span class="sxs-lookup"><span data-stu-id="53396-103">CA2213: Disposable fields should be disposed</span></span>

| | <span data-ttu-id="53396-104">Wert</span><span class="sxs-lookup"><span data-stu-id="53396-104">Value</span></span> |
|-|-|
| <span data-ttu-id="53396-105">**Regel-ID**</span><span class="sxs-lookup"><span data-stu-id="53396-105">**Rule ID**</span></span> |<span data-ttu-id="53396-106">CA2213</span><span class="sxs-lookup"><span data-stu-id="53396-106">CA2213</span></span>|
| <span data-ttu-id="53396-107">**Kategorie**</span><span class="sxs-lookup"><span data-stu-id="53396-107">**Category**</span></span> |<span data-ttu-id="53396-108">Microsoft. Usage</span><span class="sxs-lookup"><span data-stu-id="53396-108">Microsoft.Usage</span></span>|
| <span data-ttu-id="53396-109">**Behebung ist unterbrechend oder nicht unterbrechend**</span><span class="sxs-lookup"><span data-stu-id="53396-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="53396-110">Nicht unterbrechend</span><span class="sxs-lookup"><span data-stu-id="53396-110">Non-breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="53396-111">Ursache</span><span class="sxs-lookup"><span data-stu-id="53396-111">Cause</span></span>

<span data-ttu-id="53396-112">Ein Typ, der implementiert, <xref:System.IDisposable?displayProperty=fullName> deklariert Felder mit Typen, die ebenfalls implementieren <xref:System.IDisposable> .</span><span class="sxs-lookup"><span data-stu-id="53396-112">A type that implements <xref:System.IDisposable?displayProperty=fullName> declares fields that are of types that also implement <xref:System.IDisposable>.</span></span> <span data-ttu-id="53396-113">Die- <xref:System.IDisposable.Dispose%2A> Methode des-Felds wird nicht von der- <xref:System.IDisposable.Dispose%2A> Methode des deklarierenden Typs aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="53396-113">The <xref:System.IDisposable.Dispose%2A> method of the field is not called by the <xref:System.IDisposable.Dispose%2A> method of the declaring type.</span></span>

## <a name="rule-description"></a><span data-ttu-id="53396-114">Regelbeschreibung</span><span class="sxs-lookup"><span data-stu-id="53396-114">Rule description</span></span>

<span data-ttu-id="53396-115">Ein Typ ist für die Freigabe aller nicht verwalteten Ressourcen zuständig.</span><span class="sxs-lookup"><span data-stu-id="53396-115">A type is responsible for disposing of all its unmanaged resources.</span></span> <span data-ttu-id="53396-116">Rule CA2213 prüft, ob ein verwerfbarer Typ (d. h. ein Typ <xref:System.IDisposable> , `T` der implementiert) ein Feld deklariert `F` , das eine Instanz eines verwerfbaren Typs ist `FT` .</span><span class="sxs-lookup"><span data-stu-id="53396-116">Rule CA2213 checks to see whether a disposable type (that is, one that implements <xref:System.IDisposable>) `T` declares a field `F` that is an instance of a disposable type `FT`.</span></span> <span data-ttu-id="53396-117">Für jedes Feld, dem `F` ein lokal erstelltes Objekt innerhalb der Methoden oder Initialisierer des enthaltenden Typs zugewiesen `T` wird, versucht die Regel, einen-Rückruf zu suchen `FT.Dispose` .</span><span class="sxs-lookup"><span data-stu-id="53396-117">For each field `F` that's assigned a locally created object within the methods or initializers of the containing type `T`, the rule attempts to locate a call to `FT.Dispose`.</span></span> <span data-ttu-id="53396-118">Die-Regel durchsucht die Methoden, die von aufgerufen werden, `T.Dispose` und eine Ebene niedriger (d. h. die Methoden, die von den von aufgerufenen Methoden aufgerufen werden `T.Dispose`</span><span class="sxs-lookup"><span data-stu-id="53396-118">The rule searches the methods called by `T.Dispose` and one level lower (that is, the methods called by the methods called by `T.Dispose`).</span></span>

> [!NOTE]
> <span data-ttu-id="53396-119">Mit Ausnahme der [Sonderfälle](#special-cases)wird Regel CA2213 nur für Felder ausgelöst, denen ein lokal erstelltes verwerfbares Objekt innerhalb der Methoden und Initialisierer des enthaltenden Typs zugewiesen wird.</span><span class="sxs-lookup"><span data-stu-id="53396-119">Other than the [special cases](#special-cases), rule CA2213 fires only for fields that are assigned a locally created disposable object within the containing type's methods and initializers.</span></span> <span data-ttu-id="53396-120">Wenn das Objekt erstellt oder außerhalb des Typs zugewiesen wird `T` , wird die Regel nicht ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="53396-120">If the object is created or assigned outside of type `T`, the rule does not fire.</span></span> <span data-ttu-id="53396-121">Dies reduziert das Rauschen in Fällen, in denen der enthaltende Typ nicht die Verantwortung für die Freigabe des Objekts übernimmt.</span><span class="sxs-lookup"><span data-stu-id="53396-121">This reduces noise for cases where the containing type doesn't own the responsibility for disposing of the object.</span></span>

## <a name="special-cases"></a><span data-ttu-id="53396-122">Spezialfälle</span><span class="sxs-lookup"><span data-stu-id="53396-122">Special cases</span></span>

<span data-ttu-id="53396-123">Regel CA2213 kann auch für Felder der folgenden Typen ausgelöst werden, auch wenn das Objekt, dem Sie zugewiesen sind, nicht lokal erstellt wurde:</span><span class="sxs-lookup"><span data-stu-id="53396-123">Rule CA2213 can also fire for fields of the following types even if the object they're assigned isn't created locally:</span></span>

- <xref:System.IO.Stream?displayProperty=nameWithType>
- <xref:System.IO.TextReader?displayProperty=nameWithType>
- <xref:System.IO.TextWriter?displayProperty=nameWithType>
- <xref:System.Resources.IResourceReader?displayProperty=nameWithType>

<span data-ttu-id="53396-124">Wenn Sie ein Objekt eines dieser Typen an einen Konstruktor übergeben und dann einem Feld zuweisen, wird eine Freigabe *Besitz Übertragung* an den neu erstellten Typ angegeben.</span><span class="sxs-lookup"><span data-stu-id="53396-124">Passing an object of one of these types to a constructor and then assigning it to a field indicates a *dispose ownership transfer* to the newly constructed type.</span></span> <span data-ttu-id="53396-125">Das heißt, der neu konstruierte Typ ist nun für das Freigeben des Objekts verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="53396-125">That is, the newly constructed type is now responsible for disposing of the object.</span></span> <span data-ttu-id="53396-126">Wenn das Objekt nicht verworfen wird, tritt ein Verstoß gegen CA2213 auf.</span><span class="sxs-lookup"><span data-stu-id="53396-126">If the object is not disposed, a violation of CA2213 occurs.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="53396-127">Behandeln von Verstößen</span><span class="sxs-lookup"><span data-stu-id="53396-127">How to fix violations</span></span>

<span data-ttu-id="53396-128">Um einen Verstoß gegen diese Regel zu beheben, müssen Sie <xref:System.IDisposable.Dispose%2A> für Felder mit Typen abrufen, die implementieren <xref:System.IDisposable> .</span><span class="sxs-lookup"><span data-stu-id="53396-128">To fix a violation of this rule, call <xref:System.IDisposable.Dispose%2A> on fields that are of types that implement <xref:System.IDisposable>.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="53396-129">Wann sollten Warnungen unterdrückt werden?</span><span class="sxs-lookup"><span data-stu-id="53396-129">When to suppress warnings</span></span>

<span data-ttu-id="53396-130">Es ist sicher, eine Warnung aus dieser Regel zu unterdrücken, wenn Folgendes gilt:</span><span class="sxs-lookup"><span data-stu-id="53396-130">It's safe to suppress a warning from this rule if:</span></span>

- <span data-ttu-id="53396-131">Der gekennzeichnete Typ ist nicht für die Freigabe der Ressource zuständig, die im Feld gehalten wird (d. h., der Typ hat keinen Freigabe *Besitz*).</span><span class="sxs-lookup"><span data-stu-id="53396-131">The flagged type is not responsible for releasing the resource held by the field (that is, the type does not have *dispose ownership*)</span></span>
- <span data-ttu-id="53396-132">Der Aufruf von <xref:System.IDisposable.Dispose%2A> tritt auf einer tieferen Aufruf Ebene auf als die Regel Überprüfungen.</span><span class="sxs-lookup"><span data-stu-id="53396-132">The call to <xref:System.IDisposable.Dispose%2A> occurs at a deeper calling level than the rule checks</span></span>
- <span data-ttu-id="53396-133">der Freigabe Besitz der Felder wird nicht vom enthaltenden Typ gehalten.</span><span class="sxs-lookup"><span data-stu-id="53396-133">the dispose ownership of the field(s) is not held by the containing type.</span></span>

## <a name="example"></a><span data-ttu-id="53396-134">Beispiel</span><span class="sxs-lookup"><span data-stu-id="53396-134">Example</span></span>

<span data-ttu-id="53396-135">Der folgende Code Ausschnitt zeigt einen Typ `TypeA` , der implementiert <xref:System.IDisposable> .</span><span class="sxs-lookup"><span data-stu-id="53396-135">The following snippet shows a type `TypeA` that implements <xref:System.IDisposable>.</span></span>

:::code language="csharp" source="snippets/csharp/all-rules/ca2213.cs" id="snippet1":::

<span data-ttu-id="53396-136">Der folgende Code Ausschnitt zeigt einen Typ `TypeB` , der die Regel CA2213 verletzt, indem er ein Feld als verwerfbaren `aFieldOfADisposableType` Typ ( `TypeA` ) deklariert und nicht <xref:System.IDisposable.Dispose%2A> für das Feld aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="53396-136">The following snippet shows a type `TypeB` that violates rule CA2213 by declaring a field `aFieldOfADisposableType` as a disposable type (`TypeA`) and not calling <xref:System.IDisposable.Dispose%2A> on the field.</span></span>

:::code language="csharp" source="snippets/csharp/all-rules/ca2213.cs" id="snippet2":::

<span data-ttu-id="53396-137">Um die Verletzung zu beheben, müssen Sie für das verwerfbare Feld aufzurufen `Dispose()` :</span><span class="sxs-lookup"><span data-stu-id="53396-137">To fix the violation, call `Dispose()` on the disposable field:</span></span>

```csharp
protected virtual void Dispose(bool disposing)
{
   if (!disposed)
   {
      // Dispose of resources held by this instance.
      aFieldOfADisposableType.Dispose();

      disposed = true;

      // Suppress finalization of this disposed instance.
      if (disposing)
      {
          GC.SuppressFinalize(this);
      }
   }
}
```

## <a name="see-also"></a><span data-ttu-id="53396-138">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="53396-138">See also</span></span>

- <xref:System.IDisposable?displayProperty=fullName>
- [<span data-ttu-id="53396-139">Muster verwerfen</span><span class="sxs-lookup"><span data-stu-id="53396-139">Dispose pattern</span></span>](../../../standard/garbage-collection/implementing-dispose.md)
