---
title: 'CA1045: Typen nicht als Verweis übergeben (Code Analyse)'
description: 'Weitere Informationen zur Code Analyse Regel CA1045: Typen nicht als Verweis übergeben'
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- CA1045
- DoNotPassTypesByReference
helpviewer_keywords:
- CA1045
- DoNotPassTypesByReference
author: gewarren
ms.author: gewarren
ms.openlocfilehash: 475e62a2abbab7c071e3b5d51b2ada5227111eaa
ms.sourcegitcommit: 2e4adc490c1d2a705a0592b295d606b10b9f51f1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/25/2020
ms.locfileid: "96591434"
---
# <a name="ca1045-do-not-pass-types-by-reference"></a><span data-ttu-id="5a1ad-103">CA1045: Typen nicht als Verweis übergeben.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-103">CA1045: Do not pass types by reference</span></span>

| | <span data-ttu-id="5a1ad-104">Wert</span><span class="sxs-lookup"><span data-stu-id="5a1ad-104">Value</span></span> |
|-|-|
| <span data-ttu-id="5a1ad-105">**Regel-ID**</span><span class="sxs-lookup"><span data-stu-id="5a1ad-105">**Rule ID**</span></span> |<span data-ttu-id="5a1ad-106">CA1045</span><span class="sxs-lookup"><span data-stu-id="5a1ad-106">CA1045</span></span>|
| <span data-ttu-id="5a1ad-107">**Kategorie**</span><span class="sxs-lookup"><span data-stu-id="5a1ad-107">**Category**</span></span> |<span data-ttu-id="5a1ad-108">Microsoft. Design</span><span class="sxs-lookup"><span data-stu-id="5a1ad-108">Microsoft.Design</span></span>|
| <span data-ttu-id="5a1ad-109">**Behebung ist unterbrechend oder nicht unterbrechend**</span><span class="sxs-lookup"><span data-stu-id="5a1ad-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="5a1ad-110">Breaking</span><span class="sxs-lookup"><span data-stu-id="5a1ad-110">Breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="5a1ad-111">Ursache</span><span class="sxs-lookup"><span data-stu-id="5a1ad-111">Cause</span></span>

<span data-ttu-id="5a1ad-112">Eine öffentliche oder geschützte Methode in einem öffentlichen Typ verfügt über einen `ref` Parameter, der einen primitiven Typ, einen Verweistyp oder einen Werttyp annimmt, bei dem es sich nicht um einen der integrierten Typen handelt.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-112">A public or protected method in a public type has a `ref` parameter that takes a primitive type, a reference type, or a value type that is not one of the built-in types.</span></span>

## <a name="rule-description"></a><span data-ttu-id="5a1ad-113">Regelbeschreibung</span><span class="sxs-lookup"><span data-stu-id="5a1ad-113">Rule description</span></span>

<span data-ttu-id="5a1ad-114">Die Übergabe von Typen als Verweis (mit `out` oder `ref` ) erfordert die Verwendung von Zeigern, das Verständnis der Unterschiede zwischen Werttypen und Verweis Typen sowie die Behandlung von Methoden mit mehreren Rückgabe Werten.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-114">Passing types by reference (using `out` or `ref`) requires experience with pointers, understanding how value types and reference types differ, and handling methods that have multiple return values.</span></span> <span data-ttu-id="5a1ad-115">Außerdem wird der Unterschied zwischen `out` -und- `ref` Parametern nicht häufig verstanden.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-115">Also, the difference between `out` and `ref` parameters is not widely understood.</span></span>

<span data-ttu-id="5a1ad-116">Wenn ein Verweistyp als Verweis übergeben wird, beabsichtigt die Methode, den-Parameter zu verwenden, um eine andere Instanz des Objekts zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-116">When a reference type is passed "by reference," the method intends to use the parameter to return a different instance of the object.</span></span> <span data-ttu-id="5a1ad-117">(Die Übergabe eines Verweis Typs als Verweis wird auch als Verwendung eines doppelten Zeigers, Zeiger auf einen Zeiger oder doppelte Dereferenzierung bezeichnet.) Mit der Standard Aufruf Konvention, die als Wert übergeben wird, erhält ein Parameter, der einen Verweistyp annimmt, bereits einen Zeiger auf das Objekt.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-117">(Passing a reference type by reference is also known as using a double pointer, pointer to a pointer, or double indirection.) Using the default calling convention, which is pass "by value," a parameter that takes a reference type already receives a pointer to the object.</span></span> <span data-ttu-id="5a1ad-118">Der Zeiger, nicht das Objekt, auf das es verweist, wird als Wert übermittelt.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-118">The pointer, not the object to which it points, is passed by value.</span></span> <span data-ttu-id="5a1ad-119">Das übergeben nach Wert bedeutet, dass die Methode den Zeiger nicht ändern kann, damit Sie auf eine neue Instanz des Verweis Typs verweist, kann jedoch den Inhalt des Objekts ändern, auf das es verweist.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-119">Passing by value means that the method cannot change the pointer to have it point to a new instance of the reference type, but can change the contents of the object to which it points.</span></span> <span data-ttu-id="5a1ad-120">Dies ist für die meisten Anwendungen ausreichend und liefert das gewünschte Verhalten.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-120">For most applications this is sufficient and yields the behavior that you want.</span></span>

<span data-ttu-id="5a1ad-121">Wenn eine Methode eine andere Instanz zurückgeben muss, verwenden Sie den Rückgabewert der-Methode, um dies zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-121">If a method must return a different instance, use the return value of the method to accomplish this.</span></span> <span data-ttu-id="5a1ad-122">Eine Reihe <xref:System.String?displayProperty=fullName> von Methoden, die mit Zeichen folgen arbeiten und eine neue Instanz einer Zeichenfolge zurückgeben, finden Sie unter der-Klasse.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-122">See the <xref:System.String?displayProperty=fullName> class for a variety of methods that operate on strings and return a new instance of a string.</span></span> <span data-ttu-id="5a1ad-123">Wenn dieses Modell verwendet wird, wird es dem Aufrufer überlassen, zu entscheiden, ob das ursprüngliche Objekt beibehalten wird.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-123">By using this model, it is left to the caller to decide whether the original object is preserved.</span></span>

<span data-ttu-id="5a1ad-124">Obwohl Rückgabewerte alltäglich und stark verwendet werden, sind für die korrekte Anwendung von `out` -und- `ref` Parametern zwischen Entwurfs-und Codierungs Fähigkeiten erforderlich.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-124">Although return values are commonplace and heavily used, the correct application of `out` and `ref` parameters requires intermediate design and coding skills.</span></span> <span data-ttu-id="5a1ad-125">Bibliotheks Architekten, die für eine allgemeine Zielgruppe entwerfen, sollten nicht erwarten, dass Benutzer die Arbeit mit- `out` oder- `ref` Parametern meistern.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-125">Library architects who design for a general audience should not expect users to master working with `out` or `ref` parameters.</span></span>

> [!NOTE]
> <span data-ttu-id="5a1ad-126">Wenn Sie mit Parametern arbeiten, die große Strukturen darstellen, können die zusätzlichen Ressourcen, die erforderlich sind, um diese Strukturen zu kopieren, beim übergeben nach Wert einen Leistungs Effekt verursachen.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-126">When you work with parameters that are large structures, the additional resources that are required to copy these structures could cause a performance effect when you pass by value.</span></span> <span data-ttu-id="5a1ad-127">In diesen Fällen können Sie die Verwendung der `ref` Parameter oder in Erwägung gezogen `out` .</span><span class="sxs-lookup"><span data-stu-id="5a1ad-127">In these cases, you might consider using `ref` or `out` parameters.</span></span>

## <a name="how-to-fix-violations"></a><span data-ttu-id="5a1ad-128">Behandeln von Verstößen</span><span class="sxs-lookup"><span data-stu-id="5a1ad-128">How to fix violations</span></span>

<span data-ttu-id="5a1ad-129">Um einen Verstoß gegen diese Regel zu beheben, der durch einen Werttyp verursacht wird, lassen Sie die Methode das Objekt als Rückgabewert zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-129">To fix a violation of this rule that is caused by a value type, have the method return the object as its return value.</span></span> <span data-ttu-id="5a1ad-130">Wenn die Methode mehrere Werte zurückgeben muss, entwerfen Sie Sie so um, dass eine einzelne Instanz eines Objekts zurückgegeben wird, das die Werte enthält.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-130">If the method must return multiple values, redesign it to return a single instance of an object that holds the values.</span></span>

<span data-ttu-id="5a1ad-131">Um einen Verstoß gegen diese Regel zu beheben, der durch einen Verweistyp verursacht wird, stellen Sie sicher, dass das gewünschte Verhalten eine neue Instanz des Verweises zurückgeben soll.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-131">To fix a violation of this rule that is caused by a reference type, make sure that the behavior that you want is to return a new instance of the reference.</span></span> <span data-ttu-id="5a1ad-132">Wenn dies der Fall ist, sollte die Methode ihren Rückgabewert verwenden, um dies zu tun.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-132">If it is, the method should use its return value to do this.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="5a1ad-133">Wann sollten Warnungen unterdrückt werden?</span><span class="sxs-lookup"><span data-stu-id="5a1ad-133">When to suppress warnings</span></span>

<span data-ttu-id="5a1ad-134">Es ist sicher, eine Warnung aus dieser Regel zu unterdrücken. Dieser Entwurf kann jedoch Probleme mit der Benutzerfreundlichkeit verursachen.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-134">It is safe to suppress a warning from this rule; however, this design could cause usability issues.</span></span>

## <a name="configurability"></a><span data-ttu-id="5a1ad-135">Konfigurierbarkeit</span><span class="sxs-lookup"><span data-stu-id="5a1ad-135">Configurability</span></span>

<span data-ttu-id="5a1ad-136">Ab Version 3.0.0 des Analyzer-Pakets können Sie basierend auf ihrer Barrierefreiheit konfigurieren, für welche Teile Ihrer Codebasis diese Regel ausgeführt werden soll.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-136">Starting with version 3.0.0 of the analyzer package, You can configure which parts of your codebase to run this rule on, based on their accessibility.</span></span> <span data-ttu-id="5a1ad-137">Um z. b. anzugeben, dass die Regel nur für die nicht öffentliche API-Oberfläche ausgeführt werden soll, fügen Sie das folgende Schlüssel-Wert-Paar in eine *Editor config* -Datei in Ihrem Projekt ein:</span><span class="sxs-lookup"><span data-stu-id="5a1ad-137">For example, to specify that the rule should run only against the non-public API surface, add the following key-value pair to an *.editorconfig* file in your project:</span></span>

```ini
dotnet_code_quality.ca1045.api_surface = private, internal
```

<span data-ttu-id="5a1ad-138">Sie können diese Option nur für diese Regel, für alle Regeln oder für alle Regeln in dieser Kategorie (Entwurf) konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-138">You can configure this option for just this rule, for all rules, or for all rules in this category (Design).</span></span> <span data-ttu-id="5a1ad-139">Weitere Informationen finden Sie unter [Konfigurationsoptionen für die Code Qualitäts Regel](../code-quality-rule-options.md).</span><span class="sxs-lookup"><span data-stu-id="5a1ad-139">For more information, see [Code quality rule configuration options](../code-quality-rule-options.md).</span></span>

## <a name="example"></a><span data-ttu-id="5a1ad-140">Beispiel</span><span class="sxs-lookup"><span data-stu-id="5a1ad-140">Example</span></span>

<span data-ttu-id="5a1ad-141">Die folgende Bibliothek zeigt zwei Implementierungen einer-Klasse, die Antworten auf das Feedback des Benutzers generiert.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-141">The following library shows two implementations of a class that generates responses to the feedback of the user.</span></span> <span data-ttu-id="5a1ad-142">Die erste Implementierung ( `BadRefAndOut` ) zwingt den Bibliotheks Benutzer, drei Rückgabewerte zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-142">The first implementation (`BadRefAndOut`) forces the library user to manage three return values.</span></span> <span data-ttu-id="5a1ad-143">Die zweite Implementierung ( `RedesignedRefAndOut` ) vereinfacht die Benutzer Leistung durch die Rückgabe einer Instanz einer Container Klasse ( `ReplyData` ), die die Daten als einzelne Einheit verwaltet.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-143">The second implementation (`RedesignedRefAndOut`) simplifies the user experience by returning an instance of a container class (`ReplyData`) that manages the data as a single unit.</span></span>

:::code language="csharp" source="snippets/csharp/all-rules/ca1045.cs" id="snippet1":::

## <a name="example-1"></a><span data-ttu-id="5a1ad-144">Beispiel 1</span><span class="sxs-lookup"><span data-stu-id="5a1ad-144">Example 1</span></span>

<span data-ttu-id="5a1ad-145">Die folgende Anwendung veranschaulicht die Benutzeroberflächen Darstellung.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-145">The following application illustrates the experience of the user.</span></span> <span data-ttu-id="5a1ad-146">Der-Befehl für die neu gestaltete Bibliothek ( `UseTheSimplifiedClass` -Methode) ist einfacher, und die von der-Methode zurückgegebenen Informationen können problemlos verwaltet werden.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-146">The call to the redesigned library (`UseTheSimplifiedClass` method) is more straightforward, and the information that is returned by the method is easily managed.</span></span> <span data-ttu-id="5a1ad-147">Die Ausgabe der beiden Methoden ist identisch.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-147">The output from the two methods is identical.</span></span>

:::code language="csharp" source="snippets/csharp/all-rules/ca1045.cs" id="snippet2":::

## <a name="example-2"></a><span data-ttu-id="5a1ad-148">Beispiel 2</span><span class="sxs-lookup"><span data-stu-id="5a1ad-148">Example 2</span></span>

<span data-ttu-id="5a1ad-149">Die folgende Beispiel Bibliothek veranschaulicht `ref` , wie Parameter für Verweis Typen verwendet werden, und zeigt eine bessere Möglichkeit, diese Funktionalität zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-149">The following example library illustrates how `ref` parameters for reference types are used, and shows a better way to implement this functionality.</span></span>

:::code language="csharp" source="snippets/csharp/all-rules/ca1045.cs" id="snippet3":::

## <a name="example-3"></a><span data-ttu-id="5a1ad-150">Beispiel 3</span><span class="sxs-lookup"><span data-stu-id="5a1ad-150">Example 3</span></span>

<span data-ttu-id="5a1ad-151">Die folgende Anwendung ruft jede Methode in der Bibliothek auf, um das Verhalten zu veranschaulichen.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-151">The following application calls each method in the library to demonstrate the behavior.</span></span>

:::code language="csharp" source="snippets/csharp/all-rules/ca1045.cs" id="snippet4":::

<span data-ttu-id="5a1ad-152">Dieses Beispiel erzeugt die folgende Ausgabe:</span><span class="sxs-lookup"><span data-stu-id="5a1ad-152">This example produces the following output:</span></span>

```txt
Changing pointer - passed by value:
12345
12345
Changing pointer - passed by reference:
12345
12345 ABCDE
Passing by return value:
12345 ABCDE
```

## <a name="related-rules"></a><span data-ttu-id="5a1ad-153">Verwandte Regeln</span><span class="sxs-lookup"><span data-stu-id="5a1ad-153">Related rules</span></span>

[<span data-ttu-id="5a1ad-154">CA1021: out-Parameter vermeiden.</span><span class="sxs-lookup"><span data-stu-id="5a1ad-154">CA1021: Avoid out parameters</span></span>](ca1021.md)
