---
title: Empfohlene Vorgehensweisen für Beobachterentwurfsmuster
ms.date: 03/30/2017
helpviewer_keywords:
- observer design pattern [.NET], best practices
- best practices [.NET], observer design pattern
ms.assetid: c834760f-ddd4-417f-abb7-a059679d5b8c
ms.openlocfilehash: 48a9bb49be20bbedbaa19d622aabfd18affe39bd
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/18/2020
ms.locfileid: "94828256"
---
# <a name="observer-design-pattern-best-practices"></a><span data-ttu-id="42635-102">Empfohlene Vorgehensweisen für Beobachterentwurfsmuster</span><span class="sxs-lookup"><span data-stu-id="42635-102">Observer Design Pattern Best Practices</span></span>

<span data-ttu-id="42635-103">In .NET wird das Beobachterentwurfsmuster als eine Reihe von Schnittstellen implementiert.</span><span class="sxs-lookup"><span data-stu-id="42635-103">In .NET, the observer design pattern is implemented as a set of interfaces.</span></span> <span data-ttu-id="42635-104">Die <xref:System.IObservable%601?displayProperty=nameWithType>-Schnittstelle stellt den Datenanbieter dar, der auch für die Bereitstellung einer <xref:System.IDisposable>-Implementierung verantwortlich ist, mit der Beobachter Benachrichtigungsabonnements kündigen können.</span><span class="sxs-lookup"><span data-stu-id="42635-104">The <xref:System.IObservable%601?displayProperty=nameWithType> interface represents the data provider, which is also responsible for providing an <xref:System.IDisposable> implementation that lets observers unsubscribe from notifications.</span></span> <span data-ttu-id="42635-105">Die <xref:System.IObserver%601?displayProperty=nameWithType>-Schnittstelle stellt den Beobachter dar.</span><span class="sxs-lookup"><span data-stu-id="42635-105">The <xref:System.IObserver%601?displayProperty=nameWithType> interface represents the observer.</span></span> <span data-ttu-id="42635-106">Dieses Thema beschreibt die empfohlenen Vorgehensweisen, die Entwickler befolgen sollten, wenn sie das Beobachterentwurfsmuster unter Verwendung dieser Schnittstellen implementieren.</span><span class="sxs-lookup"><span data-stu-id="42635-106">This topic describes the best practices that developers should follow when implementing the observer design pattern using these interfaces.</span></span>  
  
## <a name="threading"></a><span data-ttu-id="42635-107">Threading</span><span class="sxs-lookup"><span data-stu-id="42635-107">Threading</span></span>  
 <span data-ttu-id="42635-108">In der Regel implementiert ein Anbieter die <xref:System.IObservable%601.Subscribe%2A?displayProperty=nameWithType>-Methode, indem er einen bestimmten Beobachter einer Abonnentenliste hinzufügt, die durch ein Auflistungsobjekt dargestellt wird, und implementiert die <xref:System.IDisposable.Dispose%2A?displayProperty=nameWithType>-Methode, indem ein bestimmten Beobachter aus der Abonnentenliste entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="42635-108">Typically, a provider implements the <xref:System.IObservable%601.Subscribe%2A?displayProperty=nameWithType> method by adding a particular observer to a subscriber list that is represented by some collection object, and it implements the <xref:System.IDisposable.Dispose%2A?displayProperty=nameWithType> method by removing a particular observer from the subscriber list.</span></span> <span data-ttu-id="42635-109">Ein Beobachter kann diese Methoden jederzeit aufrufen.</span><span class="sxs-lookup"><span data-stu-id="42635-109">An observer can call these methods at any time.</span></span> <span data-ttu-id="42635-110">Da der Anbieter/Beobachter-Vertrag außerdem nicht angibt, wer für das Kündigen nach der <xref:System.IObserver%601.OnCompleted%2A?displayProperty=nameWithType>-Callbackmethode verantwortlich ist, können der Anbieter und der Beobachter beide versuchen, denselben Member aus der Liste zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="42635-110">In addition, because the provider/observer contract does not specify who is responsible for unsubscribing after the <xref:System.IObserver%601.OnCompleted%2A?displayProperty=nameWithType> callback method, the provider and observer may both try to remove the same member from the list.</span></span> <span data-ttu-id="42635-111">Aufgrund dieser Möglichkeit sollten die <xref:System.IObservable%601.Subscribe%2A>- und die <xref:System.IDisposable.Dispose%2A>-Methode threadsicher sein.</span><span class="sxs-lookup"><span data-stu-id="42635-111">Because of this possibility, both the <xref:System.IObservable%601.Subscribe%2A> and <xref:System.IDisposable.Dispose%2A> methods should be thread-safe.</span></span> <span data-ttu-id="42635-112">In der Regel umfasst dies die Verwendung einer [gleichzeitigen Auflistung](../parallel-programming/data-structures-for-parallel-programming.md) oder eine Sperre.</span><span class="sxs-lookup"><span data-stu-id="42635-112">Typically, this involves using a [concurrent collection](../parallel-programming/data-structures-for-parallel-programming.md) or a lock.</span></span> <span data-ttu-id="42635-113">Für Implementierungen, die nicht threadsicher sind, sollte dies explizit dokumentiert werden.</span><span class="sxs-lookup"><span data-stu-id="42635-113">Implementations that are not thread-safe should explicitly document that they are not.</span></span>  
  
 <span data-ttu-id="42635-114">Alle weiteren Garantien müssen in einer Ebene über dem Anbieter/Beobachter-Vertrag angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="42635-114">Any additional guarantees have to be specified in a layer on top of the provider/observer contract.</span></span> <span data-ttu-id="42635-115">Implementierer sollten klar kommunizieren, wenn sie zusätzliche Anforderungen auferlegen, um Verwirrungen der Benutzer zum Beobachtervertrag zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="42635-115">Implementers should clearly call out when they impose additional requirements to avoid user confusion about the observer contract.</span></span>  
  
## <a name="handling-exceptions"></a><span data-ttu-id="42635-116">Behandeln von Ausnahmen</span><span class="sxs-lookup"><span data-stu-id="42635-116">Handling Exceptions</span></span>  
 <span data-ttu-id="42635-117">Aufgrund der losen Kopplung zwischen einem Datenanbieter und einem Beobachter sollen Ausnahmen im Beobachterentwurfsmuster nur der Information dienen.</span><span class="sxs-lookup"><span data-stu-id="42635-117">Because of the loose coupling between a data provider and an observer, exceptions in the observer design pattern are intended to be informational.</span></span> <span data-ttu-id="42635-118">Dies beeinflusst das Verarbeiten von Ausnahmen im Beobachterentwurfsmuster durch Anbieter und Beobachter.</span><span class="sxs-lookup"><span data-stu-id="42635-118">This affects how providers and observers handle exceptions in the observer design pattern.</span></span>  
  
### <a name="the-provider----calling-the-onerror-method"></a><span data-ttu-id="42635-119">Der Anbieter – Aufrufen der OnError-Methode</span><span class="sxs-lookup"><span data-stu-id="42635-119">The Provider -- Calling the OnError Method</span></span>  
 <span data-ttu-id="42635-120">Die <xref:System.IObserver%601.OnError%2A>-Methode dient als Informationsmeldung an Beobachter – ähnlich wie die <xref:System.IObserver%601.OnNext%2A?displayProperty=nameWithType>-Methode.</span><span class="sxs-lookup"><span data-stu-id="42635-120">The <xref:System.IObserver%601.OnError%2A> method is intended as an informational message to observers, much like the <xref:System.IObserver%601.OnNext%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="42635-121">Allerdings wurde die <xref:System.IObserver%601.OnNext%2A>-Methode entwickelt, um einem Beobachter aktuelle bzw. aktualisierte Daten bereitzustellen, während die <xref:System.IObserver%601.OnError%2A>-Methode entwickelt wurde, um anzugeben, dass der Anbieter keine gültige Daten bereitstellen kann.</span><span class="sxs-lookup"><span data-stu-id="42635-121">However, the <xref:System.IObserver%601.OnNext%2A> method is designed to provide an observer with current or updated data, whereas the <xref:System.IObserver%601.OnError%2A> method is designed to indicate that the provider is unable to provide valid data.</span></span>  
  
 <span data-ttu-id="42635-122">Der Anbieter sollte diese empfohlenen Vorgehensweisen beim Verarbeiten von Ausnahmen und dem Aufrufen der <xref:System.IObserver%601.OnError%2A>-Methode verwenden:</span><span class="sxs-lookup"><span data-stu-id="42635-122">The provider should follow these best practices when handling exceptions and calling the <xref:System.IObserver%601.OnError%2A> method:</span></span>  
  
- <span data-ttu-id="42635-123">Der Anbieter muss seine eigenen Ausnahmen verarbeiten, wenn er spezielle Anforderungen hat.</span><span class="sxs-lookup"><span data-stu-id="42635-123">The provider must handle its own exceptions if it has any specific requirements.</span></span>  
  
- <span data-ttu-id="42635-124">Der Anbieter sollte nicht erwarten oder voraussetzen, dass Beobachter Ausnahmen auf eine bestimmte Weise verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="42635-124">The provider should not expect or require that observers handle exceptions in any particular way.</span></span>  
  
- <span data-ttu-id="42635-125">Der Anbieter sollte die <xref:System.IObserver%601.OnError%2A>-Methode aufrufen, wenn er eine Ausnahme behandelt, die die Bereitstellung von Updates gefährdet.</span><span class="sxs-lookup"><span data-stu-id="42635-125">The provider should call the <xref:System.IObserver%601.OnError%2A> method when it handles an exception that compromises its ability to provide updates.</span></span> <span data-ttu-id="42635-126">Informationen zu solchen Ausnahmen können an den Beobachter übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="42635-126">Information on such exceptions can be passed to the observer.</span></span> <span data-ttu-id="42635-127">In anderen Fällen besteht keine Notwendigkeit, den Beobachter über eine Ausnahme zu benachrichtigen.</span><span class="sxs-lookup"><span data-stu-id="42635-127">In other cases, there is no need to notify observers of an exception.</span></span>  
  
 <span data-ttu-id="42635-128">Sobald der Anbieter die <xref:System.IObserver%601.OnError%2A>- oder <xref:System.IObserver%601.OnCompleted%2A?displayProperty=nameWithType>-Methode aufruft, sollte es keine weiteren Benachrichtigungen geben, und der Anbieter kann seine Beobachter kündigen.</span><span class="sxs-lookup"><span data-stu-id="42635-128">Once the provider calls the <xref:System.IObserver%601.OnError%2A> or <xref:System.IObserver%601.OnCompleted%2A?displayProperty=nameWithType> method, there should be no further notifications, and the provider can unsubscribe its observers.</span></span> <span data-ttu-id="42635-129">Allerdings können die Beobachter das Abonnement auch jederzeit selbst kündigen, auch bevor oder nachdem sie eine <xref:System.IObserver%601.OnError%2A>- oder <xref:System.IObserver%601.OnCompleted%2A?displayProperty=nameWithType>-Benachrichtigung empfangen.</span><span class="sxs-lookup"><span data-stu-id="42635-129">However, the observers can also unsubscribe themselves at any time, including both before and after they receive an <xref:System.IObserver%601.OnError%2A> or <xref:System.IObserver%601.OnCompleted%2A?displayProperty=nameWithType> notification.</span></span> <span data-ttu-id="42635-130">Das Beobachterentwurfsmuster schreibt nicht vor, ob der Anbieter oder der Beobachter für die Kündigung zuständig ist; aus diesem Grund besteht die Möglichkeit, dass beide versuchen, zu kündigen.</span><span class="sxs-lookup"><span data-stu-id="42635-130">The observer design pattern does not dictate whether the provider or the observer is responsible for unsubscribing; therefore, there is a possibility that both may attempt to unsubscribe.</span></span> <span data-ttu-id="42635-131">Wenn Beobachter kündigen, werden sie in der Regel aus einer Abonnentenauflistung entfernt.</span><span class="sxs-lookup"><span data-stu-id="42635-131">Typically, when observers unsubscribe, they are removed from a subscribers collection.</span></span> <span data-ttu-id="42635-132">In einer Single-Thread-Anwendung sollte die <xref:System.IDisposable.Dispose%2A?displayProperty=nameWithType>-Implementierung sicherstellen, dass ein Objektverweis gültig ist und dass das Objekt ein Mitglied der Abonnentenauflistung ist, bevor der Versuch unternommen wird, es zu entfernen.</span><span class="sxs-lookup"><span data-stu-id="42635-132">In a single-threaded application, the <xref:System.IDisposable.Dispose%2A?displayProperty=nameWithType> implementation should ensure that an object reference is valid and that the object is a member of the subscribers collection before attempting to remove it.</span></span> <span data-ttu-id="42635-133">In einer Multithreadanwendung sollte ein threadsicheres Auflistungsobjekt, z. B. ein <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType>-Objekt, verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="42635-133">In a multithreaded application, a thread-safe collection object, such as a <xref:System.Collections.Concurrent.BlockingCollection%601?displayProperty=nameWithType> object, should be used.</span></span>  
  
### <a name="the-observer----implementing-the-onerror-method"></a><span data-ttu-id="42635-134">Der Beobachter – Implementieren der OnError-Methode</span><span class="sxs-lookup"><span data-stu-id="42635-134">The Observer -- Implementing the OnError Method</span></span>  
 <span data-ttu-id="42635-135">Wenn ein Beobachter eine Fehlerbenachrichtigung von einem Anbieter empfängt, sollte der Beobachter die Ausnahme als Informationsmeldung behandeln und sollte nicht verpflichtet sein, bestimmte Maßnahmen zu ergreifen.</span><span class="sxs-lookup"><span data-stu-id="42635-135">When an observer receives an error notification from a provider, the observer should treat the exception as informational and should not be required to take any particular action.</span></span>  
  
 <span data-ttu-id="42635-136">Der Beobachter sollte diesen empfohlenen Vorgehensweisen bei der Reaktion auf einen <xref:System.IObserver%601.OnError%2A>-Methodenaufruf von einem Anbieter folgen:</span><span class="sxs-lookup"><span data-stu-id="42635-136">The observer should follow these best practices when responding to an <xref:System.IObserver%601.OnError%2A> method call from a provider:</span></span>  
  
- <span data-ttu-id="42635-137">Der Beobachter sollte keine Ausnahmen in seinen Schnittstellenimplementierungen auslösen, z. B. <xref:System.IObserver%601.OnNext%2A> oder <xref:System.IObserver%601.OnError%2A>.</span><span class="sxs-lookup"><span data-stu-id="42635-137">The observer should not throw exceptions from its interface implementations, such as <xref:System.IObserver%601.OnNext%2A> or <xref:System.IObserver%601.OnError%2A>.</span></span> <span data-ttu-id="42635-138">Wenn der Beobachter aber Ausnahmen auslöst, sollte er davon ausgehen, dass diese Ausnahmen nicht behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="42635-138">However, if the observer does throw exceptions, it should expect these exceptions to go unhandled.</span></span>  
  
- <span data-ttu-id="42635-139">Um die Aufrufliste beizubehalten, sollte ein Beobachter, der ein <xref:System.Exception>-Objekt, das an die <xref:System.IObserver%601.OnError%2A>-Methode übergeben wurde, auslösen möchte, die Ausnahme vor dem Auslösen umschließen.</span><span class="sxs-lookup"><span data-stu-id="42635-139">To preserve the call stack, an observer that wishes to throw an <xref:System.Exception> object that was passed to its <xref:System.IObserver%601.OnError%2A> method should wrap the exception before throwing it.</span></span> <span data-ttu-id="42635-140">Zu diesem Zweck sollte ein Standardausnahmeobjekt verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="42635-140">A standard exception object should be used for this purpose.</span></span>  
  
## <a name="additional-best-practices"></a><span data-ttu-id="42635-141">Weitere empfohlene Vorgehensweisen</span><span class="sxs-lookup"><span data-stu-id="42635-141">Additional Best Practices</span></span>  
 <span data-ttu-id="42635-142">Der Versuch, die Registrierung in der <xref:System.IObservable%601.Subscribe%2A?displayProperty=nameWithType>-Methode aufzuheben, kann in einem Nullverweis resultieren.</span><span class="sxs-lookup"><span data-stu-id="42635-142">Attempting to unregister in the <xref:System.IObservable%601.Subscribe%2A?displayProperty=nameWithType> method may result in a null reference.</span></span> <span data-ttu-id="42635-143">Aus diesem Grund wird empfohlen, dieses Verfahren zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="42635-143">Therefore, we recommend that you avoid this practice.</span></span>  
  
 <span data-ttu-id="42635-144">Es ist zwar möglich, einen Beobachter an mehrere Anbieter anzufügen, das empfohlene Muster ist aber das Anfügen einer <xref:System.IObserver%601>-Instanz an nur eine <xref:System.IObservable%601>-Instanz.</span><span class="sxs-lookup"><span data-stu-id="42635-144">Although it is possible to attach an observer to multiple providers, the recommended pattern is to attach an <xref:System.IObserver%601> instance to only one <xref:System.IObservable%601> instance.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="42635-145">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="42635-145">See also</span></span>

- [<span data-ttu-id="42635-146">Beobachterentwurfsmuster</span><span class="sxs-lookup"><span data-stu-id="42635-146">Observer Design Pattern</span></span>](observer-design-pattern.md)
- [<span data-ttu-id="42635-147">Gewusst wie: Implementieren eines Observers</span><span class="sxs-lookup"><span data-stu-id="42635-147">How to: Implement an Observer</span></span>](how-to-implement-an-observer.md)
- [<span data-ttu-id="42635-148">Gewusst wie: Implementieren eines Anbieters</span><span class="sxs-lookup"><span data-stu-id="42635-148">How to: Implement a Provider</span></span>](how-to-implement-a-provider.md)
