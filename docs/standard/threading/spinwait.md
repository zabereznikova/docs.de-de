---
title: SpinWait
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- synchronization primitives, SpinWait
ms.assetid: 36012f42-34e5-4f86-adf4-973f433ed6c6
ms.openlocfilehash: 2031ebc30d0789181786053d401e69da782a619f
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/18/2020
ms.locfileid: "94826208"
---
# <a name="spinwait"></a><span data-ttu-id="87f3b-102">SpinWait</span><span class="sxs-lookup"><span data-stu-id="87f3b-102">SpinWait</span></span>

<span data-ttu-id="87f3b-103"><xref:System.Threading.SpinWait?displayProperty=nameWithType> ist ein einfacher Synchronisierungstyp, den Sie in Szenarien auf niedriger Ebene verwenden können, um die aufwändigen Kontextwechsel und Kernelübergänge zu vermeiden, die für Kernelereignisse erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="87f3b-103"><xref:System.Threading.SpinWait?displayProperty=nameWithType> is a lightweight synchronization type that you can use in low-level scenarios to avoid the expensive context switches and kernel transitions that are required for kernel events.</span></span> <span data-ttu-id="87f3b-104">Wenn bei Computern mit mehreren Kernen nicht erwartet wird, dass eine Ressource für längere Zeit beibehalten wird, kann es effizienter sein, wenn ein wartender Thread für ein paar Dutzend oder Hundert Zyklen im Benutzermodus rotiert und dann versucht wird, die Ressource zu erlangen.</span><span class="sxs-lookup"><span data-stu-id="87f3b-104">On multicore computers, when a resource is not expected to be held for long periods of time, it can be more efficient for a waiting thread to spin in user mode for a few dozen or a few hundred cycles, and then retry to acquire the resource.</span></span> <span data-ttu-id="87f3b-105">Wenn die Ressource nach den Spinvorgängen verfügbar ist, haben Sie mehrere Tausend Zyklen gespeichert.</span><span class="sxs-lookup"><span data-stu-id="87f3b-105">If the resource is available after spinning, then you have saved several thousand cycles.</span></span> <span data-ttu-id="87f3b-106">Wenn die Ressource immer noch nicht verfügbar ist, haben Sie nur wenige Zyklen verbraucht und können weiterhin in einen kernelbasierten Wartevorgang eintreten.</span><span class="sxs-lookup"><span data-stu-id="87f3b-106">If the resource is still not available, then you have spent only a few cycles and can still enter a kernel-based wait.</span></span> <span data-ttu-id="87f3b-107">Diese Kombination aus Spin- und Wartevorgang wird manchmal als *zweiphasiger Wartevorgang* bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="87f3b-107">This spinning-then-waiting combination is sometimes referred to as a *two-phase wait operation*.</span></span>  
  
 <span data-ttu-id="87f3b-108"><xref:System.Threading.SpinWait> soll in Verbindung mit .NET-Typen verwendet werden, die Kernelereignisse wie <xref:System.Threading.ManualResetEvent> umschließen.</span><span class="sxs-lookup"><span data-stu-id="87f3b-108"><xref:System.Threading.SpinWait> is designed to be used in conjunction with the .NET types that wrap kernel events such as <xref:System.Threading.ManualResetEvent>.</span></span> <span data-ttu-id="87f3b-109"><xref:System.Threading.SpinWait> kann auch eigenständig für grundlegende Spinfunktionalität in nur einem Programm verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="87f3b-109"><xref:System.Threading.SpinWait> can also be used by itself for basic spinning functionality in just one program.</span></span>  
  
 <span data-ttu-id="87f3b-110"><xref:System.Threading.SpinWait> ist mehr als nur eine leere Schleife.</span><span class="sxs-lookup"><span data-stu-id="87f3b-110"><xref:System.Threading.SpinWait> is more than just an empty loop.</span></span> <span data-ttu-id="87f3b-111">Es ist sorgfältig implementiert, um das richtige Spinverhalten für den Allgemeinfall bereitzustellen, und initiiert selbst Kontextwechsel, wenn es ausreichend lange rotiert hat (ungefähr der für einen Kernelübergang erforderliche Zeitraum).</span><span class="sxs-lookup"><span data-stu-id="87f3b-111">It is carefully implemented to provide correct spinning behavior for the general case, and will itself initiate context switches if it spins long enough (roughly the length of time required for a kernel transition).</span></span> <span data-ttu-id="87f3b-112">Auf Einzelkerncomputern erzeugt <xref:System.Threading.SpinWait> z.B. sofort das Zeitsegment des Threads, da sich drehende Blöcke den Status an alle Threads weiterleiten.</span><span class="sxs-lookup"><span data-stu-id="87f3b-112">For example, on single-core computers, <xref:System.Threading.SpinWait> yields the time slice of the thread immediately because spinning blocks forward progress on all threads.</span></span> <span data-ttu-id="87f3b-113"><xref:System.Threading.SpinWait> erzeugt sie ebenfalls, sogar auf Computern mit mehreren Kernen, um zu verhindern, dass der wartende Thread Threads mit höherer Priorität oder den Garbage Collector blockiert.</span><span class="sxs-lookup"><span data-stu-id="87f3b-113"><xref:System.Threading.SpinWait> also yields even on multi-core machines to prevent the waiting thread from blocking higher-priority threads or the garbage collector.</span></span> <span data-ttu-id="87f3b-114">Aus diesem Grund sollten Sie bei Verwendung von <xref:System.Threading.SpinWait> in einem zweiphasigen Wartevorgang die Kernelwartezeit aufrufen, bevor <xref:System.Threading.SpinWait> selbst einen Kontextwechsel initiiert.</span><span class="sxs-lookup"><span data-stu-id="87f3b-114">Therefore, if you are using a <xref:System.Threading.SpinWait> in a two-phase wait operation, we recommend that you invoke the kernel wait before the <xref:System.Threading.SpinWait> itself initiates a context switch.</span></span> <span data-ttu-id="87f3b-115"><xref:System.Threading.SpinWait> stellt die <xref:System.Threading.SpinWait.NextSpinWillYield%2A>-Eigenschaft bereit, die Sie vor jedem Aufruf von <xref:System.Threading.SpinWait.SpinOnce%2A> überprüfen können.</span><span class="sxs-lookup"><span data-stu-id="87f3b-115"><xref:System.Threading.SpinWait> provides the <xref:System.Threading.SpinWait.NextSpinWillYield%2A> property, which you can check before every call to <xref:System.Threading.SpinWait.SpinOnce%2A>.</span></span> <span data-ttu-id="87f3b-116">Wenn die Eigenschaft `true` zurückgibt, initiieren Sie Ihren eigenen Wartevorgang.</span><span class="sxs-lookup"><span data-stu-id="87f3b-116">When the property returns `true`, initiate your own Wait operation.</span></span> <span data-ttu-id="87f3b-117">Ein Beispiel finden Sie unter [Gewusst wie: Implementieren eines Wartevorgangs mit zwei Phasen mit SpinWait](how-to-use-spinwait-to-implement-a-two-phase-wait-operation.md).</span><span class="sxs-lookup"><span data-stu-id="87f3b-117">For an example, see [How to: Use SpinWait to Implement a Two-Phase Wait Operation](how-to-use-spinwait-to-implement-a-two-phase-wait-operation.md).</span></span>  
  
 <span data-ttu-id="87f3b-118">Wenn Sie keinen zweiphasigen Wartevorgang ausführen, sondern einfach Schleifendurchläufe, bis eine Bedingung wahr ist, können Sie <xref:System.Threading.SpinWait> aktivieren, um dessen Kontextwechsel auszuführen, damit es ein „guter Bürger“ in der Windows-Betriebssystemumgebung ist.</span><span class="sxs-lookup"><span data-stu-id="87f3b-118">If you are not performing a two-phase wait operation but are just spinning until some condition is true, you can enable <xref:System.Threading.SpinWait> to perform its context switches so that it is a good citizen in the Windows operating system environment.</span></span> <span data-ttu-id="87f3b-119">Das folgende grundlegende Beispiel zeigt ein <xref:System.Threading.SpinWait> in einem sperrenfreien Stapel.</span><span class="sxs-lookup"><span data-stu-id="87f3b-119">The following basic example shows a <xref:System.Threading.SpinWait> in a lock-free stack.</span></span> <span data-ttu-id="87f3b-120">Wenn Sie einen threadsicheren Stapel mit hoher Leistung benötigen, ziehen Sie <xref:System.Collections.Concurrent.ConcurrentStack%601?displayProperty=nameWithType> in Betracht.</span><span class="sxs-lookup"><span data-stu-id="87f3b-120">If you require a high-performance, thread-safe stack, consider using <xref:System.Collections.Concurrent.ConcurrentStack%601?displayProperty=nameWithType>.</span></span>  
  
 [!code-csharp[CDS_SpinWait#05](../../../samples/snippets/csharp/VS_Snippets_Misc/cds_spinwait/cs/spinwait.cs#05)]
 [!code-vb[CDS_SpinWait#05](../../../samples/snippets/visualbasic/VS_Snippets_Misc/cds_spinwait/vb/cds_spinwait1.vb#05)]  
  
## <a name="see-also"></a><span data-ttu-id="87f3b-121">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="87f3b-121">See also</span></span>

- <xref:System.Threading.Thread.SpinWait%2A>
- [<span data-ttu-id="87f3b-122">Threading Objects and Features (Threadingobjekte und -funktionen)</span><span class="sxs-lookup"><span data-stu-id="87f3b-122">Threading Objects and Features</span></span>](threading-objects-and-features.md)
