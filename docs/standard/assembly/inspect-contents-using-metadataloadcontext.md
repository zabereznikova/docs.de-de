---
title: 'Vorgehensweise: Untersuchen von Assemblyinhalten mithilfe von MetadataLoadContext'
description: Lernen Sie die Verwendung von MetadataLoadContext kennen – einer API, mit der Sie .NET-Assemblys zur Untersuchung laden können.
author: MSDN-WhiteKnight
ms.date: 03/10/2020
ms.technology: dotnet-standard
ms.openlocfilehash: 7f90149a98632ea57e8d241a0ccdf4b50264ac5c
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 09/15/2020
ms.locfileid: "90552023"
---
# <a name="how-to-inspect-assembly-contents-using-metadataloadcontext"></a><span data-ttu-id="1a246-103">Vorgehensweise: Untersuchen von Assemblyinhalten mithilfe von MetadataLoadContext</span><span class="sxs-lookup"><span data-stu-id="1a246-103">How to: Inspect assembly contents using MetadataLoadContext</span></span>

<span data-ttu-id="1a246-104">Mithilfe der Reflektions-API in .NET können Entwickler standardmäßig die Inhalte von Assemblys untersuchen, die im Hauptausführungskontext geladen werden.</span><span class="sxs-lookup"><span data-stu-id="1a246-104">The reflection API in .NET by default enables developers to inspect the contents of assemblies loaded into the main execution context.</span></span> <span data-ttu-id="1a246-105">Manchmal ist es jedoch nicht möglich, eine Assembly in den Ausführungskontext zu laden – weil sie beispielsweise für eine andere Plattform oder Prozessorarchitektur kompiliert wurde, oder weil es sich um eine [Referenzassembly](reference-assemblies.md) handelt.</span><span class="sxs-lookup"><span data-stu-id="1a246-105">However, sometimes it isn't possible to load an assembly into the execution context, for example, because it was compiled for another platform or processor architecture, or it's a [reference assembly](reference-assemblies.md).</span></span> <span data-ttu-id="1a246-106">Die <xref:System.Reflection.MetadataLoadContext?displayProperty=fullName>-API ermöglicht es Ihnen, solche Assemblys zu laden und zu untersuchen.</span><span class="sxs-lookup"><span data-stu-id="1a246-106">The <xref:System.Reflection.MetadataLoadContext?displayProperty=fullName> API allows you to load and inspect such assemblies.</span></span> <span data-ttu-id="1a246-107">In den <xref:System.Reflection.MetadataLoadContext> geladene Assemblys werden lediglich als Metadaten behandelt, d. h. Sie können Typen in der Assembly untersuchen, aber keinen darin enthaltenen Code ausführen.</span><span class="sxs-lookup"><span data-stu-id="1a246-107">Assemblies loaded into the <xref:System.Reflection.MetadataLoadContext> are treated only as metadata, that is, you can examine types in the assembly, but you can't execute any code contained in it.</span></span> <span data-ttu-id="1a246-108">Im Gegensatz zum Hauptausführungskontext lädt der <xref:System.Reflection.MetadataLoadContext> nicht automatisch Abhängigkeiten aus dem aktuellen Verzeichnis. Stattdessen wird die benutzerdefinierte Bindungslogik aus <xref:System.Reflection.MetadataAssemblyResolver> verwendet, der an sie übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="1a246-108">Unlike the main execution context, the <xref:System.Reflection.MetadataLoadContext> doesn't automatically load dependencies from the current directory; instead it uses the custom binding logic provided by the <xref:System.Reflection.MetadataAssemblyResolver> passed to it.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="1a246-109">Voraussetzungen</span><span class="sxs-lookup"><span data-stu-id="1a246-109">Prerequisites</span></span>

<span data-ttu-id="1a246-110">Installieren Sie zur Verwendung von <xref:System.Reflection.MetadataLoadContext> das NuGet-Paket [System.Reflection.MetadataLoadContext](https://www.nuget.org/packages/System.Reflection.MetadataLoadContext).</span><span class="sxs-lookup"><span data-stu-id="1a246-110">To use <xref:System.Reflection.MetadataLoadContext>, install the [System.Reflection.MetadataLoadContext](https://www.nuget.org/packages/System.Reflection.MetadataLoadContext) NuGet package.</span></span> <span data-ttu-id="1a246-111">Es wird in jedem .NET Standard 2.0-konformen Zielframework unterstützt, wie etwa .NET Core 2.0 oder .NET Framework 4.6.1.</span><span class="sxs-lookup"><span data-stu-id="1a246-111">It is supported on any .NET Standard 2.0-compliant target framework, for example, .NET Core 2.0 or .NET Framework 4.6.1.</span></span>

## <a name="create-metadataassemblyresolver-for-metadataloadcontext"></a><span data-ttu-id="1a246-112">Erstellen von „MetadataAssemblyResolver“ für MetadataLoadContext</span><span class="sxs-lookup"><span data-stu-id="1a246-112">Create MetadataAssemblyResolver for MetadataLoadContext</span></span>

<span data-ttu-id="1a246-113">Zum Erstellen des <xref:System.Reflection.MetadataLoadContext> muss eine <xref:System.Reflection.MetadataAssemblyResolver>-Instanz bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="1a246-113">Creating the <xref:System.Reflection.MetadataLoadContext> requires providing the instance of the <xref:System.Reflection.MetadataAssemblyResolver>.</span></span> <span data-ttu-id="1a246-114">Die einfachste Möglichkeit hierzu ist die Verwendung von <xref:System.Reflection.PathAssemblyResolver>, der Assemblys aus der angegebenen Sammlung mit Assembly-Pfadzeichenfolgen auflöst.</span><span class="sxs-lookup"><span data-stu-id="1a246-114">The simplest way to provide one is to use the <xref:System.Reflection.PathAssemblyResolver>, which resolves assemblies from the given collection of assembly path strings.</span></span> <span data-ttu-id="1a246-115">Diese Sammlung sollte neben den Assemblys, die Sie direkt untersuchen möchten, auch alle benötigten Abhängigkeiten umfassen.</span><span class="sxs-lookup"><span data-stu-id="1a246-115">This collection, besides assemblies you want to inspect directly, should also include all needed dependencies.</span></span> <span data-ttu-id="1a246-116">Um beispielsweise das custom-Attribut in einer externen Assembly zu lesen, müssen Sie diese Assembly einschließen, da ansonsten eine Ausnahme ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="1a246-116">For example, to read the custom attribute located in an external assembly, you should include that assembly or an exception will be thrown.</span></span> <span data-ttu-id="1a246-117">In den meisten Fällen sollten Sie mindestens die *Kernassembly* einschließen – also die Assembly, die integrierte Systemtypen wie z. B. <xref:System.Object?displayProperty=nameWithType> enthält.</span><span class="sxs-lookup"><span data-stu-id="1a246-117">In most cases, you should include at least the *core assembly*, that is, the assembly containing built-in system types, such as <xref:System.Object?displayProperty=nameWithType>.</span></span> <span data-ttu-id="1a246-118">Der folgende Code zeigt, wie Sie den <xref:System.Reflection.PathAssemblyResolver> mithilfe der Sammlung erstellen, die die untersuchte Assembly und die Kernassembly der aktuellen Runtime enthält:</span><span class="sxs-lookup"><span data-stu-id="1a246-118">The following code shows how to create the <xref:System.Reflection.PathAssemblyResolver> using the collection consisting of the inspected assembly and the current runtime's core assembly:</span></span>

[!code-csharp[](snippets/inspect-contents-using-metadataloadcontext/MetadataLoadContextSnippets.cs#CoreAssembly)]

<span data-ttu-id="1a246-119">Wenn Sie Zugriff auf alle BCL-Typen benötigen, können Sie alle Runtimeassemblys in die Sammlung aufnehmen.</span><span class="sxs-lookup"><span data-stu-id="1a246-119">If you need access to all BCL types, you can include all runtime assemblies in the collection.</span></span> <span data-ttu-id="1a246-120">Der folgende Code zeigt, wie Sie den <xref:System.Reflection.PathAssemblyResolver> mithilfe der Sammlung erstellen, die die untersuchte Assembly und alle Assemblys der aktuellen Runtime enthält:</span><span class="sxs-lookup"><span data-stu-id="1a246-120">The following code shows how to create the <xref:System.Reflection.PathAssemblyResolver> using the collection consisting of the inspected assembly and all assemblies of the current runtime:</span></span>

[!code-csharp[](snippets/inspect-contents-using-metadataloadcontext/MetadataLoadContextSnippets.cs#RuntimeAssemblies)]

## <a name="create-metadataloadcontext"></a><span data-ttu-id="1a246-121">Erstellen von MetadataLoadContext</span><span class="sxs-lookup"><span data-stu-id="1a246-121">Create MetadataLoadContext</span></span>

<span data-ttu-id="1a246-122">Um den <xref:System.Reflection.MetadataLoadContext> zu erstellen, rufen Sie den zugehörigen Konstruktor <xref:System.Reflection.MetadataLoadContext.%23ctor%28System.Reflection.MetadataAssemblyResolver%2CSystem.String%29> auf und übergeben den zuvor erstellten <xref:System.Reflection.MetadataAssemblyResolver> als ersten Parameter und den Namen der Kernassembly als zweiten Parameter.</span><span class="sxs-lookup"><span data-stu-id="1a246-122">To create the <xref:System.Reflection.MetadataLoadContext>, invoke its constructor <xref:System.Reflection.MetadataLoadContext.%23ctor%28System.Reflection.MetadataAssemblyResolver%2CSystem.String%29>, passing the previously created <xref:System.Reflection.MetadataAssemblyResolver> as the first parameter and the core assembly name as the second parameter.</span></span> <span data-ttu-id="1a246-123">Sie können den Namen der Kernassembly weglassen. In diesem Fall versucht der Konstruktor, Standardnamen wie „mscorlib“, „System.Runtime“ oder „netstandard“ zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="1a246-123">You can omit the core assembly name, in which case the constructor will attempt to use default names: "mscorlib", "System.Runtime", or "netstandard".</span></span>

<span data-ttu-id="1a246-124">Nachdem Sie den Kontext erstellt haben, können Sie mithilfe von Methoden wie z. B. <xref:System.Reflection.MetadataLoadContext.LoadFromAssemblyPath%2A> Assemblys in den Kontext laden.</span><span class="sxs-lookup"><span data-stu-id="1a246-124">After you've created the context, you can load assemblies into it using methods such as <xref:System.Reflection.MetadataLoadContext.LoadFromAssemblyPath%2A>.</span></span> <span data-ttu-id="1a246-125">Sie können für geladene Assemblys alle Reflektions-APIs verwenden – mit Ausnahme derjenigen, die eine Codeausführung umfassen.</span><span class="sxs-lookup"><span data-stu-id="1a246-125">You can use all reflection APIs on loaded assemblies except ones that involve code execution.</span></span> <span data-ttu-id="1a246-126">Die <xref:System.Reflection.MemberInfo.GetCustomAttributes%2A>-Methode hingegen schließt eine Ausführung von Konstruktoren ein. Verwenden Sie deshalb stattdessen die <xref:System.Reflection.MemberInfo.GetCustomAttributesData%2A>-Methode, wenn Sie benutzerdefinierte Attribute im <xref:System.Reflection.MetadataLoadContext> untersuchen müssen.</span><span class="sxs-lookup"><span data-stu-id="1a246-126">The <xref:System.Reflection.MemberInfo.GetCustomAttributes%2A> method does involve the execution of constructors, so use the <xref:System.Reflection.MemberInfo.GetCustomAttributesData%2A> method instead when you need to examine custom attributes in the <xref:System.Reflection.MetadataLoadContext>.</span></span>

<span data-ttu-id="1a246-127">Das folgende Codebeispiel erstellt <xref:System.Reflection.MetadataLoadContext>, lädt die Assembly in den Kontext und gibt Assemblyattribute in der Konsole aus:</span><span class="sxs-lookup"><span data-stu-id="1a246-127">The following code sample creates <xref:System.Reflection.MetadataLoadContext>, loads the assembly into it, and outputs assembly attributes into the console:</span></span>

[!code-csharp[](snippets/inspect-contents-using-metadataloadcontext/MetadataLoadContextSnippets.cs#CreateContext)]

## <a name="example"></a><span data-ttu-id="1a246-128">Beispiel</span><span class="sxs-lookup"><span data-stu-id="1a246-128">Example</span></span>

<span data-ttu-id="1a246-129">Ein vollständiges Codebeispiel finden Sie unter [Inspect assembly contents using MetadataLoadContext](/samples/dotnet/samples/inspect-assembly-contents-using-metadataloadcontext/) (Untersuchen von Assemblyinhalten mithilfe von MetadataLoadContext).</span><span class="sxs-lookup"><span data-stu-id="1a246-129">For a complete code example, see the [Inspect assembly contents using MetadataLoadContext sample](/samples/dotnet/samples/inspect-assembly-contents-using-metadataloadcontext/).</span></span>
