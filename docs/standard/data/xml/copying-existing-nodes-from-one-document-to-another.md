---
title: Kopieren bestehender Knoten aus einem Dokument in ein anderes
ms.date: 03/30/2017
ms.assetid: 3caa78c1-3448-4b7b-b83c-228ee857635e
ms.openlocfilehash: f4d58fa5aafdd48feff1a768ab0463ac09315476
ms.sourcegitcommit: 965a5af7918acb0a3fd3baf342e15d511ef75188
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/18/2020
ms.locfileid: "94829608"
---
# <a name="copying-existing-nodes-from-one-document-to-another"></a><span data-ttu-id="ea2d3-102">Kopieren bestehender Knoten aus einem Dokument in ein anderes</span><span class="sxs-lookup"><span data-stu-id="ea2d3-102">Copying Existing Nodes from One Document to Another</span></span>
<span data-ttu-id="ea2d3-103">Die **ImportNode**-Methode ist das Verfahren, mit dem Sie einen Knoten oder eine ganze Knotenunterstruktur von einem **XmlDocument** in ein anderes kopieren können.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-103">The **ImportNode** method is the mechanism by which a node or entire node subtree is copied from one **XmlDocument** to another.</span></span> <span data-ttu-id="ea2d3-104">Der Knoten, der von dem Aufruf zurückgegeben wird, ist eine Kopie des Knotens aus dem Quelldokument, einschließlich Attributwerten, Knotennamen, Knotentyp und allen namespacebezogenen Attributen wie Präfix, lokaler Name und Namespace-URI (Uniform Resource Identifier).</span><span class="sxs-lookup"><span data-stu-id="ea2d3-104">The node returned from the call is a copy of the node from the source document, including attribute values, the node name, node type, and all namespace-related attributes such as the prefix, local name, and namespace Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="ea2d3-105">Das Quelldokument bleibt dabei unverändert.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-105">The source document is not changed.</span></span> <span data-ttu-id="ea2d3-106">Nachdem Sie den Knoten importiert haben, müssen Sie ihn noch der Struktur hinzufügen, indem Sie eine der Methoden zum Einfügen von Knoten verwenden.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-106">After you have imported the node, you still have to add it to the tree using one of the methods used to insert nodes.</span></span>  
  
 <span data-ttu-id="ea2d3-107">Sobald der Knoten an das neue Dokument angehängt worden ist, ist das neue Dokument Eigentümer des Knotens.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-107">When the node is attached to its new document, the new document owns the node.</span></span> <span data-ttu-id="ea2d3-108">Grund hierfür ist, dass jeder Knoten, wenn er erstellt wird, zu einem Dokument gehört, das sein Eigentümer ist. Dies ist auch der Fall, wenn die Knoten in unterschiedlichen Dokumentfragmenten erstellt werden.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-108">The reason is that each node, when created, has an owning document, even if the nodes are created in separate document fragments.</span></span> <span data-ttu-id="ea2d3-109">Dies ist eine XML-DOM-spezifische (Dokumentobjektmodell) Anforderung, die durch den Factoryerstellungsentwurf für die **XmlDocument**-Klasse durchgesetzt wird.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-109">This is a requirement of the XML Document Object Model (DOM) and is enforced by the factory creation design on the **XmlDocument** class.</span></span> <span data-ttu-id="ea2d3-110">So stellt z.B. **CreateElement** die einzige Möglichkeit zum Erstellen neuer Knoten dar.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-110">For example, **CreateElement**, is the only way to create new nodes.</span></span>  
  
 <span data-ttu-id="ea2d3-111">Je nach Knotentyp des importierten Knotens und dem Wert des *deep*-Parameters werden ggf. zusätzliche Informationen kopiert.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-111">Depending on the node type of the imported node and the value of the *deep* parameter, additional information is copied as appropriate.</span></span> <span data-ttu-id="ea2d3-112">Diese Methode gibt das Verhalten wieder, das erwartet würde, wenn ein Fragment eines XML- oder HTML-Quellcodes aus einem Dokument in ein anderes kopiert würde, und berücksichtigt die Tatsache, dass bei XML die beiden Dokumente unterschiedliche DTDs (Document Type Definitions) aufweisen können.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-112">This method attempts to mirror the behavior expected if a fragment of XML or HTML source was copied from one document to another, accounting for the fact that for XML, the two documents may have different document type definitions (DTDs).</span></span>  
  
 <span data-ttu-id="ea2d3-113">In der folgenden Tabelle wird das spezielle Verhalten für jeden Knotentyp veranschaulicht, der importiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-113">The following table describes the specific behavior for each type of node that can be imported.</span></span>  
  
|<span data-ttu-id="ea2d3-114">Knotentyp</span><span class="sxs-lookup"><span data-stu-id="ea2d3-114">Node Type</span></span>|<span data-ttu-id="ea2d3-115">*deep*-Parameter ist „true“</span><span class="sxs-lookup"><span data-stu-id="ea2d3-115">*deep* parameter is true</span></span>|<span data-ttu-id="ea2d3-116">*deep*-Parameter ist „false“</span><span class="sxs-lookup"><span data-stu-id="ea2d3-116">*deep* parameter is false</span></span>|  
|---------------|------------------------------|-------------------------------|  
|<span data-ttu-id="ea2d3-117">XmlAttribute</span><span class="sxs-lookup"><span data-stu-id="ea2d3-117">XmlAttribute</span></span>|<span data-ttu-id="ea2d3-118">Die <xref:System.Xml.XmlAttribute.Specified%2A> ist im XmlAttribute auf **true** festgelegt.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-118">The <xref:System.Xml.XmlAttribute.Specified%2A> is set to **true** on the XmlAttribute.</span></span> <span data-ttu-id="ea2d3-119">Die untergeordneten Elemente des **XmlAttribute**-Quellknotens werden rekursiv importiert. Die daraus resultierenden Knoten werden neu assembliert und bilden die entsprechende Unterstruktur.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-119">The descendants of the source **XmlAttribute** are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span>|<span data-ttu-id="ea2d3-120">Der *deep*-Parameter gilt nicht für **XmlAttribute**-Knoten, da diese beim Importieren stets ihre untergeordneten Knoten mitnehmen.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-120">The *deep* parameter does not apply to **XmlAttribute** nodes, because they always carry their child nodes with them when imported.</span></span>|  
|<span data-ttu-id="ea2d3-121">XmlCDataSection</span><span class="sxs-lookup"><span data-stu-id="ea2d3-121">XmlCDataSection</span></span>|<span data-ttu-id="ea2d3-122">Kopiert den Knoten einschließlich der zugehörigen Daten.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-122">Copies the node, including its data.</span></span>|<span data-ttu-id="ea2d3-123">Kopiert den Knoten einschließlich der zugehörigen Daten.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-123">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="ea2d3-124">XmlComment</span><span class="sxs-lookup"><span data-stu-id="ea2d3-124">XmlComment</span></span>|<span data-ttu-id="ea2d3-125">Kopiert den Knoten einschließlich der zugehörigen Daten.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-125">Copies the node, including its data.</span></span>|<span data-ttu-id="ea2d3-126">Kopiert den Knoten einschließlich der zugehörigen Daten.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-126">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="ea2d3-127">XmlDocumentFragment</span><span class="sxs-lookup"><span data-stu-id="ea2d3-127">XmlDocumentFragment</span></span>|<span data-ttu-id="ea2d3-128">Die untergeordneten Elemente des Quellknotens werden rekursiv importiert. Die daraus resultierenden Knoten werden neu assembliert und bilden die entsprechende Teilstruktur.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-128">The descendants of the source node are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span>|<span data-ttu-id="ea2d3-129">Ein leeres **XmlDocumentFragment** wird erstellt.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-129">An empty **XmlDocumentFragment** is created.</span></span>|  
|<span data-ttu-id="ea2d3-130">XmlDocumentType</span><span class="sxs-lookup"><span data-stu-id="ea2d3-130">XmlDocumentType</span></span>|<span data-ttu-id="ea2d3-131">Kopiert den Knoten einschließlich der zugehörigen Daten.\*</span><span class="sxs-lookup"><span data-stu-id="ea2d3-131">Copies the node, including its data.\*</span></span>|<span data-ttu-id="ea2d3-132">Kopiert den Knoten einschließlich der zugehörigen Daten.\*</span><span class="sxs-lookup"><span data-stu-id="ea2d3-132">Copies the node, including its data.\*</span></span>|  
|<span data-ttu-id="ea2d3-133">XmlElement</span><span class="sxs-lookup"><span data-stu-id="ea2d3-133">XmlElement</span></span>|<span data-ttu-id="ea2d3-134">Die untergeordneten Elemente des Quellelements werden rekursiv importiert. Die daraus resultierenden Knoten werden neu assembliert und bilden die entsprechende Teilstruktur.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-134">The descendants of the source element are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span> <span data-ttu-id="ea2d3-135">**Hinweis**:  Standardattribute werden nicht kopiert.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-135">**Note:**  Default attributes are not copied.</span></span> <span data-ttu-id="ea2d3-136">Wenn das Dokument, in das importiert wird, Standardattribute für diesen Elementnamen definiert, werden diese zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-136">If the document being imported into defines default attributes for this element name, those are assigned.</span></span>|<span data-ttu-id="ea2d3-137">Die angegebenen Attributknoten des Quellelements werden importiert, und die generierten **XmlAttribute**-Knoten werden an das neue Element angehängt.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-137">Specified attribute nodes of the source element are imported, and the generated **XmlAttribute** nodes are attached to the new element.</span></span> <span data-ttu-id="ea2d3-138">Die untergeordneten Knoten werden nicht kopiert.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-138">The descendant nodes are not copied.</span></span> <span data-ttu-id="ea2d3-139">**Hinweis**:  Standardattribute werden nicht kopiert.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-139">**Note:**  Default attributes are not copied.</span></span> <span data-ttu-id="ea2d3-140">Wenn das Dokument, in das importiert wird, Standardattribute für diesen Elementnamen definiert, werden diese zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-140">If the document being imported into defines default attributes for this element name, those are assigned.</span></span>|  
|<span data-ttu-id="ea2d3-141">XmlEntityReference</span><span class="sxs-lookup"><span data-stu-id="ea2d3-141">XmlEntityReference</span></span>|<span data-ttu-id="ea2d3-142">Da im Quell- und Zieldokument die Entitäten unterschiedlich definiert sein können, kopiert diese Methode nur den **XmlEntityReference**-Knoten.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-142">Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node.</span></span> <span data-ttu-id="ea2d3-143">Der Ersetzungstext ist davon nicht betroffen.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-143">The replacement text is not included.</span></span> <span data-ttu-id="ea2d3-144">Wenn die Entität des Zieldokuments definiert ist, wird deren Wert zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-144">If the destination document has the entity defined, its value is assigned.</span></span>|<span data-ttu-id="ea2d3-145">Da im Quell- und Zieldokument die Entitäten unterschiedlich definiert sein können, kopiert diese Methode nur den **XmlEntityReference**-Knoten.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-145">Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node.</span></span> <span data-ttu-id="ea2d3-146">Der Ersetzungstext ist davon nicht betroffen.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-146">The replacement text is not included.</span></span> <span data-ttu-id="ea2d3-147">Wenn die Entität des Zieldokuments definiert ist, wird deren Wert zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-147">If the destination document has the entity defined, its value is assigned.</span></span>|  
|<span data-ttu-id="ea2d3-148">XmlProcessingInstruction</span><span class="sxs-lookup"><span data-stu-id="ea2d3-148">XmlProcessingInstruction</span></span>|<span data-ttu-id="ea2d3-149">Kopiert den Ziel- und Datenwert des importierten Knotens.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-149">Copies the target and data value from the imported node.</span></span>|<span data-ttu-id="ea2d3-150">Kopiert den Ziel- und Datenwert des importierten Knotens.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-150">Copies the target and data value from the imported node.</span></span>|  
|<span data-ttu-id="ea2d3-151">XmlText</span><span class="sxs-lookup"><span data-stu-id="ea2d3-151">XmlText</span></span>|<span data-ttu-id="ea2d3-152">Kopiert den Knoten einschließlich der zugehörigen Daten.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-152">Copies the node, including its data.</span></span>|<span data-ttu-id="ea2d3-153">Kopiert den Knoten einschließlich der zugehörigen Daten.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-153">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="ea2d3-154">XmlSignificantWhitespace</span><span class="sxs-lookup"><span data-stu-id="ea2d3-154">XmlSignificantWhitespace</span></span>|<span data-ttu-id="ea2d3-155">Kopiert den Knoten einschließlich der zugehörigen Daten.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-155">Copies the node, including its data.</span></span>|<span data-ttu-id="ea2d3-156">Kopiert den Knoten einschließlich der zugehörigen Daten.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-156">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="ea2d3-157">XmlWhitespace</span><span class="sxs-lookup"><span data-stu-id="ea2d3-157">XmlWhitespace</span></span>|<span data-ttu-id="ea2d3-158">Kopiert den Knoten einschließlich der zugehörigen Daten.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-158">Copies the node, including its data.</span></span>|<span data-ttu-id="ea2d3-159">Kopiert den Knoten einschließlich der zugehörigen Daten.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-159">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="ea2d3-160">XmlDeclaration</span><span class="sxs-lookup"><span data-stu-id="ea2d3-160">XmlDeclaration</span></span>|<span data-ttu-id="ea2d3-161">Kopiert den Ziel- und Datenwert des importierten Knotens.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-161">Copies the target and data value from the imported node.</span></span>|<span data-ttu-id="ea2d3-162">Kopiert den Ziel- und Datenwert des importierten Knotens.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-162">Copies the target and data value from the imported node.</span></span>|  
|<span data-ttu-id="ea2d3-163">Alle anderen Knotentypen.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-163">All other node types</span></span>|<span data-ttu-id="ea2d3-164">Diese Knotentypen können nicht importiert werden.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-164">These node types cannot be imported.</span></span>|<span data-ttu-id="ea2d3-165">Diese Knotentypen können nicht importiert werden.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-165">These node types cannot be imported.</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="ea2d3-166">Obwohl DocumentType-Knoten importiert werden können, kann ein Dokument nur einen DocumentType aufweisen.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-166">Although DocumentType nodes can be imported, a document can only have one DocumentType.</span></span> <span data-ttu-id="ea2d3-167">Sobald Sie also den Dokumenttyp importiert haben, müssen Sie vor dem Einsetzen in die Struktur sicherstellen, dass sich in dem Dokument kein anderer Dokumenttyp befindet.</span><span class="sxs-lookup"><span data-stu-id="ea2d3-167">So, once you have imported the document type, before inserting it into tree you have to make sure that there is no document type in the document.</span></span> <span data-ttu-id="ea2d3-168">Informationen zum Entfernen von Knoten finden Sie unter [Entfernen von Knoten, Inhalten und Werten aus einem XML-Dokument](removing-nodes-content-and-values-from-an-xml-document.md).</span><span class="sxs-lookup"><span data-stu-id="ea2d3-168">For information on removing nodes, see [Removing Nodes, Content, and Values from an XML Document](removing-nodes-content-and-values-from-an-xml-document.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ea2d3-169">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="ea2d3-169">See also</span></span>

- [<span data-ttu-id="ea2d3-170">XML-Dokumentobjektmodell (DOM)</span><span class="sxs-lookup"><span data-stu-id="ea2d3-170">XML Document Object Model (DOM)</span></span>](xml-document-object-model-dom.md)
