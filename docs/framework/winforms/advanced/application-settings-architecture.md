---
title: Architektur der Anwendungseinstellungen
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- application settings [Windows Forms], architecture
ms.assetid: c8eb2ad0-fac6-4ea2-9140-675a4a44d562
ms.openlocfilehash: c3858cfab59b63761f43f6b3eaad9bf8ca4c1dbc
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 08/22/2019
ms.locfileid: "69916696"
---
# <a name="application-settings-architecture"></a><span data-ttu-id="096e9-102">Architektur der Anwendungseinstellungen</span><span class="sxs-lookup"><span data-stu-id="096e9-102">Application Settings Architecture</span></span>
<span data-ttu-id="096e9-103">In diesem Thema wird beschrieben, wie die Architektur der Anwendungseinstellungen funktioniert. Außerdem werden erweiterte Funktionen der Architektur erläutert, z.B. gruppierte Einstellungen und Einstellungsschlüssel.</span><span class="sxs-lookup"><span data-stu-id="096e9-103">This topic describes how the Application Settings architecture works, and explores advanced features of the architecture, such as grouped settings and settings keys.</span></span>

 <span data-ttu-id="096e9-104">Die Architektur der Anwendungseinstellungen unterstützt definierende, stark typisierte Einstellungen mit Geltungsbereich Anwendung oder Benutzer sowie die Beibehaltung der Einstellungen zwischen Anwendungssitzungen.</span><span class="sxs-lookup"><span data-stu-id="096e9-104">The application settings architecture supports defining strongly typed settings with either application or user scope, and persisting the settings between application sessions.</span></span> <span data-ttu-id="096e9-105">Die Architektur bietet eine Standardpersistenz-Engine zum Speichern von Einstellungen und Laden aus dem lokalen Dateisystem.</span><span class="sxs-lookup"><span data-stu-id="096e9-105">The architecture provides a default persistence engine for saving settings to and loading them from the local file system.</span></span> <span data-ttu-id="096e9-106">Die Architektur definiert auch Schnittstellen zur Bereitstellung einer benutzerdefinierten Persistenz-Engine.</span><span class="sxs-lookup"><span data-stu-id="096e9-106">The architecture also defines interfaces for supplying a custom persistence engine.</span></span>

 <span data-ttu-id="096e9-107">Schnittstellen werden bereitgestellt, die benutzerdefinierten Komponenten ermöglichen, ihre eigenen Einstellungen beizubehalten, wenn sie in einer Anwendung gehostet werden können.</span><span class="sxs-lookup"><span data-stu-id="096e9-107">Interfaces are provided that enable custom components to persist their own settings when they are hosted in an application.</span></span> <span data-ttu-id="096e9-108">Mithilfe von Einstellungsschlüsseln können Komponenten Einstellungen für mehrere Instanzen der Komponente getrennt halten.</span><span class="sxs-lookup"><span data-stu-id="096e9-108">By using settings keys, components can keep settings for multiple instances of the component separate.</span></span>

## <a name="defining-settings"></a><span data-ttu-id="096e9-109">Definieren von Einstellungen</span><span class="sxs-lookup"><span data-stu-id="096e9-109">Defining Settings</span></span>
 <span data-ttu-id="096e9-110">Die Architektur der Anwendungseinstellungen wird sowohl in ASP.net als auch Windows Forms verwendet und enthält eine Reihe von Basisklassen, die in beiden Umgebungen gemeinsam verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="096e9-110">The application settings architecture is used within both ASP.NET and Windows Forms, and it contains a number of base classes that are shared across both environments.</span></span> <span data-ttu-id="096e9-111">Das wichtigste ist <xref:System.Configuration.SettingsBase>, das den Zugriff auf Einstellungen über eine Auflistung ermöglicht und Methoden auf niedriger Ebene zum Laden und Speichern von Einstellungen bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="096e9-111">The most important is <xref:System.Configuration.SettingsBase>, which provides access to settings through a collection, and provides low-level methods for loading and saving settings.</span></span> <span data-ttu-id="096e9-112">Jede Umgebung implementiert eine eigene von <xref:System.Configuration.SettingsBase> abgeleitete Klasse, um zusätzliche Einstellungs Funktionen für diese Umgebung bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="096e9-112">Each environment implements its own class derived from <xref:System.Configuration.SettingsBase> to provide additional settings functionality for that environment.</span></span> <span data-ttu-id="096e9-113">In einer Windows Forms basierten Anwendung müssen alle Anwendungseinstellungen für eine von der <xref:System.Configuration.ApplicationSettingsBase> -Klasse abgeleitete Klasse definiert werden, die der-Basisklasse die folgenden Funktionen hinzufügt:</span><span class="sxs-lookup"><span data-stu-id="096e9-113">In a Windows Forms-based application, all application settings must be defined on a class derived from the <xref:System.Configuration.ApplicationSettingsBase> class, which adds the following functionality to the base class:</span></span>

- <span data-ttu-id="096e9-114">Lade- und Speichervorgänge auf höherer Ebene</span><span class="sxs-lookup"><span data-stu-id="096e9-114">Higher-level loading and saving operations</span></span>

- <span data-ttu-id="096e9-115">Unterstützung für benutzerspezifische Einstellungen</span><span class="sxs-lookup"><span data-stu-id="096e9-115">Support for user-scoped settings</span></span>

- <span data-ttu-id="096e9-116">Wiederherstellen der vordefinierten Standardeinstellungen eines Benutzers</span><span class="sxs-lookup"><span data-stu-id="096e9-116">Reverting a user's settings to the predefined defaults</span></span>

- <span data-ttu-id="096e9-117">Aktualisieren von Einstellungen aus einer früheren Anwendungsversion</span><span class="sxs-lookup"><span data-stu-id="096e9-117">Upgrading settings from a previous application version</span></span>

- <span data-ttu-id="096e9-118">Überprüfen von Einstellungen, bevor sie geändert oder bevor sie gespeichert werden</span><span class="sxs-lookup"><span data-stu-id="096e9-118">Validating settings, either before they are changed or before they are saved</span></span>

 <span data-ttu-id="096e9-119">Die Einstellungen können mit einer Reihe von Attributen beschrieben werden, die im <xref:System.Configuration> -Namespace definiert sind. Diese werden unter [Attribute für Anwendungseinstellungen](application-settings-attributes.md)beschrieben.</span><span class="sxs-lookup"><span data-stu-id="096e9-119">The settings can be described using a number of attributes defined within the <xref:System.Configuration> namespace; these are described in [Application Settings Attributes](application-settings-attributes.md).</span></span> <span data-ttu-id="096e9-120">Wenn Sie eine Einstellung definieren, müssen Sie Sie entweder <xref:System.Configuration.ApplicationScopedSettingAttribute> mit oder <xref:System.Configuration.UserScopedSettingAttribute>anwenden, wodurch beschrieben wird, ob die Einstellung für die gesamte Anwendung oder nur für den aktuellen Benutzer gilt.</span><span class="sxs-lookup"><span data-stu-id="096e9-120">When you define a setting, you must apply it with either <xref:System.Configuration.ApplicationScopedSettingAttribute> or <xref:System.Configuration.UserScopedSettingAttribute>, which describes whether the setting applies to the entire application or just to the current user.</span></span>

 <span data-ttu-id="096e9-121">Das folgende Codebeispiel definiert eine benutzerdefinierte Einstellungsklasse mit einer Einstellung: `BackgroundColor`.</span><span class="sxs-lookup"><span data-stu-id="096e9-121">The following code example defines a custom settings class with a single setting, `BackgroundColor`.</span></span>

 [!code-csharp[ApplicationSettings.Create#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Create/CS/MyAppSettings.cs#1)]
 [!code-vb[ApplicationSettings.Create#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Create/VB/MyAppSettings.vb#1)]

## <a name="settings-persistence"></a><span data-ttu-id="096e9-122">Beibehaltung von Einstellungen</span><span class="sxs-lookup"><span data-stu-id="096e9-122">Settings Persistence</span></span>
 <span data-ttu-id="096e9-123">Die <xref:System.Configuration.ApplicationSettingsBase> -Klasse speichert oder lädt keine Einstellungen. dieser Auftrag fällt auf den Einstellungs Anbieter, eine Klasse, die von <xref:System.Configuration.SettingsProvider>abgeleitet wird.</span><span class="sxs-lookup"><span data-stu-id="096e9-123">The <xref:System.Configuration.ApplicationSettingsBase> class does not itself persist or load settings; this job falls to the settings provider, a class that derives from <xref:System.Configuration.SettingsProvider>.</span></span> <span data-ttu-id="096e9-124">Wenn eine abgeleitete Klasse <xref:System.Configuration.ApplicationSettingsBase> von keinen Einstellungs Anbieter über den <xref:System.Configuration.SettingsProviderAttribute>angibt, wird der Standardanbieter <xref:System.Configuration.LocalFileSettingsProvider>,, verwendet.</span><span class="sxs-lookup"><span data-stu-id="096e9-124">If a derived class of <xref:System.Configuration.ApplicationSettingsBase> does not specify a settings provider through the <xref:System.Configuration.SettingsProviderAttribute>, then the default provider, <xref:System.Configuration.LocalFileSettingsProvider>, is used.</span></span>

 <span data-ttu-id="096e9-125">Das Konfigurationssystem, das ursprünglich mit dem .NET Framework freigegeben wurde, unterstützt die Bereitstellung statischer Anwendungs Konfigurationsdaten entweder über die Datei "Machine `app.`. config" des lokalen Computers oder innerhalb einer Datei "exe. config", die Sie mit Ihre Anwendung.</span><span class="sxs-lookup"><span data-stu-id="096e9-125">The configuration system that was originally released with the .NET Framework supports providing static application configuration data through either the local computer's machine.config file or within an `app.`exe.config file that you deploy with your application.</span></span> <span data-ttu-id="096e9-126">Diese <xref:System.Configuration.LocalFileSettingsProvider> Native Unterstützung wird von der-Klasse wie folgt erweitert:</span><span class="sxs-lookup"><span data-stu-id="096e9-126">The <xref:System.Configuration.LocalFileSettingsProvider> class expands this native support in the following ways:</span></span>

- <span data-ttu-id="096e9-127">Anwendungsspezifische Einstellungen können in der Datei machine.config oder `app.`exe.config gespeichert werden.</span><span class="sxs-lookup"><span data-stu-id="096e9-127">Application-scoped settings can be stored in either the machine.config or `app.`exe.config files.</span></span> <span data-ttu-id="096e9-128">Die Datei machine.config ist immer schreibgeschützt, während `app`. exe.config aufgrund von Sicherheitsüberlegungen für die meisten Anwendungen schreibgeschützt ist.</span><span class="sxs-lookup"><span data-stu-id="096e9-128">Machine.config is always read-only, while `app`.exe.config is restricted by security considerations to read-only for most applications.</span></span>

- <span data-ttu-id="096e9-129">Benutzerspezifische Einstellungen können in `app`. exe.config-Dateien gespeichert werden und werden dann als statische Standardwerte behandelt.</span><span class="sxs-lookup"><span data-stu-id="096e9-129">User-scoped settings can be stored in `app`.exe.config files, in which case they are treated as static defaults.</span></span>

- <span data-ttu-id="096e9-130">Nicht standardmäßige benutzerspezifische Einstellungen werden in einer neuen Datei, *benutzer*.config gespeichert, wobei *benutzer* der Benutzername der Person ist, die aktuell die Anwendung ausführt.</span><span class="sxs-lookup"><span data-stu-id="096e9-130">Non-default user-scoped settings are stored in a new file, *user*.config, where *user* is the user name of the person currently executing the application.</span></span> <span data-ttu-id="096e9-131">Sie können einen Standardwert für eine benutzerspezifische Einstellung mit <xref:System.Configuration.DefaultSettingValueAttribute>festlegen.</span><span class="sxs-lookup"><span data-stu-id="096e9-131">You can specify a default for a user-scoped setting with <xref:System.Configuration.DefaultSettingValueAttribute>.</span></span> <span data-ttu-id="096e9-132">Da sich benutzerspezifische Einstellungen häufig während der Ausführung der Anwendung ändern, hat `user`config Lese-/Schreibzugriff.</span><span class="sxs-lookup"><span data-stu-id="096e9-132">Because user-scoped settings often change during application execution, `user`.config is always read/write.</span></span>

 <span data-ttu-id="096e9-133">Alle drei Konfigurationsdateien speichern Einstellungen im XML-Format.</span><span class="sxs-lookup"><span data-stu-id="096e9-133">All three configuration files store settings in XML format.</span></span> <span data-ttu-id="096e9-134">Das XML-Element der obersten Ebene für anwendungsspezifische Einstellungen ist `<appSettings>`, während `<userSettings>` für die benutzerspezifischen Einstellungen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="096e9-134">The top-level XML element for application-scoped settings is `<appSettings>`, while `<userSettings>` is used for user-scoped settings.</span></span> <span data-ttu-id="096e9-135">Eine `app`. exe.config-Datei mit anwendungsspezifischen Einstellungen und Standardwerten für benutzerspezifische Einstellungen sieht wie folgt aus:</span><span class="sxs-lookup"><span data-stu-id="096e9-135">An `app`.exe.config file which contains both application-scoped settings and defaults for user-scoped settings would look like this:</span></span>

```xml
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <configSections>
        <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
            <section name="WindowsApplication1.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
        </sectionGroup>
        <sectionGroup name="userSettings" type="System.Configuration.UserSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" >
            <section name="WindowsApplication1.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" allowExeDefinition="MachineToLocalUser" />
        </sectionGroup>
    </configSections>
    <applicationSettings>
        <WindowsApplication1.Properties.Settings>
            <setting name="Cursor" serializeAs="String">
                <value>Default</value>
            </setting>
            <setting name="DoubleBuffering" serializeAs="String">
                <value>False</value>
            </setting>
        </WindowsApplication1.Properties.Settings>
    </applicationSettings>
    <userSettings>
        <WindowsApplication1.Properties.Settings>
            <setting name="FormTitle" serializeAs="String">
                <value>Form1</value>
            </setting>
            <setting name="FormSize" serializeAs="String">
                <value>595, 536</value>
            </setting>
        </WindowsApplication1.Properties.Settings>
    </userSettings>
</configuration>
```

 <span data-ttu-id="096e9-136">Eine Definition der Elemente im Abschnitt Anwendungseinstellungen einer Konfigurationsdatei finden Sie unter [Schema für Anwendungseinstellungen](../../configure-apps/file-schema/application-settings-schema.md).</span><span class="sxs-lookup"><span data-stu-id="096e9-136">For a definition of the elements within the application settings section of a configuration file, see [Application Settings Schema](../../configure-apps/file-schema/application-settings-schema.md).</span></span>

### <a name="settings-bindings"></a><span data-ttu-id="096e9-137">Einstellungen für Bindungen</span><span class="sxs-lookup"><span data-stu-id="096e9-137">Settings Bindings</span></span>
 <span data-ttu-id="096e9-138">Anwendungseinstellungen verwenden die Datenbindungsarchitektur von Windows Forms, um die bidirektionale Kommunikation von Einstellungsaktualisierungen zwischen dem Einstellungsobjekt und den Komponenten bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="096e9-138">Application settings uses the Windows Forms data binding architecture to provide two-way communication of settings updates between the settings object and components.</span></span> <span data-ttu-id="096e9-139">Wenn Sie mit Visual Studio Anwendungseinstellungen erstellen und diese Komponenteneigenschaften zuordnen, werden die Bindungen automatisch generiert.</span><span class="sxs-lookup"><span data-stu-id="096e9-139">If you use Visual Studio to create application settings and assign them to component properties, these bindings are generated automatically.</span></span>

 <span data-ttu-id="096e9-140">Eine Anwendungs Einstellung kann nur an eine Komponente gebunden werden, die die <xref:System.Windows.Forms.IBindableComponent> -Schnittstelle unterstützt.</span><span class="sxs-lookup"><span data-stu-id="096e9-140">You can only bind an application setting to a component that supports the <xref:System.Windows.Forms.IBindableComponent> interface.</span></span> <span data-ttu-id="096e9-141">Außerdem muss die Komponente ein Änderungs Ereignis für eine bestimmte gebundene Eigenschaft implementieren oder Anwendungseinstellungen benachrichtigen, dass die Eigenschaft über die <xref:System.ComponentModel.INotifyPropertyChanged> -Schnittstelle geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="096e9-141">Also, the component must implement a change event for a specific bound property, or notify application settings that the property has changed through the <xref:System.ComponentModel.INotifyPropertyChanged> interface.</span></span> <span data-ttu-id="096e9-142">Wenn die Komponente nicht implementiert und <xref:System.Windows.Forms.IBindableComponent> Sie die Bindung über Visual Studio durchführen, werden die gebundenen Eigenschaften zum ersten Mal festgelegt, aber nicht aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="096e9-142">If the component does not implement <xref:System.Windows.Forms.IBindableComponent> and you are binding through Visual Studio, the bound properties will be set the first time, but will not update.</span></span> <span data-ttu-id="096e9-143">Wenn die Komponente implementiert <xref:System.Windows.Forms.IBindableComponent> , aber keine Benachrichtigungen über Eigenschafts Änderungen unterstützt, wird die Bindung nicht in der Einstellungsdatei aktualisiert, wenn die-Eigenschaft geändert wird.</span><span class="sxs-lookup"><span data-stu-id="096e9-143">If the component implements <xref:System.Windows.Forms.IBindableComponent> but does not support property change notifications, the binding will not update in the settings file when the property is changed.</span></span>

 <span data-ttu-id="096e9-144">Einige Windows Forms Komponenten, wie z <xref:System.Windows.Forms.ToolStripItem>. b., unterstützen keine Einstellungs Bindungen.</span><span class="sxs-lookup"><span data-stu-id="096e9-144">Some Windows Forms components, such as <xref:System.Windows.Forms.ToolStripItem>, do not support settings bindings.</span></span>

### <a name="settings-serialization"></a><span data-ttu-id="096e9-145">Serialisierung von Einstellungen</span><span class="sxs-lookup"><span data-stu-id="096e9-145">Settings Serialization</span></span>
 <span data-ttu-id="096e9-146">Wenn <xref:System.Configuration.LocalFileSettingsProvider> Einstellungen auf dem Datenträger gespeichert werden müssen, werden die folgenden Aktionen durchführt:</span><span class="sxs-lookup"><span data-stu-id="096e9-146">When <xref:System.Configuration.LocalFileSettingsProvider> must save settings to disk, it performs the following actions:</span></span>

1. <span data-ttu-id="096e9-147">Verwendet Reflektion, um alle Eigenschaften zu überprüfen, <xref:System.Configuration.ApplicationSettingsBase> die in der abgeleiteten Klasse definiert sind, und <xref:System.Configuration.ApplicationScopedSettingAttribute> ermittelt <xref:System.Configuration.UserScopedSettingAttribute>die Eigenschaften, die entweder mit oder angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="096e9-147">Uses reflection to examine all of the properties defined on your <xref:System.Configuration.ApplicationSettingsBase> derived class, finding those that are applied with either <xref:System.Configuration.ApplicationScopedSettingAttribute> or <xref:System.Configuration.UserScopedSettingAttribute>.</span></span>

2. <span data-ttu-id="096e9-148">Serialisieren der Eigenschaft auf den Datenträger.</span><span class="sxs-lookup"><span data-stu-id="096e9-148">Serializes the property to disk.</span></span> <span data-ttu-id="096e9-149">Zuerst wird versucht, den <xref:System.ComponentModel.TypeConverter.ConvertToString%2A> oder <xref:System.ComponentModel.TypeConverter.ConvertFromString%2A> <xref:System.ComponentModel.TypeConverter>für die zugeordnete des Typs aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="096e9-149">It first attempts to call the <xref:System.ComponentModel.TypeConverter.ConvertToString%2A> or <xref:System.ComponentModel.TypeConverter.ConvertFromString%2A> on the type's associated <xref:System.ComponentModel.TypeConverter>.</span></span> <span data-ttu-id="096e9-150">Schlägt der Versuch fehl, wird stattdessen die XML-Serialisierung angewendet.</span><span class="sxs-lookup"><span data-stu-id="096e9-150">If this does not succeed, it uses XML serialization instead.</span></span>

3. <span data-ttu-id="096e9-151">Bestimmen, welche Einstellungen in welche Datei übergehen, basierend auf dem Attribut der Einstellung.</span><span class="sxs-lookup"><span data-stu-id="096e9-151">Determines which settings go in which files, based on the setting's attribute.</span></span>

 <span data-ttu-id="096e9-152">Wenn Sie Ihre eigene Einstellungs Klasse implementieren, können Sie mit dem <xref:System.Configuration.SettingsSerializeAsAttribute> eine Einstellung für die binäre oder benutzerdefinierte Serialisierung mithilfe der <xref:System.Configuration.SettingsSerializeAs> -Enumeration markieren.</span><span class="sxs-lookup"><span data-stu-id="096e9-152">If you implement your own settings class, you can use the <xref:System.Configuration.SettingsSerializeAsAttribute> to mark a setting for either binary or custom serialization using the <xref:System.Configuration.SettingsSerializeAs> enumeration.</span></span> <span data-ttu-id="096e9-153">Weitere Informationen zum Erstellen Ihrer eigenen Einstellungs Klasse im Code finden [Sie unter Gewusst wie: Erstellen Sie Anwendungs](how-to-create-application-settings.md)Einstellungen.</span><span class="sxs-lookup"><span data-stu-id="096e9-153">For more information on creating your own settings class in code, see [How to: Create Application Settings](how-to-create-application-settings.md).</span></span>

### <a name="settings-file-locations"></a><span data-ttu-id="096e9-154">Einstellen von Dateispeicherorten</span><span class="sxs-lookup"><span data-stu-id="096e9-154">Settings File Locations</span></span>
 <span data-ttu-id="096e9-155">Der Speicherort der Dateien `app`. exe.config und *benutzer*.config hängt davon ab, wie die Anwendung installiert ist.</span><span class="sxs-lookup"><span data-stu-id="096e9-155">The location of the `app`.exe.config and *user*.config files will differ based on how the application is installed.</span></span> <span data-ttu-id="096e9-156">Bei einer Windows Forms basierten Anwendung, die auf den lokalen Computer kopiert `app`wurde, befindet sich die Datei. exe. config im selben Verzeichnis wie das Basisverzeichnis der ausführbaren Hauptdatei der Anwendung, und die Datei " *User*. config" befindet sich an dem Speicherort, der von angegeben wird. die <xref:System.Windows.Forms.Application.LocalUserAppDataPath%2A?displayProperty=nameWithType> -Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="096e9-156">For a Windows Forms-based application copied onto the local computer, `app`.exe.config will reside in the same directory as the base directory of the application's main executable file, and *user*.config will reside in the location specified by the <xref:System.Windows.Forms.Application.LocalUserAppDataPath%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="096e9-157">Für eine Anwendung, die mittels ClickOnce installiert wird, befinden sich beide Dateien im ClickOnce-Datenverzeichnis unter%InstallRoot%\Documents und Settings\\*username*\Local Settings.</span><span class="sxs-lookup"><span data-stu-id="096e9-157">For an application installed by means of ClickOnce, both of these files will reside in the ClickOnce Data Directory underneath %InstallRoot%\Documents and Settings\\*username*\Local Settings.</span></span>

 <span data-ttu-id="096e9-158">Der Speicherort dieser Dateien unterscheidet sich geringfügig, wenn ein Benutzer Roamingprofile aktiviert hat. Der Benutzer kann dann verschiedene Windows- oder Anwendungseinstellungen definieren, wenn er andere Computer in einer Domäne verwendet.</span><span class="sxs-lookup"><span data-stu-id="096e9-158">The storage location of these files is slightly different if a user has enabled roaming profiles, which enables a user to define different Windows and application settings when he or she is using other computers within a domain.</span></span> <span data-ttu-id="096e9-159">In diesem Fall werden `app`die Dateien exe. config und *User*. config sowohl von ClickOnce-Anwendungen als auch von nicht-ClickOnce-Anwendungen unter%InstallRoot%\Documents und\\Settings*username*\ Application Data gespeichert.</span><span class="sxs-lookup"><span data-stu-id="096e9-159">In that case, both ClickOnce applications and non-ClickOnce applications will have their `app`.exe.config and *user*.config files stored under %InstallRoot%\Documents and Settings\\*username*\Application Data.</span></span>

 <span data-ttu-id="096e9-160">Weitere Informationen zur Funktionsweise der Anwendungseinstellungen mit der neuen Bereitstellungstechnologie finden Sie unter [ClickOnce und Anwendungseinstellungen](/visualstudio/deployment/clickonce-and-application-settings).</span><span class="sxs-lookup"><span data-stu-id="096e9-160">For more information about how the Application Settings feature works with the new deployment technology, see [ClickOnce and Application Settings](/visualstudio/deployment/clickonce-and-application-settings).</span></span> <span data-ttu-id="096e9-161">Weitere Informationen zum ClickOnce-Datenverzeichnis finden Sie unter [zugreifen auf lokale und Remote Daten in ClickOnce-Anwendungen](/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications).</span><span class="sxs-lookup"><span data-stu-id="096e9-161">For more information about the ClickOnce Data Directory, see [Accessing Local and Remote Data in ClickOnce Applications](/visualstudio/deployment/accessing-local-and-remote-data-in-clickonce-applications).</span></span>

## <a name="application-settings-and-security"></a><span data-ttu-id="096e9-162">Einstellungen und Sicherheit von Anwendungen</span><span class="sxs-lookup"><span data-stu-id="096e9-162">Application Settings and Security</span></span>
 <span data-ttu-id="096e9-163">Anwendungseinstellungen sollen in teilweiser Vertrauenswürdigkeit, einer eingeschränkten Umgebung, funktionieren, die der Standard für über das Internet oder ein Intranet gehostete Windows Forms-Anwendungen ist.</span><span class="sxs-lookup"><span data-stu-id="096e9-163">Application settings are designed to work in partial trust, a restricted environment that is the default for Windows Forms applications hosted over the Internet or an intranet.</span></span> <span data-ttu-id="096e9-164">Außer teilweiser Vertrauenswürdigkeit sind keine besonderen Berechtigungen erforderlich, um Anwendungseinstellungen mit dem Standardeinstellungsanbieter zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="096e9-164">No special permissions beyond partial trust are needed to use application settings with the default settings provider.</span></span>

 <span data-ttu-id="096e9-165">Wenn Anwendungseinstellungen in einer ClickOnce-Anwendung verwendet werden, `user`wird die config-Datei im ClickOnce-Datenverzeichnis gespeichert.</span><span class="sxs-lookup"><span data-stu-id="096e9-165">When application settings are used in a ClickOnce application, the `user`.config file is stored in the ClickOnce data directory.</span></span> <span data-ttu-id="096e9-166">Die Größe der config- `user`Datei der Anwendung darf nicht das von ClickOnce festgelegte Datenverzeichnis Kontingent überschreiten.</span><span class="sxs-lookup"><span data-stu-id="096e9-166">The size of the application's `user`.config file cannot exceed the data directory quota set by ClickOnce.</span></span> <span data-ttu-id="096e9-167">Weitere Informationen finden Sie unter [ClickOnce und Anwendungseinstellungen](/visualstudio/deployment/clickonce-and-application-settings).</span><span class="sxs-lookup"><span data-stu-id="096e9-167">For more information, see [ClickOnce and Application Settings](/visualstudio/deployment/clickonce-and-application-settings).</span></span>

## <a name="custom-settings-providers"></a><span data-ttu-id="096e9-168">Benutzerdefinierte Einstellungsanbieter</span><span class="sxs-lookup"><span data-stu-id="096e9-168">Custom Settings Providers</span></span>
 <span data-ttu-id="096e9-169">In der Architektur der Anwendungseinstellungen gibt es eine lose Kopplung zwischen der Anwendungs Einstellungs-Wrapper Klasse, die <xref:System.Configuration.ApplicationSettingsBase>von abgeleitet ist, und den zugeordneten Einstellungs Anbietern bzw <xref:System.Configuration.SettingsProvider>. Anbietern, die von abgeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="096e9-169">In the Application Settings architecture, there is a loose coupling between the applications settings wrapper class, derived from <xref:System.Configuration.ApplicationSettingsBase>, and the associated settings provider or providers, derived from <xref:System.Configuration.SettingsProvider>.</span></span> <span data-ttu-id="096e9-170">Diese Zuordnung wird nur durch das definiert <xref:System.Configuration.SettingsProviderAttribute> , das auf die Wrapper Klasse oder die jeweiligen Eigenschaften angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="096e9-170">This association is defined only by the <xref:System.Configuration.SettingsProviderAttribute> applied to the wrapper class or its individual properties.</span></span> <span data-ttu-id="096e9-171">Wenn ein Einstellungs Anbieter nicht explizit angegeben wird, wird der Standardanbieter <xref:System.Configuration.LocalFileSettingsProvider>verwendet.</span><span class="sxs-lookup"><span data-stu-id="096e9-171">If a settings provider is not explicitly specified, the default provider, <xref:System.Configuration.LocalFileSettingsProvider>, is used.</span></span> <span data-ttu-id="096e9-172">Daher unterstützt diese Architektur das Erstellen und Verwenden von benutzerdefinierten Einstellungsanbietern.</span><span class="sxs-lookup"><span data-stu-id="096e9-172">As a result, this architecture supports creating and using custom settings providers.</span></span>

 <span data-ttu-id="096e9-173">Nehmen wir beispielsweise an, dass Sie `SqlSettingsProvider`, entwickeln und verwenden möchten, einen Anbieter, der sämtliche Einstellungsdaten in einer Microsoft SQL Server-Datenbank speichert.</span><span class="sxs-lookup"><span data-stu-id="096e9-173">For example, suppose that you want to develop and use `SqlSettingsProvider`, a provider that will store all settings data in a Microsoft SQL Server database.</span></span> <span data-ttu-id="096e9-174">Die <xref:System.Configuration.SettingsProvider>von abgeleitete Klasse empfängt diese Informationen in Ihrer `Initialize` -Methode als Parameter vom Typ <xref:System.Collections.Specialized.NameValueCollection?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="096e9-174">Your <xref:System.Configuration.SettingsProvider>-derived class would receive this information in its `Initialize` method as a parameter of type <xref:System.Collections.Specialized.NameValueCollection?displayProperty=nameWithType>.</span></span> <span data-ttu-id="096e9-175">Anschließend implementieren Sie die <xref:System.Configuration.SettingsProvider.GetPropertyValues%2A> -Methode, um die Einstellungen aus dem Datenspeicher abzurufen und <xref:System.Configuration.SettingsProvider.SetPropertyValues%2A> zu speichern.</span><span class="sxs-lookup"><span data-stu-id="096e9-175">You would then implement the <xref:System.Configuration.SettingsProvider.GetPropertyValues%2A> method to retrieve your settings from the data store, and <xref:System.Configuration.SettingsProvider.SetPropertyValues%2A> to save them.</span></span> <span data-ttu-id="096e9-176">Der Anbieter kann den <xref:System.Configuration.SettingsPropertyCollection> bereitgestellten für <xref:System.Configuration.SettingsProvider.GetPropertyValues%2A> verwenden, um den Namen, den Typ und den Gültigkeitsbereich der Eigenschaft sowie alle anderen Einstellungs Attribute zu bestimmen, die für diese Eigenschaft definiert sind.</span><span class="sxs-lookup"><span data-stu-id="096e9-176">Your provider can use the <xref:System.Configuration.SettingsPropertyCollection> supplied to <xref:System.Configuration.SettingsProvider.GetPropertyValues%2A> to determine the property's name, type, and scope, as well as any other settings attributes defined for that property.</span></span>

 <span data-ttu-id="096e9-177">Der Anbieter muss eine Eigenschaft und eine Methode implementieren, deren Implementierungen möglicherweise nicht offensichtlich sind.</span><span class="sxs-lookup"><span data-stu-id="096e9-177">Your provider will need to implement one property and one method whose implementations may not be obvious.</span></span> <span data-ttu-id="096e9-178">Die <xref:System.Configuration.SettingsProvider.ApplicationName%2A> -Eigenschaft ist eine abstrakte Eigenschaft <xref:System.Configuration.SettingsProvider>von. Sie sollten Sie programmieren, um Folgendes zurückzugeben:</span><span class="sxs-lookup"><span data-stu-id="096e9-178">The <xref:System.Configuration.SettingsProvider.ApplicationName%2A> property is an abstract property of <xref:System.Configuration.SettingsProvider>; you should program it to return the following:</span></span>

 [!code-csharp[ApplicationSettings.Architecture#2](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Architecture/CS/DummyClass.cs#2)]
 [!code-vb[ApplicationSettings.Architecture#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Architecture/VB/DummyProviderClass.vb#2)]

 <span data-ttu-id="096e9-179">Die abgeleitete Klasse muss außerdem eine `Initialize`-Methode implementieren, die keine Argumente akzeptiert und keinen Wert zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="096e9-179">Your derived class must also implement an `Initialize` method that takes no arguments and returns no value.</span></span> <span data-ttu-id="096e9-180">Diese Methode wird nicht von <xref:System.Configuration.SettingsProvider>definiert.</span><span class="sxs-lookup"><span data-stu-id="096e9-180">This method is not defined by <xref:System.Configuration.SettingsProvider>.</span></span>

 <span data-ttu-id="096e9-181">Schließlich implementieren Sie für <xref:System.Configuration.IApplicationSettingsProvider> Ihren Anbieter, um Unterstützung für das Aktualisieren von Einstellungen, das Zurücksetzen von Einstellungen auf ihre Standardwerte und das Aktualisieren von Einstellungen von einer Anwendungs Version auf eine andere zu bieten.</span><span class="sxs-lookup"><span data-stu-id="096e9-181">Finally, you implement <xref:System.Configuration.IApplicationSettingsProvider> on your provider to provide support for refreshing settings, reverting settings to their defaults, and upgrading settings from one application version to another.</span></span>

 <span data-ttu-id="096e9-182">Nachdem Sie Ihren Anbieter implementiert und kompiliert haben, müssen Sie Ihre Einstellungenklasse anweisen, diesen Anbieter anstelle des standardmäßigen Anbieters zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="096e9-182">Once you have implemented and compiled your provider, you need to instruct your settings class to use this provider instead of the default.</span></span> <span data-ttu-id="096e9-183">Dies erreichen Sie über den <xref:System.Configuration.SettingsProviderAttribute>.</span><span class="sxs-lookup"><span data-stu-id="096e9-183">You accomplish this through the <xref:System.Configuration.SettingsProviderAttribute>.</span></span> <span data-ttu-id="096e9-184">Wenn Sie auf eine gesamte Einstellungs Klasse angewendet wird, wird der Anbieter für jede Einstellung verwendet, die von der-Klasse definiert wird. Wenn Sie auf einzelne Einstellungen angewendet wird, verwendet die Architektur der Anwendungseinstellungen diesen Anbieter nur für diese <xref:System.Configuration.LocalFileSettingsProvider> Einstellungen und für den Rest.</span><span class="sxs-lookup"><span data-stu-id="096e9-184">If applied to an entire settings class, the provider is used for each setting that the class defines; if applied to individual settings, Application Settings architecture uses that provider for those settings only, and uses <xref:System.Configuration.LocalFileSettingsProvider> for the rest.</span></span> <span data-ttu-id="096e9-185">Das folgende Codebeispiel veranschaulicht, wie die Einstellungenklasse angewiesen wird, den benutzerdefinierten Anbieter zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="096e9-185">The following code example shows how to instruct the settings class to use your custom provider.</span></span>

 [!code-csharp[ApplicationSettings.Architecture#1](~/samples/snippets/csharp/VS_Snippets_Winforms/ApplicationSettings.Architecture/CS/DummyClass.cs#1)]
 [!code-vb[ApplicationSettings.Architecture#1](~/samples/snippets/visualbasic/VS_Snippets_Winforms/ApplicationSettings.Architecture/VB/DummyProviderClass.vb#1)]

 <span data-ttu-id="096e9-186">Ein Anbieter kann von mehreren Threads gleichzeitig aufgerufen werden, schreibt jedoch immer in den gleichen Speicherort. Aus diesem Grund instanziiert die Architektur für Anwendungseinstellungen immer nur eine einzelne Instanz der Anbieterklasse.</span><span class="sxs-lookup"><span data-stu-id="096e9-186">A provider may be called from multiple threads simultaneously, but it will always write to the same storage location; therefore, the Application Settings architecture will only ever instantiate a single instance of your provider class.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="096e9-187">Sie sollten sicherstellen, dass der Anbieter threadsicher ist und jeweils nur einem Thread gestattet, in die Konfigurationsdateien zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="096e9-187">You should ensure that your provider is thread-safe, and only allows one thread at a time to write to the configuration files.</span></span>

 <span data-ttu-id="096e9-188">Der Anbieter muss nicht alle Einstellungs Attribute <xref:System.Configuration?displayProperty=nameWithType> unterstützen, die im-Namespace definiert sind, er muss jedoch mindestens unterstützt <xref:System.Configuration.ApplicationScopedSettingAttribute> werden und <xref:System.Configuration.UserScopedSettingAttribute>muss ebenfalls unterstützen. <xref:System.Configuration.DefaultSettingValueAttribute></span><span class="sxs-lookup"><span data-stu-id="096e9-188">Your provider does not need to support all of the settings attributes defined in the <xref:System.Configuration?displayProperty=nameWithType> namespace, though it must at a minimum support <xref:System.Configuration.ApplicationScopedSettingAttribute> and <xref:System.Configuration.UserScopedSettingAttribute>, and should also support <xref:System.Configuration.DefaultSettingValueAttribute>.</span></span> <span data-ttu-id="096e9-189">Für die Attribute, die nicht unterstützt werden, sollte der Anbieter ohne Benachrichtigung fehlschlagen und keine Ausnahme auslösen.</span><span class="sxs-lookup"><span data-stu-id="096e9-189">For those attributes that it does not support, your provider should just fail without notification; it should not throw an exception.</span></span> <span data-ttu-id="096e9-190">Wenn die Settings-Klasse eine ungültige Kombination von Attributen verwendet – z. <xref:System.Configuration.ApplicationScopedSettingAttribute> b <xref:System.Configuration.UserScopedSettingAttribute> . Anwenden von und auf dieselbe Einstellung –, sollte der Anbieter eine Ausnahme auslösen und den Vorgang beenden.</span><span class="sxs-lookup"><span data-stu-id="096e9-190">If the settings class uses an invalid combination of attributes, however — such as applying <xref:System.Configuration.ApplicationScopedSettingAttribute> and <xref:System.Configuration.UserScopedSettingAttribute> to the same setting — your provider should throw an exception and cease operation.</span></span>

## <a name="see-also"></a><span data-ttu-id="096e9-191">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="096e9-191">See also</span></span>

- <xref:System.Configuration.ApplicationSettingsBase>
- <xref:System.Configuration.SettingsProvider>
- <xref:System.Configuration.LocalFileSettingsProvider>
- [<span data-ttu-id="096e9-192">Übersicht über Anwendungseinstellungen</span><span class="sxs-lookup"><span data-stu-id="096e9-192">Application Settings Overview</span></span>](application-settings-overview.md)
- [<span data-ttu-id="096e9-193">Application Settings for Custom Controls</span><span class="sxs-lookup"><span data-stu-id="096e9-193">Application Settings for Custom Controls</span></span>](application-settings-for-custom-controls.md)
- [<span data-ttu-id="096e9-194">ClickOnce und Anwendungseinstellungen</span><span class="sxs-lookup"><span data-stu-id="096e9-194">ClickOnce and Application Settings</span></span>](/visualstudio/deployment/clickonce-and-application-settings)
- [<span data-ttu-id="096e9-195">Schema für Anwendungseinstellungen</span><span class="sxs-lookup"><span data-stu-id="096e9-195">Application Settings Schema</span></span>](../../configure-apps/file-schema/application-settings-schema.md)
