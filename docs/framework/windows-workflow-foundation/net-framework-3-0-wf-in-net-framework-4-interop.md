---
title: Verwenden von .NET Framework 3.0-WF-Aktivitäten unter .NET Framework 4 mit der Interop-Aktivität
ms.date: 03/30/2017
ms.assetid: 71f112ba-abb0-46f7-b05f-a5d2eb9d0c5c
ms.openlocfilehash: 69b3a49f96de4f955b16225864be3ee46b168356
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/26/2020
ms.locfileid: "96268624"
---
# <a name="using-net-framework-30-wf-activities-in-net-framework-4-with-the-interop-activity"></a><span data-ttu-id="112a9-102">Verwenden von .NET Framework 3.0-WF-Aktivitäten unter .NET Framework 4 mit der Interop-Aktivität</span><span class="sxs-lookup"><span data-stu-id="112a9-102">Using .NET Framework 3.0 WF Activities in .NET Framework 4 with the Interop Activity</span></span>

<span data-ttu-id="112a9-103">Bei der <xref:System.Activities.Statements.Interop> Aktivität handelt es sich um eine-Aktivität [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] (WF 4,5), die eine .NET Framework 3,5 (WF 3,5)-Aktivität innerhalb eines Workflows umschließt [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="112a9-103">The <xref:System.Activities.Statements.Interop> activity is a [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] (WF 4.5) activity that wraps a .NET Framework 3.5 (WF 3.5) activity within a [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] workflow.</span></span> <span data-ttu-id="112a9-104">Die WF 3-Aktivität kann eine einzelne Blattaktivität oder eine ganze Aktivitätsstruktur darstellen.</span><span class="sxs-lookup"><span data-stu-id="112a9-104">The WF 3 activity can be a single leaf activity or an entire tree of activities.</span></span> <span data-ttu-id="112a9-105">Die Ausführung (einschließlich Abbruch und Ausnahmebehandlung) und die Persistenz der .NET Framework 3,5-Aktivität erfolgen innerhalb des Kontexts der [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] Workflow Instanz, die ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="112a9-105">The execution (including cancellation and exception handling) and the persistence of the .NET Framework 3.5 activity occur within the context of the [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] workflow instance that is executing.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="112a9-106">Die- <xref:System.Activities.Statements.Interop> Aktivität wird nicht in der Toolbox des Workflow-Designers angezeigt, es sei denn, für das Projekt des Workflows ist die Einstellung für das **Ziel Framework** auf " **.NET Framework 4,5**</span><span class="sxs-lookup"><span data-stu-id="112a9-106">The <xref:System.Activities.Statements.Interop> activity does not appear in the workflow designer toolbox unless the workflow's project has its **Target Framework** setting set to **.NET Framework 4.5**.</span></span>  
  
## <a name="criteria-for-using-a-wf-3-activity-with-an-interop-activity"></a><span data-ttu-id="112a9-107">Kriterien für die Verwendung einer WF 3-Aktivität mit einer Interop-Aktivität</span><span class="sxs-lookup"><span data-stu-id="112a9-107">Criteria for Using a WF 3 Activity with an Interop Activity</span></span>  

 <span data-ttu-id="112a9-108">Damit eine WF 3-Aktivität innerhalb einer <xref:System.Activities.Statements.Interop>-Aktivität erfolgreich ausgeführt werden kann, müssen die folgenden Kriterien erfüllt werden:</span><span class="sxs-lookup"><span data-stu-id="112a9-108">For a WF 3 activity to successfully execute within an <xref:System.Activities.Statements.Interop> activity, the following criteria must be met:</span></span>  
  
- <span data-ttu-id="112a9-109">Die WF 3-Aktivität muss von <xref:System.Workflow.ComponentModel.Activity?displayProperty=nameWithType> abgeleitet sein.</span><span class="sxs-lookup"><span data-stu-id="112a9-109">The WF 3 activity must derive from <xref:System.Workflow.ComponentModel.Activity?displayProperty=nameWithType>.</span></span>  
  
- <span data-ttu-id="112a9-110">Die WF 3-Aktivität muss als `public` deklariert werden und darf nicht `abstract` sein.</span><span class="sxs-lookup"><span data-stu-id="112a9-110">The WF 3 activity must be declared as `public` and cannot be `abstract`.</span></span>  
  
- <span data-ttu-id="112a9-111">Die WF 3-Aktivität muss über einen öffentlichen Parameter losen Konstruktor verfügen.</span><span class="sxs-lookup"><span data-stu-id="112a9-111">The WF 3 activity must have a public parameterless constructor.</span></span>  
  
- <span data-ttu-id="112a9-112">Aufgrund von Einschränkungen bei den Schnittstellentypen, die die <xref:System.Activities.Statements.Interop>-Aktivität unterstützen kann, können das <xref:System.Workflow.Activities.HandleExternalEventActivity>-Objekt und das <xref:System.Workflow.Activities.CallExternalMethodActivity>-Objekt nicht direkt verwendet werden. Abgeleitete Aktivitäten, die mit dem Tool für Workflow-Kommunikationsaktivitäten (WCA.exe) erstellt wurden, können jedoch verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="112a9-112">Due to limitations in the interface types that the <xref:System.Activities.Statements.Interop> activity can support, <xref:System.Workflow.Activities.HandleExternalEventActivity> and <xref:System.Workflow.Activities.CallExternalMethodActivity> cannot be used directly, but derivative activities created using the Workflow Communication Activity tool (WCA.exe) can be used.</span></span> <span data-ttu-id="112a9-113">Weitere Informationen finden Sie unter [Windows Workflow Foundation Tools](/previous-versions/dotnet/netframework-3.5/ms734408(v=vs.90)) .</span><span class="sxs-lookup"><span data-stu-id="112a9-113">See [Windows Workflow Foundation Tools](/previous-versions/dotnet/netframework-3.5/ms734408(v=vs.90)) for details.</span></span>  
  
## <a name="configuring-a-wf-3-activity-within-an-interop-activity"></a><span data-ttu-id="112a9-114">Konfigurieren einer WF 3-Aktivität innerhalb einer Interop-Aktivität</span><span class="sxs-lookup"><span data-stu-id="112a9-114">Configuring a WF 3 Activity Within an Interop Activity</span></span>  

 <span data-ttu-id="112a9-115">Um Daten zu konfigurieren und in bzw. aus einer WF 3-Aktivität über die Grenzen der Interoperation zu übergeben, werden die Eigenschaften und die Metadateneigenschaften der WF 3-Aktivität von der <xref:System.Activities.Statements.Interop>-Aktivität verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="112a9-115">To configure and pass data into and out of a WF 3 activity, across the interoperation boundary, the WF 3 activity’s properties and metadata properties are exposed by the <xref:System.Activities.Statements.Interop> activity.</span></span> <span data-ttu-id="112a9-116">Die Metadateneigenschaften der WF 3-Aktivität (z. B. <xref:System.Workflow.ComponentModel.Activity.Name%2A>) werden über die <xref:System.Activities.Statements.Interop.ActivityMetaProperties%2A>-Auflistung verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="112a9-116">The WF 3 activity’s metadata properties (such as <xref:System.Workflow.ComponentModel.Activity.Name%2A>) are exposed through the <xref:System.Activities.Statements.Interop.ActivityMetaProperties%2A> collection.</span></span> <span data-ttu-id="112a9-117">Dies ist eine Auflistung von Name-Wert-Paaren, mit denen die Werte für die Metadateneigenschaften der WF 3-Aktivität definiert werden.</span><span class="sxs-lookup"><span data-stu-id="112a9-117">This is a collection of name-value pairs used to define the values for the WF 3 activity’s metadata properties.</span></span> <span data-ttu-id="112a9-118">Eine Metadateneigenschaft ist eine Eigenschaft, die von der Abhängigkeitseigenschaft unterstützt wird, für die das <xref:System.Workflow.ComponentModel.DependencyPropertyOptions.Metadata>-Kennzeichen festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="112a9-118">A metadata property is a property backed by dependency property for which the <xref:System.Workflow.ComponentModel.DependencyPropertyOptions.Metadata> flag is set.</span></span>  
  
 <span data-ttu-id="112a9-119">Die Eigenschaften der WF 3-Aktivität werden über die <xref:System.Activities.Statements.Interop.ActivityProperties%2A>-Auflistung verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="112a9-119">The WF 3 activity’s properties are exposed through the <xref:System.Activities.Statements.Interop.ActivityProperties%2A> collection.</span></span> <span data-ttu-id="112a9-120">Dies ist ein Satz von Name-Wert-Paaren, wobei jeder Wert ein <xref:System.Activities.Argument>-Objekt ist, mit dem Argumente für die Eigenschaften der WF 3-Aktivität definiert werden.</span><span class="sxs-lookup"><span data-stu-id="112a9-120">This is a set of name-value pairs, where each value is a <xref:System.Activities.Argument> object, used to define the arguments for the WF 3 activity’s properties.</span></span> <span data-ttu-id="112a9-121">Da die Richtung einer WF 3-Aktivitäts Eigenschaft nicht abgeleitet werden kann, wird jede Eigenschaft als <xref:System.Activities.InArgument> / <xref:System.Activities.OutArgument> paar angezeigt.</span><span class="sxs-lookup"><span data-stu-id="112a9-121">Because the direction of a WF 3 activity property cannot be inferred, every property is surfaced as an <xref:System.Activities.InArgument>/<xref:System.Activities.OutArgument> pair.</span></span> <span data-ttu-id="112a9-122">Abhängig von der Verwendung der Aktivitätseigenschaft empfiehlt es sich, einen <xref:System.Activities.InArgument>-Eintrag, einen <xref:System.Activities.OutArgument>-Eintrag oder beides bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="112a9-122">Depending on the activity’s usage of the property, you may want to provide an <xref:System.Activities.InArgument> entry, an <xref:System.Activities.OutArgument> entry, or both.</span></span> <span data-ttu-id="112a9-123">Der erwartete Name des <xref:System.Activities.InArgument>-Eintrags in der Auflistung entspricht dem Namen der Eigenschaft, wie sie für die WF 3-Aktivität definiert wurde.</span><span class="sxs-lookup"><span data-stu-id="112a9-123">The expected name of the <xref:System.Activities.InArgument> entry in the collection is the name of the property as defined on the WF 3 activity.</span></span> <span data-ttu-id="112a9-124">Der erwartete Name des <xref:System.Activities.OutArgument> Eintrags in der Auflistung ist eine Verkettung des Namens der Eigenschaft und der Zeichenfolge "out".</span><span class="sxs-lookup"><span data-stu-id="112a9-124">The expected name of the <xref:System.Activities.OutArgument> entry in the collection is a concatenation of the name of the property and the string "Out".</span></span>  
  
## <a name="limitations-of-using-a-wf-3-activity-within-an-interop-activity"></a><span data-ttu-id="112a9-125">Einschränkungen bei der Verwendung einer WF 3-Aktivität innerhalb einer Interop-Aktivität</span><span class="sxs-lookup"><span data-stu-id="112a9-125">Limitations of Using a WF 3 Activity Within an Interop Activity</span></span>  

 <span data-ttu-id="112a9-126">Die vom System bereitgestellten WF 3-Aktivitäten können nicht direkt in einer <xref:System.Activities.Statements.Interop>-Aktivität umschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="112a9-126">The WF 3 system-provided activities cannot be directly wrapped in an <xref:System.Activities.Statements.Interop> activity.</span></span> <span data-ttu-id="112a9-127">Bei einigen WF 3-Aktivitäten ist der Grund hierfür, dass es eine analoge WF 4.5-Aktivität wie z. B. <xref:System.Workflow.Activities.DelayActivity> gibt.</span><span class="sxs-lookup"><span data-stu-id="112a9-127">For some WF 3 activities, such as <xref:System.Workflow.Activities.DelayActivity>, this is because there is an analogous WF 4.5 activity.</span></span> <span data-ttu-id="112a9-128">Bei anderen rührt dies daher, dass die Funktionalität der Aktivität nicht unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="112a9-128">For others, this is because the functionality of the activity is not supported.</span></span> <span data-ttu-id="112a9-129">Viele vom System bereitgestellte WF 3-Aktivitäten können in Workflows verwendet werden, die von der <xref:System.Activities.Statements.Interop>-Aktivität umschlossen werden, jedoch mit folgenden Einschränkungen:</span><span class="sxs-lookup"><span data-stu-id="112a9-129">Many WF 3 system-provided activities can be used within workflows wrapped by the <xref:System.Activities.Statements.Interop> activity, subject to the following restrictions:</span></span>  
  
1. <span data-ttu-id="112a9-130">Das <xref:System.ServiceModel.Activities.Send>-Objekt und das <xref:System.ServiceModel.Activities.Receive>-Objekt können nicht in einer <xref:System.Activities.Statements.Interop>-Aktivität verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="112a9-130"><xref:System.ServiceModel.Activities.Send> and <xref:System.ServiceModel.Activities.Receive> cannot be used in an <xref:System.Activities.Statements.Interop> activity.</span></span>  
  
2. <span data-ttu-id="112a9-131">Die Objekte <xref:System.Workflow.Activities.WebServiceInputActivity>, <xref:System.Workflow.Activities.WebServiceOutputActivity> und <xref:System.Workflow.Activities.WebServiceFaultActivity> können nicht in einer <xref:System.Activities.Statements.Interop>-Aktivität verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="112a9-131"><xref:System.Workflow.Activities.WebServiceInputActivity>, <xref:System.Workflow.Activities.WebServiceOutputActivity>, and <xref:System.Workflow.Activities.WebServiceFaultActivity> cannot be used within an <xref:System.Activities.Statements.Interop> activity.</span></span>  
  
3. <span data-ttu-id="112a9-132">Das <xref:System.Workflow.Activities.InvokeWorkflowActivity>-Objekt kann nicht in einer <xref:System.Activities.Statements.Interop>-Aktivität verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="112a9-132"><xref:System.Workflow.Activities.InvokeWorkflowActivity> cannot be used within an <xref:System.Activities.Statements.Interop> activity.</span></span>  
  
4. <span data-ttu-id="112a9-133">Das <xref:System.Workflow.ComponentModel.SuspendActivity>-Objekt kann nicht in einer <xref:System.Activities.Statements.Interop>-Aktivität verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="112a9-133"><xref:System.Workflow.ComponentModel.SuspendActivity> cannot be used within an <xref:System.Activities.Statements.Interop> activity.</span></span>  
  
5. <span data-ttu-id="112a9-134">Kompensationsbezogene Aktivitäten können nicht in einer <xref:System.Activities.Statements.Interop>-Aktivität verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="112a9-134">Compensation-related activities cannot be used within an <xref:System.Activities.Statements.Interop> activity.</span></span>  
  
 <span data-ttu-id="112a9-135">Es gibt auch einige bestimmte Verhaltensmerkmale bezüglich der Verwendung von WF 3-Aktivitäten in der <xref:System.Activities.Statements.Interop>-Aktivität:</span><span class="sxs-lookup"><span data-stu-id="112a9-135">There are also some behavioral specifics to understand regarding the use of WF 3 activities within the <xref:System.Activities.Statements.Interop> activity:</span></span>  
  
1. <span data-ttu-id="112a9-136">In einer <xref:System.Activities.Statements.Interop>-Aktivität enthaltene WF 3-Aktivitäten werden initialisiert, wenn die <xref:System.Activities.Statements.Interop>-Aktivität ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="112a9-136">WF 3 activities contained within an <xref:System.Activities.Statements.Interop> activity are initialized when the <xref:System.Activities.Statements.Interop> activity is executed.</span></span> <span data-ttu-id="112a9-137">In WF 4.5 gibt es vor der Ausführung keine Initialisierungsphase für eine Workflowinstanz.</span><span class="sxs-lookup"><span data-stu-id="112a9-137">In WF 4.5 there is no initialization phase for a workflow instance prior to its execution.</span></span>  
  
2. <span data-ttu-id="112a9-138">Die WF 4.5-Laufzeit setzt unabhängig davon, wo diese Transaktion beginnt (innerhalb oder außerhalb einer <xref:System.Activities.Statements.Interop>-Aktivität), keinen Prüfpunkt für den Workflowinstanzzustand, wenn eine Transaktion beginnt.</span><span class="sxs-lookup"><span data-stu-id="112a9-138">The WF 4.5 runtime does not checkpoint workflow instance state when a transaction begins, regardless of where that transaction begins (within or outside of an <xref:System.Activities.Statements.Interop> activity).</span></span>  
  
3. <span data-ttu-id="112a9-139">WF 3-Nachverfolgungsdatensätze für Aktivitäten in einer <xref:System.Activities.Statements.Interop>-Aktivität werden für WF 4.5-Nachverfolgungsteilnehmer in Form von <xref:System.Activities.Tracking.InteropTrackingRecord>-Objekten bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="112a9-139">WF 3 tracking records for activities within an <xref:System.Activities.Statements.Interop> activity are provided to WF 4.5 tracking participants as <xref:System.Activities.Tracking.InteropTrackingRecord> objects.</span></span> <span data-ttu-id="112a9-140"><xref:System.Activities.Tracking.InteropTrackingRecord> ist eine Ableitung von <xref:System.Activities.Tracking.CustomTrackingRecord>.</span><span class="sxs-lookup"><span data-stu-id="112a9-140"><xref:System.Activities.Tracking.InteropTrackingRecord> is a derivative of <xref:System.Activities.Tracking.CustomTrackingRecord>.</span></span>  
  
4. <span data-ttu-id="112a9-141">Eine benutzerdefinierte WF 3-Aktivität kann über Workflowwarteschlangen in der Interoperationsumgebung auf Daten zugreifen, wie dies auch innerhalb der WF 3-Workflowlaufzeit möglich ist.</span><span class="sxs-lookup"><span data-stu-id="112a9-141">A WF 3 custom activity can access data using workflow queues within the interoperation environment in exactly the same way as within the WF 3 workflow runtime.</span></span> <span data-ttu-id="112a9-142">Es sind keine benutzerdefinierten Änderungen an Aktivitätscode erforderlich.</span><span class="sxs-lookup"><span data-stu-id="112a9-142">No custom activity code changes are required.</span></span> <span data-ttu-id="112a9-143">Auf dem Host werden Daten in eine WF 3-Workflowwarteschlange eingereiht, indem ein <xref:System.Activities.Bookmark>-Objekt wieder aufgenommen wird.</span><span class="sxs-lookup"><span data-stu-id="112a9-143">On the host, data is enqueued to a WF 3 workflow queue by resuming a <xref:System.Activities.Bookmark>.</span></span> <span data-ttu-id="112a9-144">Der Name des Lesezeichens entspricht dem Workflow-Warteschlangennamen des <xref:System.IComparable>-Objekts in Form einer Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="112a9-144">The name of the bookmark is the string form of the <xref:System.IComparable> workflow queue name.</span></span>
