---
title: Erstellen von Workflows, Aktivitäten und Ausdrücken mit imperativem Code
ms.date: 03/30/2017
ms.assetid: cefc9cfc-2882-4eb9-8c94-7a6da957f2b2
ms.openlocfilehash: 7f22880a965274961006f999b1170634377fcf1c
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/12/2020
ms.locfileid: "79183028"
---
# <a name="authoring-workflows-activities-and-expressions-using-imperative-code"></a><span data-ttu-id="4f522-102">Erstellen von Workflows, Aktivitäten und Ausdrücken mit imperativem Code</span><span class="sxs-lookup"><span data-stu-id="4f522-102">Authoring Workflows, Activities, and Expressions Using Imperative Code</span></span>
<span data-ttu-id="4f522-103">Eine Workflowdefinition ist eine Struktur konfigurierter Aktivitätsobjekte.</span><span class="sxs-lookup"><span data-stu-id="4f522-103">A workflow definition is a tree of configured activity objects.</span></span> <span data-ttu-id="4f522-104">Diese Struktur mit Aktivitäten kann auf viele verschiedene Arten definiert werden, z. B. durch manuelle Bearbeitung des XAML-Codes oder mit dem Workflow-Designer, um XAML-Daten zu erzeugen.</span><span class="sxs-lookup"><span data-stu-id="4f522-104">This tree of activities can be defined many ways, including by hand-editing XAML or by using the Workflow Designer to produce XAML.</span></span> <span data-ttu-id="4f522-105">Die Verwendung von XAML ist jedoch keine Voraussetzung.</span><span class="sxs-lookup"><span data-stu-id="4f522-105">Use of XAML, however, is not a requirement.</span></span> <span data-ttu-id="4f522-106">Sie können Workflowdefinitionen auch programmgesteuert erstellen.</span><span class="sxs-lookup"><span data-stu-id="4f522-106">Workflow definitions can also be created programmatically.</span></span> <span data-ttu-id="4f522-107">Dieses Thema bietet eine Übersicht über das Erstellen von Workflowdefinitionen, Aktivitäten und Ausdrücken mithilfe von Code.</span><span class="sxs-lookup"><span data-stu-id="4f522-107">This topic provides an overview of creating workflow definitions, activities, and expressions by using code.</span></span> <span data-ttu-id="4f522-108">Beispiele für das Arbeiten mit XAML-Workflows mithilfe von Code finden Sie unter [Serialisieren von Workflows und Aktivitäten zu und von XAML](serializing-workflows-and-activities-to-and-from-xaml.md).</span><span class="sxs-lookup"><span data-stu-id="4f522-108">For examples of working with XAML workflows using code, see [Serializing Workflows and Activities to and from XAML](serializing-workflows-and-activities-to-and-from-xaml.md).</span></span>  
  
## <a name="creating-workflow-definitions"></a><span data-ttu-id="4f522-109">Erstellen von Workflowdefinitionen</span><span class="sxs-lookup"><span data-stu-id="4f522-109">Creating Workflow Definitions</span></span>  
 <span data-ttu-id="4f522-110">Sie können eine Workflowdefinition erstellen, indem Sie eine Instanz eines Aktivitätstyps instanziieren und die Eigenschaften des Aktivitätsobjekts konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="4f522-110">A workflow definition can be created by instantiating an instance of an activity type and configuring the activity object’s properties.</span></span> <span data-ttu-id="4f522-111">Für Aktivitäten, die keine untergeordneten Aktivitäten enthalten, erreichen Sie dies mit einigen Codezeilen.</span><span class="sxs-lookup"><span data-stu-id="4f522-111">For activities that do not contain child activities, this can be accomplished using a few lines of code.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#47](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#47)]  
  
> [!NOTE]
> <span data-ttu-id="4f522-112">In den Beispielen dieses Themas wird <xref:System.Activities.WorkflowInvoker> zum Ausführen der Beispielworkflows verwendet.</span><span class="sxs-lookup"><span data-stu-id="4f522-112">The examples in this topic use <xref:System.Activities.WorkflowInvoker> to run the sample workflows.</span></span> <span data-ttu-id="4f522-113">Weitere Informationen zum Aufrufen von Workflows, zum Übergeben von Argumenten und den verschiedenen verfügbaren Hostingoptionen finden Sie unter [Verwenden von WorkflowInvoker und WorkflowApplication](using-workflowinvoker-and-workflowapplication.md).</span><span class="sxs-lookup"><span data-stu-id="4f522-113">For more information about invoking workflows, passing arguments, and the different hosting choices that are available, see [Using WorkflowInvoker and WorkflowApplication](using-workflowinvoker-and-workflowapplication.md).</span></span>  
  
 <span data-ttu-id="4f522-114">In diesem Beispiel wird ein Workflow erstellt, der aus einer einzelnen <xref:System.Activities.Statements.WriteLine>-Aktivität besteht.</span><span class="sxs-lookup"><span data-stu-id="4f522-114">In this example, a workflow that consists of a single <xref:System.Activities.Statements.WriteLine> activity is created.</span></span> <span data-ttu-id="4f522-115">Das <xref:System.Activities.Statements.WriteLine>-Argument der <xref:System.Activities.Statements.WriteLine.Text%2A>-Aktivität wird festgelegt, und der Workflow wird aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="4f522-115">The <xref:System.Activities.Statements.WriteLine> activity’s <xref:System.Activities.Statements.WriteLine.Text%2A> argument is set, and the workflow is invoked.</span></span> <span data-ttu-id="4f522-116">Wenn eine Aktivität untergeordnete Aktivitäten enthält, ist die Konstruktionsmethode ähnlich.</span><span class="sxs-lookup"><span data-stu-id="4f522-116">If an activity contains child activities, the method of construction is similar.</span></span> <span data-ttu-id="4f522-117">Im folgenden Beispiel wird eine <xref:System.Activities.Statements.Sequence>-Aktivität verwendet, die zwei <xref:System.Activities.Statements.WriteLine>-Aktivitäten enthält.</span><span class="sxs-lookup"><span data-stu-id="4f522-117">The following example uses a <xref:System.Activities.Statements.Sequence> activity that contains two <xref:System.Activities.Statements.WriteLine> activities.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#48](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#48)]  
  
### <a name="using-object-initializers"></a><span data-ttu-id="4f522-118">Verwenden von Objektinitialisierern</span><span class="sxs-lookup"><span data-stu-id="4f522-118">Using Object Initializers</span></span>  
 <span data-ttu-id="4f522-119">In den Beispielen in diesem Thema wird die Syntax zur Objektinitialisierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="4f522-119">The examples in this topic use object initialization syntax.</span></span> <span data-ttu-id="4f522-120">Die Objektinitialisierungssyntax kann eine nützliche Möglichkeit zum Erstellen von Workflowdefinitionen per Code darstellen, da diese eine hierarchische Ansicht der Aktivitäten im Workflow bietet und die Beziehung zwischen den Aktivitäten anzeigt.</span><span class="sxs-lookup"><span data-stu-id="4f522-120">Object initialization syntax can be a useful way to create workflow definitions in code because it provides a hierarchical view of the activities in the workflow and shows the relationship between the activities.</span></span> <span data-ttu-id="4f522-121">Die Verwendung der Objektinitialisierungssyntax ist keine Anforderung der programmgesteuerten Erstellung von Workflows.</span><span class="sxs-lookup"><span data-stu-id="4f522-121">There is no requirement to use object initialization syntax when you programmatically create workflows.</span></span> <span data-ttu-id="4f522-122">Das folgende Beispiel entspricht von der Funktion her dem vorherigen Beispiel.</span><span class="sxs-lookup"><span data-stu-id="4f522-122">The following example is functionally equivalent to the previous example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#49](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#49)]  
  
 <span data-ttu-id="4f522-123">Weitere Informationen zu Objektinitialisierern finden Sie unter [Gewusst wie: Initialisieren von Objekten ohne Aufruf eines Konstruktors (Programmierhandbuch für](../../csharp/programming-guide/classes-and-structs/how-to-initialize-objects-by-using-an-object-initializer.md) den Programmierer) und [Gewusst wie: Deklarieren eines Objekts mithilfe eines Objektinitialisierers](../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-declare-an-object-by-using-an-object-initializer.md).</span><span class="sxs-lookup"><span data-stu-id="4f522-123">For more information about object initializers, see [How to: Initialize Objects without Calling a Constructor (C# Programming Guide)](../../csharp/programming-guide/classes-and-structs/how-to-initialize-objects-by-using-an-object-initializer.md) and [How to: Declare an Object by Using an Object Initializer](../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-declare-an-object-by-using-an-object-initializer.md).</span></span>  
  
### <a name="working-with-variables-literal-values-and-expressions"></a><span data-ttu-id="4f522-124">Verwenden von Variablen, literalen Werten und Ausdrücken</span><span class="sxs-lookup"><span data-stu-id="4f522-124">Working with Variables, Literal Values, and Expressions</span></span>  
 <span data-ttu-id="4f522-125">Achten Sie beim Erstellen einer Workflowdefinition per Code darauf, welcher Code als Teil der Erstellung einer Workflowdefinition ausgeführt wird und welcher Code als Teil der Ausführung einer Instanz dieses Workflows ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="4f522-125">When creating a workflow definition using code, be aware of what code executes as part of the creation of the workflow definition and what code executes as part of the execution of an instance of that workflow.</span></span> <span data-ttu-id="4f522-126">Der folgende Workflow soll z. B. eine zufällige Zahl generieren und auf die Konsole schreiben.</span><span class="sxs-lookup"><span data-stu-id="4f522-126">For example, the following workflow is intended to generate a random number and write it to the console.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#50](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#50)]  
  
 <span data-ttu-id="4f522-127">Wenn dieser Workflowdefinitionscode ausgeführt wird, erfolgt der Aufruf von `Random.Next`, und das Ergebnis wird in der Workflowdefinition als literaler Wert gespeichert.</span><span class="sxs-lookup"><span data-stu-id="4f522-127">When this workflow definition code is executed, the call to `Random.Next` is made and the result is stored in the workflow definition as a literal value.</span></span> <span data-ttu-id="4f522-128">Es können viele Instanzen dieses Workflows aufgerufen werden, und für alle wird jeweils die gleiche Zahl angezeigt.</span><span class="sxs-lookup"><span data-stu-id="4f522-128">Many instances of this workflow can be invoked, and all would display the same number.</span></span> <span data-ttu-id="4f522-129">Um die Zufallszahlengenerierung während der Workflowausführung durchführen zu lassen, müssen Sie einen Ausdruck verwenden, der bei jeder Ausführung des Workflows ausgewertet wird.</span><span class="sxs-lookup"><span data-stu-id="4f522-129">To have the random number generation occur during workflow execution, an expression must be used that is evaluated each time the workflow runs.</span></span> <span data-ttu-id="4f522-130">Im folgenden Beispiel wird ein Visual Basic-Ausdruck mit <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> verwendet.</span><span class="sxs-lookup"><span data-stu-id="4f522-130">In the following example, a Visual Basic expression is used with a <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601>.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#51](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#51)]  
  
 <span data-ttu-id="4f522-131">Der Ausdruck im vorherigen Beispiel könnte auch mithilfe von <xref:Microsoft.CSharp.Activities.CSharpValue%601> und einem C#-Ausdruck implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-131">The expression in the previous example could also be implemented using a <xref:Microsoft.CSharp.Activities.CSharpValue%601> and a C# expression.</span></span>  
  
```csharp  
new Assign<int>  
{  
    To = n,  
    Value = new CSharpValue<int>("new Random().Next(1, 101)")  
}  
```  
  
 <span data-ttu-id="4f522-132">C#-Ausdrücke müssen kompiliert werden, bevor der Workflow, in dem sie enthalten sind, aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="4f522-132">C# expressions must be compiled before the workflow containing them is invoked.</span></span> <span data-ttu-id="4f522-133">Wenn die C-Ausdrücke nicht <xref:System.NotSupportedException> kompiliert werden, wird eine ausgelöst, wenn ``Expression Activity type 'CSharpValue`1' requires compilation in order to run.  Please ensure that the workflow has been compiled.`` der Workflow mit einer Meldung ähnlich der folgenden aufgerufen wird: In den meisten Szenarien, in denen Workflows in Visual Studio erstellt wurden, werden die C-Ausdrücke automatisch kompiliert, aber in einigen Szenarien, z. B. Codeworkflows, müssen die C-Ausdrücke manuell kompiliert werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-133">If the C# expressions are not compiled, a <xref:System.NotSupportedException> is thrown when the workflow is invoked with a message similar to the following: ``Expression Activity type 'CSharpValue`1' requires compilation in order to run.  Please ensure that the workflow has been compiled.`` In most scenarios involving workflows created in Visual Studio the C# expressions are compiled automatically, but in some scenarios, such as code workflows, the C# expressions must be manually compiled.</span></span> <span data-ttu-id="4f522-134">Ein Beispiel für das Kompilieren von C-Ausdrücken finden Sie im Abschnitt [Verwenden von C-Ausdrücken in Codeworkflows](csharp-expressions.md#CodeWorkflows) im Thema ["C-Ausdrücke".](csharp-expressions.md)</span><span class="sxs-lookup"><span data-stu-id="4f522-134">For an example of how to compile C# expressions, see the [Using C# expressions in code workflows](csharp-expressions.md#CodeWorkflows) section of the [C# Expressions](csharp-expressions.md) topic.</span></span>  
  
 <span data-ttu-id="4f522-135"><xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> stellt einen Ausdruck in Visual Basic-Syntax dar, der als R-Wert in einem Ausdruck verwendet werden kann, und <xref:Microsoft.CSharp.Activities.CSharpValue%601> stellt einen Ausdruck in C#-Syntax dar, der als R-Wert in einem Ausdruck verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="4f522-135">A <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> represents an expression in Visual Basic syntax that can be used as an r-value in an expression, and a <xref:Microsoft.CSharp.Activities.CSharpValue%601> represents an expression in C# syntax that can be used as an r-value in an expression.</span></span> <span data-ttu-id="4f522-136">Diese Ausdrücke werden jedes Mal ausgewertet, wenn die enthaltende Aktivität ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="4f522-136">These expressions are evaluated each time the containing activity is executed.</span></span> <span data-ttu-id="4f522-137">Das Ergebnis des Ausdrucks wird der Workflowvariablen `n` zugewiesen, und diese Ergebnisse werden von der nächsten Aktivität im Workflow verwendet.</span><span class="sxs-lookup"><span data-stu-id="4f522-137">The result of the expression is assigned to the workflow variable `n`, and these results are used by the next activity in the workflow.</span></span> <span data-ttu-id="4f522-138">Um zur Laufzeit auf den Wert der Workflowvariablen `n` zuzugreifen, ist der <xref:System.Activities.ActivityContext> erforderlich.</span><span class="sxs-lookup"><span data-stu-id="4f522-138">To access the value of the workflow variable `n` at runtime, the <xref:System.Activities.ActivityContext> is required.</span></span> <span data-ttu-id="4f522-139">Darauf kann mit dem folgenden Lambdaausdruck zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-139">This can be accessed by using the following lambda expression.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="4f522-140">Beachten Sie, dass beide Codebeispiele C# als Programmiersprache verwenden. In einem Fall wird jedoch <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> und im anderen <xref:Microsoft.CSharp.Activities.CSharpValue%601> verwendet.</span><span class="sxs-lookup"><span data-stu-id="4f522-140">Note that both of these code are examples are using C# as the programming language, but one uses a <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> and one uses a <xref:Microsoft.CSharp.Activities.CSharpValue%601>.</span></span> <span data-ttu-id="4f522-141"><xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> und <xref:Microsoft.CSharp.Activities.CSharpValue%601> können sowohl in Visual Basic- als auch in C#-Projekten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-141"><xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> and <xref:Microsoft.CSharp.Activities.CSharpValue%601> can be used in both Visual Basic and C# projects.</span></span> <span data-ttu-id="4f522-142">Standardmäßig entsprechen die im Workflow-Designer erstellten Ausdrücke der Programmiersprache des Hostingprojekts.</span><span class="sxs-lookup"><span data-stu-id="4f522-142">By default, expressions created in the workflow designer match the language of the hosting project.</span></span> <span data-ttu-id="4f522-143">Wenn Workflows im Code erstellt werden, wählt der Workflowautor die verwendete Sprache nach eigenem Ermessen aus.</span><span class="sxs-lookup"><span data-stu-id="4f522-143">When creating workflows in code, the desired language is at the discretion of the workflow author.</span></span>  
  
 <span data-ttu-id="4f522-144">In diesen Beispielen wird das Ergebnis des Ausdrucks der Workflowvariablen `n` zugewiesen, und diese Ergebnisse werden von der nächsten Aktivität im Workflow verwendet.</span><span class="sxs-lookup"><span data-stu-id="4f522-144">In these examples the result of the expression is assigned to the workflow variable `n`, and these results are used by the next activity in the workflow.</span></span> <span data-ttu-id="4f522-145">Um zur Laufzeit auf den Wert der Workflowvariablen `n` zuzugreifen, ist der <xref:System.Activities.ActivityContext> erforderlich.</span><span class="sxs-lookup"><span data-stu-id="4f522-145">To access the value of the workflow variable `n` at runtime, the <xref:System.Activities.ActivityContext> is required.</span></span> <span data-ttu-id="4f522-146">Darauf kann mit dem folgenden Lambdaausdruck zugegriffen werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-146">This can be accessed by using the following lambda expression.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#52](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#52)]  
  
 <span data-ttu-id="4f522-147">Weitere Informationen zu Lambda-Ausdrücken finden Sie unter [Lambda-Ausdrücke (Programmierhandbuch für die Programmieren)](../../csharp/programming-guide/statements-expressions-operators/lambda-expressions.md) oder [Lambda-Ausdrücke (Visual Basic).](../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md)</span><span class="sxs-lookup"><span data-stu-id="4f522-147">For more information about lambda expressions, see [Lambda Expressions (C# Programming Guide)](../../csharp/programming-guide/statements-expressions-operators/lambda-expressions.md) or [Lambda Expressions (Visual Basic)](../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md).</span></span>  
  
 <span data-ttu-id="4f522-148">Lambda-Ausdrücke können nicht in das XAML-Format serialisiert werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-148">Lambda expressions are not serializable to XAML format.</span></span> <span data-ttu-id="4f522-149">Wenn versucht wird, einen Workflow mit Lambda-Ausdrücken zu serialisieren, wird <xref:System.Activities.Expressions.LambdaSerializationException> mit der folgenden Meldung ausgelöst: "Dieser Workflow enthält im Code spezifizierte Lambda-Ausdrücke.</span><span class="sxs-lookup"><span data-stu-id="4f522-149">If an attempt to serialize a workflow with lambda expressions is made, a <xref:System.Activities.Expressions.LambdaSerializationException> is thrown with the following message: "This workflow contains lambda expressions specified in code.</span></span> <span data-ttu-id="4f522-150">Diese Ausdrücke sind nicht XAML-serialisierbar.</span><span class="sxs-lookup"><span data-stu-id="4f522-150">These expressions are not XAML serializable.</span></span> <span data-ttu-id="4f522-151">Um den Workflow XAML-serialisierbar zu machen, verwenden Sie entweder VisualBasicValue/VisualBasicReference oder ExpressionServices.Convert(lambda).</span><span class="sxs-lookup"><span data-stu-id="4f522-151">In order to make your workflow XAML-serializable, either use VisualBasicValue/VisualBasicReference or ExpressionServices.Convert(lambda).</span></span> <span data-ttu-id="4f522-152">Dadurch werden die Lambda-Ausdrücke in Ausdrucksaktivitäten konvertiert."</span><span class="sxs-lookup"><span data-stu-id="4f522-152">This will convert your lambda expressions into expression activities."</span></span> <span data-ttu-id="4f522-153">Um diesen Ausdruck mit XAML kompatibel zu machen, verwenden Sie <xref:System.Activities.Expressions.ExpressionServices> und <xref:System.Activities.Expressions.ExpressionServices.Convert%2A>. Dies wird im folgenden Beispiel veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="4f522-153">To make this expression compatible with XAML, use <xref:System.Activities.Expressions.ExpressionServices> and <xref:System.Activities.Expressions.ExpressionServices.Convert%2A>, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#53](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#53)]  
  
 <span data-ttu-id="4f522-154">Es kann auch ein <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-154">A <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> could also be used.</span></span> <span data-ttu-id="4f522-155">Beachten Sie, dass kein Lambda-Ausdruck erforderlich ist, wenn Sie einen Visual Basic-Ausdruck verwenden.</span><span class="sxs-lookup"><span data-stu-id="4f522-155">Note that no lambda expression is required when using a Visual Basic expression.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#54](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#54)]  
  
 <span data-ttu-id="4f522-156">Zur Laufzeit werden die Visual Basic-Ausdrücke in LINQ-Ausdrücke kompiliert.</span><span class="sxs-lookup"><span data-stu-id="4f522-156">At run time, Visual Basic expressions are compiled into LINQ expressions.</span></span> <span data-ttu-id="4f522-157">Beide vorherigen Beispiele sind in XAML serialisierbar, aber wenn die serialisierte XAML im Workflow-Designer angezeigt und bearbeitet werden soll, verwenden Sie <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> für die Ausdrücke.</span><span class="sxs-lookup"><span data-stu-id="4f522-157">Both of the previous examples are serializable to XAML, but if the serialized XAML is intended to be viewed and edited in the workflow designer, use <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> for your expressions.</span></span> <span data-ttu-id="4f522-158">Serialisierte Workflows, die `ExpressionServices.Convert` verwenden, können zwar im Designer geöffnet werden, der Wert des Ausdrucks ist jedoch leer.</span><span class="sxs-lookup"><span data-stu-id="4f522-158">Serialized workflows that use `ExpressionServices.Convert` can be opened in the designer, but the value of the expression will be blank.</span></span> <span data-ttu-id="4f522-159">Weitere Informationen zum Serialisieren von Workflows in XAML finden Sie unter [Serialisieren von Workflows und Aktivitäten zu und von XAML](serializing-workflows-and-activities-to-and-from-xaml.md).</span><span class="sxs-lookup"><span data-stu-id="4f522-159">For more information about serializing workflows to XAML, see [Serializing Workflows and Activities to and from XAML](serializing-workflows-and-activities-to-and-from-xaml.md).</span></span>  
  
#### <a name="literal-expressions-and-reference-types"></a><span data-ttu-id="4f522-160">Literale Ausdrücke und Verweistypen</span><span class="sxs-lookup"><span data-stu-id="4f522-160">Literal Expressions and Reference Types</span></span>  
 <span data-ttu-id="4f522-161">Literale Ausdrücke werden in Workflows durch die <xref:System.Activities.Expressions.Literal%601>-Aktivität dargestellt.</span><span class="sxs-lookup"><span data-stu-id="4f522-161">Literal expressions are represented in workflows by the <xref:System.Activities.Expressions.Literal%601> activity.</span></span> <span data-ttu-id="4f522-162">Die folgenden <xref:System.Activities.Statements.WriteLine>-Aktivitäten sind funktional äquivalent.</span><span class="sxs-lookup"><span data-stu-id="4f522-162">The following <xref:System.Activities.Statements.WriteLine> activities are functionally equivalent.</span></span>  
  
```csharp  
new WriteLine  
{  
    Text = "Hello World."  
},  
new WriteLine  
{  
    Text = new Literal<string>("Hello World.")  
}  
```  
  
 <span data-ttu-id="4f522-163">Es ist nicht zulässig, einen literalen Ausdruck mit einem beliebigen Verweistyp außer <xref:System.String> zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="4f522-163">It is invalid to initialize a literal expression with any reference type except <xref:System.String>.</span></span> <span data-ttu-id="4f522-164">Im folgenden Beispiel wird die <xref:System.Activities.Statements.Assign>-Eigenschaft einer <xref:System.Activities.Statements.Assign.Value%2A>-Aktivität mit einem literalen Ausdruck mit `List<string>` initialisiert.</span><span class="sxs-lookup"><span data-stu-id="4f522-164">In the following example, an <xref:System.Activities.Statements.Assign> activity's <xref:System.Activities.Statements.Assign.Value%2A> property is initialized with a literal expression using a `List<string>`.</span></span>  
  
```csharp  
new Assign  
{  
    To = new OutArgument<List<string>>(items),  
    Value = new InArgument<List<string>>(new List<string>())  
},  
```  
  
 <span data-ttu-id="4f522-165">Bei der Überprüfung des Workflows, der die Aktivität enthält, wird der folgende Validierungsfehler zurückgegeben: „Literal unterstützt nur Werttypen und den unveränderlichen Typ „System.String“.</span><span class="sxs-lookup"><span data-stu-id="4f522-165">When the workflow containing this activity is validated, the following validation error is returned: "Literal only supports value types and the immutable type System.String.</span></span> <span data-ttu-id="4f522-166">Der System.Collections.Generic.List\`1 [System.String]-Typ kann nicht als Literal verwendet werden."</span><span class="sxs-lookup"><span data-stu-id="4f522-166">The type System.Collections.Generic.List\`1[System.String] cannot be used as a literal."</span></span> <span data-ttu-id="4f522-167">Beim Aufrufen des Workflows wird <xref:System.Activities.InvalidWorkflowException> ausgelöst, die den Text des Validierungsfehlers enthält.</span><span class="sxs-lookup"><span data-stu-id="4f522-167">If the workflow is invoked, an <xref:System.Activities.InvalidWorkflowException> is thrown that contains the text of the validation error.</span></span> <span data-ttu-id="4f522-168">Dies ist ein Validierungsfehler, da durch das Erstellen eines literalen Ausdrucks mit einem Verweistyp keine neue Instanz des Verweistyps für die einzelnen Instanzen des Workflows erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="4f522-168">This is a validation error because creating a literal expression with a reference type does not create a new instance of the reference type for each instance of the workflow.</span></span> <span data-ttu-id="4f522-169">Um diesen Fehler zu beheben, ersetzen Sie den literalen Ausdruck durch einen Ausdruck, der eine neue Instanz des Verweistyps erstellt und zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="4f522-169">To resolve this, replace the literal expression with one that creates and returns a new instance of the reference type.</span></span>  
  
```csharp  
new Assign  
{  
    To = new OutArgument<List<string>>(items),  
    Value = new InArgument<List<string>>(new VisualBasicValue<List<string>>("New List(Of String)"))  
},  
```  
  
 <span data-ttu-id="4f522-170">Weitere Informationen zu Ausdrücken finden Sie unter [Ausdrücke](expressions.md).</span><span class="sxs-lookup"><span data-stu-id="4f522-170">For more information about expressions, see [Expressions](expressions.md).</span></span>  
  
#### <a name="invoking-methods-on-objects-using-expressions-and-the-invokemethod-activity"></a><span data-ttu-id="4f522-171">Aufrufen von Methoden für Objekte mithilfe von Ausdrücken und der InvokeMethod-Aktivität</span><span class="sxs-lookup"><span data-stu-id="4f522-171">Invoking Methods on Objects using Expressions and the InvokeMethod Activity</span></span>  
 <span data-ttu-id="4f522-172">Die <xref:System.Activities.Expressions.InvokeMethod%601>-Aktivität kann verwendet werden, um statische und Instanzenmethoden von Klassen in .NET Framework aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="4f522-172">The <xref:System.Activities.Expressions.InvokeMethod%601> activity can be used to invoke static and instance methods of classes in the .NET Framework.</span></span> <span data-ttu-id="4f522-173">In einem vorherigen Beispiel dieses Themas wird eine Zufallszahl mithilfe der <xref:System.Random>-Klasse generiert.</span><span class="sxs-lookup"><span data-stu-id="4f522-173">In a previous example in this topic, a random number was generated using the <xref:System.Random> class.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#51](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#51)]  
  
 <span data-ttu-id="4f522-174">Die <xref:System.Activities.Expressions.InvokeMethod%601>-Aktivität kann auch verwendet werden, um die <xref:System.Random.Next%2A>-Methode der <xref:System.Random>-Klasse aufzurufen.</span><span class="sxs-lookup"><span data-stu-id="4f522-174">The <xref:System.Activities.Expressions.InvokeMethod%601> activity could also have been used to call the <xref:System.Random.Next%2A> method of the <xref:System.Random> class.</span></span>  
  
```csharp  
new InvokeMethod<int>  
{  
    TargetObject = new InArgument<Random>(new VisualBasicValue<Random>("New Random()")),  
    MethodName = "Next",  
    Parameters =
    {  
        new InArgument<int>(1),  
        new InArgument<int>(101)  
    },  
    Result = n  
}  
```  
  
 <span data-ttu-id="4f522-175">Da <xref:System.Random.Next%2A> keine statische Methode ist, wird eine Instanz der <xref:System.Random>-Klasse für die <xref:System.Activities.Expressions.InvokeMethod%601.TargetObject%2A>-Eigenschaft angegeben.</span><span class="sxs-lookup"><span data-stu-id="4f522-175">Since <xref:System.Random.Next%2A> is not a static method, an instance of the <xref:System.Random> class is supplied for the <xref:System.Activities.Expressions.InvokeMethod%601.TargetObject%2A> property.</span></span> <span data-ttu-id="4f522-176">In diesem Beispiel wird eine neue Instanz mit einem Visual Basic-Ausdruck erstellt. Diese hätte jedoch auch zuvor erstellt und in einer Workflowvariablen gespeichert werden können.</span><span class="sxs-lookup"><span data-stu-id="4f522-176">In this example a new instance is created using a Visual Basic expression, but it could also have been created previously and stored in a workflow variable.</span></span> <span data-ttu-id="4f522-177">In diesem Beispiel wäre es einfacher, die <xref:System.Activities.Statements.Assign%601>-Aktivität anstelle der <xref:System.Activities.Expressions.InvokeMethod%601>-Aktivität zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="4f522-177">In this example, it would be simpler to use the <xref:System.Activities.Statements.Assign%601> activity instead of the <xref:System.Activities.Expressions.InvokeMethod%601> activity.</span></span> <span data-ttu-id="4f522-178">Wenn der Methodenaufruf, der letztendlich entweder durch die <xref:System.Activities.Statements.Assign%601>-Aktivität oder durch <xref:System.Activities.Expressions.InvokeMethod%601>-Aktivität aufgerufen wird, eine lange Ausführungszeit aufweist, bietet <xref:System.Activities.Expressions.InvokeMethod%601> einen Vorteil, da sie über eine <xref:System.Activities.Expressions.InvokeMethod%601.RunAsynchronously%2A>-Eigenschaft verfügt.</span><span class="sxs-lookup"><span data-stu-id="4f522-178">If the method call ultimately invoked by either the <xref:System.Activities.Statements.Assign%601> or <xref:System.Activities.Expressions.InvokeMethod%601> activities is long running, <xref:System.Activities.Expressions.InvokeMethod%601> has an advantage since it has a <xref:System.Activities.Expressions.InvokeMethod%601.RunAsynchronously%2A> property.</span></span> <span data-ttu-id="4f522-179">Wenn diese Eigenschaft auf `true` festgelegt ist, wird die aufgerufene Methode im Hinblick auf den Workflow asynchron ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="4f522-179">When this property is set to `true`, the invoked method will run asynchronously with regard to the workflow.</span></span> <span data-ttu-id="4f522-180">Wenn andere Aktivitäten parallel sind, werden sie nicht blockiert, während die Methode asynchron ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="4f522-180">If other activities are in parallel, they will not be blocked while the method is asynchronously executing.</span></span> <span data-ttu-id="4f522-181">Auch wenn die aufzurufende Methode über keinen Rückgabewert verfügt, stellt <xref:System.Activities.Expressions.InvokeMethod%601> die geeignete Möglichkeit zum Aufrufen der Methode dar.</span><span class="sxs-lookup"><span data-stu-id="4f522-181">Also, if the method to be invoked has no return value, then <xref:System.Activities.Expressions.InvokeMethod%601> is the appropriate way to invoke the method.</span></span>  
  
## <a name="arguments-and-dynamic-activities"></a><span data-ttu-id="4f522-182">Argumente und dynamische Aktivitäten</span><span class="sxs-lookup"><span data-stu-id="4f522-182">Arguments and Dynamic Activities</span></span>  
 <span data-ttu-id="4f522-183">Eine Workflowdefinition wird im Code erstellt, indem Aktivitäten in einer Aktivitätsstruktur zusammengestellt und alle Eigenschaften und Argumente konfiguriert werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-183">A workflow definition is created in code by assembling activities into an activity tree and configuring any properties and arguments.</span></span> <span data-ttu-id="4f522-184">Vorhandene Argumente können gebunden werden, aber Aktivitäten können keine neuen Argumente hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-184">Existing arguments can be bound, but new arguments cannot be added to activities.</span></span> <span data-ttu-id="4f522-185">Dies gilt auch für Workflowargumente, die an die Stammaktivität übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-185">This includes workflow arguments passed to the root activity.</span></span> <span data-ttu-id="4f522-186">In imperativem Code werden Workflowargumente als Eigenschaften eines neuen CLR-Typs angegeben, und in XAML werden sie mithilfe von `x:Class` und `x:Member` deklariert.</span><span class="sxs-lookup"><span data-stu-id="4f522-186">In imperative code, workflow arguments are specified as properties on a new CLR type, and in XAML they are declared by using `x:Class` and `x:Member`.</span></span> <span data-ttu-id="4f522-187">Da kein neuer CLR-Typ erstellt wird, wenn eine Workflowdefinition als Struktur von Objekten im Arbeitsspeicher erstellt wird, können Argumente nicht hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-187">Because there is no new CLR type created when a workflow definition is created as a tree of in-memory objects, arguments cannot be added.</span></span> <span data-ttu-id="4f522-188">Argumente können jedoch einer <xref:System.Activities.DynamicActivity> hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-188">However, arguments can be added to a <xref:System.Activities.DynamicActivity>.</span></span> <span data-ttu-id="4f522-189">In diesem Beispiel wird eine <xref:System.Activities.DynamicActivity%601> erstellt, die zwei ganzzahlige Argumente verwendet, diese zusammenfügt und das Ergebnis zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="4f522-189">In this example, a <xref:System.Activities.DynamicActivity%601> is created that takes two integer arguments, adds them together, and returns the result.</span></span> <span data-ttu-id="4f522-190">Für jedes Argument wird ein <xref:System.Activities.DynamicActivityProperty>-Element erstellt, und das Ergebnis des Vorgangs wird dem <xref:System.Activities.Activity%601.Result%2A>-Argument von <xref:System.Activities.DynamicActivity%601> zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="4f522-190">A <xref:System.Activities.DynamicActivityProperty> is created for each argument, and the result of the operation is assigned to the <xref:System.Activities.Activity%601.Result%2A> argument of the <xref:System.Activities.DynamicActivity%601>.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#55](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#55)]  
  
 <span data-ttu-id="4f522-191">Weitere Informationen zu dynamischen Aktivitäten finden Sie unter [Erstellen einer Aktivität zur Laufzeit](creating-an-activity-at-runtime-with-dynamicactivity.md).</span><span class="sxs-lookup"><span data-stu-id="4f522-191">For more information about dynamic activities, see [Creating an Activity at Runtime](creating-an-activity-at-runtime-with-dynamicactivity.md).</span></span>  
  
## <a name="compiled-activities"></a><span data-ttu-id="4f522-192">Kompilierte Aktivitäten</span><span class="sxs-lookup"><span data-stu-id="4f522-192">Compiled Activities</span></span>  
 <span data-ttu-id="4f522-193">Dynamische Aktivitäten bieten eine Möglichkeit, eine Aktivität mit Argumenten auf der Basis von Code zu definieren, Aktivitäten können jedoch auch im Code erstellt und in Typen kompiliert werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-193">Dynamic activities are one way to define an activity that contains arguments using code, but activities can also be created in code and compiled into types.</span></span> <span data-ttu-id="4f522-194">Es können einfache Aktivitäten erstellt werden, die von <xref:System.Activities.CodeActivity> abgeleitet sind, und asynchrone Aktivitäten, die von <xref:System.Activities.AsyncCodeActivity> abgeleitet sind.</span><span class="sxs-lookup"><span data-stu-id="4f522-194">Simple activities can be created that derive from <xref:System.Activities.CodeActivity>, and asynchronous activities that derive from <xref:System.Activities.AsyncCodeActivity>.</span></span> <span data-ttu-id="4f522-195">Diese Aktivitäten können Argumente und Rückgabewerte aufweisen, und ihre Logik kann mithilfe von imperativem Code definiert werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-195">These activities can have arguments, return values, and define their logic using imperative code.</span></span> <span data-ttu-id="4f522-196">Beispiele für das Erstellen dieser Arten von Aktivitäten finden Sie unter [CodeActivity-Basisklasse](workflow-activity-authoring-using-the-codeactivity-class.md) und [Erstellen asynchroner Aktivitäten](creating-asynchronous-activities-in-wf.md).</span><span class="sxs-lookup"><span data-stu-id="4f522-196">For examples of creating these types of activities, see [CodeActivity Base Class](workflow-activity-authoring-using-the-codeactivity-class.md) and [Creating Asynchronous Activities](creating-asynchronous-activities-in-wf.md).</span></span>  
  
 <span data-ttu-id="4f522-197">Aktivitäten, die von <xref:System.Activities.NativeActivity> abgeleitet werden, können ihre Logik mithilfe von imperativem Code definieren, und sie können auch untergeordnete Aktivitäten enthalten, die die Logik definieren.</span><span class="sxs-lookup"><span data-stu-id="4f522-197">Activities that derive from <xref:System.Activities.NativeActivity> can define their logic using imperative code and they can also contain child activities that define the logic.</span></span> <span data-ttu-id="4f522-198">Sie haben außerdem Vollzugriff auf Funktionen der Laufzeit, z. B. das Erstellen von Lesezeichen.</span><span class="sxs-lookup"><span data-stu-id="4f522-198">They also have full access to the features of the runtime such as creating bookmarks.</span></span> <span data-ttu-id="4f522-199">Beispiele zum Erstellen <xref:System.Activities.NativeActivity>einer -basierten Aktivität finden Sie unter [NativeActivity Base Class](nativeactivity-base-class.md), [Gewusst: Erstellen einer Aktivität](how-to-create-an-activity.md)und benutzerdefinierter Verbund mithilfe des Beispiels für [systemeigene Aktivitäten.](./samples/custom-composite-using-native-activity.md)</span><span class="sxs-lookup"><span data-stu-id="4f522-199">For examples of creating a <xref:System.Activities.NativeActivity>-based activity, see [NativeActivity Base Class](nativeactivity-base-class.md), [How to: Create an Activity](how-to-create-an-activity.md), and the [Custom Composite using Native Activity](./samples/custom-composite-using-native-activity.md) sample.</span></span>  
  
 <span data-ttu-id="4f522-200">Aktivitäten, die von <xref:System.Activities.Activity> abgeleitet sind, definieren ihre Logik nur durch die Verwendung untergeordneter Aktivitäten.</span><span class="sxs-lookup"><span data-stu-id="4f522-200">Activities that derive from <xref:System.Activities.Activity> define their logic solely through the use of child activities.</span></span> <span data-ttu-id="4f522-201">Diese Aktivitäten werden in der Regel mit dem Workflow-Designer erstellt, können aber auch mithilfe von Code definiert werden.</span><span class="sxs-lookup"><span data-stu-id="4f522-201">These activities are typically created by using the workflow designer, but can also be defined by using code.</span></span> <span data-ttu-id="4f522-202">Im folgenden Beispiel wird eine `Square`-Aktivität definiert, die von `Activity<int>` abgeleitet wird.</span><span class="sxs-lookup"><span data-stu-id="4f522-202">In the following example, a `Square` activity is defined that derives from `Activity<int>`.</span></span> <span data-ttu-id="4f522-203">Die `Square`-Aktivität verfügt über ein einzelnes <xref:System.Activities.InArgument%601> namens `Value` und definiert ihre Logik, indem eine <xref:System.Activities.Statements.Sequence>-Aktivität unter Verwendung der <xref:System.Activities.Activity.Implementation%2A>-Eigenschaft angegeben wird.</span><span class="sxs-lookup"><span data-stu-id="4f522-203">The `Square` activity has a single <xref:System.Activities.InArgument%601> named `Value`, and defines its logic by specifying a <xref:System.Activities.Statements.Sequence> activity using the <xref:System.Activities.Activity.Implementation%2A> property.</span></span> <span data-ttu-id="4f522-204">Die <xref:System.Activities.Statements.Sequence>-Aktivität enthält eine <xref:System.Activities.Statements.WriteLine>-Aktivität und eine <xref:System.Activities.Statements.Assign%601>-Aktivität.</span><span class="sxs-lookup"><span data-stu-id="4f522-204">The <xref:System.Activities.Statements.Sequence> activity contains a <xref:System.Activities.Statements.WriteLine> activity and an <xref:System.Activities.Statements.Assign%601> activity.</span></span> <span data-ttu-id="4f522-205">Zusammen implementieren diese drei Aktivitäten die Logik der `Square`-Aktivität.</span><span class="sxs-lookup"><span data-stu-id="4f522-205">Together, these three activities implement the logic of the `Square` activity.</span></span>  
  
```csharp  
class Square : Activity<int>  
{  
    [RequiredArgument]  
    public InArgument<int> Value { get; set; }  
  
    public Square()  
    {  
        this.Implementation = () => new Sequence  
        {  
            Activities =  
            {  
                new WriteLine  
                {  
                    Text = new InArgument<string>((env) => "Squaring the value: " + this.Value.Get(env))  
                },  
                new Assign<int>  
                {  
                    To = new OutArgument<int>((env) => this.Result.Get(env)),  
                    Value = new InArgument<int>((env) => this.Value.Get(env) * this.Value.Get(env))  
                }  
            }  
        };  
    }  
}  
```  
  
 <span data-ttu-id="4f522-206">Im folgenden Beispiel wird mit `Square` eine Workflowdefinition aufgerufen, die aus einer einzelnen <xref:System.Activities.WorkflowInvoker>-Aktivität besteht.</span><span class="sxs-lookup"><span data-stu-id="4f522-206">In the following example, a workflow definition consisting of a single `Square` activity is invoked using <xref:System.Activities.WorkflowInvoker>.</span></span>  
  
```csharp  
Dictionary<string, object> inputs = new Dictionary<string, object> {{ "Value", 5}};  
int result = WorkflowInvoker.Invoke(new Square(), inputs);  
Console.WriteLine("Result: {0}", result);  
```  
  
 <span data-ttu-id="4f522-207">Wenn der Workflow aufgerufen wird, wird die folgende Ausgabe in der Konsole angezeigt:</span><span class="sxs-lookup"><span data-stu-id="4f522-207">When the workflow is invoked, the following output is displayed to the console:</span></span>  
  
 <span data-ttu-id="4f522-208">**Quadrieren des Werts: 5**</span><span class="sxs-lookup"><span data-stu-id="4f522-208">**Squaring the value: 5**</span></span>  
<span data-ttu-id="4f522-209">**Ergebnis: 25**</span><span class="sxs-lookup"><span data-stu-id="4f522-209">**Result: 25**</span></span>
