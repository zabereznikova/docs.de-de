---
title: Empfohlene Vorgehensweisen für die Persistenz
ms.date: 03/30/2017
ms.assetid: 6974c5a4-1af8-4732-ab53-7d694608a3a0
ms.openlocfilehash: 8ffbb3ebfa8f85e2b0052a9df9ada30766accd8e
ms.sourcegitcommit: 32a575bf4adccc901f00e264f92b759ced633379
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/04/2019
ms.locfileid: "74802517"
---
# <a name="persistence-best-practices"></a><span data-ttu-id="6cf80-102">Empfohlene Vorgehensweisen für die Persistenz</span><span class="sxs-lookup"><span data-stu-id="6cf80-102">Persistence Best Practices</span></span>
<span data-ttu-id="6cf80-103">In diesem Dokument werden empfohlene Vorgehensweisen für Entwurf und Konfiguration von Workflows bezüglich der Workflowpersistenz behandelt.</span><span class="sxs-lookup"><span data-stu-id="6cf80-103">This document covers best practices for workflow design and configuration related to workflow persistence.</span></span>  
  
## <a name="design-and-implementation-of-durable-workflows"></a><span data-ttu-id="6cf80-104">Entwurf und Implementierung von permanenten Workflows</span><span class="sxs-lookup"><span data-stu-id="6cf80-104">Design and Implementation of Durable Workflows</span></span>  
 <span data-ttu-id="6cf80-105">Im Allgemeinen wechseln sich bei einem Workflow kurze Phasen, in denen Arbeit ausgeführt wird, mit Phasen ab, die durch Leerlauf und das Warten auf ein Ereignis gekennzeichnet sind.</span><span class="sxs-lookup"><span data-stu-id="6cf80-105">In general, workflows perform work in short periods that are interleaved with times during which the workflow is idle because it is waiting for an event.</span></span> <span data-ttu-id="6cf80-106">Ein solches Ereignis kann beispielsweise eine Nachricht oder ein ablaufender Zeitgeber sein.</span><span class="sxs-lookup"><span data-stu-id="6cf80-106">This event can be such things as a message or an expiring timer.</span></span> <span data-ttu-id="6cf80-107">Um die Workflowinstanz beim Wechsel in den Leerlauf entladen zu können, muss diese vom Diensthost beibehalten werden.</span><span class="sxs-lookup"><span data-stu-id="6cf80-107">To be able to unload the workflow instance when it becomes idle, the service host must persist the workflow instance.</span></span> <span data-ttu-id="6cf80-108">Dies ist nur dann möglich, wenn sich die Workflowinstanz nicht in einer Zone ohne Persistenz befindet (z. B. beim Warten auf den Abschluss einer Transaktion oder auf einen asynchronen Rückruf).</span><span class="sxs-lookup"><span data-stu-id="6cf80-108">This is possible only if the workflow instance is not in a no-persist zone (for example, waiting for a transaction to complete, or waiting for an asynchronous callback).</span></span> <span data-ttu-id="6cf80-109">Um das Entladen von Workflowinstanzen im Leerlauf zu ermöglichen, sollten Workflowautoren Transaktionsbereiche und asynchrone Aktivitäten nur bei Aktionen mit kurzer Laufzeit verwenden.</span><span class="sxs-lookup"><span data-stu-id="6cf80-109">To allow an idle workflow instance to unload, the workflow author should use transaction scopes and asynchronous activities for short-lived actions only.</span></span> <span data-ttu-id="6cf80-110">Insbesondere sollten Verzögerungsaktivitäten in Zonen ohne Persistenz so wenig Zeit wie möglich in Anspruch nehmen.</span><span class="sxs-lookup"><span data-stu-id="6cf80-110">In particular, the author should keep delay activities within these no-persist zones as short as possible.</span></span>  
  
 <span data-ttu-id="6cf80-111">Workflows können nur beibehalten werden, wenn alle verwendeten Datentypen serialisierbar sind.</span><span class="sxs-lookup"><span data-stu-id="6cf80-111">A workflow can only be persisted if all of the data types used by the workflow are serializable.</span></span> <span data-ttu-id="6cf80-112">Außerdem müssen benutzerdefinierte Typen in beibehaltenen Workflows mit <xref:System.Runtime.Serialization.NetDataContractSerializer> serialisiert werden können, damit sie von <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> gespeichert werden können.</span><span class="sxs-lookup"><span data-stu-id="6cf80-112">In addition, custom types used in persisted workflows must be serializable with <xref:System.Runtime.Serialization.NetDataContractSerializer> in order to be persisted by <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore>.</span></span>  
  
 <span data-ttu-id="6cf80-113">Beim einem Host- oder Computerausfall können Workflowinstanzen, die nicht beibehalten wurden, nicht wiederhergestellt werden.</span><span class="sxs-lookup"><span data-stu-id="6cf80-113">A workflow instance cannot be recovered in case of a host or computer failure if it has not been persisted.</span></span> <span data-ttu-id="6cf80-114">Im Allgemeinen wird daher empfohlen, Workflowinstanzen in der Frühphase des Workflowlebenszyklus persistent zu speichern.</span><span class="sxs-lookup"><span data-stu-id="6cf80-114">In general, we recommend that you persist a workflow instance early in the workflow’s life cycle.</span></span>  
  
 <span data-ttu-id="6cf80-115">Bei Workflows, die über einen langen Zeitraum ausgelastet sind, wird empfohlen, die Workflowinstanz in diesem Zeitraum regelmäßig persistent zu speichern.</span><span class="sxs-lookup"><span data-stu-id="6cf80-115">If your workflow is busy for a long time, we recommend that you persist the workflow instance regularly throughout its busy period.</span></span> <span data-ttu-id="6cf80-116">Hierzu können Sie <xref:System.Activities.Statements.Persist>-Aktivitäten in der Abfolge von Aktivitäten einfügen, durch die die Workflowinstanz ausgelastet ist.</span><span class="sxs-lookup"><span data-stu-id="6cf80-116">You can do this by adding <xref:System.Activities.Statements.Persist> activities throughout the sequence of activities that keep the workflow instance busy.</span></span> <span data-ttu-id="6cf80-117">Bei einer Wiederherstellung der Anwendungsdomäne oder einem Ausfall des Hosts oder Computers wird das System dann nicht wieder auf den Anfang des Auslastungszeitraums zurückgesetzt.</span><span class="sxs-lookup"><span data-stu-id="6cf80-117">In this manner, application domain recycling, host failures, or computer failures do not cause the system to be rolled back to the start of the busy period.</span></span> <span data-ttu-id="6cf80-118">Bedenken Sie, dass das Hinzufügen von <xref:System.Activities.Statements.Persist>-Aktivitäten zum Workflow zu Leistungseinbußen führen kann.</span><span class="sxs-lookup"><span data-stu-id="6cf80-118">Be aware that adding <xref:System.Activities.Statements.Persist> activities to your workflow could lead to a degradation of performance.</span></span>  
  
 <span data-ttu-id="6cf80-119">Windows Server AppFabric erleichtert die Konfiguration und Verwendung von Persistenz erheblich.</span><span class="sxs-lookup"><span data-stu-id="6cf80-119">Windows Server App Fabric greatly simplifies the configuration and use of persistence.</span></span> <span data-ttu-id="6cf80-120">Weitere Informationen finden Sie unter [Windows Server App Fabric-Persistenz](https://docs.microsoft.com/previous-versions/appfabric/ee677272(v=azure.10)) .</span><span class="sxs-lookup"><span data-stu-id="6cf80-120">For more information, see [Windows Server App Fabric Persistence](https://docs.microsoft.com/previous-versions/appfabric/ee677272(v=azure.10))</span></span>  
  
## <a name="configuration-of-scalability-parameters"></a><span data-ttu-id="6cf80-121">Konfiguration von Skalierbarkeitsparametern</span><span class="sxs-lookup"><span data-stu-id="6cf80-121">Configuration of Scalability Parameters</span></span>  
 <span data-ttu-id="6cf80-122">Die Einstellungen der folgenden Parameter hängen von den Anforderungen an die Skalierbarkeit und Leistung ab:</span><span class="sxs-lookup"><span data-stu-id="6cf80-122">Scalability and performance requirements determine the settings of the following parameters:</span></span>  
  
- <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A>  
  
- <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A>  
  
- <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A>  
  
 <span data-ttu-id="6cf80-123">Diese Parameter sollten in Abhängigkeit vom aktuellen Szenario wie nachfolgend angegeben festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="6cf80-123">These parameters should be set as follows, according to the current scenario.</span></span>  
  
### <a name="scenario-a-small-number-of-workflow-instances-that-require-optimal-response-time"></a><span data-ttu-id="6cf80-124">Szenario: Wenige Workflowinstanzen, die eine optimale Reaktionszeit erfordern</span><span class="sxs-lookup"><span data-stu-id="6cf80-124">Scenario: A Small Number of Workflow Instances That Require Optimal Response Time</span></span>  
 <span data-ttu-id="6cf80-125">Bei diesem Szenario sollten alle Workflowinstanzen auch im Leerlauf geladen bleiben.</span><span class="sxs-lookup"><span data-stu-id="6cf80-125">In this scenario, all workflow instances should remain loaded when they become idle.</span></span> <span data-ttu-id="6cf80-126">Legen Sie <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> auf einen hohen Wert fest.</span><span class="sxs-lookup"><span data-stu-id="6cf80-126">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to a large value.</span></span> <span data-ttu-id="6cf80-127">Diese Einstellung verhindert eine Verschiebung von Workflowinstanzen zwischen Computern.</span><span class="sxs-lookup"><span data-stu-id="6cf80-127">The use of this setting prevents a workflow instance from moving between computers.</span></span> <span data-ttu-id="6cf80-128">Verwenden Sie diese Einstellung nur, wenn mindestens eine der folgenden Bedingungen erfüllt ist:</span><span class="sxs-lookup"><span data-stu-id="6cf80-128">Use this setting only if one or more of the following are true:</span></span>  
  
- <span data-ttu-id="6cf80-129">Eine Workflowinstanz empfängt eine einzelne Nachricht während des Lebenszyklus.</span><span class="sxs-lookup"><span data-stu-id="6cf80-129">A workflow instance receives a single message throughout its lifetime.</span></span>  
  
- <span data-ttu-id="6cf80-130">Alle Workflowinstanzen werden auf einem Computer ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="6cf80-130">All workflow instances run on a single computer</span></span>  
  
- <span data-ttu-id="6cf80-131">Alle Nachrichten, die von einer Workflowinstanz empfangen werden, werden auf demselben Computer empfangen.</span><span class="sxs-lookup"><span data-stu-id="6cf80-131">All messages that are received by a workflow instance are received by the same computer.</span></span>  
  
 <span data-ttu-id="6cf80-132">Verwenden Sie <xref:System.Activities.Statements.Persist>-Aktivitäten, oder legen Sie <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> auf 0 (null) fest, um eine Wiederherstellung der Workflowinstanz nach einem Ausfall des Diensthosts oder Computers zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="6cf80-132">Use <xref:System.Activities.Statements.Persist> activities or set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> to 0 to enable recovery of your workflow instance after service host or computer failures.</span></span>  
  
### <a name="scenario-workflow-instances-are-idle-for-long-periods-of-time"></a><span data-ttu-id="6cf80-133">Szenario: Workflowinstanzen befinden sich über lange Zeiträume im Leerlauf</span><span class="sxs-lookup"><span data-stu-id="6cf80-133">Scenario: Workflow Instances Are Idle for Long Periods of Time</span></span>  
 <span data-ttu-id="6cf80-134">Legen Sie <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> in diesem Szenario auf 0 (null) fest, um Ressourcen so bald wie möglich freizugeben.</span><span class="sxs-lookup"><span data-stu-id="6cf80-134">In this scenario, set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 0 to release resources as soon as possible.</span></span>  
  
### <a name="scenario-workflow-instances-receive-multiple-messages-in-a-short-period-of-time"></a><span data-ttu-id="6cf80-135">Szenario: Workflowinstanzen empfangen mehrere Nachrichten in einem kurzen Zeitraum</span><span class="sxs-lookup"><span data-stu-id="6cf80-135">Scenario: Workflow Instances Receive Multiple Messages in a Short Period of Time</span></span>  
 <span data-ttu-id="6cf80-136">Legen Sie <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> in diesem Szenario auf 60 Sekunden fest, wenn die Nachrichten auf demselben Computer empfangen werden.</span><span class="sxs-lookup"><span data-stu-id="6cf80-136">In this scenario, set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 60 seconds if these messages are received by the same computer.</span></span> <span data-ttu-id="6cf80-137">Dadurch wird auch eine rasche Abfolge des Entladens und Ladens einer Workflowinstanz verhindert.</span><span class="sxs-lookup"><span data-stu-id="6cf80-137">This prevents a rapid sequence of unloading and loading of a workflow instance.</span></span> <span data-ttu-id="6cf80-138">Gleichzeitig verbleibt die Instanz nicht unnötig lange im Speicher.</span><span class="sxs-lookup"><span data-stu-id="6cf80-138">This also does not keep the instance in memory for too long.</span></span>  
  
 <span data-ttu-id="6cf80-139">Legen Sie <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> auf 0 (null) fest, und legen Sie <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A> auf BasicRetry oder AggressiveRetry fest, wenn die Nachrichten auf verschiedenen Computern empfangen werden können.</span><span class="sxs-lookup"><span data-stu-id="6cf80-139">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to 0, and set <xref:System.ServiceModel.Activities.Description.SqlWorkflowInstanceStoreBehavior.InstanceLockedExceptionAction%2A> to BasicRetry or AggressiveRetry if these messages may be received by different computers.</span></span> <span data-ttu-id="6cf80-140">Dadurch kann die Workflowinstanz von einem anderen Computer geladen werden.</span><span class="sxs-lookup"><span data-stu-id="6cf80-140">This allows the workflow instance to be loaded by another computer.</span></span>  
  
### <a name="scenario-workflow-uses-delay-activities-with-short-durations"></a><span data-ttu-id="6cf80-141">Szenario: Workflow mit Verzögerungsaktivitäten und kurzen Zeitspannen</span><span class="sxs-lookup"><span data-stu-id="6cf80-141">Scenario: Workflow Uses Delay Activities with Short Durations</span></span>  
 <span data-ttu-id="6cf80-142">In diesem Szenario wird die Persistenzdatenbank vom <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> in regelmäßigen Abständen nach Instanzen abgefragt, die aufgrund einer abgelaufenen <xref:System.Activities.Statements.Delay>-Aktivität geladen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="6cf80-142">In this scenario, the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> regularly polls the persistence database for instances that should be loaded because of an expired <xref:System.Activities.Statements.Delay> activity.</span></span> <span data-ttu-id="6cf80-143">Wenn <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> einen Timer ermittelt, der während des nächsten Abrufintervalls abläuft, wird das Abrufintervall vom SQL-Workflowinstanzspeicher verkürzt.</span><span class="sxs-lookup"><span data-stu-id="6cf80-143">If the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> finds a timer that will expire in the next polling interval, the SQL Workflow Instance Store shortens the polling interval.</span></span> <span data-ttu-id="6cf80-144">Der nächste Abruf erfolgt dann unmittelbar nach Ablauf des Timers.</span><span class="sxs-lookup"><span data-stu-id="6cf80-144">The next poll will then occur right after the timer has expired.</span></span> <span data-ttu-id="6cf80-145">Auf diese Weise erreicht der SQL-Workflowinstanzspeicher eine hohe Genauigkeit für Timer, deren Ausführungsdauer das Abfrageintervall übersteigt, das durch <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="6cf80-145">This way, the SQL Workflow Instance Store achieves a high accuracy of timers that run longer than the polling interval, which is set by <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span></span> <span data-ttu-id="6cf80-146">Damit eine rechtzeitige Verarbeitung kürzerer Verzögerungen gewährleistet ist, muss die Workflowinstanz mindestens für ein Abfrageintervall im Speicher verbleiben.</span><span class="sxs-lookup"><span data-stu-id="6cf80-146">To enable timely processing of shorter delays, the workflow instance must remain in memory for at least one polling interval.</span></span>  
  
 <span data-ttu-id="6cf80-147">Legen Sie <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> auf 0 (null) fest, um die Ablaufzeit in die Persistenzdatenbank zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="6cf80-147">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A> to 0 to write the expiration time to the persistence database.</span></span>  
  
 <span data-ttu-id="6cf80-148">Legen Sie <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> auf <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> oder einen längeren Zeitraum fest, damit die Instanz mindestens für ein Abfrageintervall im Speicher verbleibt.</span><span class="sxs-lookup"><span data-stu-id="6cf80-148">Set <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> to longer than or equal to <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to keep the instance in memory for at least one polling interval.</span></span>  
  
 <span data-ttu-id="6cf80-149">Es wird nicht empfohlen, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> zu verkürzen, da dies zu einer erhöhten Auslastung der Persistenzdatenbank führt.</span><span class="sxs-lookup"><span data-stu-id="6cf80-149">We do not recommend reducing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> because this leads to an increased load on the persistence database.</span></span> <span data-ttu-id="6cf80-150">Bei allen Diensthosts, die den <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> verwenden, wird die Datenbank einmal im Erkennungszeitraum abgefragt.</span><span class="sxs-lookup"><span data-stu-id="6cf80-150">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the database one time per detection period.</span></span> <span data-ttu-id="6cf80-151">Wenn Sie <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> auf ein zu kurzes Zeitintervall festlegen, kann es bei einer großen Anzahl an Diensthosts zu Einbußen bei der Systemleistung kommen.</span><span class="sxs-lookup"><span data-stu-id="6cf80-151">Setting <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to too small a time interval may cause your system's performance to decrease if the number of service hosts is large.</span></span>  
  
## <a name="configuring-the-sql-workflow-instance-store"></a><span data-ttu-id="6cf80-152">Konfigurieren des SQL-Workflowinstanzspeichers</span><span class="sxs-lookup"><span data-stu-id="6cf80-152">Configuring the SQL Workflow Instance Store</span></span>  
 <span data-ttu-id="6cf80-153">Der SQL-Workflowinstanzspeicher verfügt über folgende Konfigurationsparameter:</span><span class="sxs-lookup"><span data-stu-id="6cf80-153">The SQL Workflow Instance Store has the following configuration parameters:</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceEncodingOption%2A>  
 <span data-ttu-id="6cf80-154">Mit diesem Parameter wird der <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> angewiesen, den Zustand der Workflowinstanz zu komprimieren.</span><span class="sxs-lookup"><span data-stu-id="6cf80-154">This parameter instructs the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to compress the workflow instance state.</span></span> <span data-ttu-id="6cf80-155">Durch die Komprimierung müssen weniger Daten in der Persistenzdatenbank gespeichert werden. Dies verringert den Netzwerkdatenverkehr, wenn sich die Persistenzdatenbank auf einem dedizierten Datenbankserver befindet.</span><span class="sxs-lookup"><span data-stu-id="6cf80-155">Compression reduces the amount of data that is stored in the persistence database and reduces network traffic in case the persistence database resides on a dedicated database server.</span></span> <span data-ttu-id="6cf80-156">Wenn die Komprimierung verwendet wird, sind entsprechende Berechnungsressourcen zur Komprimierung und Extrahierung des Instanzzustands erforderlich.</span><span class="sxs-lookup"><span data-stu-id="6cf80-156">If compression is used, it requires computational resources to compress and extract the instance state.</span></span> <span data-ttu-id="6cf80-157">Durch die Komprimierung wird i. d. R. eine höhere Leistung erreicht.</span><span class="sxs-lookup"><span data-stu-id="6cf80-157">In most cases, compression yields increased performance.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceCompletionAction%2A>  
 <span data-ttu-id="6cf80-158">Mit diesem Parameter wird der <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> angewiesen, abgeschlossene Instanzen entweder zu speichern oder zu löschen.</span><span class="sxs-lookup"><span data-stu-id="6cf80-158">This parameter instructs the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to either keep or delete completed instances.</span></span> <span data-ttu-id="6cf80-159">Durch die Beibehaltung abgeschlossener Instanzen steigen die Speicheranforderungen an die Persistenzdatenbank. Außerdem nimmt die Tabellengröße zu, und Suchvorgänge in Tabellen dauern länger.</span><span class="sxs-lookup"><span data-stu-id="6cf80-159">Keeping completed instances increases the persistence database storage requirements and leads to larger tables, which increases table lookup times.</span></span> <span data-ttu-id="6cf80-160">Wenn Sie abgeschlossene Instanzen nicht zum Debuggen oder Überwachen benötigen, sollte der <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> so konfiguriert sein, dass abgeschlossene Instanzen gelöscht werden.</span><span class="sxs-lookup"><span data-stu-id="6cf80-160">Unless completed instances are required for debugging or auditing, it is best to instruct the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> to delete completed instances.</span></span> <span data-ttu-id="6cf80-161">Gelöschte Instanzen sollten nur beibehalten werden, wenn vom Benutzer ein Prozess eingerichtet wird, um diese letztendlich zu löschen.</span><span class="sxs-lookup"><span data-stu-id="6cf80-161">Deleted instances should be kept only if the user establishes a process for eventually removing them.</span></span> <span data-ttu-id="6cf80-162">Solange abgeschlossene Workflowinstanzen im Instanzspeicher verbleiben, können Korrelationsschlüssel nicht wiederverwendet werden.</span><span class="sxs-lookup"><span data-stu-id="6cf80-162">Note that correlation keys cannot be reused as long as the completed workflow instance resides in the instance store.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>  
 <span data-ttu-id="6cf80-163">Mit diesem Parameter wird das maximale Zeitintervall definiert, in dem die Persistenzdatenbank von <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> nach Instanzen abgefragt wird, die bei Ablauf einer <xref:System.Activities.Statements.Delay>-Aktivität geladen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="6cf80-163">This parameter defines the maximum interval with which the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the persistence database for instances that should be loaded when a <xref:System.Activities.Statements.Delay> activity expires.</span></span> <span data-ttu-id="6cf80-164">Wenn <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> einen Timer ermittelt, der während des nächsten Abrufintervalls abläuft, wird das Abrufintervall verkürzt, sodass die folgende Abfrage unmittelbar nach Ablauf des Timers durchgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="6cf80-164">If the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> finds a timer that will expire in the next polling interval, it shortens the polling interval so that the next poll will occur right after the timer has expired.</span></span> <span data-ttu-id="6cf80-165">Auf diese Weise erreicht der SQL-Workflowinstanzspeicher eine hohe Genauigkeit für Zeitgeber, deren Ausführungsdauer die <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> übersteigt.</span><span class="sxs-lookup"><span data-stu-id="6cf80-165">This way, the SQL Workflow Instance Store achieves a high accuracy of timers that run longer than <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>.</span></span>  
  
 <span data-ttu-id="6cf80-166">Es wird nicht empfohlen, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> zu verkürzen, da dies zu einer erhöhten Auslastung der Persistenzdatenbank führt.</span><span class="sxs-lookup"><span data-stu-id="6cf80-166">We do not recommend reducing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A>, because this leads to an increased load on the persistence database.</span></span> <span data-ttu-id="6cf80-167">Bei allen Diensthosts, die den <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> verwenden, wird die Datenbank einmal im Erkennungszeitraum abgefragt.</span><span class="sxs-lookup"><span data-stu-id="6cf80-167">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> polls the database one time per detection period.</span></span> <span data-ttu-id="6cf80-168">Wenn Sie <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> auf ein zu kurzes Intervall festlegen, kann es bei einer großen Anzahl an Diensthosts zu Einbußen bei der Systemleistung kommen.</span><span class="sxs-lookup"><span data-stu-id="6cf80-168">Setting <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.RunnableInstancesDetectionPeriod%2A> to too small an interval may cause your system's performance to decrease if the number of service hosts is large.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>  
 <span data-ttu-id="6cf80-169">Dieser Parameter definiert das Intervall zur Erneuerung der Hostsperre in der Persistenzdatenbank.</span><span class="sxs-lookup"><span data-stu-id="6cf80-169">This parameter defines the interval with which the host renews its lock in the persistence database.</span></span> <span data-ttu-id="6cf80-170">Durch eine Verkürzung dieses Intervalls wird eine schnellere Wiederherstellung von Workflowinstanzen bei einem Host- oder Computerausfall ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="6cf80-170">Shortening this interval will enable a quicker recovery of the workflow instances in case a host or computer fails.</span></span> <span data-ttu-id="6cf80-171">Allerdings wird durch kurze Erneuerungszeiträume für Sperren die Auslastung der Persistenzdatenbank erhöht.</span><span class="sxs-lookup"><span data-stu-id="6cf80-171">On the other hand, a short lock renewal period increases the load on the persistence database.</span></span> <span data-ttu-id="6cf80-172">Alle Diensthosts, die den <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> verwenden, aktualisieren ihre Sperren in der Datenbank einmal pro Erneuerungszeitraum.</span><span class="sxs-lookup"><span data-stu-id="6cf80-172">Each service host that uses the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> will update its locks in the database one time per renewal period.</span></span> <span data-ttu-id="6cf80-173">Bei Computern mit vielen Diensthosts sollte sichergestellt werden, dass sich die Sperrerneuerungen nicht negativ auf die Systemleistung auswirken.</span><span class="sxs-lookup"><span data-stu-id="6cf80-173">If a computer runs many service hosts, make sure that the load caused by lock renewal does not decrease your system's performance.</span></span> <span data-ttu-id="6cf80-174">Verkürzen Sie andernfalls die <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>.</span><span class="sxs-lookup"><span data-stu-id="6cf80-174">If it does, consider increasing the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.HostLockRenewalPeriod%2A>.</span></span>  
  
 <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A>  
 <span data-ttu-id="6cf80-175">Wenn diese Einstellung aktiviert ist, wird von <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> 30 Sekunden lang versucht, eine gesperrte Instanz erneut zu laden.</span><span class="sxs-lookup"><span data-stu-id="6cf80-175">If enabled, the <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore> retries to load a locked instance for the next 30 seconds.</span></span> <span data-ttu-id="6cf80-176">Legen Sie <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> auf BasicRetry oder AggressiveRetry fest, wenn der Workflow mehrere Nachrichten innerhalb kurzer Zeit empfängt und die Nachrichten von verschiedenen Computern empfangen werden.</span><span class="sxs-lookup"><span data-stu-id="6cf80-176">Set <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> to BasicRetry or AggressiveRetry if the workflow receives multiple messages in a short time, and these messages are received by different computers.</span></span>  
  
 <span data-ttu-id="6cf80-177">Da durch den Mechanismus zum Wiederholen des Ladevorgangs kein Leistungsmehraufwand verursacht wird, solange der Mechanismus nicht tatsächlich ausgeführt wird, sollte <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> in jedem Fall aktiviert sein.</span><span class="sxs-lookup"><span data-stu-id="6cf80-177">Because the load retry mechanism does not introduce any performance overhead as long as load retries are not tried, <xref:System.Activities.DurableInstancing.SqlWorkflowInstanceStore.InstanceLockedExceptionAction%2A> should always be enabled.</span></span>
