---
title: NAT-Durchlauf mit IPv6 und Teredo
ms.date: 03/30/2017
ms.assetid: 568cd245-3300-49ef-a995-d81bf845d961
ms.openlocfilehash: a6448ddf117e1f454338869820751ae5d9e0070e
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/26/2020
ms.locfileid: "96258620"
---
# <a name="nat-traversal-using-ipv6-and-teredo"></a><span data-ttu-id="2b621-102">NAT-Durchlauf mit IPv6 und Teredo</span><span class="sxs-lookup"><span data-stu-id="2b621-102">NAT Traversal using IPv6 and Teredo</span></span>

<span data-ttu-id="2b621-103">Es wurden Verbesserungen vorgenommen, sodass nun der NAT-Durchlauf (Netzwerkadressenübersetzung) unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="2b621-103">Enhancements were made that provide support for Network Address Translation (NAT) traversal.</span></span> <span data-ttu-id="2b621-104">Diese Änderungen wurden für den Gebrauch mit IPv6 und Teredo entwickelt, sie können aber auch auf andere Technologien zum IP-Tunneln angewendet werden.</span><span class="sxs-lookup"><span data-stu-id="2b621-104">These changes are designed for use with IPv6 and Teredo, but they are also applicable to other IP tunneling technologies.</span></span> <span data-ttu-id="2b621-105">Diese Verbesserungen betreffen Klassen im <xref:System.Net> und verknüpften Namespaces.</span><span class="sxs-lookup"><span data-stu-id="2b621-105">These enhancements affect classes in the <xref:System.Net> and related namespaces.</span></span>  
  
 <span data-ttu-id="2b621-106">Diese Änderungen können sich auf Client- und Serveranwendungen auswirken, die Technologien zum IP-Tunneln verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="2b621-106">These changes can affect client and server applications that plan to use IP tunneling technologies.</span></span>  
  
 <span data-ttu-id="2b621-107">Die Änderungen, die für die Unterstützung des NAT-Durchlaufs vorgenommen wurden, sind nur für Anwendungen mit .NET Framework Version 4 verfügbar.</span><span class="sxs-lookup"><span data-stu-id="2b621-107">The changes to support NAT traversal are available only for applications using .NET Framework version 4.</span></span> <span data-ttu-id="2b621-108">Diese Features stehen in früheren Versionen des .NET Frameworks nicht zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="2b621-108">These features are not available on earlier versions of the .NET Framework.</span></span>  
  
## <a name="overview"></a><span data-ttu-id="2b621-109">Übersicht</span><span class="sxs-lookup"><span data-stu-id="2b621-109">Overview</span></span>  

 <span data-ttu-id="2b621-110">Internetprotokoll Version 4 (IPv4) hat die Länge einer IPv4-Adresse als 32-Bit angegeben.</span><span class="sxs-lookup"><span data-stu-id="2b621-110">The Internet Protocol version 4 (IPv4) defined an IPv4 address as 32 bits long.</span></span> <span data-ttu-id="2b621-111">Deshalb unterstützt IPv4 etwa 4 Milliarden eindeutige IP-Adressen (2 hoch 32).</span><span class="sxs-lookup"><span data-stu-id="2b621-111">As a result, IPv4 supports approximately 4 billion unique IP addresses (2^32).</span></span> <span data-ttu-id="2b621-112">Als die Zahl der Computer und Netzwerkgeräte mit Internetzugriff in den 1990ern anwuchs, wurden die Grenzen des IPv4-Adressraums aufgezeigt.</span><span class="sxs-lookup"><span data-stu-id="2b621-112">As the number of computers and network devices on the Internet expanded in the 1990s, the limits of the IPv4 address space became apparent.</span></span>  
  
 <span data-ttu-id="2b621-113">Eine von mehreren eingesetzten Methoden zur Verlängerung der Lebensdauer von IPv4 wurde in NAT bereitgestellt. Damit kann eine einzelne, eindeutige öffentliche IP-Adresse eine große Zahl privater IP-Adressen darstellen (privates Netzwerk).</span><span class="sxs-lookup"><span data-stu-id="2b621-113">One of several techniques used to extend the lifetime of IPv4 has been to deploy NAT to allow a single unique public IP address to represent a large number of private IP addresses (private Intranet).</span></span> <span data-ttu-id="2b621-114">Die privaten Adressen des NAT-Geräts haben die einzelne öffentliche IPv4-Adresse gemein.</span><span class="sxs-lookup"><span data-stu-id="2b621-114">The private IP addresses behind the NAT device share the single public IPv4 address.</span></span> <span data-ttu-id="2b621-115">Das NAT-Gerät ist möglicherweise ein dediziertes Hardwaregerät (z.B. ein kostengünstiger Funkzugriffspunkt und Router) oder ein Computer, der einen Dienst zur Bereitstellung von NAT ausführt.</span><span class="sxs-lookup"><span data-stu-id="2b621-115">The NAT device may be a dedicated hardware device (an inexpensive Wireless Access Point and router, for example) or a computer running a service to provide NAT.</span></span> <span data-ttu-id="2b621-116">Ein Gerät oder Dienst für diese öffentliche IP-Adresse übersetzt IP-Netzwerkpakete zwischen dem Internet und dem privaten Netzwerk.</span><span class="sxs-lookup"><span data-stu-id="2b621-116">A device or service for this public IP address translates IP network packets between the public Internet and the private Intranet.</span></span>  
  
 <span data-ttu-id="2b621-117">Dies funktioniert ideal mit Clientanwendungen, die im privaten Netzwerk ausgeführt werden, die Anforderungen an andere IP-Adressen (überwiegend Server) im Internet senden.</span><span class="sxs-lookup"><span data-stu-id="2b621-117">This scheme works well for client applications running on the private Intranet that send requests to other IP addresses (usually servers) on the Internet.</span></span> <span data-ttu-id="2b621-118">Das NAT-Gerät oder der NAT-Server kann ein Mapping der Clientanforderungen beibehalten, sodass klar ist, an welche Stelle eine Antwort geschickt werden muss, wenn diese zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="2b621-118">The NAT device or server can keep a mapping of client requests so when a response is returned it knows where to send the response.</span></span> <span data-ttu-id="2b621-119">Diese Methode ist jedoch problematisch für Anwendungen, die in einem privaten Netzwerk hinter dem NAT-Gerät ausgeführt werden, die Dienste bereitstellen, auf Pakete lauschen und darauf reagieren möchten.</span><span class="sxs-lookup"><span data-stu-id="2b621-119">But this scheme poses problems for applications running in the private Intranet behind the NAT device that want to provide services, listen for packets, and respond.</span></span> <span data-ttu-id="2b621-120">Dies gilt insbesondere für Peer-zu-Peer-Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="2b621-120">This is particularly the case for peer-to-peer applications.</span></span>  
  
 <span data-ttu-id="2b621-121">Das IPv6-Protokoll hat die Länge einer IPv4-Adresse als 128-Bit angegeben.</span><span class="sxs-lookup"><span data-stu-id="2b621-121">The IPv6 protocol defined an IPv4 address as 128 bits long.</span></span> <span data-ttu-id="2b621-122">Deshalb unterstützt IPv6 einen sehr großen IP-Adressraum von 3,2 x 10^38 eindeutigen Adressen (2 hoch 128).</span><span class="sxs-lookup"><span data-stu-id="2b621-122">As a result, IPv6 supports very a large IP address space of 3.2 x 10^38 unique addresses (2^128).</span></span> <span data-ttu-id="2b621-123">Bei einem Adressraum dieser Größe kann jedes mit dem Internet verbundene Gerät eine eindeutige Adresse erhalten.</span><span class="sxs-lookup"><span data-stu-id="2b621-123">With an address space of this size, it is possible for every device connected to the Internet to be given a unique address.</span></span> <span data-ttu-id="2b621-124">Dabei gibt es allerdings Probleme.</span><span class="sxs-lookup"><span data-stu-id="2b621-124">But there are problems.</span></span> <span data-ttu-id="2b621-125">Ein Großteil der Welt verwendet immer noch IPv4.</span><span class="sxs-lookup"><span data-stu-id="2b621-125">Much of the world is still using only IPv4.</span></span> <span data-ttu-id="2b621-126">Insbesondere Router und Funkzugriffspunkte, die von kleinen Unternehmen, Organisationen und Haushalten eingesetzt werden, unterstützen kein IPv6.</span><span class="sxs-lookup"><span data-stu-id="2b621-126">In particular, many of the existing routers and wireless access points used by small companies, organizations, and households do not support IPv6.</span></span> <span data-ttu-id="2b621-127">Darüber hinaus unterstützen einige Internetanbieter dieser Kunden IPv6 nicht oder haben die Konfiguration nicht konfiguriert.</span><span class="sxs-lookup"><span data-stu-id="2b621-127">Also some Internet service providers that serve these customers either do not support or have not configured support for IPv6.</span></span>  
  
 <span data-ttu-id="2b621-128">Es wurden mehrere Übergangstechnologien für IPv6 entwickelt, um IPv6-Adressen in ein IPv4-Paket zu tunneln.</span><span class="sxs-lookup"><span data-stu-id="2b621-128">Several IPv6 transition technologies have been developed to tunnel IPv6 addresses in an IPv4 packet.</span></span> <span data-ttu-id="2b621-129">Zu diesen Technologien zählen 6to4-, ISATAP- und Teredo-Tunnel, die Adressenzuweisungen und automatisches Host-zu-Host-Tunneln für IPv6-Unicastdatenverkehr bieten, wenn IPv6-Hosts IPv4-Netzwerke durchlaufen müssen, um andere IPv6-Netzwerke zu erreichen.</span><span class="sxs-lookup"><span data-stu-id="2b621-129">These technologies include 6to4, ISATAP, and Teredo tunnels that provide address assignment and host-to-host automatic tunneling for unicast IPv6 traffic when IPv6 hosts must traverse IP4 networks to reach other IPv6 networks.</span></span> <span data-ttu-id="2b621-130">IPv6-Pakete werden als IPv4-Pakete getunnelt gesendet.</span><span class="sxs-lookup"><span data-stu-id="2b621-130">IPv6 packets are sent tunneled as IPv4 packets.</span></span> <span data-ttu-id="2b621-131">Es werden mehrere Tunnelmethoden verwendet, um IPv6-Adressen den NAT-Durchlauf durch ein NAT-Gerät zu erlauben.</span><span class="sxs-lookup"><span data-stu-id="2b621-131">Several tunneling techniques are being used that allow NAT traversal for IPv6 addresses through a NAT device.</span></span>  
  
 <span data-ttu-id="2b621-132">Teredo ist eine der IPv6-Übergangstechnologien, durch die IPv6-Konnektivität in IPv4-Netzwerken möglich ist.</span><span class="sxs-lookup"><span data-stu-id="2b621-132">Teredo is one of the IPv6 transition technologies which brings IPv6 connectivity to IPv4 networks.</span></span> <span data-ttu-id="2b621-133">Teredo wird in der RFC 4380 dokumentiert, die von der Internet Engineering Task Force (IETF) veröffentlicht wird.</span><span class="sxs-lookup"><span data-stu-id="2b621-133">Teredo is documented in RFC 4380 published by the Internet Engineering Task Force (IETF).</span></span> <span data-ttu-id="2b621-134">Windows XP SP2 und höher bietet Unterstützung für einen virtuellen Teredo-Adapter, der eine öffentliche IPv6-IP-Adresse im Bereich 2001:0::/32 bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="2b621-134">Windows XP SP2 and later provide support for a virtual Teredo adapter which can provide a public IPv6 address in the range 2001:0::/32.</span></span> <span data-ttu-id="2b621-135">Diese IPv6-Adresse kann verwendet werden, um auf eingehende Verbindungen aus dem Internet zu lauschen und kann IPv6-fähigen Clients bereitgestellt werden, die eine Verbindung mit dem lauschenden Dienst herstellen möchten.</span><span class="sxs-lookup"><span data-stu-id="2b621-135">This IPv6 address can be used to listen for incoming connections from the Internet and can be provided to IPv6 enabled clients that wish to connect to the listening service.</span></span> <span data-ttu-id="2b621-136">So muss sich eine Anwendung nicht mehr darum kümmern, wie es auf einen Computer hinter einem NAT-Gerät eingeht, da die Anwendung einfach eine Verbindung mit ihrer IPv6-Teredo-Adresse herstellen kann.</span><span class="sxs-lookup"><span data-stu-id="2b621-136">This frees an application from worrying about how to address a computer behind a NAT device, since the application can just connect to it using its IPv6 Teredo address.</span></span>  
  
## <a name="enhancements-to-support-nat-traversal-and-teredo"></a><span data-ttu-id="2b621-137">Verbesserungen zur Unterstützung des NAT-Durchlaufs und Teredo</span><span class="sxs-lookup"><span data-stu-id="2b621-137">Enhancements to Support NAT Traversal and Teredo</span></span>  

 <span data-ttu-id="2b621-138">Den Namespaces <xref:System.Net>, <xref:System.Net.NetworkInformation>und <xref:System.Net.Sockets> wurden Verbesserungen hinzugefügt, um den NAT-Durchlauf mit IPv6 und Teredo zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="2b621-138">Enhancements are added to the <xref:System.Net>, <xref:System.Net.NetworkInformation>, and <xref:System.Net.Sockets> namespaces for supporting NAT traversal using IPv6 and Teredo.</span></span>  
  
 <span data-ttu-id="2b621-139">Mehrere Methoden werden zu der <xref:System.Net.NetworkInformation.IPGlobalProperties?displayProperty=nameWithType>-Klasse hinzugefügt, um die Liste von Unicast-IP-Adressen auf dem Host abzurufen.</span><span class="sxs-lookup"><span data-stu-id="2b621-139">Several methods are added to the <xref:System.Net.NetworkInformation.IPGlobalProperties?displayProperty=nameWithType> class to get the list of unicast IP addresses on the host.</span></span> <span data-ttu-id="2b621-140">Die <xref:System.Net.NetworkInformation.IPGlobalProperties.BeginGetUnicastAddresses%2A>-Methode beginnt eine asynchrone Anforderung zum Abrufen der Tabelle der stabilen Unicast-IP-Adresse auf dem lokalen Computer.</span><span class="sxs-lookup"><span data-stu-id="2b621-140">The <xref:System.Net.NetworkInformation.IPGlobalProperties.BeginGetUnicastAddresses%2A> method begins an asynchronous request to retrieve the stable unicast IP address table on the local computer.</span></span> <span data-ttu-id="2b621-141">Die <xref:System.Net.NetworkInformation.IPGlobalProperties.EndGetUnicastAddresses%2A>-Methode beendet eine ausstehende asynchrone Anforderung zum Abrufen der Tabelle der stabilen Unicast-IP-Adresse auf dem lokalen Computer.</span><span class="sxs-lookup"><span data-stu-id="2b621-141">The <xref:System.Net.NetworkInformation.IPGlobalProperties.EndGetUnicastAddresses%2A> method ends a pending asynchronous request to retrieve the stable unicast IP address table on the local computer.</span></span> <span data-ttu-id="2b621-142">Die <xref:System.Net.NetworkInformation.IPGlobalProperties.GetUnicastAddresses%2A>-Methode ist eine synchrone Anforderung zum Abrufen der Tabelle der stabilen Unicast-IP-Adresse auf dem lokalen Computer, wobei falls nötig gewartet wird, bis sich die Adressentabelle stabilisiert.</span><span class="sxs-lookup"><span data-stu-id="2b621-142">The <xref:System.Net.NetworkInformation.IPGlobalProperties.GetUnicastAddresses%2A> method is a synchronous request to retrieve the stable unicast IP address table on the local computer, waiting until the address table stabilizes if necessary.</span></span>  
  
 <span data-ttu-id="2b621-143">Die <xref:System.Net.IPAddress.IsIPv6Teredo%2A?displayProperty=nameWithType>-Eigenschaft kann verwendet werden, um zu bestimmen, ob eine <xref:System.Net.IPAddress> eine IPv6 Teredo-Adresse ist.</span><span class="sxs-lookup"><span data-stu-id="2b621-143">The <xref:System.Net.IPAddress.IsIPv6Teredo%2A?displayProperty=nameWithType> property can be used to determine if an <xref:System.Net.IPAddress> is an IPv6 Teredo address.</span></span>  
  
 <span data-ttu-id="2b621-144">Die Verwendung dieser neuen <xref:System.Net.NetworkInformation.IPGlobalProperties>-Klassenmethoden in Kombination mit der <xref:System.Net.IPAddress.IsIPv6Teredo%2A>-Eigenschaft ermöglicht es einer Anwendung, die Teredo-Adresse leicht zu finden.</span><span class="sxs-lookup"><span data-stu-id="2b621-144">Using these new <xref:System.Net.NetworkInformation.IPGlobalProperties> class methods in combination with the <xref:System.Net.IPAddress.IsIPv6Teredo%2A> property allows an application to easily find the Teredo address.</span></span> <span data-ttu-id="2b621-145">Eine Anwendung muss die lokale Teredo-Adresse normalerweise nur kennen, wenn sie diese Information an Remoteanwendungen kommuniziert.</span><span class="sxs-lookup"><span data-stu-id="2b621-145">An application normally only needs to know the local Teredo address if it is communicating this information to remote applications.</span></span> <span data-ttu-id="2b621-146">Beispielsweise könnte eine Peer-zu-Peer-Anwendung alle ihre IPv6-Adressen an einen Zuordnungsserver senden, der diese dann an andere Peers weiterleiten kann, um die direkte Kommunikation zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="2b621-146">For example, a peer-to-peer application might send all of its IPv6 addresses to a matchmaking server which can then forward them to others peers to enable direct communication.</span></span>  
  
 <span data-ttu-id="2b621-147">Eine Anwendung sollte normalerweise ihren lauschenden Dienst so festlegen, dass er an <xref:System.Net.IPAddress.IPv6Any?displayProperty=nameWithType> anstatt an der lokalen Teredo-Adresse lauscht.</span><span class="sxs-lookup"><span data-stu-id="2b621-147">An application should normally set its listening service to listen on <xref:System.Net.IPAddress.IPv6Any?displayProperty=nameWithType> rather than on the local Teredo address.</span></span> <span data-ttu-id="2b621-148">Wenn also ein Remoteclient oder Peer über eine IPv6-Route zum Host des lauschenden Diensts verfügt, kann der Client oder Peer mithilfe von IPv6 direkt eine Verbindung herstellen und muss nicht Teredo verwenden, um Pakete zu tunneln.</span><span class="sxs-lookup"><span data-stu-id="2b621-148">So if a remote client or peer has a direct IPv6 route to the host of the listening service, the client or peer can connect directly using IPv6 and not have to use Teredo to tunnel packets.</span></span>  
  
 <span data-ttu-id="2b621-149">Bei TCP-Anwendungen verfügt die <xref:System.Net.Sockets.TcpListener?displayProperty=nameWithType>-Klasse über eine <xref:System.Net.Sockets.TcpListener.AllowNatTraversal%2A>-Methode zum Aktivieren des NAT-Durchlaufs.</span><span class="sxs-lookup"><span data-stu-id="2b621-149">For TCP applications, the <xref:System.Net.Sockets.TcpListener?displayProperty=nameWithType> class has an <xref:System.Net.Sockets.TcpListener.AllowNatTraversal%2A> method to enable NAT traversal.</span></span> <span data-ttu-id="2b621-150">Bei UDP-Anwendungen verfügt die <xref:System.Net.Sockets.UdpClient?displayProperty=nameWithType>-Klasse über eine <xref:System.Net.Sockets.UdpClient.AllowNatTraversal%2A>-Methode zum Aktivieren des NAT-Durchlaufs.</span><span class="sxs-lookup"><span data-stu-id="2b621-150">For UDP applications, the <xref:System.Net.Sockets.UdpClient?displayProperty=nameWithType> class has an <xref:System.Net.Sockets.UdpClient.AllowNatTraversal%2A> method to enable NAT traversal.</span></span>  
  
 <span data-ttu-id="2b621-151">Bei Anwendungen, die <xref:System.Net.Sockets.Socket?displayProperty=nameWithType> und zugehörige Klassen verwenden, können die <xref:System.Net.Sockets.Socket.GetSocketOption%2A>- und <xref:System.Net.Sockets.Socket.SetSocketOption%2A>-Methoden mit der Socketoption <xref:System.Net.Sockets.SocketOptionName.IPProtectionLevel?displayProperty=nameWithType> verwendet werden, um den NAT-Durchlauf abzufragen, zu aktivieren oder zu deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="2b621-151">For applications that use the <xref:System.Net.Sockets.Socket?displayProperty=nameWithType> and related classes, the <xref:System.Net.Sockets.Socket.GetSocketOption%2A> and <xref:System.Net.Sockets.Socket.SetSocketOption%2A> methods can be used with the <xref:System.Net.Sockets.SocketOptionName.IPProtectionLevel?displayProperty=nameWithType> socket option to query, enable, or disable NAT traversal.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2b621-152">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="2b621-152">See also</span></span>

- <xref:System.Net.IPAddress.IsIPv6Teredo%2A?displayProperty=nameWithType>
- <xref:System.Net.NetworkInformation.IPGlobalProperties.BeginGetUnicastAddresses%2A?displayProperty=nameWithType>
- <xref:System.Net.NetworkInformation.IPGlobalProperties.EndGetUnicastAddresses%2A?displayProperty=nameWithType>
- <xref:System.Net.NetworkInformation.IPGlobalProperties.GetUnicastAddresses%2A?displayProperty=nameWithType>
- <xref:System.Net.Sockets.IPProtectionLevel?displayProperty=nameWithType>
- <xref:System.Net.Sockets.Socket.SetIPProtectionLevel%2A?displayProperty=nameWithType>
- <xref:System.Net.Sockets.TcpListener.AllowNatTraversal%2A?displayProperty=nameWithType>
- <xref:System.Net.Sockets.UdpClient.AllowNatTraversal%2A?displayProperty=nameWithType>
