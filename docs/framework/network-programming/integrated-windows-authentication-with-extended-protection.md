---
title: Integrierte Windows-Authentifizierung mit erweitertem Schutz
ms.date: 03/30/2017
ms.assetid: 81731998-d5e7-49e4-ad38-c8e6d01689d0
ms.openlocfilehash: 74f421131da0e5b11fd676ff23229f5ff6ec7eca
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/26/2020
ms.locfileid: "96241622"
---
# <a name="integrated-windows-authentication-with-extended-protection"></a><span data-ttu-id="9c7fa-102">Integrierte Windows-Authentifizierung mit erweitertem Schutz</span><span class="sxs-lookup"><span data-stu-id="9c7fa-102">Integrated Windows Authentication with Extended Protection</span></span>

<span data-ttu-id="9c7fa-103">Es wurden Verbesserungen vorgenommen, die beeinflussen, wie die integrierte Windows-Authentifizierung durch <xref:System.Net.HttpWebRequest>, <xref:System.Net.HttpListener>, <xref:System.Net.Mail.SmtpClient>, <xref:System.Net.Security.SslStream>, <xref:System.Net.Security.NegotiateStream> und verknüpfte Klassen in <xref:System.Net> sowie verknüpfte Namespaces behandelt wird.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-103">Enhancements were made that affect how integrated Windows authentication is handled by the <xref:System.Net.HttpWebRequest>, <xref:System.Net.HttpListener>, <xref:System.Net.Mail.SmtpClient>, <xref:System.Net.Security.SslStream>, <xref:System.Net.Security.NegotiateStream>, and related classes in the <xref:System.Net> and related namespaces.</span></span> <span data-ttu-id="9c7fa-104">Unterstützung für erweiterten Schutz wurde zur Verbesserung der Sicherheit hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-104">Support was added for extended protection to enhance security.</span></span>  
  
 <span data-ttu-id="9c7fa-105">Diese Änderungen können sich auf Anwendungen auswirken, die diese Klassen für Webanforderungen und den Empfang der Antworten verwenden, in denen die integrierte Windows-Authentifizierung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-105">These changes can affect applications that use these classes to make web requests and receive responses where integrated Windows authentication is used.</span></span> <span data-ttu-id="9c7fa-106">Die Änderung kann sich auch auf Webserver und Clientanwendungen auswirken, die für die Verwendung der integrierten Windows-Authentifizierung konfiguriert sind.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-106">This change can also impact web servers and client applications that are configured to use integrated Windows authentication.</span></span>  
  
 <span data-ttu-id="9c7fa-107">Zudem können sich die Änderungen auf Anwendungen auswirken, die diese Klassen für andere Anforderungstypen verwenden und Antworten erhalten, in denen die integrierte Windows-Authentifizierung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-107">These changes can also affect applications that use these classes to make other types of requests and receive responses where integrated Windows authentication is used.</span></span>  
  
 <span data-ttu-id="9c7fa-108">Die Änderungen zur Unterstützung des erweiterten Schutzes sind nur für Anwendungen verfügbar, die Windows 7 und Windows Server 2008 R2 ausführen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-108">The changes to support extended protection are available only for applications on Windows 7 and Windows Server 2008 R2.</span></span> <span data-ttu-id="9c7fa-109">Die erweiterten Schutzfunktionen sind nicht für frühere Windows-Versionen verfügbar.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-109">The extended protection features are not available on earlier versions of Windows.</span></span>  
  
## <a name="overview"></a><span data-ttu-id="9c7fa-110">Übersicht</span><span class="sxs-lookup"><span data-stu-id="9c7fa-110">Overview</span></span>  

 <span data-ttu-id="9c7fa-111">Durch die Gestaltung der integrierten Windows-Authentifizierung sind einige Abfragerückmeldungen zu Anmeldeinformationen universell, d.h. sie können wiederverwendet oder weitergeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-111">The design of integrated Windows authentication allows for some credential challenge responses to be universal, meaning they can be re-used or forwarded.</span></span> <span data-ttu-id="9c7fa-112">Die Abfragerückmeldungen sollten so konstruiert sein, dass sie mindestens über zielspezifische Informationen verfügen, vorzugsweise auch über einige kanalspezifische Informationen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-112">The challenge responses should be constructed at a minimum with target specific information and preferably also with some channel specific information.</span></span> <span data-ttu-id="9c7fa-113">Der erweiterte Schutz kann dann von Diensten bereitgestellt werden, damit Abfragerückmeldungen zu Anmeldeinformationen auch sicher dienstspezifische Informationen, wie z.B. einen Dienstprinzipalnamen (Service Principal Name, SPN), enthalten.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-113">Services can then provide extended protection to ensure that credential challenge responses contain service specific information such as a Service Principal Name (SPN).</span></span> <span data-ttu-id="9c7fa-114">Enthält der Austausch von Anmeldedaten diese Informationen, können die Dienste besser vor einer böswilligen Verwendung von Abfragerückmeldungen zu Anmeldeinformationen schützen, die möglicherweise nicht ordnungsgemäß verwendet wurden.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-114">With this information in the credential exchanges, services are able to better protect against malicious use of credential challenge responses that might have been improperly used.</span></span>  
  
 <span data-ttu-id="9c7fa-115">Die Gestaltung des erweiterten Schutzes stellt eine Verbesserung der Authentifizierungsprotokolle dar, um Relay-Angriffe auf die Authentifizierung zu verringern.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-115">The extended protection design is an enhancement to authentication protocols designed to mitigate authentication relay attacks.</span></span> <span data-ttu-id="9c7fa-116">Sie basiert auf Kanalbindungs- und Dienstbindungsinformationen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-116">It revolves around the concept of channel and service binding information.</span></span>  
  
 <span data-ttu-id="9c7fa-117">Die Hauptziele lauten wie folgt:</span><span class="sxs-lookup"><span data-stu-id="9c7fa-117">The overall objectives are the following:</span></span>  
  
1. <span data-ttu-id="9c7fa-118">Unterstützt der Client nach der Aktualisierung den erweiterten Schutz, sollten die Anwendungen allen unterstützten Authentifizierungsprotokollen Kanalbindungs- und Dienstbindungsinformationen bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-118">If the client is updated to support the extended protection, applications should supply a channel binding and service binding information to all supported authentication protocols.</span></span> <span data-ttu-id="9c7fa-119">Kanalbindungsinformationen können nur bereitgestellt werden, wenn ein Kanal (TLS) vorhanden ist, an den sie sich binden können.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-119">Channel binding information can only be supplied when there is a channel (TLS) to bind to.</span></span> <span data-ttu-id="9c7fa-120">Dienstbindungsinformationen sollten immer bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-120">Service binding information should always be supplied.</span></span>  
  
2. <span data-ttu-id="9c7fa-121">Aktualisierte und ordnungsgemäß konfigurierte Server überprüfen möglicherweise die Kanalbindungs- und die Dienstbindungsinformationen, wenn sie im Clientauthentifizierungstoken vorhanden sind. Stimmen die Kanalbindungen nicht überein, wird der Authentifizierungsversuch abgelehnt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-121">Updated servers which are properly configured may verify the channel and service binding information when it is present in the client authentication token and reject the authentication attempt if the channel bindings do not match.</span></span> <span data-ttu-id="9c7fa-122">Je nach Bereitstellungsszenario überprüfen die Server möglicherweise die Kanalbindung, die Dienstbindung oder beides.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-122">Depending on the deployment scenario, servers may verify channel binding, service binding or both.</span></span>  
  
3. <span data-ttu-id="9c7fa-123">Aktualisierte Server können abwärtskompatible Clientanforderungen, die die Kanalbindungsinformationen der Richtlinie nicht enthalten, annehmen oder ablehnen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-123">Updated servers have the ability to accept or reject down-level client requests that do not contain the channel binding information based on policy.</span></span>  
  
 <span data-ttu-id="9c7fa-124">Die durch den erweiterten Schutz verwendeten Informationen bestehen aus einem oder beiden der folgenden zwei Elemente:</span><span class="sxs-lookup"><span data-stu-id="9c7fa-124">Information used by extended protection consists of one or both of the following two parts:</span></span>  
  
1. <span data-ttu-id="9c7fa-125">einem Kanalbindungstoken oder CBT (Channel Binding Token)</span><span class="sxs-lookup"><span data-stu-id="9c7fa-125">A Channel Binding Token or CBT.</span></span>  
  
2. <span data-ttu-id="9c7fa-126">Dienstbindungsinformationen in Form eines Dienstprinzipalnamens oder SPN (Service Principal Name)</span><span class="sxs-lookup"><span data-stu-id="9c7fa-126">Service Binding information in the form of a Service Principal Name or SPN.</span></span>  
  
 <span data-ttu-id="9c7fa-127">Dienstbindungsinformationen deuten darauf hin, dass sich ein Client bei einem bestimmten Dienstendpunkt authentifizieren möchte.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-127">Service Binding information is an indication of a client’s intent to authenticate to a particular service endpoint.</span></span> <span data-ttu-id="9c7fa-128">Sie werden mit den folgenden Eigenschaften vom Client zum Server übermittelt:</span><span class="sxs-lookup"><span data-stu-id="9c7fa-128">It is communicated from client to server with the following properties:</span></span>  
  
- <span data-ttu-id="9c7fa-129">Der SPN-Wert muss für den Server, der die Clientauthentifizierung durchführt, als Klartext verfügbar sein.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-129">The SPN value must be available to the server performing client authentication in clear text form.</span></span>  
  
- <span data-ttu-id="9c7fa-130">Der SPN-Wert ist öffentlich.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-130">The value of the SPN is public.</span></span>  
  
- <span data-ttu-id="9c7fa-131">Der SPN muss während der Übertragung kryptografisch geschützt sein, damit der Wert bei einem Man-in-the-Middle-Angriff nicht eingefügt, entfernt oder geändert werden kann.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-131">The SPN must be cryptographically protected in transit such that a man-in-the-middle attack cannot insert, remove or modify its value.</span></span>  
  
 <span data-ttu-id="9c7fa-132">Ein CBT ist eine Eigenschaft des gesicherten Außenkanals (z.B. TLS), die zur Kopplung (Bindung) an eine Konversation über einen clientauthentifizierten Innenkanal verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-132">A CBT is a property of the outer secure channel (such as TLS) used to tie (bind) it to a conversation over an inner, client-authenticated channel.</span></span> <span data-ttu-id="9c7fa-133">Das CBT muss über die folgenden Eigenschaften verfügen (auch durch IETF RFC 5056 definiert):</span><span class="sxs-lookup"><span data-stu-id="9c7fa-133">The CBT must have the following properties (also defined by IETF RFC 5056):</span></span>  
  
- <span data-ttu-id="9c7fa-134">Ist ein Außenkanal vorhanden, muss der CBT-Wert eine Eigenschaft sein, die entweder den Außenkanal oder den Serverendpunkt identifiziert. Sie muss auf beiden Seiten der Konversation unabhängig empfangen werden, sowohl beim Client als auch beim Server.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-134">When an outer channel exists, the value of the CBT must be a property identifying either the outer channel or the server endpoint, independently arrived at by both client and server sides of a conversation.</span></span>  
  
- <span data-ttu-id="9c7fa-135">Der Wert des vom Client gesendeten CBT darf nicht von einem Angreifer beeinflusst werden können.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-135">Value of the CBT sent by the client must not be something an attacker can influence.</span></span>  
  
- <span data-ttu-id="9c7fa-136">Es kann nicht garantiert werden, dass der CBT-Wert geheim bleibt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-136">No guarantees are made about secrecy of the CBT value.</span></span> <span data-ttu-id="9c7fa-137">Dies bedeutet jedoch nicht, dass der Wert der Dienstbindungs- sowie der Kanalbindungsinformationen immer von einem beliebigen anderen Server als dem überprüft werden kann, der die Authentifizierung ausführt. Das Protokoll, das das CBT enthält, verschlüsselt ihn möglicherweise.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-137">This does not however mean that the value of the service binding as well as channel binding information can always be examined by any other but the server performing authentication, as the protocol carrying the CBT may be encrypting it.</span></span>  
  
- <span data-ttu-id="9c7fa-138">Das CBT muss während der Übertragung kryptografisch geschützt sein, damit der Wert von einem Angreifer nicht eingefügt, entfernt oder geändert werden kann.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-138">The CBT must be cryptographically integrity protected in transit such that an attacker cannot insert, remove or modify its value.</span></span>  
  
 <span data-ttu-id="9c7fa-139">Die Kanalbindung erfolgt durch den Client, der den SPN und das CBT manipulationsgeschützt an den Server überträgt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-139">Channel binding is accomplished by the client transferring the SPN and the CBT to the server in a tamperproof fashion.</span></span> <span data-ttu-id="9c7fa-140">Der Server überprüft die Kanalbindungsinformationen anhand der Richtlinie und lehnt Authentifizierungsversuche ab, die er als nicht an ihn gerichtet einstuft.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-140">The server validates the channel binding information in accordance with its policy and rejects authentication attempts for which it does not believe itself to have been the intended target.</span></span> <span data-ttu-id="9c7fa-141">So werden die beiden Kanäle kryptografisch miteinander verbunden.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-141">This way, the two channels become cryptographically bound together.</span></span>  
  
 <span data-ttu-id="9c7fa-142">Damit die Kompatibilität mit vorhandenen Clients und Anwendungen erhalten bleibt, kann ein Server so konfiguriert werden, dass er Authentifizierungsversuche von Clients zulässt, die noch nicht den erweiterten Schutz unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-142">To preserve compatibility with existing clients and applications, a server may be configured to allow authentication attempts by clients that do not yet support extended protection.</span></span> <span data-ttu-id="9c7fa-143">Diese Konfiguration wird als „teilweise gehärtet“ bezeichnet, im Gegensatz zu einer „vollständig gehärteten“ Konfiguration.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-143">This is referred to as a "partially hardened" configuration, in contrast to a "fully hardened" configuration.</span></span>  
  
 <span data-ttu-id="9c7fa-144">Mehrere Komponenten der Namespaces <xref:System.Net> und <xref:System.Net.Security> führen die integrierte Windows-Authentifizierung für eine aufrufende Anwendung aus.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-144">Multiple components in the <xref:System.Net> and <xref:System.Net.Security> namespaces perform integrated Windows authentication on behalf of a calling application.</span></span> <span data-ttu-id="9c7fa-145">In diesem Abschnitt werden die erforderlichen Änderungen an System.Net-Komponenten beschrieben, um den erweiterten Schutz ihrer Verwendung der integrierten Windows-Authentifizierung hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-145">This section describes changes to System.Net components to add extended protection in their use of integrated Windows authentication.</span></span>  
  
 <span data-ttu-id="9c7fa-146">Der erweiterte Schutz wird derzeit für Windows 7 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-146">Extended protection is currently supported on Windows 7.</span></span> <span data-ttu-id="9c7fa-147">Über einen bereitgestellten Mechanismus ermittelt eine Anwendung, ob das Betriebssystem den erweiterten Schutz unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-147">A mechanism is provided so an application can determine if the operating system supports extended protection.</span></span>  
  
## <a name="changes-to-support-extended-protection"></a><span data-ttu-id="9c7fa-148">Erforderliche Änderungen für den erweiterten Schutz</span><span class="sxs-lookup"><span data-stu-id="9c7fa-148">Changes to Support Extended Protection</span></span>  

 <span data-ttu-id="9c7fa-149">Der bei der integrierten Windows-Authentifizierung verwendete Authentifizierungsvorgang enthält je nach Authentifizierungsprotokoll häufig eine Abfrage, die vom Zielcomputer ausgegeben und an den Clientcomputer zurückgesendet wird.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-149">The authentication process used with integrated Windows authentication, depending on the authentication protocol used, often includes a challenge issued by the destination computer and sent back to the client computer.</span></span> <span data-ttu-id="9c7fa-150">Der erweiterte Schutz fügt diesem Authentifizierungsvorgang neue Funktionen hinzu.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-150">Extended protection adds new features to this authentication process</span></span>  
  
 <span data-ttu-id="9c7fa-151">Der Namespace <xref:System.Security.Authentication.ExtendedProtection> stellt Unterstützung für die Authentifizierung mit erweitertem Schutz für Anwendungen bereit.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-151">The <xref:System.Security.Authentication.ExtendedProtection> namespace provides support for authentication using extended protection for applications.</span></span> <span data-ttu-id="9c7fa-152">In diesem Namespace stellt die Klasse <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> die Kanalbindung dar.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-152">The <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> class in this namespace represents a channel binding.</span></span> <span data-ttu-id="9c7fa-153">Die Klasse <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> stellt in diesem Namespace die erweiterte Schutzrichtlinie dar, die vom Server zur Validierung eingehender Clientverbindungen verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-153">The <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> class in this namespace represents the extended protection policy used by the server to validate incoming client connections.</span></span> <span data-ttu-id="9c7fa-154">Andere Klassenmember werden mit erweitertem Schutz verwendet.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-154">Other class members are used with extended protection.</span></span>  
  
 <span data-ttu-id="9c7fa-155">Bei Serveranwendungen beinhalten diese Klassen:</span><span class="sxs-lookup"><span data-stu-id="9c7fa-155">For server applications, these classes include the following:</span></span>  
  
 <span data-ttu-id="9c7fa-156">Eine <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> mit den folgenden Elementen:</span><span class="sxs-lookup"><span data-stu-id="9c7fa-156">A <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> that has the following elements:</span></span>  
  
- <span data-ttu-id="9c7fa-157">Eine <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy.OSSupportsExtendedProtection%2A>-Eigenschaft, die angibt, ob das Betriebssystem die integrierte Windows-Authentifizierung mit erweitertem Schutz unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-157">An <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy.OSSupportsExtendedProtection%2A> property that indicates whether the operating system supports integrated windows authentication with extended protection.</span></span>  
  
- <span data-ttu-id="9c7fa-158">Ein <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement>-Wert, der angibt, wann die erweiterte Schutzrichtlinie erzwungen werden soll.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-158">A <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> value that indicates when the extended protection policy should be enforced.</span></span>  
  
- <span data-ttu-id="9c7fa-159">Ein <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario>-Wert, der das Bereitstellungsszenario angibt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-159">A <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> value that indicates the deployment scenario.</span></span> <span data-ttu-id="9c7fa-160">Dieser wirkt sich darauf aus, wie der erweiterte Schutz aktiviert wird.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-160">This influences how extended protection is checked.</span></span>  
  
- <span data-ttu-id="9c7fa-161">Eine optionale <xref:System.Security.Authentication.ExtendedProtection.ServiceNameCollection> mit der benutzerdefinierten SPN-Liste für einen Abgleich mit dem vom Client bereitgestellten SPN als beabsichtigtem Ziel der Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-161">An optional <xref:System.Security.Authentication.ExtendedProtection.ServiceNameCollection> that contains the custom SPN list that is used to match against the SPN provided by the client as the intended target of the authentication.</span></span>  
  
- <span data-ttu-id="9c7fa-162">Eine optionale <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> mit einer benutzerdefinierten Kanalbindung zur Validierung.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-162">An optional <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding> that contains a custom channel binding to use for validation.</span></span> <span data-ttu-id="9c7fa-163">Dies ist kein häufiges Szenario.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-163">This scenario is not a common case</span></span>  
  
 <span data-ttu-id="9c7fa-164">Der Namespace <xref:System.Security.Authentication.ExtendedProtection.Configuration> stellt Unterstützung für die Konfiguration der Authentifizierung mit erweitertem Schutz für Anwendungen bereit.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-164">The <xref:System.Security.Authentication.ExtendedProtection.Configuration> namespace provides support for configuration of authentication using extended protection for applications.</span></span>  
  
 <span data-ttu-id="9c7fa-165">Bei einer Reihe von Funktionen wurden Änderungen vorgenommen, um den erweiterten Schutz im vorhandenen Namespace <xref:System.Net> zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-165">A number of feature changes were made to support extended protection in the existing <xref:System.Net> namespace.</span></span> <span data-ttu-id="9c7fa-166">Dazu gehören folgende Änderungen:</span><span class="sxs-lookup"><span data-stu-id="9c7fa-166">These changes include the following:</span></span>  
  
- <span data-ttu-id="9c7fa-167">Eine neue <xref:System.Net.TransportContext>-Klasse, die einen Transportkontext darstellt, im Namespace <xref:System.Net>.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-167">A new <xref:System.Net.TransportContext> class added to the <xref:System.Net> namespace that represents a transport context.</span></span>  
  
- <span data-ttu-id="9c7fa-168">Neue Überladungsmethoden <xref:System.Net.HttpWebRequest.EndGetRequestStream%2A> und <xref:System.Net.HttpWebRequest.GetRequestStream%2A> in der Klasse <xref:System.Net.HttpWebRequest> zum Abrufen von <xref:System.Net.TransportContext> für die Unterstützung des erweiterten Schutzes bei Clientanwendungen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-168">New <xref:System.Net.HttpWebRequest.EndGetRequestStream%2A> and <xref:System.Net.HttpWebRequest.GetRequestStream%2A> overload methods in the <xref:System.Net.HttpWebRequest> class that allow retrieving the <xref:System.Net.TransportContext> to support extended protection for client applications.</span></span>  
  
- <span data-ttu-id="9c7fa-169">Erweiterungen für die Klassen <xref:System.Net.HttpListener> und <xref:System.Net.HttpListenerRequest> zur Unterstützung von Serveranwendungen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-169">Additions to the <xref:System.Net.HttpListener> and <xref:System.Net.HttpListenerRequest> classes to support server applications.</span></span>  
  
 <span data-ttu-id="9c7fa-170">Eine Funktionsänderung wurde vorgenommen, um den erweiterten Schutz für SMTP-Clientanwendungen im vorhandenen Namespace <xref:System.Net.Mail> zu unterstützen:</span><span class="sxs-lookup"><span data-stu-id="9c7fa-170">A feature change was made to support extended protection for SMTP client applications in the existing <xref:System.Net.Mail> namespace:</span></span>  
  
- <span data-ttu-id="9c7fa-171">Eine <xref:System.Net.Mail.SmtpClient.TargetName%2A>-Eigenschaft in der Klasse <xref:System.Net.Mail.SmtpClient>, die den zur Authentifizierung verwendeten SPN bei der Verwendung des erweiterten Schutzes in SMTP-Clientanwendungen darstellt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-171">A <xref:System.Net.Mail.SmtpClient.TargetName%2A> property in the <xref:System.Net.Mail.SmtpClient> class that represents the SPN to use for authentication when using extended protection for SMTP client applications.</span></span>  
  
 <span data-ttu-id="9c7fa-172">Bei einer Reihe von Funktionen wurden Änderungen vorgenommen, um den erweiterten Schutz im vorhandenen Namespace <xref:System.Net.Security> zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-172">A number of feature changes were made to support extended protection in the existing <xref:System.Net.Security> namespace.</span></span> <span data-ttu-id="9c7fa-173">Dazu gehören folgende Änderungen:</span><span class="sxs-lookup"><span data-stu-id="9c7fa-173">These changes include the following:</span></span>  
  
- <span data-ttu-id="9c7fa-174">Neue Überladungsmethoden <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsClient%2A> und <xref:System.Net.Security.NegotiateStream.AuthenticateAsClient%2A> in der Klasse <xref:System.Net.Security.NegotiateStream> zur Übergabe eines CBT für die Unterstützung des erweiterten Schutzes bei Clientanwendungen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-174">New <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsClient%2A> and <xref:System.Net.Security.NegotiateStream.AuthenticateAsClient%2A> overload methods in the <xref:System.Net.Security.NegotiateStream> class that allow passing a CBT to support extended protection for client applications.</span></span>  
  
- <span data-ttu-id="9c7fa-175">Neue Überladungsmethoden <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsServer%2A> und <xref:System.Net.Security.NegotiateStream.AuthenticateAsServer%2A> in der Klasse <xref:System.Net.Security.NegotiateStream> zur Übergabe einer <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> für die Unterstützung des erweiterten Schutzes bei Serveranwendungen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-175">New <xref:System.Net.Security.NegotiateStream.BeginAuthenticateAsServer%2A> and <xref:System.Net.Security.NegotiateStream.AuthenticateAsServer%2A> overload methods in the <xref:System.Net.Security.NegotiateStream> class that allow passing an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> to support extended protection for server applications.</span></span>  
  
- <span data-ttu-id="9c7fa-176">Eine neue <xref:System.Net.Security.SslStream.TransportContext%2A>-Eigenschaft in der Klasse <xref:System.Net.Security.SslStream> für die Unterstützung des erweiterten Schutzes bei Client- und Serveranwendungen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-176">A new <xref:System.Net.Security.SslStream.TransportContext%2A> property in the <xref:System.Net.Security.SslStream> class to support extended protection for client and server applications.</span></span>  
  
 <span data-ttu-id="9c7fa-177">Eine <xref:System.Net.Configuration.SmtpNetworkElement>-Eigenschaft wurde hinzugefügt, um die Konfiguration des erweiterten Schutzes für SMTP-Clients im Namespace <xref:System.Net.Security> zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-177">A <xref:System.Net.Configuration.SmtpNetworkElement> property was added to support configuration of extended protection for SMTP clients in the <xref:System.Net.Security> namespace.</span></span>  
  
## <a name="extended-protection-for-client-applications"></a><span data-ttu-id="9c7fa-178">Erweiterter Schutz für Clientanwendungen</span><span class="sxs-lookup"><span data-stu-id="9c7fa-178">Extended Protection for Client Applications</span></span>  

 <span data-ttu-id="9c7fa-179">Der erweiterte Schutz wird bei den meisten Clientanwendungen automatisch unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-179">Extended protection support for most client applications happens automatically.</span></span> <span data-ttu-id="9c7fa-180">Die Klassen <xref:System.Net.HttpWebRequest> und <xref:System.Net.Mail.SmtpClient> unterstützen den erweiterten Schutz, wenn die zugrunde liegende Windows-Version den erweiterten Schutz unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-180">The <xref:System.Net.HttpWebRequest> and <xref:System.Net.Mail.SmtpClient> classes support extended protection whenever the underlying version of Windows supports extended protection.</span></span> <span data-ttu-id="9c7fa-181">Eine <xref:System.Net.HttpWebRequest>-Instanz sendet einen SPN, der aus dem <xref:System.Uri> erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-181">An <xref:System.Net.HttpWebRequest> instance sends an SPN constructed from the <xref:System.Uri>.</span></span> <span data-ttu-id="9c7fa-182">Eine <xref:System.Net.Mail.SmtpClient>-Instanz sendet standardmäßig einen SPN, der aus dem Hostnamen des SMTP-Mailservers erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-182">By default, an <xref:System.Net.Mail.SmtpClient> instance sends an SPN constructed from the host name of the SMTP mail server.</span></span>  
  
 <span data-ttu-id="9c7fa-183">Clientanwendungen können zur benutzerdefinierten Authentifizierung die Methoden <xref:System.Net.HttpWebRequest.EndGetRequestStream%28System.IAsyncResult%2CSystem.Net.TransportContext%40%29?displayProperty=nameWithType> oder <xref:System.Net.HttpWebRequest.GetRequestStream%28System.Net.TransportContext%40%29?displayProperty=nameWithType> in der Klasse <xref:System.Net.HttpWebRequest> verwenden, die den <xref:System.Net.TransportContext> und das CBT mithilfe der Methode <xref:System.Net.TransportContext.GetChannelBinding%2A> abrufen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-183">For custom authentication, client applications can use the <xref:System.Net.HttpWebRequest.EndGetRequestStream%28System.IAsyncResult%2CSystem.Net.TransportContext%40%29?displayProperty=nameWithType> or <xref:System.Net.HttpWebRequest.GetRequestStream%28System.Net.TransportContext%40%29?displayProperty=nameWithType> methods in the <xref:System.Net.HttpWebRequest> class that allow retrieving the <xref:System.Net.TransportContext> and the CBT using the <xref:System.Net.TransportContext.GetChannelBinding%2A> method.</span></span>  
  
 <span data-ttu-id="9c7fa-184">Sie können den von einer <xref:System.Net.HttpWebRequest>-Instanz an einen bestimmten Server gesendeten SPN zur integrierten Windows-Authentifizierung überschreiben, indem Sie die Eigenschaft <xref:System.Net.AuthenticationManager.CustomTargetNameDictionary%2A> festlegen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-184">The SPN to use for integrated Windows authentication sent by an <xref:System.Net.HttpWebRequest> instance to a given service can be overridden by setting the <xref:System.Net.AuthenticationManager.CustomTargetNameDictionary%2A> property.</span></span>  
  
 <span data-ttu-id="9c7fa-185">Mit der Eigenschaft <xref:System.Net.Mail.SmtpClient.TargetName%2A> kann ein benutzerdefinierter SPN zur integrierten Windows-Authentifizierung für die SMTP-Verbindung festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-185">The <xref:System.Net.Mail.SmtpClient.TargetName%2A> property can be used to set a custom SPN to use for integrated Windows authentication for the SMTP connection.</span></span>  
  
## <a name="extended-protection-for-server-applications"></a><span data-ttu-id="9c7fa-186">Erweiterter Schutz für Serveranwendungen</span><span class="sxs-lookup"><span data-stu-id="9c7fa-186">Extended Protection for Server Applications</span></span>  

 <span data-ttu-id="9c7fa-187"><xref:System.Net.HttpListener> stellt automatisch Mechanismen zur Validierung von Dienstbindungen bereit, wenn die HTTP-Authentifizierung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-187"><xref:System.Net.HttpListener> automatically provides mechanisms for validating service bindings when performing HTTP authentication.</span></span>  
  
 <span data-ttu-id="9c7fa-188">Das sicherste Szenario ist die Aktivierung des erweiterten Schutzes für die Präfixe `HTTPS://`.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-188">The most secure scenario is to enable extended protection for `HTTPS://` prefixes.</span></span> <span data-ttu-id="9c7fa-189">Legen Sie in diesem Fall <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> auf <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> fest, für das <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> auf <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> oder <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> festgelegt ist, sowie <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> auf <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected>. Ein Wert von <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> versetzt <xref:System.Net.HttpListener> in den teilweise gehärteten Modus, während <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> dem vollständig gehärteten Modus entspricht.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-189">In this case, set <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> to an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> set to <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> or <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>, and <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> set to <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected> A value of  <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> puts <xref:System.Net.HttpListener> in partially hardened mode, while <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> corresponds to fully hardened mode.</span></span>  
  
 <span data-ttu-id="9c7fa-190">Wird in dieser Konfiguration eine Anforderung über einen sicheren Außenkanal an den Server gesendet, wird der Außenkanal nach einer Kanalbindung abgefragt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-190">In this configuration when a request is made to the server through an outer secure channel, the outer channel is queried for a channel binding.</span></span> <span data-ttu-id="9c7fa-191">Diese Kanalbindung wird an die SSPI-Authentifizierungsaufrufe übergeben, die überprüfen, ob die Kanalbindung im Authentifizierungsblob übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-191">This channel binding is passed to the authentication SSPI calls, which validate that the channel binding in the authentication blob matches.</span></span> <span data-ttu-id="9c7fa-192">Es gibt drei mögliche Ergebnisse:</span><span class="sxs-lookup"><span data-stu-id="9c7fa-192">There are three possible outcomes:</span></span>  
  
1. <span data-ttu-id="9c7fa-193">Das zugrunde liegende Betriebssystem des Servers unterstützt den erweiterten Schutz nicht.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-193">The server’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="9c7fa-194">Die Anforderung wird der Anwendung nicht verfügbar gemacht, und die Antwort „Nicht autorisiert (401).“ wird an den Client zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-194">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="9c7fa-195">Eine Nachricht mit dem Grund für den Fehler wird in der Ablaufverfolgungsquelle <xref:System.Net.HttpListener> protokolliert.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-195">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
2. <span data-ttu-id="9c7fa-196">Es tritt beim SSPI-Aufruf ein Fehler auf. Dies bedeutet entweder, dass die vom Client angegebene Kanalbindung nicht mit dem erwarteten Wert übereinstimmt, der aus dem Außenkanal abgerufen wurde, oder dass der Client bei der Konfiguration der erweiterten Schutzrichtlinie auf dem Server für <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> keine Kanalbindung bereitgestellt hat.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-196">The SSPI call fails indicating that either the client specified a channel binding that did not match the expected value retrieved from the outer channel or the client failed to supply a channel binding when the extended protection policy on the server was configured for <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>.</span></span> <span data-ttu-id="9c7fa-197">In beiden Fällen wird die Anforderung der Anwendung nicht verfügbar gemacht, und die Antwort „Nicht autorisiert (401)“ wird an den Client zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-197">In both cases, the request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="9c7fa-198">Eine Nachricht mit dem Grund für den Fehler wird in der Ablaufverfolgungsquelle <xref:System.Net.HttpListener> protokolliert.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-198">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
3. <span data-ttu-id="9c7fa-199">Der Client gibt die richtige Kanalbindung an oder kann ohne Angabe einer Kanalbindung die Verbindung herstellen, da die erweiterte Schutzrichtlinie auf dem Server mit <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> konfiguriert ist. Die Anforderung wird für die Verarbeitung an die Anwendung zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-199">The client specifies the correct channel binding or is allowed to connect without specifying a channel binding since the extended protection policy on the server is configured with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> The request is returned to the application for processing.</span></span> <span data-ttu-id="9c7fa-200">Die Dienstnamenüberprüfung wird nicht automatisch ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-200">No service name check is performed automatically.</span></span> <span data-ttu-id="9c7fa-201">Eine Anwendung führt möglicherweise eine eigene Überprüfung des Dienstnamens mithilfe der <xref:System.Net.HttpListenerRequest.ServiceName%2A>-Eigenschaft durch. Dies ist unter diesen Umständen jedoch redundant.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-201">An application may choose to perform its own service name validation using the <xref:System.Net.HttpListenerRequest.ServiceName%2A> property, but under these circumstances it is redundant.</span></span>  
  
 <span data-ttu-id="9c7fa-202">Führt eine Anwendung eigene SSPI-Aufrufe zur Durchführung der Authentifizierung auf der Basis von Blobs durch, die im Text einer HTTP-Anforderung ausgetauscht werden, und ist eine Unterstützung der Kanalbindung erwünscht, muss die Anwendung die erwartete Kanalbindung vom sicheren Außenkanal mithilfe von <xref:System.Net.HttpListener> abrufen, um sie an die native Win32-Funktion [AcceptSecurityContext](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) zu übergeben.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-202">If an application makes its own SSPI calls to perform authentication based on blobs passed back and forth within the body of an HTTP request and wishes to support channel binding, it needs to retrieve the expected channel binding from the outer secure channel using <xref:System.Net.HttpListener> in order to pass it to native Win32 [AcceptSecurityContext](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) function.</span></span> <span data-ttu-id="9c7fa-203">Verwenden Sie hierfür die Eigenschaft <xref:System.Net.HttpListenerRequest.TransportContext%2A>, und rufen Sie zum Abrufen des CBT die Methode <xref:System.Net.TransportContext.GetChannelBinding%2A> auf.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-203">To do this, use the <xref:System.Net.HttpListenerRequest.TransportContext%2A> property and call <xref:System.Net.TransportContext.GetChannelBinding%2A> method to retrieve the CBT.</span></span> <span data-ttu-id="9c7fa-204">Nur Endpunktbindungen werden unterstützt.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-204">Only endpoint bindings are supported.</span></span> <span data-ttu-id="9c7fa-205">Wird etwas anderes als <xref:System.Security.Authentication.ExtendedProtection.ChannelBindingKind.Endpoint> angegeben, wird eine <xref:System.NotSupportedException> ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-205">If anything other <xref:System.Security.Authentication.ExtendedProtection.ChannelBindingKind.Endpoint> is specified, a <xref:System.NotSupportedException> will be thrown.</span></span> <span data-ttu-id="9c7fa-206">Unterstützt das zugrunde liegende Betriebssystem die Kanalbindung, gibt die Methode <xref:System.Net.TransportContext.GetChannelBinding%2A> ein <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding><xref:System.Runtime.InteropServices.SafeHandle> zurück, das einen Zeiger mit einer Kanalbindung umschließt, die an die Funktion [AcceptSecurityContext](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) als im Parameter `pInput` übergebener Member „PvBuffer“ einer Struktur „SecBuffer“ übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-206">If the underlying operating system supports channel binding, the <xref:System.Net.TransportContext.GetChannelBinding%2A> method will return a <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding><xref:System.Runtime.InteropServices.SafeHandle> wrapping a pointer to a channel binding suitable for passing to [AcceptSecurityContext](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) function as the pvBuffer member of a SecBuffer structure passed in the `pInput` parameter.</span></span> <span data-ttu-id="9c7fa-207">Die Eigenschaft <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding.Size%2A> enthält die Länge der Kanalbindung in Bytes.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-207">The <xref:System.Security.Authentication.ExtendedProtection.ChannelBinding.Size%2A> property contains the length, in bytes, of the channel binding.</span></span> <span data-ttu-id="9c7fa-208">Unterstützt das zugrunde liegende Betriebssystem keine Kanalbindungen, gibt die Funktion `null` zurück.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-208">If the underlying operating system does not support channel bindings, the function will return `null`.</span></span>  
  
 <span data-ttu-id="9c7fa-209">Ein anderes mögliches Szenario ist die Aktivierung des erweiterten Schutz für die Präfixe `HTTP://`, wenn keine Proxys verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-209">Another possible scenario is to enable extended protection for `HTTP://` prefixes when proxies are not used.</span></span> <span data-ttu-id="9c7fa-210">Legen Sie in diesem Fall <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> auf <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> fest, für das <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> auf <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> oder <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> festgelegt ist, sowie <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> auf <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected>. Ein Wert von <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> versetzt <xref:System.Net.HttpListener> in den teilweise gehärteten Modus, während <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> dem vollständig gehärteten Modus entspricht.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-210">In this case, set <xref:System.Net.HttpListener.ExtendedProtectionPolicy%2A?displayProperty=nameWithType> to an <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> with <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement> set to <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> or <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>, and <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario> set to <xref:System.Security.Authentication.ExtendedProtection.ProtectionScenario.TransportSelected> A value of  <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> puts <xref:System.Net.HttpListener> in partially hardened mode, while <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> corresponds to fully hardened mode.</span></span>  
  
 <span data-ttu-id="9c7fa-211">Eine Standardliste mit den zulässigen Dienstnamen wird auf Grundlage der Präfixe erstellt, die mit <xref:System.Net.HttpListener> registriert wurden.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-211">A default list of allowed service names is created based on the prefixes which have been registered with the <xref:System.Net.HttpListener>.</span></span> <span data-ttu-id="9c7fa-212">Diese Standardliste kann mit der Eigenschaft <xref:System.Net.HttpListener.DefaultServiceNames%2A> überprüft werden.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-212">This default list can be examined through the <xref:System.Net.HttpListener.DefaultServiceNames%2A> property.</span></span> <span data-ttu-id="9c7fa-213">Ist die Liste nicht vollständig, kann eine Anwendung im Konstruktor für die Klasse <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> eine benutzerdefinierte Dienstnamensammlung angeben, die anstelle der Standard-Dienstnamenliste verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-213">If this list is not comprehensive, an application can specify a custom service name collection in the constructor for the <xref:System.Security.Authentication.ExtendedProtection.ExtendedProtectionPolicy> class which will be used instead of the default service name list.</span></span>  
  
 <span data-ttu-id="9c7fa-214">Wird in dieser Konfiguration eine Anforderung ohne sicheren Außenkanal an den Server gesendet, erfolgt die Authentifizierung üblicherweise ohne Überprüfung der Kanalbindung.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-214">In this configuration, when a request is made to the server without an outer secure channel authentication proceeds normally without a channel binding check.</span></span> <span data-ttu-id="9c7fa-215">Bei erfolgreicher Authentifizierung wird der Kontext nach dem vom Client bereitgestellten Dienstnamen abgefragt und anhand der Liste der zulässigen Dienstnamen überprüft.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-215">If the authentication succeeds, the context is queried for the service name that the client provided and validated against the list of acceptable service names.</span></span> <span data-ttu-id="9c7fa-216">Es gibt vier mögliche Ergebnisse:</span><span class="sxs-lookup"><span data-stu-id="9c7fa-216">There are four possible outcomes:</span></span>  
  
1. <span data-ttu-id="9c7fa-217">Das zugrunde liegende Betriebssystem des Servers unterstützt den erweiterten Schutz nicht.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-217">The server’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="9c7fa-218">Die Anforderung wird der Anwendung nicht verfügbar gemacht, und die Antwort „Nicht autorisiert (401).“ wird an den Client zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-218">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="9c7fa-219">Eine Nachricht mit dem Grund für den Fehler wird in der Ablaufverfolgungsquelle <xref:System.Net.HttpListener> protokolliert.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-219">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
2. <span data-ttu-id="9c7fa-220">Das zugrunde liegende Betriebssystem des Clients unterstützt den erweiterten Schutz nicht.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-220">The client’s underlying operating system does not support extended protection.</span></span> <span data-ttu-id="9c7fa-221">Der Authentifizierungsversuch wird in der <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported>-Konfiguration erfolgreich ausgeführt, und die Anforderung wird an die Anwendung zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-221">In the <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.WhenSupported> configuration, the authentication attempt will succeed and the request will be returned to the application.</span></span> <span data-ttu-id="9c7fa-222">Es tritt in der <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always>-Konfiguration beim Authentifizierungsversuch ein Fehler auf.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-222">In the <xref:System.Security.Authentication.ExtendedProtection.PolicyEnforcement.Always> configuration, the authentication attempt will fail.</span></span> <span data-ttu-id="9c7fa-223">Die Anforderung wird der Anwendung nicht verfügbar gemacht, und die Antwort „Nicht autorisiert (401).“ wird an den Client zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-223">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="9c7fa-224">Eine Nachricht mit dem Grund für den Fehler wird in der Ablaufverfolgungsquelle <xref:System.Net.HttpListener> protokolliert.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-224">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
3. <span data-ttu-id="9c7fa-225">Das zugrunde liegende Betriebssystem des Clients unterstützt den erweiterten Schutz, doch in der Anwendung wurde keine Dienstbindung angegeben.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-225">The client’s underlying operating system supports extended protection, but the application did not specify a service binding.</span></span> <span data-ttu-id="9c7fa-226">Die Anforderung wird der Anwendung nicht verfügbar gemacht, und die Antwort „Nicht autorisiert (401).“ wird an den Client zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-226">The request will not be exposed to the application, and an unauthorized (401) response will be returned to the client.</span></span> <span data-ttu-id="9c7fa-227">Eine Nachricht mit dem Grund für den Fehler wird in der Ablaufverfolgungsquelle <xref:System.Net.HttpListener> protokolliert.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-227">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
4. <span data-ttu-id="9c7fa-228">Es wurde vom Client eine Dienstbindung angegeben.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-228">The client specified a service binding.</span></span> <span data-ttu-id="9c7fa-229">Die Dienstbindung wird mit der Liste der zulässigen Dienstbindungen verglichen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-229">The service binding is compared to the list of allowed service bindings.</span></span> <span data-ttu-id="9c7fa-230">Bei einer Übereinstimmung wird die Anforderung an die Anwendung zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-230">If it matches, the request is returned to the application.</span></span> <span data-ttu-id="9c7fa-231">Andernfalls wird die Anforderung der Anwendung nicht verfügbar gemacht, und die Antwort „Nicht autorisiert (401)“ wird automatisch an den Client zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-231">Otherwise, the request will not be exposed to the application, and an unauthorized (401) response will be automatically returned to the client.</span></span> <span data-ttu-id="9c7fa-232">Eine Nachricht mit dem Grund für den Fehler wird in der Ablaufverfolgungsquelle <xref:System.Net.HttpListener> protokolliert.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-232">A message will be logged to the <xref:System.Net.HttpListener> trace source specifying the reason for the failure.</span></span>  
  
 <span data-ttu-id="9c7fa-233">Reicht diese einfache Vorgehensweise mit einer Liste aus zulässigen Dienstnamen nicht aus, kann eine Anwendung durch Abfragen der Eigenschaft <xref:System.Net.HttpListenerRequest.ServiceName%2A> möglicherweise eine eigene Überprüfung der Dienstnamen bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-233">If this simple approach using an allowed list of acceptable service names is insufficient, an application may provide its own service name validation by querying the <xref:System.Net.HttpListenerRequest.ServiceName%2A> property.</span></span> <span data-ttu-id="9c7fa-234">Im 1. und 2. Fall gibt die Eigenschaft `null` zurück.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-234">In cases 1 and 2 above, the property will return `null`.</span></span> <span data-ttu-id="9c7fa-235">Im 3. Fall wird eine leere Zeichenfolge zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-235">In case 3, it will return an empty string.</span></span> <span data-ttu-id="9c7fa-236">Im 4. Fall wird der vom Client angegebene Dienstname zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-236">In case 4, the service name specified by the client will be returned.</span></span>  
  
 <span data-ttu-id="9c7fa-237">Diese erweiterten Schutzfunktionen können auch von Serveranwendungen für die Authentifizierung mit anderen Anforderungstypen und bei vertrauenswürdigen Proxys verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="9c7fa-237">These extended protection features can also be used by server applications for authentication with other types of requests and when trusted proxies are used.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9c7fa-238">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="9c7fa-238">See also</span></span>

- <xref:System.Security.Authentication.ExtendedProtection>
- <xref:System.Security.Authentication.ExtendedProtection.Configuration>
