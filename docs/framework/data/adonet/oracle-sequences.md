---
title: Oracle-Sequenzen
ms.date: 03/30/2017
ms.assetid: 27cd371d-8252-414d-b5b2-5d31fa44b585
ms.openlocfilehash: d6e6bb51b8bd317c7161500b89993be689659fad
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/12/2020
ms.locfileid: "79149413"
---
# <a name="oracle-sequences"></a><span data-ttu-id="90174-102">Oracle-Sequenzen</span><span class="sxs-lookup"><span data-stu-id="90174-102">Oracle Sequences</span></span>
<span data-ttu-id="90174-103">Der .NET Framework-Datenanbieter für Oracle bietet Unterstützung für das Abrufen der vom Server generierten Oracle-Sequenz-Schlüsselwerte, nachdem mit <xref:System.Data.OracleClient.OracleDataAdapter> Einfügevorgänge ausgeführt wurden.</span><span class="sxs-lookup"><span data-stu-id="90174-103">The .NET Framework Data Provider for Oracle provides support for retrieving the server-generated key Oracle Sequence values after performing inserts by using the <xref:System.Data.OracleClient.OracleDataAdapter>.</span></span>  
  
 <span data-ttu-id="90174-104">SQL Server und Oracle unterstützen die Erstellung von Spalten, die automatisch inkrementiert und für Primärschlüssel verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="90174-104">SQL Server and Oracle support the creation of automatically incrementing columns that can be designated as primary keys.</span></span> <span data-ttu-id="90174-105">Diese Werte werden vom Server generiert, wenn einer Tabelle Zeilen hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="90174-105">These values are generated by the server as rows are added to a table.</span></span> <span data-ttu-id="90174-106">In SQL Server legen Sie die Identität einer Spalte fest, in Oracle erstellen Sie eine Sequenz.</span><span class="sxs-lookup"><span data-stu-id="90174-106">In SQL Server, you set the Identity property of a column; in Oracle you create a Sequence.</span></span> <span data-ttu-id="90174-107">Zwischen den AutoIncrement-Spalten in SQL Server und den Sequenzen in Oracle besteht der folgende Unterschied:</span><span class="sxs-lookup"><span data-stu-id="90174-107">The difference between auto-increment columns in SQL Server and sequences in Oracle is that:</span></span>  
  
- <span data-ttu-id="90174-108">In SQL Server markieren Sie eine Spalte als &lt;legacyBold&gt;AutoIncrement&lt;/legacyBold&gt;-Spalte, woraufhin SQL Server automatisch neue Werte für die Spalte generiert, sobald eine neue Zeile eingefügt wird.</span><span class="sxs-lookup"><span data-stu-id="90174-108">In SQL Server, you mark a column as an auto-increment column and SQL Server automatically generates new values for the column when you insert a new row.</span></span>  
  
- <span data-ttu-id="90174-109">In Oracle erstellen Sie eine Sequenz, um neue Werte für eine Spalte in Ihrer Tabelle zu generieren, wobei es aber keine direkte Verknüpfung zwischen der Sequenz und der Tabelle bzw. Spalte gibt.</span><span class="sxs-lookup"><span data-stu-id="90174-109">In Oracle, you create a sequence to generate new values for a column in your table, but there is no direct link between the sequence and the table or column.</span></span> <span data-ttu-id="90174-110">Eine Oracle-Sequenz ist ein Objekt wie eine Tabelle oder eine gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="90174-110">An Oracle sequence is an object, like a table or a stored procedure.</span></span>  
  
 <span data-ttu-id="90174-111">Wenn Sie in einer Oracle-Datenbank eine Sequenz erstellen, können Sie deren Erstwert und den Inkrementwert definieren.</span><span class="sxs-lookup"><span data-stu-id="90174-111">When you create a sequence in an Oracle database, you can define its initial value and the increment between its values.</span></span> <span data-ttu-id="90174-112">Sie können die Sequenz auch nach neuen Werten abfragen, bevor Sie neue Zeilen senden.</span><span class="sxs-lookup"><span data-stu-id="90174-112">You can also query the sequence for new values before submitting new rows.</span></span> <span data-ttu-id="90174-113">Das bedeutet, Ihr Code kann die Schlüsselwerte für neue Zeilen erkennen, bevor Sie sie in die Datenbank einfügen.</span><span class="sxs-lookup"><span data-stu-id="90174-113">That means your code can recognize the key values for new rows before you insert them into the database.</span></span>  
  
 <span data-ttu-id="90174-114">Weitere Informationen zum Erstellen von Spalten mit automatischer Inkrementierung mithilfe von SQL Server und ADO.NET finden Sie unter [Abrufen von Identitäts- oder Autonummernwerten](retrieving-identity-or-autonumber-values.md) und [Erstellen von AutoInkrementspalten](./dataset-datatable-dataview/creating-autoincrement-columns.md).</span><span class="sxs-lookup"><span data-stu-id="90174-114">For more information about creating auto-increment columns by using SQL Server and ADO.NET, see [Retrieving Identity or Autonumber Values](retrieving-identity-or-autonumber-values.md) and [Creating AutoIncrement Columns](./dataset-datatable-dataview/creating-autoincrement-columns.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="90174-115">Beispiel</span><span class="sxs-lookup"><span data-stu-id="90174-115">Example</span></span>  
 <span data-ttu-id="90174-116">Im folgenden C#-Beispiel wird gezeigt, wie Sie neue Sequenzwerte aus einer Oracle-Datenbank abrufen können.</span><span class="sxs-lookup"><span data-stu-id="90174-116">The following C# example demonstrates how you can retrieve new sequence values from Oracle database.</span></span> <span data-ttu-id="90174-117">Im Beispiel wird auf die Sequenz in der INSERT INTO-Abfrage verwiesen, mit der die neuen Zeilen eingefügt werden. Daraufhin wird der Sequenzwert zurückgegeben, der mit der in Oracle10g eingeführten RETURNING-Klausel generiert wird.</span><span class="sxs-lookup"><span data-stu-id="90174-117">The example references the sequence in the INSERT INTO query used to submit the new rows, and then returns the sequence value generated using the RETURNING clause introduced in Oracle10g.</span></span> <span data-ttu-id="90174-118">Das Beispiel fügt einer <xref:System.Data.DataTable> eine Reihe anstehender neuer Zeilen hinzu. Dabei kommt die ADO.NET-&lt;legacyBold&gt;AutoIncrement&lt;/legacyBold&gt;-Funktionalität zum Einsatz, mit der "Platzhalter"-Primärschlüsselwerte generiert werden.</span><span class="sxs-lookup"><span data-stu-id="90174-118">The example adds a series of pending new rows in a <xref:System.Data.DataTable> by using ADO.NET’s auto-increment functionality to generate "placeholder" primary key values.</span></span> <span data-ttu-id="90174-119">Beachten Sie, dass der von ADO.NET generierte Inkrementwert für die neue Zeile lediglich ein "Platzhalter" ist.</span><span class="sxs-lookup"><span data-stu-id="90174-119">Note that the increment value ADO.NET generated for the new row is just a "placeholder".</span></span> <span data-ttu-id="90174-120">Die Datenbank generiert u. U. andere Werte als ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="90174-120">That means the database might generate different values from the ones ADO.NET generates.</span></span>  
  
 <span data-ttu-id="90174-121">Bevor die anstehenden Einfügungen an die Datenbank gesendet werden, zeigt das Beispiel den Inhalt der Zeilen an.</span><span class="sxs-lookup"><span data-stu-id="90174-121">Before submitting the pending inserts to the database, the example displays the contents of the rows.</span></span> <span data-ttu-id="90174-122">Der Code erstellt dann ein neues <xref:System.Data.OracleClient.OracleDataAdapter>-Objekt und richtet dessen Eigenschaften <xref:System.Data.OracleClient.OracleDataAdapter.InsertCommand%2A> und <xref:System.Data.OracleClient.OracleDataAdapter.UpdateBatchSize%2A> ein.</span><span class="sxs-lookup"><span data-stu-id="90174-122">Then, the code creates a new <xref:System.Data.OracleClient.OracleDataAdapter> object and sets its <xref:System.Data.OracleClient.OracleDataAdapter.InsertCommand%2A> and the <xref:System.Data.OracleClient.OracleDataAdapter.UpdateBatchSize%2A> properties.</span></span> <span data-ttu-id="90174-123">Im Beispiel wird auch die Logik angegeben, mit der die vom Server generierten Werte unter Verwendung von Ausgabeparametern zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="90174-123">The example also supplies the logic to return the server-generated values by using output parameters.</span></span> <span data-ttu-id="90174-124">Anschließend wird das Update ausgeführt, indem die anstehenden Zeilen gesendet werden, und es wird der Inhalt der <xref:System.Data.DataTable> angezeigt.</span><span class="sxs-lookup"><span data-stu-id="90174-124">Then, the example executes the update to submit the pending rows and displays the contents of the <xref:System.Data.DataTable>.</span></span>  
  
```csharp  
public void OracleSequence(String connectionString)  
{  
   String insertString =
      "INSERT INTO SequenceTest_Table (ID, OtherColumn)" +  
      "VALUES (SequenceTest_Sequence.NEXTVAL, :OtherColumn)" +  
      "RETURNING ID INTO :ID";  
  
   using (OracleConnection conn = new OracleConnection(connectionString))  
   {  
      //Open a connection.  
      conn.Open();  
      OracleCommand cmd = conn.CreateCommand();  
  
      // Prepare the database.  
      cmd.CommandText = "DROP SEQUENCE SequenceTest_Sequence";  
      try { cmd.ExecuteNonQuery(); } catch { }  
  
      cmd.CommandText = "DROP TABLE SequenceTest_Table";  
      try { cmd.ExecuteNonQuery(); } catch { }  
  
      cmd.CommandText = "CREATE TABLE SequenceTest_Table " +  
                     "(ID int PRIMARY KEY, OtherColumn varchar(255))";  
      cmd.ExecuteNonQuery();  
  
      cmd.CommandText = "CREATE SEQUENCE SequenceTest_Sequence " +  
                        "START WITH 100 INCREMENT BY 5";  
      cmd.ExecuteNonQuery();  
  
      DataTable testTable = new DataTable();  
      DataColumn column = testTable.Columns.Add("ID", typeof(int));  
      column.AutoIncrement = true;  
      column.AutoIncrementSeed = -1;  
      column.AutoIncrementStep = -1;  
      testTable.PrimaryKey = new DataColumn[] { column };  
      testTable.Columns.Add("OtherColumn", typeof(string));  
      for (int rowCounter = 1; rowCounter <= 15; rowCounter++)  
      {  
         testTable.Rows.Add(null, "Row #" + rowCounter.ToString());  
      }  
  
      Console.WriteLine("Before Update => ");  
      foreach (DataRow row in testTable.Rows)  
      {  
         Console.WriteLine("   {0} - {1}", row["ID"], row["OtherColumn"]);  
      }  
      Console.WriteLine();  
  
      cmd.CommandText =
        "SELECT ID, OtherColumn FROM SequenceTest_Table";  
      OracleDataAdapter da = new OracleDataAdapter(cmd);  
      da.InsertCommand = new OracleCommand(insertString, conn);  
      da.InsertCommand.Parameters.Add(":ID", OracleType.Int32, 0, "ID");  
      da.InsertCommand.Parameters[0].Direction = ParameterDirection.Output;  
      da.InsertCommand.Parameters.Add(":OtherColumn", OracleType.VarChar, 255, "OtherColumn");  
      da.InsertCommand.UpdatedRowSource = UpdateRowSource.OutputParameters;  
      da.UpdateBatchSize = 10;  
  
      da.Update(testTable);  
  
      Console.WriteLine("After Update => ");  
      foreach (DataRow row in testTable.Rows)  
      {  
         Console.WriteLine("   {0} - {1}", row["ID"], row["OtherColumn"]);  
      }  
      // Close the connection.  
      conn.Close();  
   }  
}  
```  
  
## <a name="see-also"></a><span data-ttu-id="90174-125">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="90174-125">See also</span></span>

- [<span data-ttu-id="90174-126">Oracle und ADO.NET</span><span class="sxs-lookup"><span data-stu-id="90174-126">Oracle and ADO.NET</span></span>](oracle-and-adonet.md)
- [<span data-ttu-id="90174-127">Übersicht über ADO.NET</span><span class="sxs-lookup"><span data-stu-id="90174-127">ADO.NET Overview</span></span>](ado-net-overview.md)
