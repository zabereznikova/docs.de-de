---
title: Abrufen einer "DbProviderFactory"
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: a16e4a4d-6a5b-45db-8635-19570e4572ae
ms.openlocfilehash: 0e2efd593019199ff641610b8602825cc60d4661
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/12/2020
ms.locfileid: "79149465"
---
# <a name="obtaining-a-dbproviderfactory"></a><span data-ttu-id="81bd8-102">Abrufen einer "DbProviderFactory"</span><span class="sxs-lookup"><span data-stu-id="81bd8-102">Obtaining a DbProviderFactory</span></span>
<span data-ttu-id="81bd8-103">Der Prozess des Abrufens einer <xref:System.Data.Common.DbProviderFactory> beinhaltet die Übergabe von Informationen zu einem Datenanbieter an die <xref:System.Data.Common.DbProviderFactories>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="81bd8-103">The process of obtaining a <xref:System.Data.Common.DbProviderFactory> involves passing information about a data provider to the <xref:System.Data.Common.DbProviderFactories> class.</span></span> <span data-ttu-id="81bd8-104">Auf der Grundlage dieser Informationen erstellt die <xref:System.Data.Common.DbProviderFactories.GetFactory%2A>-Methode eine stark typisierte Anbieterfactory.</span><span class="sxs-lookup"><span data-stu-id="81bd8-104">Based on this information, the <xref:System.Data.Common.DbProviderFactories.GetFactory%2A> method creates a strongly typed provider factory.</span></span> <span data-ttu-id="81bd8-105">So können Sie z. B. zum Erstellen einer <xref:System.Data.SqlClient.SqlClientFactory>`GetFactory` eine Zeichenfolge übergeben, in der als Anbietername "System.Data.SqlClient" angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="81bd8-105">For example, to create a <xref:System.Data.SqlClient.SqlClientFactory>, you can pass `GetFactory` a string with the provider name specified as "System.Data.SqlClient".</span></span> <span data-ttu-id="81bd8-106">Die andere Überladung von `GetFactory` verwendet eine <xref:System.Data.DataRow>.</span><span class="sxs-lookup"><span data-stu-id="81bd8-106">The other overload of `GetFactory` takes a <xref:System.Data.DataRow>.</span></span> <span data-ttu-id="81bd8-107">Nach dem Erstellen der Anbieterfactory können Sie deren Methoden zum Erstellen zusätzlicher Objekte verwenden.</span><span class="sxs-lookup"><span data-stu-id="81bd8-107">Once you create the provider factory, you can then use its methods to create additional objects.</span></span> <span data-ttu-id="81bd8-108">Zu den Methoden einer `SqlClientFactory` gehören u. a. <xref:System.Data.SqlClient.SqlClientFactory.CreateConnection%2A>, <xref:System.Data.SqlClient.SqlClientFactory.CreateCommand%2A> und <xref:System.Data.SqlClient.SqlClientFactory.CreateDataAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="81bd8-108">Some of the methods of a `SqlClientFactory` include <xref:System.Data.SqlClient.SqlClientFactory.CreateConnection%2A>, <xref:System.Data.SqlClient.SqlClientFactory.CreateCommand%2A>, and <xref:System.Data.SqlClient.SqlClientFactory.CreateDataAdapter%2A>.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="81bd8-109">Die .NET Framework-Klassen <xref:System.Data.OracleClient.OracleClientFactory>, <xref:System.Data.Odbc.OdbcFactory> und <xref:System.Data.OleDb.OleDbFactory> bieten die gleiche Funktionalität.</span><span class="sxs-lookup"><span data-stu-id="81bd8-109">The .NET Framework <xref:System.Data.OracleClient.OracleClientFactory>, <xref:System.Data.Odbc.OdbcFactory>, and <xref:System.Data.OleDb.OleDbFactory> classes also provide similar functionality.</span></span>  
  
## <a name="registering-dbproviderfactories"></a><span data-ttu-id="81bd8-110">Registrieren von "DbProviderFactories"</span><span class="sxs-lookup"><span data-stu-id="81bd8-110">Registering DbProviderFactories</span></span>  
 <span data-ttu-id="81bd8-111">Jeder .NET Framework-Datenanbieter, der eine werksbasierte Klasse unterstützt, registriert Konfigurationsinformationen im Abschnitt **DbProviderFactories** der **Datei machine.config** auf dem lokalen Computer.</span><span class="sxs-lookup"><span data-stu-id="81bd8-111">Each .NET Framework data provider that supports a factory-based class registers configuration information in the **DbProviderFactories** section of the **machine.config** file on the local computer.</span></span> <span data-ttu-id="81bd8-112">Das folgende Konfigurationsdateifragment zeigt die Syntax und das Format für <xref:System.Data.SqlClient>.</span><span class="sxs-lookup"><span data-stu-id="81bd8-112">The following configuration file fragment shows the syntax and format for <xref:System.Data.SqlClient>.</span></span>  
  
```xml  
<system.data>  
  <DbProviderFactories>  
    <add name="SqlClient Data Provider"  
     invariant="System.Data.SqlClient"
     description=".Net Framework Data Provider for SqlServer"
     type="System.Data.SqlClient.SqlClientFactory, System.Data,
     Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"  
    />  
  </DbProviderFactories>  
</system.data>  
```  
  
 <span data-ttu-id="81bd8-113">Das **invariante** Attribut identifiziert den zugrunde liegenden Datenanbieter.</span><span class="sxs-lookup"><span data-stu-id="81bd8-113">The **invariant** attribute identifies the underlying data provider.</span></span> <span data-ttu-id="81bd8-114">Diese dreiteilige Benennungssyntax wird auch zum Erstellen einer neuen Factory und zum Identifizieren des Anbieters in einer Anwendungskonfigurationsdatei verwendet, sodass der Anbietername und die damit verknüpfte Verbindungszeichenfolge zur Laufzeit abgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="81bd8-114">This three-part naming syntax is also used when creating a new factory and for identifying the provider in an application configuration file so that the provider name, along with its associated connection string, can be retrieved at run time.</span></span>  
  
## <a name="retrieving-provider-information"></a><span data-ttu-id="81bd8-115">Abrufen von Anbieterinformationen</span><span class="sxs-lookup"><span data-stu-id="81bd8-115">Retrieving Provider Information</span></span>  
 <span data-ttu-id="81bd8-116">Zum Abrufen von Informationen zu allen auf dem lokalen Computer installierten Datenanbietern können Sie die <xref:System.Data.Common.DbProviderFactories.GetFactoryClasses%2A>-Methode verwenden.</span><span class="sxs-lookup"><span data-stu-id="81bd8-116">You can retrieve information about all of the data providers installed on the local computer by using the <xref:System.Data.Common.DbProviderFactories.GetFactoryClasses%2A> method.</span></span> <span data-ttu-id="81bd8-117">Es gibt <xref:System.Data.DataTable> einen benannten **DbProviderFactories** zurück, der die in der folgenden Tabelle beschriebenen Spalten enthält.</span><span class="sxs-lookup"><span data-stu-id="81bd8-117">It returns a <xref:System.Data.DataTable> named **DbProviderFactories** that contains the columns described in the following table.</span></span>  
  
|<span data-ttu-id="81bd8-118">Spaltenordinalzahl</span><span class="sxs-lookup"><span data-stu-id="81bd8-118">Column ordinal</span></span>|<span data-ttu-id="81bd8-119">Spaltenname</span><span class="sxs-lookup"><span data-stu-id="81bd8-119">Column name</span></span>|<span data-ttu-id="81bd8-120">Beispielausgabe</span><span class="sxs-lookup"><span data-stu-id="81bd8-120">Example output</span></span>|<span data-ttu-id="81bd8-121">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="81bd8-121">Description</span></span>|  
|--------------------|-----------------|--------------------|-----------------|  
|<span data-ttu-id="81bd8-122">0</span><span class="sxs-lookup"><span data-stu-id="81bd8-122">0</span></span>|<span data-ttu-id="81bd8-123">**Name**</span><span class="sxs-lookup"><span data-stu-id="81bd8-123">**Name**</span></span>|<span data-ttu-id="81bd8-124">SqlClient Data Provider</span><span class="sxs-lookup"><span data-stu-id="81bd8-124">SqlClient Data Provider</span></span>|<span data-ttu-id="81bd8-125">Lesbarer Name des Datenanbieters</span><span class="sxs-lookup"><span data-stu-id="81bd8-125">Readable name for the data provider</span></span>|  
|<span data-ttu-id="81bd8-126">1</span><span class="sxs-lookup"><span data-stu-id="81bd8-126">1</span></span>|<span data-ttu-id="81bd8-127">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="81bd8-127">**Description**</span></span>|<span data-ttu-id="81bd8-128">.Net Framework Data Provider for SqlServer</span><span class="sxs-lookup"><span data-stu-id="81bd8-128">.Net Framework Data Provider for SqlServer</span></span>|<span data-ttu-id="81bd8-129">Lesbare Beschreibung des Datenanbieters</span><span class="sxs-lookup"><span data-stu-id="81bd8-129">Readable description of the data provider</span></span>|  
|<span data-ttu-id="81bd8-130">2</span><span class="sxs-lookup"><span data-stu-id="81bd8-130">2</span></span>|<span data-ttu-id="81bd8-131">**InvariantName**</span><span class="sxs-lookup"><span data-stu-id="81bd8-131">**InvariantName**</span></span>|<span data-ttu-id="81bd8-132">System.Data.SqlClient</span><span class="sxs-lookup"><span data-stu-id="81bd8-132">System.Data.SqlClient</span></span>|<span data-ttu-id="81bd8-133">Name, der für programmgesteuerte Verweise auf den Datenanbieter verwendet werden können</span><span class="sxs-lookup"><span data-stu-id="81bd8-133">Name that can be used programmatically to refer to the data provider</span></span>|  
|<span data-ttu-id="81bd8-134">3</span><span class="sxs-lookup"><span data-stu-id="81bd8-134">3</span></span>|<span data-ttu-id="81bd8-135">**Assemblyqualifiedname**</span><span class="sxs-lookup"><span data-stu-id="81bd8-135">**AssemblyQualifiedName**</span></span>|<span data-ttu-id="81bd8-136">System.Data.SqlClient.SqlClientFactory, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</span><span class="sxs-lookup"><span data-stu-id="81bd8-136">System.Data.SqlClient.SqlClientFactory, System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</span></span>|<span data-ttu-id="81bd8-137">Voll qualifizierter Name der Factoryklasse, die genügend Informationen zum Instanziieren des Objekts enthält</span><span class="sxs-lookup"><span data-stu-id="81bd8-137">Fully qualified name of the factory class, which contains enough information to instantiate the object</span></span>|  
  
 <span data-ttu-id="81bd8-138">Diese `DataTable` kann verwendet werden, um den Benutzer in die Lage zu versetzen, zur Laufzeit eine <xref:System.Data.DataRow> auszuwählen.</span><span class="sxs-lookup"><span data-stu-id="81bd8-138">This `DataTable` can be used to enable a user to select a <xref:System.Data.DataRow> at run time.</span></span> <span data-ttu-id="81bd8-139">Die ausgewählte `DataRow` kann dann an die <xref:System.Data.Common.DbProviderFactories.GetFactory%2A>-Methode übergeben werden, um eine stark typisierte <xref:System.Data.Common.DbProviderFactory> zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="81bd8-139">The selected `DataRow` can then be passed to the <xref:System.Data.Common.DbProviderFactories.GetFactory%2A> method to create a strongly typed <xref:System.Data.Common.DbProviderFactory>.</span></span> <span data-ttu-id="81bd8-140">Eine ausgewählte <xref:System.Data.DataRow> kann an die `GetFactory`-Methode übergeben werden, um das gewünschte `DbProviderFactory`-Objekt zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="81bd8-140">A selected <xref:System.Data.DataRow> can be passed to the `GetFactory` method to create the desired `DbProviderFactory` object.</span></span>  
  
## <a name="listing-the-installed-provider-factory-classes"></a><span data-ttu-id="81bd8-141">Auflisten der installierten Anbieterfactoryklassen</span><span class="sxs-lookup"><span data-stu-id="81bd8-141">Listing the Installed Provider Factory Classes</span></span>  
 <span data-ttu-id="81bd8-142">Dieses Beispiel zeigt, wie Sie mit der <xref:System.Data.Common.DbProviderFactories.GetFactoryClasses%2A>-Methode eine <xref:System.Data.DataTable> mit Informationen zu den installierten Anbietern zurückgeben können.</span><span class="sxs-lookup"><span data-stu-id="81bd8-142">This example demonstrates how to use the <xref:System.Data.Common.DbProviderFactories.GetFactoryClasses%2A> method to return a <xref:System.Data.DataTable> containing information about the installed providers.</span></span> <span data-ttu-id="81bd8-143">Der Code durchläuft jede Zeile in der `DataTable` und zeigt im Konsolenfenster die Informationen zu den einzelnen installierten Anbietern an.</span><span class="sxs-lookup"><span data-stu-id="81bd8-143">The code iterates through each row in the `DataTable`, displaying information for each installed provider in the console window.</span></span>  
  
 [!code-csharp[DataWorks DbProviderFactories#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DbProviderFactories/CS/source.cs#1)]
 [!code-vb[DataWorks DbProviderFactories#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DbProviderFactories/VB/source.vb#1)]  
  
## <a name="using-application-configuration-files-to-store-factory-information"></a><span data-ttu-id="81bd8-144">Verwenden von Anwendungskonfigurationsdateien zum Speichern von Factoryinformationen</span><span class="sxs-lookup"><span data-stu-id="81bd8-144">Using Application Configuration Files to Store Factory Information</span></span>  
 <span data-ttu-id="81bd8-145">Das Entwurfsmuster, das für die Arbeit mit Fabriken verwendet wird, umfasst das Speichern von Anbieter- und Verbindungszeichenfolgeninformationen in einer Anwendungskonfigurationsdatei, z. **B. app.config** für eine Windows-Anwendung und **web.config** für eine ASP.NET Anwendung.</span><span class="sxs-lookup"><span data-stu-id="81bd8-145">The design pattern used for working with factories entails storing provider and connection string information in an application configuration file, such as **app.config** for a Windows application, and **web.config** for an ASP.NET application.</span></span>  
  
 <span data-ttu-id="81bd8-146">Das folgende Konfigurationsdateifragment zeigt, wie zwei benannte Verbindungszeichenfolgen, &lt;legacyBold&gt;NorthwindSQL&lt;/legacyBold&gt; für eine Verbindung mit der &lt;legacyBold&gt;Northwind&lt;/legacyBold&gt;-Datenbank in SQL Server und &lt;legacyBold&gt;NorthwindAccess&lt;/legacyBold&gt; für eine Verbindung mit der &lt;legacyBold&gt;Northwind&lt;/legacyBold&gt;-Datenbank in Access/Jet, gespeichert werden können.</span><span class="sxs-lookup"><span data-stu-id="81bd8-146">The following configuration file fragment demonstrates how to save two named connection strings, "NorthwindSQL" for a connection to the Northwind database in SQL Server, and "NorthwindAccess" for a connection to the Northwind database in Access/Jet.</span></span> <span data-ttu-id="81bd8-147">Der **invariante** Name wird für das **providerName-Attribut** verwendet.</span><span class="sxs-lookup"><span data-stu-id="81bd8-147">The **invariant** name is used for the **providerName** attribute.</span></span>  
  
```xml  
<configuration>  
  <connectionStrings>  
    <clear/>  
    <add name="NorthwindSQL"
     providerName="System.Data.SqlClient"
     connectionString=  
     "Data Source=MSSQL1;Initial Catalog=Northwind;Integrated Security=true"  
    />  
  
    <add name="NorthwindAccess"
     providerName="System.Data.OleDb"
     connectionString=  
     "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\Data\Northwind.mdb;"  
    />  
  </connectionStrings>  
</configuration>  
```  
  
### <a name="retrieving-a-connection-string-by-provider-name"></a><span data-ttu-id="81bd8-148">Abrufen einer Verbindungszeichenfolge nach Anbietername</span><span class="sxs-lookup"><span data-stu-id="81bd8-148">Retrieving a Connection String by Provider Name</span></span>  
 <span data-ttu-id="81bd8-149">Zum Erstellen einer Anbieterfactory müssen Sie sowohl eine Verbindungszeichenfolge als auch den Anbieternamen bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="81bd8-149">In order to create a provider factory, you must supply a connection string as well as the provider name.</span></span> <span data-ttu-id="81bd8-150">In diesem Beispiel wird veranschaulicht, wie eine Verbindungszeichenfolge aus einer Anwendungskonfigurationsdatei abgerufen wird, indem der Anbietername im invarianten Format "*System.Data.ProviderName*" übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="81bd8-150">This example demonstrates how to retrieve a connection string from an application configuration file by passing the provider name in the invariant format "*System.Data.ProviderName*".</span></span> <span data-ttu-id="81bd8-151">Der Code durchläuft die <xref:System.Configuration.ConnectionStringSettingsCollection>.</span><span class="sxs-lookup"><span data-stu-id="81bd8-151">The code iterates through the <xref:System.Configuration.ConnectionStringSettingsCollection>.</span></span> <span data-ttu-id="81bd8-152">Im Erfolgsfall gibt er den <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A> zurück, anderenfalls `null` (`Nothing` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="81bd8-152">It returns the <xref:System.Configuration.ConnectionStringSettings.ProviderName%2A> on success; otherwise `null` (`Nothing` in Visual Basic).</span></span> <span data-ttu-id="81bd8-153">Wenn es für einen Anbieter mehrere Einträge gibt, wird der erste gefundene Eintrag zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="81bd8-153">If there are multiple entries for a provider, the first one found is returned.</span></span> <span data-ttu-id="81bd8-154">Weitere Informationen und Beispiele zum Abrufen von Verbindungszeichenfolgen aus Konfigurationsdateien finden Sie unter [Verbindungszeichenfolgen und Konfigurationsdateien](connection-strings-and-configuration-files.md).</span><span class="sxs-lookup"><span data-stu-id="81bd8-154">For more information and examples of retrieving connection strings from configuration files, see [Connection Strings and Configuration Files](connection-strings-and-configuration-files.md).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="81bd8-155">Zum Ausführen des Codes ist ein Verweis auf `System.Configuration.dll` erforderlich.</span><span class="sxs-lookup"><span data-stu-id="81bd8-155">A reference to `System.Configuration.dll` is required in order for the code to run.</span></span>  
  
 [!code-csharp[DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/CS/source.cs#1)]
 [!code-vb[DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks ConnectionStringSettings.RetrieveFromConfigByProvider/VB/source.vb#1)]  
  
## <a name="creating-the-dbproviderfactory-and-dbconnection"></a><span data-ttu-id="81bd8-156">Erstellen der "DbProviderFactory" und der "DbConnection"</span><span class="sxs-lookup"><span data-stu-id="81bd8-156">Creating the DbProviderFactory and DbConnection</span></span>  
 <span data-ttu-id="81bd8-157">In diesem Beispiel wird <xref:System.Data.Common.DbProviderFactory> <xref:System.Data.Common.DbConnection> veranschaulicht, wie ein und ein Objekt erstellt werden, indem der Anbietername im Format "*System.Data.ProviderName*" und eine Verbindungszeichenfolge übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="81bd8-157">This example demonstrates how to create a <xref:System.Data.Common.DbProviderFactory> and <xref:System.Data.Common.DbConnection> object by passing it the provider name in the format "*System.Data.ProviderName*" and a connection string.</span></span> <span data-ttu-id="81bd8-158">Im Erfolgsfall wird ein `DbConnection`-Objekt zurückgegeben, anderenfalls `null` (`Nothing` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="81bd8-158">A `DbConnection` object is returned on success; `null` (`Nothing` in Visual Basic) on any error.</span></span>  
  
 <span data-ttu-id="81bd8-159">Der Code ruft die `DbProviderFactory` ab, indem er <xref:System.Data.Common.DbProviderFactories.GetFactory%2A> aufruft.</span><span class="sxs-lookup"><span data-stu-id="81bd8-159">The code obtains the `DbProviderFactory` by calling <xref:System.Data.Common.DbProviderFactories.GetFactory%2A>.</span></span> <span data-ttu-id="81bd8-160">Dann erstellt die <xref:System.Data.Common.DbProviderFactory.CreateConnection%2A>-Methode das <xref:System.Data.Common.DbConnection>-Objekt, und die <xref:System.Data.Common.DbConnection.ConnectionString%2A>-Eigenschaft wird auf die Verbindungszeichenfolge festgelegt.</span><span class="sxs-lookup"><span data-stu-id="81bd8-160">Then the <xref:System.Data.Common.DbProviderFactory.CreateConnection%2A> method creates the <xref:System.Data.Common.DbConnection> object and the <xref:System.Data.Common.DbConnection.ConnectionString%2A> property is set to the connection string.</span></span>  
  
 [!code-csharp[DataWorks DbProviderFactories.GetFactory#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DbProviderFactories.GetFactory/CS/source.cs#1)]
 [!code-vb[DataWorks DbProviderFactories.GetFactory#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DbProviderFactories.GetFactory/VB/source.vb#1)]  
  
## <a name="see-also"></a><span data-ttu-id="81bd8-161">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="81bd8-161">See also</span></span>

- [<span data-ttu-id="81bd8-162">DbProviderFactories</span><span class="sxs-lookup"><span data-stu-id="81bd8-162">DbProviderFactories</span></span>](dbproviderfactories.md)
- [<span data-ttu-id="81bd8-163">Verbindungszeichenfolgen</span><span class="sxs-lookup"><span data-stu-id="81bd8-163">Connection Strings</span></span>](connection-strings.md)
- <span data-ttu-id="81bd8-164">[Verwenden der Konfigurationsklassen](https://docs.microsoft.com/previous-versions/aspnet/ms228063(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="81bd8-164">[Using the Configuration Classes](https://docs.microsoft.com/previous-versions/aspnet/ms228063(v=vs.100))</span></span>
- [<span data-ttu-id="81bd8-165">Übersicht über ADO.NET</span><span class="sxs-lookup"><span data-stu-id="81bd8-165">ADO.NET Overview</span></span>](ado-net-overview.md)
