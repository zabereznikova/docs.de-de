---
title: Dienstvorgänge (WCF Data Services)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- service operations [WCF Data Services]
- WCF Data Services, service operations
ms.assetid: 583a690a-e60f-4990-8991-d6efce069d76
ms.openlocfilehash: c254a7362c7bc28f4b38fc0189ae0ea763bc90cc
ms.sourcegitcommit: 79a2d6a07ba4ed08979819666a0ee6927bbf1b01
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/28/2019
ms.locfileid: "74568849"
---
# <a name="service-operations-wcf-data-services"></a><span data-ttu-id="738b3-102">Dienstvorgänge (WCF Data Services)</span><span class="sxs-lookup"><span data-stu-id="738b3-102">Service Operations (WCF Data Services)</span></span>

<span data-ttu-id="738b3-103">WCF Data Services ermöglicht es Ihnen, Dienst Vorgänge für einen Datendienst zu definieren, um Methoden auf dem Server verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="738b3-103">WCF Data Services enables you to define service operations on a data service to expose methods on the server.</span></span> <span data-ttu-id="738b3-104">Wie andere Datendienstressourcen werden Dienstvorgänge durch URIs adressiert.</span><span class="sxs-lookup"><span data-stu-id="738b3-104">Like other data service resources, service operations are addressed by URIs.</span></span> <span data-ttu-id="738b3-105">Dienstvorgänge ermöglichen es Ihnen, die Geschäftslogik in einem Datendienst verfügbar zu machen, z. B. um Validierungslogik zu implementieren, rollenbasierte Sicherheit anzuwenden oder spezielle Abfragefunktionen verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="738b3-105">Service operations enable you to expose business logic in a data service, such as to implement validation logic, to apply role-based security, or to expose specialized querying capabilities.</span></span> <span data-ttu-id="738b3-106">Dienstvorgänge sind der von <xref:System.Data.Services.DataService%601> abgeleiteten Datendienstklasse hinzugefügte Methoden.</span><span class="sxs-lookup"><span data-stu-id="738b3-106">Service operations are methods added to the data service class that derives from <xref:System.Data.Services.DataService%601>.</span></span> <span data-ttu-id="738b3-107">Wie allen anderen Datendienstressourcen können der Dienstvorgangsmethode Parameter übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="738b3-107">Like all other data service resources, you can supply parameters to the service operation method.</span></span> <span data-ttu-id="738b3-108">Beispielsweise übergibt der folgende Dienst Vorgangs-URI (basierend auf dem [Schnellstart](quickstart-wcf-data-services.md) -Datendienst) den Wert `London` an den `city`-Parameter:</span><span class="sxs-lookup"><span data-stu-id="738b3-108">For example, the following service operation URI (based on the [quickstart](quickstart-wcf-data-services.md) data service) passes the value `London` to the `city` parameter:</span></span>

```http
http://localhost:12345/Northwind.svc/GetOrdersByCity?city='London'
```

<span data-ttu-id="738b3-109">Die Definition für diesen Dienstvorgang lautet wie folgt:</span><span class="sxs-lookup"><span data-stu-id="738b3-109">The definition for this service operation is as follows:</span></span>

[!code-csharp[Astoria Northwind Service#ServiceOperationDef](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_service/cs/northwind2.svc.cs#serviceoperationdef)]
[!code-vb[Astoria Northwind Service#ServiceOperationDef](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_service/vb/northwind2.svc.vb#serviceoperationdef)]

<span data-ttu-id="738b3-110">Sie können mit der <xref:System.Data.Services.DataService%601.CurrentDataSource%2A> des <xref:System.Data.Services.DataService%601> direkt auf die Datenquelle zugreifen, die der Datendienst verwendet.</span><span class="sxs-lookup"><span data-stu-id="738b3-110">You can use the <xref:System.Data.Services.DataService%601.CurrentDataSource%2A> of the <xref:System.Data.Services.DataService%601> to directly access the data source that the data service is using.</span></span> <span data-ttu-id="738b3-111">Weitere Informationen finden Sie unter Gewusst [wie: Definieren eines Dienst Vorgangs](how-to-define-a-service-operation-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="738b3-111">For more information, see [How to: Define a Service Operation](how-to-define-a-service-operation-wcf-data-services.md).</span></span>

<span data-ttu-id="738b3-112">Informationen zum Aufrufen eines Dienst Vorgangs aus einer .NET Framework Client Anwendung finden Sie unter Aufrufen von [Dienst Vorgängen](calling-service-operations-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="738b3-112">For information on how to call a service operation from a .NET Framework client application, see [Calling Service Operations](calling-service-operations-wcf-data-services.md).</span></span>

## <a name="service-operation-requirements"></a><span data-ttu-id="738b3-113">Anforderungen für Dienstvorgänge</span><span class="sxs-lookup"><span data-stu-id="738b3-113">Service Operation Requirements</span></span>

<span data-ttu-id="738b3-114">Beim Definieren von Dienstvorgängen für den Datendienst gelten folgende Anforderungen.</span><span class="sxs-lookup"><span data-stu-id="738b3-114">The following requirements apply when defining service operations on the data service.</span></span> <span data-ttu-id="738b3-115">Wenn eine Methode diese Anforderungen nicht erfüllt, wird sie nicht als Dienstvorgang für den Datendienst verfügbar gemacht.</span><span class="sxs-lookup"><span data-stu-id="738b3-115">If a method does not meet these requirements, it will not be exposed as a service operation for the data service.</span></span>

- <span data-ttu-id="738b3-116">Der Vorgang muss eine öffentliche Instanzmethode sein, die ein Member der Datendienstklasse ist.</span><span class="sxs-lookup"><span data-stu-id="738b3-116">The operation must be a public instance method that is a member of the data service class.</span></span>

- <span data-ttu-id="738b3-117">Die Vorgangsmethode akzeptiert möglicherweise nur Eingabeparameter.</span><span class="sxs-lookup"><span data-stu-id="738b3-117">The operation method may only accept input parameters.</span></span> <span data-ttu-id="738b3-118">Auf im Nachrichtentext gesendete Daten kann der Datendienst nicht zugreifen.</span><span class="sxs-lookup"><span data-stu-id="738b3-118">Data sent in the message body cannot be accessed by the data service.</span></span>

- <span data-ttu-id="738b3-119">Wenn Parameter definiert wurden, muss der Typ eines jeden Parameters primitiv sein.</span><span class="sxs-lookup"><span data-stu-id="738b3-119">If parameters are defined, the type of each parameter must be a primitive type.</span></span> <span data-ttu-id="738b3-120">Alle Daten eines nicht primitiven Typs müssen serialisiert werden und an einen Zeichenfolgenparameter übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="738b3-120">Any data of a non-primitive type must be serialized and passed into a string parameter.</span></span>

- <span data-ttu-id="738b3-121">Die Methode muss einen der folgenden Werte zurückgeben:</span><span class="sxs-lookup"><span data-stu-id="738b3-121">The method must return one of the following:</span></span>

  - <span data-ttu-id="738b3-122">`void` (`Nothing` in Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="738b3-122">`void` (`Nothing` in Visual Basic)</span></span>

  - <xref:System.Collections.Generic.IEnumerable%601>

  - <xref:System.Linq.IQueryable%601>

  - <span data-ttu-id="738b3-123">Ein Entitätstyp im Datenmodell, das der Datendienst verfügbar macht.</span><span class="sxs-lookup"><span data-stu-id="738b3-123">An entity type in the data model that the data service exposes.</span></span>

  - <span data-ttu-id="738b3-124">Eine primitive Klasse wie eine ganze Zahl oder Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="738b3-124">A primitive class such as integer or string.</span></span>

- <span data-ttu-id="738b3-125">Um Abfrageoptionen wie Sortieren, Paging und Filtern zu unterstützen, sollten die Methoden der Dienstvorgänge <xref:System.Linq.IQueryable%601> zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="738b3-125">In order to support query options such as sorting, paging, and filtering, service operation methods should return <xref:System.Linq.IQueryable%601>.</span></span> <span data-ttu-id="738b3-126">Anforderungen an Dienstvorgänge, die Abfrageoptionen einschließen, werden für Vorgänge abgelehnt, die nur <xref:System.Collections.Generic.IEnumerable%601> zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="738b3-126">Requests to service operations that include query options are rejected for operations that only return <xref:System.Collections.Generic.IEnumerable%601>.</span></span>

- <span data-ttu-id="738b3-127">Um den Zugriff auf verknüpfte Entitäten mit Navigationseigenschaften zu unterstützen, muss der Dienstvorgang <xref:System.Linq.IQueryable%601> zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="738b3-127">In order to support accessing related entities by using navigation properties, the service operation must return <xref:System.Linq.IQueryable%601>.</span></span>

- <span data-ttu-id="738b3-128">Die Methode muss mit dem Attribut `[WebGet]` oder `[WebInvoke]` versehen sein.</span><span class="sxs-lookup"><span data-stu-id="738b3-128">The method must be annotated with the `[WebGet]` or `[WebInvoke]` attribute.</span></span>

  - <span data-ttu-id="738b3-129">`[WebGet]` aktiviert die aufgerufene Methode mit einer GET-Anforderung.</span><span class="sxs-lookup"><span data-stu-id="738b3-129">`[WebGet]` enables the method to be invoked by using a GET request.</span></span>

  - <span data-ttu-id="738b3-130">`[WebInvoke(Method = "POST")]` aktiviert die aufgerufene Methode mit einer POST-Anforderung.</span><span class="sxs-lookup"><span data-stu-id="738b3-130">`[WebInvoke(Method = "POST")]` enables the method to be invoked by using a POST request.</span></span> <span data-ttu-id="738b3-131">Andere <xref:System.ServiceModel.Web.WebInvokeAttribute>-Methoden werden nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="738b3-131">Other <xref:System.ServiceModel.Web.WebInvokeAttribute> methods are not supported.</span></span>

- <span data-ttu-id="738b3-132">Ein Dienstvorgang kann mit <xref:System.Data.Services.SingleResultAttribute> versehen sein, das festlegt, dass der Rückgabewert der Methode eine einzelne Entität und keine Auflistung von Entitäten ist.</span><span class="sxs-lookup"><span data-stu-id="738b3-132">A service operation may be annotated with the <xref:System.Data.Services.SingleResultAttribute> that specifies that the return value from the method is a single entity rather than a collection of entities.</span></span> <span data-ttu-id="738b3-133">Dieser Unterschied schreibt die resultierende Serialisierung der Antwort und die Weise vor, in der zusätzliche Navigationseigenschaftendurchläufe im URI dargestellt werden.</span><span class="sxs-lookup"><span data-stu-id="738b3-133">This distinction dictates the resulting serialization of the response and the manner in which additional navigation property traversals are represented in the URI.</span></span> <span data-ttu-id="738b3-134">Wenn zum Beispiel die AtomPub-Serialisierung verwendet wird, ist ein einzelner Ressourcentyp als Eingangselement dargestellt, und eine Gruppe von Instanzen als Feed-Element.</span><span class="sxs-lookup"><span data-stu-id="738b3-134">For example, when using AtomPub serialization, a single resource type instance is represented as an entry element and a set of instances as a feed element.</span></span>

## <a name="addressing-service-operations"></a><span data-ttu-id="738b3-135">Adressierung von Dienstvorgängen</span><span class="sxs-lookup"><span data-stu-id="738b3-135">Addressing Service Operations</span></span>

<span data-ttu-id="738b3-136">Sie können Dienstvorgänge adressieren, indem Sie den Namen der Methode im ersten Pfadsegment eines URI platzieren.</span><span class="sxs-lookup"><span data-stu-id="738b3-136">You can address service operations by placing the name of the method in the first path segment of a URI.</span></span> <span data-ttu-id="738b3-137">Als Beispiel greift der folgende URI auf einen `GetOrdersByState`-Vorgang zu, der eine <xref:System.Linq.IQueryable%601>-Auflistung von `Orders`-Objekten zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="738b3-137">As an example, the following URI accesses a `GetOrdersByState` operation that returns an <xref:System.Linq.IQueryable%601> collection of `Orders` objects.</span></span>

```http
http://localhost:12345/Northwind.svc/GetOrdersByState?state='CA'&includeItems=true
```

<span data-ttu-id="738b3-138">Wenn Sie einen Dienstvorgang aufrufen, werden Parameter als Abfrageoptionen angegeben.</span><span class="sxs-lookup"><span data-stu-id="738b3-138">When calling a service operation, parameters are supplied as query options.</span></span> <span data-ttu-id="738b3-139">Der vorherige Dienstvorgang akzeptiert sowohl einen Zeichenfolgenparameter `state` als auch einen booleschen Parameter `includeItems`, der angibt, ob zugehörige `Order_Detail`-Objekte in die Antwort einbezogen werden.</span><span class="sxs-lookup"><span data-stu-id="738b3-139">The previous service operation accepts both a string parameter `state` and a Boolean parameter `includeItems` that indicates whether to include related `Order_Detail` objects in the response.</span></span>

<span data-ttu-id="738b3-140">Nachfolgend sind gültige Rückgabetypen für einen Dienstvorgang aufgeführt:</span><span class="sxs-lookup"><span data-stu-id="738b3-140">The following are valid return types for a service operation:</span></span>

|<span data-ttu-id="738b3-141">Gültige Rückgabetypen</span><span class="sxs-lookup"><span data-stu-id="738b3-141">Valid Return Types</span></span>|<span data-ttu-id="738b3-142">URI-Regeln</span><span class="sxs-lookup"><span data-stu-id="738b3-142">URI Rules</span></span>|
|------------------------|---------------|
|<span data-ttu-id="738b3-143">`void` (`Nothing` in Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="738b3-143">`void` (`Nothing` in Visual Basic)</span></span><br /><br /> <span data-ttu-id="738b3-144">\- oder -</span><span class="sxs-lookup"><span data-stu-id="738b3-144">-or-</span></span><br /><br /> <span data-ttu-id="738b3-145">Entitätstypen</span><span class="sxs-lookup"><span data-stu-id="738b3-145">Entity types</span></span><br /><br /> <span data-ttu-id="738b3-146">\- oder -</span><span class="sxs-lookup"><span data-stu-id="738b3-146">-or-</span></span><br /><br /> <span data-ttu-id="738b3-147">Primitive Typen</span><span class="sxs-lookup"><span data-stu-id="738b3-147">Primitive types</span></span>|<span data-ttu-id="738b3-148">Der URI muss ein einzelnes Pfadsegment sein, das den Namen des Dienstvorgangs trägt.</span><span class="sxs-lookup"><span data-stu-id="738b3-148">The URI must be a single path segment that is the name of the service operation.</span></span> <span data-ttu-id="738b3-149">Abfrageoptionen sind nicht zulässig.</span><span class="sxs-lookup"><span data-stu-id="738b3-149">Query options are not allowed.</span></span>|
|<xref:System.Collections.Generic.IEnumerable%601>|<span data-ttu-id="738b3-150">Der URI muss ein einzelnes Pfadsegment sein, das den Namen des Dienstvorgangs trägt.</span><span class="sxs-lookup"><span data-stu-id="738b3-150">The URI must be a single path segment that is the name of the service operation.</span></span> <span data-ttu-id="738b3-151">Da der Ergebnistyp kein <xref:System.Linq.IQueryable%601>-Typ ist, sind keine Abfrageoptionen zulässig.</span><span class="sxs-lookup"><span data-stu-id="738b3-151">Because the result type is not an <xref:System.Linq.IQueryable%601> type, query options are not allowed.</span></span>|
|<xref:System.Linq.IQueryable%601>|<span data-ttu-id="738b3-152">Abfragepfadsegmente zusätzlich zum Pfad, der der Name des Dienstvorgangs ist, sind zulässig.</span><span class="sxs-lookup"><span data-stu-id="738b3-152">Query path segments in addition to the path that is the name of the service operation are allowed.</span></span> <span data-ttu-id="738b3-153">Abfrageoptionen sind ebenfalls zulässig.</span><span class="sxs-lookup"><span data-stu-id="738b3-153">Query options are also allowed.</span></span>|

<span data-ttu-id="738b3-154">In Abhängigkeit vom Rückgabetyp des Dienstvorgangs können dem URI zusätzliche Pfadsegmente oder Abfrageoptionen hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="738b3-154">Additional path segments or query options may be added to the URI depending on the return type of the service operation.</span></span> <span data-ttu-id="738b3-155">Beispielsweise greift der folgende URI auf einen `GetOrdersByCity`-Vorgang zu, der eine <xref:System.Linq.IQueryable%601>-Auflistung von `Orders`-Objekten, sortiert nach `RequiredDate` in absteigender Reihenfolge, zusammen mit den verknüpften `Order_Details`-Objekten zurückgibt:</span><span class="sxs-lookup"><span data-stu-id="738b3-155">For example, the following URI accesses a `GetOrdersByCity` operation that returns an <xref:System.Linq.IQueryable%601> collection of `Orders` objects, ordered by `RequiredDate` in descending order, along with the related `Order_Details` objects:</span></span>

```http
http://localhost:12345/Northwind.svc/GetOrdersByCity?city='London'&$expand=Order_Details&$orderby=RequiredDate desc
```

## <a name="service-operations-access-control"></a><span data-ttu-id="738b3-156">Zugriffssteuerung für Dienstvorgänge</span><span class="sxs-lookup"><span data-stu-id="738b3-156">Service Operations Access Control</span></span>

<span data-ttu-id="738b3-157">Dienstweite Sichtbarkeit der Dienstvorgänge wird durch die <xref:System.Data.Services.IDataServiceConfiguration.SetServiceOperationAccessRule%2A>-Methode in der <xref:System.Data.Services.IDataServiceConfiguration>-Klasse gesteuert, und zwar auf ähnliche Weise, wie die Sichtbarkeit von Entitätenmengen durch die <xref:System.Data.Services.IDataServiceConfiguration.SetEntitySetAccessRule%2A>-Methode gesteuert wird.</span><span class="sxs-lookup"><span data-stu-id="738b3-157">Service-wide visibility of service operations is controlled by the <xref:System.Data.Services.IDataServiceConfiguration.SetServiceOperationAccessRule%2A> method on the <xref:System.Data.Services.IDataServiceConfiguration> class in much the same way that entity set visibility is controlled by using the <xref:System.Data.Services.IDataServiceConfiguration.SetEntitySetAccessRule%2A> method.</span></span> <span data-ttu-id="738b3-158">Die folgende Codezeile in der Datendienstdefinition ermöglicht z. B. den Zugriff auf den `CustomersByCity`-Dienstvorgang.</span><span class="sxs-lookup"><span data-stu-id="738b3-158">For example, the following line of code in the data service definition enables access to the `CustomersByCity` service operation.</span></span>

[!code-csharp[Astoria Northwind Service#ServiceOperationConfig](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_service/cs/northwind2.svc.cs#serviceoperationconfig)]
[!code-vb[Astoria Northwind Service#ServiceOperationConfig](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_service/vb/northwind2.svc.vb#serviceoperationconfig)]

> [!NOTE]
> <span data-ttu-id="738b3-159">Wenn ein Dienstvorgang einen Rückgabetyp aufweist, der durch das Beschränken des Zugriff auf die zugrunde liegenden Entitätenmengen ausgeblendet wurde, dann steht der Dienstvorgang Clientanwendungen nicht zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="738b3-159">If a service operation has a return type that has been hidden by restricting access on the underlying entity sets, then the service operation will not be available to client applications.</span></span>

<span data-ttu-id="738b3-160">Weitere Informationen finden Sie unter Gewusst [wie: Definieren eines Dienst Vorgangs](how-to-define-a-service-operation-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="738b3-160">For more information, see [How to: Define a Service Operation](how-to-define-a-service-operation-wcf-data-services.md).</span></span>

## <a name="raising-exceptions"></a><span data-ttu-id="738b3-161">Auslösen von Ausnahmen</span><span class="sxs-lookup"><span data-stu-id="738b3-161">Raising Exceptions</span></span>

<span data-ttu-id="738b3-162">Es empfiehlt sich, dass Sie die <xref:System.Data.Services.DataServiceException>-Klasse immer dann verwenden, wenn Sie eine Ausnahme in der Datendienstausführung auslösen.</span><span class="sxs-lookup"><span data-stu-id="738b3-162">We recommend that you use the <xref:System.Data.Services.DataServiceException> class whenever you raise an exception in the data service execution.</span></span> <span data-ttu-id="738b3-163">Das liegt daran, dass die Datendienstlaufzeit weiß, wie der HTTP-Antwortnachricht Eigenschaften dieses Ausnahmeobjekts ordnungsgemäß zugeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="738b3-163">This is because the data service runtime knows how to map properties of this exception object correctly to the HTTP response message.</span></span> <span data-ttu-id="738b3-164">Wenn Sie in einem Dienstvorgang eine <xref:System.Data.Services.DataServiceException> auslösen, wird die zurückgegebene Ausnahme in eine <xref:System.Reflection.TargetInvocationException> eingeschlossen.</span><span class="sxs-lookup"><span data-stu-id="738b3-164">When you raise a <xref:System.Data.Services.DataServiceException> in a service operation, the returned exception is wrapped in a <xref:System.Reflection.TargetInvocationException>.</span></span> <span data-ttu-id="738b3-165">Um die Basis-<xref:System.Data.Services.DataServiceException> ohne die einschließende <xref:System.Reflection.TargetInvocationException> zurückzugeben, müssen Sie die <xref:System.Data.Services.DataService%601.HandleException%2A>-Methode im <xref:System.Data.Services.DataService%601> überschreiben und die <xref:System.Data.Services.DataServiceException> aus der <xref:System.Reflection.TargetInvocationException> extrahieren und als Fehler der obersten Ebene zurückgeben, wie im folgenden Beispiel gezeigt:</span><span class="sxs-lookup"><span data-stu-id="738b3-165">To return the base <xref:System.Data.Services.DataServiceException> without the enclosing <xref:System.Reflection.TargetInvocationException>, you must override the <xref:System.Data.Services.DataService%601.HandleException%2A> method in the <xref:System.Data.Services.DataService%601>, extract the <xref:System.Data.Services.DataServiceException> from the <xref:System.Reflection.TargetInvocationException>, and return it as the top-level error, as in the following example:</span></span>

[!code-csharp[Astoria Northwind Service#HandleExceptions](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_service/cs/northwind2.svc.cs#handleexceptions)]
[!code-vb[Astoria Northwind Service#HandleExceptions](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_service/vb/northwind2.svc.vb#handleexceptions)]

## <a name="see-also"></a><span data-ttu-id="738b3-166">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="738b3-166">See also</span></span>

- [<span data-ttu-id="738b3-167">Interceptors</span><span class="sxs-lookup"><span data-stu-id="738b3-167">Interceptors</span></span>](interceptors-wcf-data-services.md)
