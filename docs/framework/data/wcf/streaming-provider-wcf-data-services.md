---
title: Streaminganbieter (WCF Data Services)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, providers
- WCF Data Services, binary data
- streaming data provider [WCF Data Services]
- WCF Data Services, streams
ms.assetid: f0978fe4-5f9f-42aa-a5c2-df395d7c9495
ms.openlocfilehash: 83f28c50c53281692e1c3c6d55cc55e8d9304ad9
ms.sourcegitcommit: ed3f926b6cdd372037bbcc214dc8f08a70366390
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/16/2020
ms.locfileid: "76116603"
---
# <a name="streaming-provider-wcf-data-services"></a><span data-ttu-id="dd81a-102">Streaminganbieter (WCF Data Services)</span><span class="sxs-lookup"><span data-stu-id="dd81a-102">Streaming Provider (WCF Data Services)</span></span>

<span data-ttu-id="dd81a-103">Ein Datendienst kann große BLOB-Daten (Binary Large Object) verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="dd81a-103">A data service can expose large object binary data.</span></span> <span data-ttu-id="dd81a-104">Diese Binärdaten können Video- und Audiostreams, Bilder, Dokumentdateien oder andere Typen binärer Medien darstellen.</span><span class="sxs-lookup"><span data-stu-id="dd81a-104">This binary data might represent video and audio streams, images, document files, or other types of binary media.</span></span> <span data-ttu-id="dd81a-105">Wenn eine Entität im Datenmodell eine oder mehrere binäre Eigenschaften enthält, gibt der Datendienst diese als Base-64-codierte Binärdaten im Eintrag im Antwortfeed zurück.</span><span class="sxs-lookup"><span data-stu-id="dd81a-105">When an entity in the data model includes one or more binary properties, the data service returns this binary data encoded as base-64 inside the entry in the response feed.</span></span> <span data-ttu-id="dd81a-106">Da das Laden und das Serialisieren von umfangreichen Binärdaten auf diese Weise die Leistung beeinträchtigen können, definiert der Open Data Protocol (odata) einen Mechanismus zum Abrufen von Binärdaten unabhängig von der Entität, zu der er gehört.</span><span class="sxs-lookup"><span data-stu-id="dd81a-106">Because loading and serializing large binary data in this manner can affect performance, the Open Data Protocol (OData) defines a mechanism for retrieving binary data independent of the entity to which it belongs.</span></span> <span data-ttu-id="dd81a-107">Dies wird erreicht, indem die Binärdaten und die Entität in einen oder mehrere Datenströme getrennt werden.</span><span class="sxs-lookup"><span data-stu-id="dd81a-107">This is accomplished by separating the binary data from the entity into one or more data streams.</span></span>

- <span data-ttu-id="dd81a-108">Medien Ressource: Binärdaten, die zu einer Entität gehören, z. b. ein Video, ein audiobild, ein Bild oder eine andere Art von Medienressourcen Datenstrom.</span><span class="sxs-lookup"><span data-stu-id="dd81a-108">Media resource - binary data that belongs to an entity, such as a video, audio, image, or other type of media resource stream.</span></span>

- <span data-ttu-id="dd81a-109">Medienlinkeintrag – eine Entität, die über einen Verweis auf einen zugehörigen Medienressourcenstream verfügt.</span><span class="sxs-lookup"><span data-stu-id="dd81a-109">Media link entry - an entity that has a reference to a related media resource stream.</span></span>

<span data-ttu-id="dd81a-110">Mit WCF Data Services definieren Sie einen binären Ressourcenstream, indem Sie einen streamingdatenanbieter implementieren.</span><span class="sxs-lookup"><span data-stu-id="dd81a-110">With WCF Data Services, you define a binary resource stream by implementing a streaming data provider.</span></span> <span data-ttu-id="dd81a-111">Die streaminganbieter-Implementierung stellt dem Datendienst den Medienressourcen Datenstrom bereit, der einer bestimmten Entität zugeordnet ist, als <xref:System.IO.Stream> Objekt.</span><span class="sxs-lookup"><span data-stu-id="dd81a-111">The streaming provider implementation supplies the data service with the media resource stream associated with a specific entity as an <xref:System.IO.Stream> object.</span></span> <span data-ttu-id="dd81a-112">Diese Implementierung ermöglicht dem Datendienst, Medienressourcen über HTTP als binäre Datenströme eines angegebenen MIME-Typs zu akzeptieren und zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="dd81a-112">This implementation enables the data service to accept and return media resources over HTTP as binary data streams of a specified MIME type.</span></span>

<span data-ttu-id="dd81a-113">Folgende Schritte sind erforderlich, um einen Datendienst zu konfigurieren, der das Streaming von Binärdaten unterstützt:</span><span class="sxs-lookup"><span data-stu-id="dd81a-113">Configuring a data service to support the streaming of binary data requires the following steps:</span></span>

1. <span data-ttu-id="dd81a-114">Kennzeichnen Sie mindestens eine Entität im Datenmodell als Medienlinkeintrag.</span><span class="sxs-lookup"><span data-stu-id="dd81a-114">Attribute one or more entities in the data model as a media link entry.</span></span> <span data-ttu-id="dd81a-115">Diese Entitäten dürfen die als Datenstrom zu sendenden Binärdaten nicht enthalten.</span><span class="sxs-lookup"><span data-stu-id="dd81a-115">These entities should not include the binary data to be streamed.</span></span> <span data-ttu-id="dd81a-116">Alle binären Eigenschaften einer Entität werden im Eintrag stets als Base-64-codierte Binärdaten zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="dd81a-116">Any binary properties of an entity are always returned in the entry as base-64 encoded binary.</span></span>

2. <span data-ttu-id="dd81a-117">Implementieren Sie die T:System.Data.Services.Providers.IDataServiceStreamProvider-Schnittstelle.</span><span class="sxs-lookup"><span data-stu-id="dd81a-117">Implement the T:System.Data.Services.Providers.IDataServiceStreamProvider interface.</span></span>

3. <span data-ttu-id="dd81a-118">Definieren Sie einen Datendienst, der die <xref:System.IServiceProvider>-Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="dd81a-118">Define a data service that implements the <xref:System.IServiceProvider> interface.</span></span> <span data-ttu-id="dd81a-119">Der Datendienst verwendet die <xref:System.IServiceProvider.GetService%2A>-Implementierung, um auf die Implementierung des Streamingdatenanbieters zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="dd81a-119">The data service uses the <xref:System.IServiceProvider.GetService%2A> implementation to access the streaming data provider implementation.</span></span> <span data-ttu-id="dd81a-120">Diese Methode gibt die entsprechende Streaminganbieterimplementierung zurück.</span><span class="sxs-lookup"><span data-stu-id="dd81a-120">This method returns the appropriate streaming provider implementation.</span></span>

4. <span data-ttu-id="dd81a-121">Aktivieren Sie große Nachrichtendatenströme in der Konfiguration der Webanwendung.</span><span class="sxs-lookup"><span data-stu-id="dd81a-121">Enable large message streams in the Web application configuration.</span></span>

5. <span data-ttu-id="dd81a-122">Aktivieren Sie den Zugriff auf binäre Ressourcen auf dem Server oder in einer Datenquelle.</span><span class="sxs-lookup"><span data-stu-id="dd81a-122">Enable access to binary resources on the server or in a data source.</span></span>

<span data-ttu-id="dd81a-123">Die Beispiele in diesem Thema basieren auf einem Beispiel-Streaming-Foto-Dienst, der im Beitrag [Data Services Streaming Provider Series: Implementieren eines streaminganbieters (Teil 1)](https://docs.microsoft.com/archive/blogs/astoriateam/data-services-streaming-provider-series-implementing-a-streaming-provider-part-1)ausführlich erläutert wird.</span><span class="sxs-lookup"><span data-stu-id="dd81a-123">The examples in this topic are based on a sample streaming photo service, which is discussed in depth in the post [Data Services Streaming Provider Series: Implementing a Streaming Provider (Part 1)](https://docs.microsoft.com/archive/blogs/astoriateam/data-services-streaming-provider-series-implementing-a-streaming-provider-part-1).</span></span> <span data-ttu-id="dd81a-124">Der Quellcode für das Streaming Photo Data Service-Beispiel ist auf [GitHub](https://github.com/microsoftarchive/msdn-code-gallery-community-s-z/tree/master/Streaming%20Photo%20OData%20Service%20Sample)verfügbar.</span><span class="sxs-lookup"><span data-stu-id="dd81a-124">The source code for the Streaming Photo Data Service sample is available on [GitHub](https://github.com/microsoftarchive/msdn-code-gallery-community-s-z/tree/master/Streaming%20Photo%20OData%20Service%20Sample).</span></span>

## <a name="defining-a-media-link-entry-in-the-data-model"></a><span data-ttu-id="dd81a-125">Definieren eines Medienlinkeintrags im Datenmodell</span><span class="sxs-lookup"><span data-stu-id="dd81a-125">Defining a Media Link Entry in the Data Model</span></span>

<span data-ttu-id="dd81a-126">Der Datenquellenanbieter bestimmt die Methode, mit der eine Entität im Datenmodell als Medienlinkeintrag definiert wird.</span><span class="sxs-lookup"><span data-stu-id="dd81a-126">The data source provider determines the way that an entity is defined as a media link entry in the data model.</span></span>

<span data-ttu-id="dd81a-127">**Entity Framework-Anbieter**</span><span class="sxs-lookup"><span data-stu-id="dd81a-127">**Entity Framework Provider**</span></span>

<span data-ttu-id="dd81a-128">Um anzugeben, dass eine Entität ein Medienlinkeintrag ist, fügen Sie der Entitätstypdefinition das `HasStream`-Attribut im konzeptionellen Modell hinzu, wie im folgenden Beispiel dargestellt:</span><span class="sxs-lookup"><span data-stu-id="dd81a-128">To indicate that an entity is a media link entry, add the `HasStream` attribute to the entity type definition in the conceptual model, as in the following example:</span></span>

[!code-xml[Astoria Photo Streaming Service#HasStream](../../../../samples/snippets/xml/VS_Snippets_Misc/astoria_photo_streaming_service/xml/photodata.edmx#hasstream)]

<span data-ttu-id="dd81a-129">Sie müssen außerdem entweder der Entität oder dem Stamm der EDMX- oder CSDL-Datei, die das Datenmodell definiert, den Namespace `xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata` hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="dd81a-129">You must also add the namespace `xmlns:m=http://schemas.microsoft.com/ado/2007/08/dataservices/metadata` either to the entity or to the root of the .edmx or .csdl file that defines the data model.</span></span>

<span data-ttu-id="dd81a-130">Ein Beispiel für einen Datendienst, der den Entity Framework Anbieter verwendet und eine Medien Ressource verfügbar macht, finden Sie im Beitrag [Data Services Streaming Provider Series: Implementieren eines streaminganbieters (Teil 1)](https://docs.microsoft.com/archive/blogs/astoriateam/data-services-streaming-provider-series-implementing-a-streaming-provider-part-1).</span><span class="sxs-lookup"><span data-stu-id="dd81a-130">For an example of a data service that uses the Entity Framework provider and exposes a media resource, see the post [Data Services Streaming Provider Series: Implementing a Streaming Provider (Part 1)](https://docs.microsoft.com/archive/blogs/astoriateam/data-services-streaming-provider-series-implementing-a-streaming-provider-part-1).</span></span>

<span data-ttu-id="dd81a-131">**Reflektionsanbieter**</span><span class="sxs-lookup"><span data-stu-id="dd81a-131">**Reflection Provider**</span></span>

<span data-ttu-id="dd81a-132">Um anzugeben, dass eine Entität ein Medienlinkeintrag ist, fügen Sie der Klasse, die den Entitätstyp im Reflektionsanbieter definiert, <xref:System.Data.Services.Common.HasStreamAttribute> hinzu.</span><span class="sxs-lookup"><span data-stu-id="dd81a-132">To indicate that an entity is a media link entry, add the <xref:System.Data.Services.Common.HasStreamAttribute> to the class that defines the entity type in the reflection provider.</span></span>

<span data-ttu-id="dd81a-133">**Benutzerdefinierter Daten Dienstanbieter**</span><span class="sxs-lookup"><span data-stu-id="dd81a-133">**Custom Data Service Provider**</span></span>

<span data-ttu-id="dd81a-134">Wenn Sie benutzerdefinierte Dienstanbieter verwenden, implementieren Sie die <xref:System.Data.Services.Providers.IDataServiceMetadataProvider>-Schnittstelle, um die Metadaten für den Datendienst zu definieren.</span><span class="sxs-lookup"><span data-stu-id="dd81a-134">When using custom service providers, you implement the <xref:System.Data.Services.Providers.IDataServiceMetadataProvider> interface to define the metadata for your data service.</span></span> <span data-ttu-id="dd81a-135">Weitere Informationen finden Sie unter [benutzerdefinierte Daten Dienstanbieter](custom-data-service-providers-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="dd81a-135">For more information, see [Custom Data Service Providers](custom-data-service-providers-wcf-data-services.md).</span></span> <span data-ttu-id="dd81a-136">Sie geben an, dass ein binärer Ressourcenstream zu einem <xref:System.Data.Services.Providers.ResourceType> gehört, indem Sie die <xref:System.Data.Services.Providers.ResourceType.IsMediaLinkEntry%2A>-Eigenschaft für den `true`, der den Entitätstyp (einen Medienlinkeintrag) darstellt, auf <xref:System.Data.Services.Providers.ResourceType> festlegen.</span><span class="sxs-lookup"><span data-stu-id="dd81a-136">You indicate that a binary resource stream belongs to a <xref:System.Data.Services.Providers.ResourceType> by setting the <xref:System.Data.Services.Providers.ResourceType.IsMediaLinkEntry%2A> property to `true` on the <xref:System.Data.Services.Providers.ResourceType> that represents the entity type, which is a media link entry.</span></span>

## <a name="implementing-the-idataservicestreamprovider-interface"></a><span data-ttu-id="dd81a-137">Implementieren der IDataServiceStreamProvider-Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="dd81a-137">Implementing the IDataServiceStreamProvider Interface</span></span>

<span data-ttu-id="dd81a-138">Um einen Datendienst zu erstellen, der binäre Datenströme unterstützt, müssen Sie die <xref:System.Data.Services.Providers.IDataServiceStreamProvider>-Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="dd81a-138">To create a data service that supports binary data streams, you must implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> interface.</span></span> <span data-ttu-id="dd81a-139">Diese Implementierung ermöglicht dem Datendienst, Binärdaten als Datenstrom an den Client zurückzugeben und Binärdaten als einen vom Client gesendeten Datenstrom zu nutzen.</span><span class="sxs-lookup"><span data-stu-id="dd81a-139">This implementation enables the data service to return binary data as a stream to the client and consume binary data as a stream sent from the client.</span></span> <span data-ttu-id="dd81a-140">Der Datendienst erstellt immer dann eine Instanz dieser Schnittstelle, wenn er auf Binärdaten als Datenstrom zugreifen muss.</span><span class="sxs-lookup"><span data-stu-id="dd81a-140">The data service creates an instance of this interface whenever it needs to access binary data as a stream.</span></span> <span data-ttu-id="dd81a-141">Die <xref:System.Data.Services.Providers.IDataServiceStreamProvider>-Schnittstelle legt die folgenden Member fest:</span><span class="sxs-lookup"><span data-stu-id="dd81a-141">The <xref:System.Data.Services.Providers.IDataServiceStreamProvider> interface specifies the following members:</span></span>

|<span data-ttu-id="dd81a-142">Mitgliedsname</span><span class="sxs-lookup"><span data-stu-id="dd81a-142">Member name</span></span>|<span data-ttu-id="dd81a-143">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="dd81a-143">Description</span></span>|
|-----------------|-----------------|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>|<span data-ttu-id="dd81a-144">Diese Methode wird vom Datendienst aufgerufen, um die entsprechende Medienressource zu löschen, wenn ihr Medienlinkeintrag gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="dd81a-144">This method is invoked by the data service to delete the corresponding media resource when its media link entry is deleted.</span></span> <span data-ttu-id="dd81a-145">Wenn Sie <xref:System.Data.Services.Providers.IDataServiceStreamProvider> implementieren, enthält diese Methode den Code, mit dem die dem angegebenen Medienlinkeintrag zugeordnete Medienressource gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="dd81a-145">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, this method contains the code that deletes the media resource associated with the supplied media link entry.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A>|<span data-ttu-id="dd81a-146">Diese Methode wird vom Datendienst aufgerufen, um eine Medienressource als Datenstrom zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="dd81a-146">This method is invoked by the data service to return a media resource as a stream.</span></span> <span data-ttu-id="dd81a-147">Wenn Sie <xref:System.Data.Services.Providers.IDataServiceStreamProvider> implementieren, enthält diese Methode den Code, der einen Datenstrom bereitstellt, der vom Datendienst zum Zurückgeben der dem bereitgestellten Medienlinkeintrag zugeordneten Medienressource verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="dd81a-147">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, this method contains the code that provides a stream that is used by the data service to the return media resource that is associated with the provided media link entry.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStreamUri%2A>|<span data-ttu-id="dd81a-148">Diese Methode wird vom Datendienst aufgerufen, um den URI zurückzugeben, der zum Anfordern der Medienressource für den Medienlinkeintrag verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="dd81a-148">This method is invoked by the data service to return the URI that is used to request the media resource for the media link entry.</span></span> <span data-ttu-id="dd81a-149">Dieser Wert wird verwendet, um das `src`-Attribut im Inhaltselement des Medienlinkeintrags zu erstellen. Dieses wird verwendet, um den Datenstrom anzufordern.</span><span class="sxs-lookup"><span data-stu-id="dd81a-149">This value is used to create the `src` attribute in the content element of the media link entry and that is used to request the data stream.</span></span> <span data-ttu-id="dd81a-150">Wenn diese Methode `null` zurückgibt, bestimmt der Datendienst den URI automatisch.</span><span class="sxs-lookup"><span data-stu-id="dd81a-150">When this method returns `null`, the data service automatically determines the URI.</span></span> <span data-ttu-id="dd81a-151">Verwenden Sie diese Methode, wenn Sie Clients mit direktem Zugriff auf binäre Daten ohne Verwendung des Streamanbieters bereitstellen müssen.</span><span class="sxs-lookup"><span data-stu-id="dd81a-151">Use this method when you need to provide clients with direct access to binary data without using the steam provider.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetStreamContentType%2A>|<span data-ttu-id="dd81a-152">Diese Methode wird vom Datendienst aufgerufen, um den Content-Type-Wert der Medienressource zurückzugeben, die dem angegebenen Medienlinkeintrag zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="dd81a-152">This method is invoked by the data service to return the Content-Type value of the media resource that is associated with the specified media link entry.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetStreamETag%2A>|<span data-ttu-id="dd81a-153">Diese Methode wird vom Datendienst aufgerufen, um das eTag des Datenstroms zurückzugeben, das der angegebenen Entität zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="dd81a-153">This method is invoked by the data service to return the eTag of the data stream that is associated with the specified entity.</span></span> <span data-ttu-id="dd81a-154">Diese Methode wird verwendet, wenn Sie Parallelität für die Binärdaten verwalten.</span><span class="sxs-lookup"><span data-stu-id="dd81a-154">This method is used when you manage concurrency for the binary data.</span></span> <span data-ttu-id="dd81a-155">Wenn diese Methode NULL zurückgibt, überwacht der Datendienst die Parallelität nicht.</span><span class="sxs-lookup"><span data-stu-id="dd81a-155">When this method returns null, the data service does not track concurrency.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A>|<span data-ttu-id="dd81a-156">Diese Methode wird vom Datendienst aufgerufen, um den Datenstrom abzurufen, der beim Empfangen des vom Client gesendeten Datenstroms verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="dd81a-156">This method is invoked by the data service to obtain the stream that is used when receiving the stream sent from the client.</span></span> <span data-ttu-id="dd81a-157">Wenn Sie <xref:System.Data.Services.Providers.IDataServiceStreamProvider> implementieren, müssen Sie einen überschreibbaren Datenstrom zurückgeben, in den der Datendienst empfangene Datenstromdaten schreibt.</span><span class="sxs-lookup"><span data-stu-id="dd81a-157">When you implement <xref:System.Data.Services.Providers.IDataServiceStreamProvider>, you must return a writable stream to which the data service writes received stream data.</span></span>|
|<xref:System.Data.Services.Providers.IDataServiceStreamProvider.ResolveType%2A>|<span data-ttu-id="dd81a-158">Gibt einen mit einem Namespace qualifizierten Typnamen zurück, der den Typ darstellt, den die Datendienstlaufzeit für den Medienlinkeintrag erstellen muss, der dem Datenstrom für die Medienressource zugeordnet ist, die eingefügt wird.</span><span class="sxs-lookup"><span data-stu-id="dd81a-158">Returns a namespace-qualified type name that represents the type that the data service runtime must create for the media link entry that is associated with the data stream for the media resource that is being inserted.</span></span>|

## <a name="creating-the-streaming-data-service"></a><span data-ttu-id="dd81a-159">Erstellen des Streamingdatendiensts</span><span class="sxs-lookup"><span data-stu-id="dd81a-159">Creating the Streaming Data Service</span></span>

<span data-ttu-id="dd81a-160">Um der WCF Data Services Laufzeit Zugriff auf die <xref:System.Data.Services.Providers.IDataServiceStreamProvider>-Implementierung bereitzustellen, muss der von Ihnen erstellte Datendienst auch die <xref:System.IServiceProvider>-Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="dd81a-160">To provide the WCF Data Services runtime with access to the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> implementation, the data service that you create must also implement the <xref:System.IServiceProvider> interface.</span></span> <span data-ttu-id="dd81a-161">Im folgenden Beispiel wird gezeigt, wie die <xref:System.IServiceProvider.GetService%2A>-Methode implementiert wird, um eine Instanz der `PhotoServiceStreamProvider`-Klasse zurückzugeben, die <xref:System.Data.Services.Providers.IDataServiceStreamProvider> implementiert.</span><span class="sxs-lookup"><span data-stu-id="dd81a-161">The following example shows how to implement the <xref:System.IServiceProvider.GetService%2A> method to return an instance of the `PhotoServiceStreamProvider` class that implements <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span></span>

[!code-csharp[Astoria Photo Streaming Service#PhotoServiceStreamingProvider](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_photo_streaming_service/cs/photodata.svc.cs#photoservicestreamingprovider)]
[!code-vb[Astoria Photo Streaming Service#PhotoServiceStreamingProvider](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_photo_streaming_service/vb/photodata.svc.vb#photoservicestreamingprovider)]

<span data-ttu-id="dd81a-162">Allgemeine Informationen zum Erstellen eines Daten dienstanzdienstanbieter finden Sie unter [Konfigurieren des Daten Dienstanbieter](configuring-the-data-service-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="dd81a-162">For general information about how to create a data service, see [Configuring the Data Service](configuring-the-data-service-wcf-data-services.md).</span></span>

## <a name="enabling-large-binary-streams-in-the-hosting-environment"></a><span data-ttu-id="dd81a-163">Aktivieren von großen binären Datenströmen in der Hostumgebung</span><span class="sxs-lookup"><span data-stu-id="dd81a-163">Enabling Large Binary Streams in the Hosting Environment</span></span>

<span data-ttu-id="dd81a-164">Wenn Sie einen Datendienst in einer ASP.NET-Webanwendung erstellen, wird Windows Communication Foundation (WCF) verwendet, um die HTTP-Protokoll Implementierung bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="dd81a-164">When you create a data service in an ASP.NET Web application, Windows Communication Foundation (WCF) is used to provide the HTTP protocol implementation.</span></span> <span data-ttu-id="dd81a-165">Standardmäßig schränkt WCF die Größe von HTTP-Nachrichten auf 65 KB ein.</span><span class="sxs-lookup"><span data-stu-id="dd81a-165">By default, WCF limits the size of HTTP messages to only 65 KB.</span></span> <span data-ttu-id="dd81a-166">Damit umfangreiche Binärdaten als Datenstrom zum und vom Datendienst gesendet werden können, müssen Sie auch die Webanwendung für die Verwendung großer Binärdateien und den Einsatz von Datenströmen für die Übertragung konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="dd81a-166">To be able to stream large binary data to and from the data service, you must also configure the Web application to enable large binary files and to use streams for transfer.</span></span> <span data-ttu-id="dd81a-167">Fügen Sie dazu Folgendes im `<configuration />`-Element der Datei Web.config der Anwendung hinzu:</span><span class="sxs-lookup"><span data-stu-id="dd81a-167">To do this, add the following in the `<configuration />` element of the application's Web.config file:</span></span>

> [!NOTE]
> <span data-ttu-id="dd81a-168">Sie müssen einen <xref:System.ServiceModel.TransferMode.Streamed?displayProperty=nameWithType> Übertragungsmodus verwenden, um sicherzustellen, dass die Binärdaten in den Anforderungs-und Antwort Nachrichten per Streaming gestreamt und nicht von WCF gepuffert werden.</span><span class="sxs-lookup"><span data-stu-id="dd81a-168">You must use a <xref:System.ServiceModel.TransferMode.Streamed?displayProperty=nameWithType> transfer mode to ensure that the binary data in both the request and response messages are streamed and not buffered by WCF.</span></span>

<span data-ttu-id="dd81a-169">Weitere Informationen finden Sie unter [Streaming Message Transfer](../../wcf/feature-details/streaming-message-transfer.md) and [Transport Kontingenten](../../wcf/feature-details/transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="dd81a-169">For more information, see [Streaming Message Transfer](../../wcf/feature-details/streaming-message-transfer.md) and [Transport Quotas](../../wcf/feature-details/transport-quotas.md).</span></span>

<span data-ttu-id="dd81a-170">Standardmäßig schränkt Internetinformationsdienste (IIS) auch die Größe von Anforderungen auf 4 MB ein.</span><span class="sxs-lookup"><span data-stu-id="dd81a-170">By default, Internet Information Services (IIS) also limits the size of requests to 4 MB.</span></span> <span data-ttu-id="dd81a-171">Damit der Datendienst bei Ausführung unter IIS Datenströme empfangen kann, die größer als 4 MB sind, müssen Sie auch das `maxRequestLength`-Attribut des [httpRuntime-Elements (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/e1f13641(v=vs.100)) im `<system.web />`-Konfigurations Abschnitt festlegen, wie im folgenden Beispiel gezeigt:</span><span class="sxs-lookup"><span data-stu-id="dd81a-171">To enable your data service to receive streams larger than 4 MB when running on IIS, you must also set the `maxRequestLength` attribute of the [httpRuntime Element (ASP.NET Settings Schema)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/e1f13641(v=vs.100)) in the `<system.web />` configuration section, as shown in the following example:</span></span>

## <a name="using-data-streams-in-a-client-application"></a><span data-ttu-id="dd81a-172">Verwenden von Datenströmen in einer Clientanwendung</span><span class="sxs-lookup"><span data-stu-id="dd81a-172">Using Data Streams in a Client Application</span></span>

<span data-ttu-id="dd81a-173">Mit der WCF Data Services-Client Bibliothek können Sie diese verfügbar gemachten Ressourcen als binäre Streams auf dem Client abrufen und aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="dd81a-173">The WCF Data Services client library enables you to both retrieve and update these exposed resources as binary streams on the client.</span></span> <span data-ttu-id="dd81a-174">Weitere Informationen finden Sie unter [Arbeiten mit Binärdaten](working-with-binary-data-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="dd81a-174">For more information, see [Working with Binary Data](working-with-binary-data-wcf-data-services.md).</span></span>

## <a name="considerations-for-working-with-a-streaming-provider"></a><span data-ttu-id="dd81a-175">Überlegungen zum Arbeiten mit einem Streaminganbieter</span><span class="sxs-lookup"><span data-stu-id="dd81a-175">Considerations for Working with a Streaming Provider</span></span>

<span data-ttu-id="dd81a-176">Folgende Aspekte sollten bei der Implementierung eines Streaminganbieters und beim Zugriff auf Medienressourcen von einem Datendienst aus berücksichtigt werden.</span><span class="sxs-lookup"><span data-stu-id="dd81a-176">The following are things to consider when you implement a streaming provider and when you access media resources from a data service.</span></span>

- <span data-ttu-id="dd81a-177">MERGE-Anforderungen werden für Medienressourcen nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="dd81a-177">MERGE requests are not supported for media resources.</span></span> <span data-ttu-id="dd81a-178">Verwenden Sie eine PUT-Anforderung, um die Medienressource einer vorhandenen Entität zu ändern.</span><span class="sxs-lookup"><span data-stu-id="dd81a-178">Use a PUT request to change the media resource of an existing entity.</span></span>

- <span data-ttu-id="dd81a-179">Eine POST-Anforderung kann nicht verwendet werden, um einen neuen Medienlinkeintrag zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="dd81a-179">A POST request cannot be used to create a new media link entry.</span></span> <span data-ttu-id="dd81a-180">Stattdessen müssen Sie eine POST-Anforderung absetzen, um eine neue Medienressource zu erstellen, und der Datendienst erstellt einen neuen Medienlinkeintrag mit Standardwerten.</span><span class="sxs-lookup"><span data-stu-id="dd81a-180">Instead, you must issue a POST request to create a new media resource, and the data service creates a new media link entry with default values.</span></span> <span data-ttu-id="dd81a-181">Diese neue Entität kann durch eine nachfolgende MERGE- oder PUT-Anforderung aktualisiert werden.</span><span class="sxs-lookup"><span data-stu-id="dd81a-181">This new entity can be updated by a subsequent MERGE or PUT request.</span></span> <span data-ttu-id="dd81a-182">Sie sollten außerdem in Betracht ziehen, die Entität zwischenzuspeichern und Aktualisierungen in der Funktion zum Entfernen vorzunehmen, z. B. das Festlegen des Eigenschaftswerts auf den Wert des Headers des Platzhalterfelds in der POST-Anforderung.</span><span class="sxs-lookup"><span data-stu-id="dd81a-182">You may also consider caching the entity and make updates in the disposer, such as setting the property value to the value of the Slug header in the POST request.</span></span>

- <span data-ttu-id="dd81a-183">Wenn eine POST-Anforderung empfangen wird, ruft der Datendienst <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> auf, um die Medienressource zu erstellen, bevor er <xref:System.Data.Services.IUpdatable.SaveChanges%2A> aufruft, um den Medienlinkeintrag zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="dd81a-183">When a POST request is received, the data service calls <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> to create the media resource before it calls <xref:System.Data.Services.IUpdatable.SaveChanges%2A> to create the media link entry.</span></span>

- <span data-ttu-id="dd81a-184">Eine Implementierung von <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> sollte kein <xref:System.IO.MemoryStream>-Objekt zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="dd81a-184">An implementation of <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> should not return a <xref:System.IO.MemoryStream> object.</span></span> <span data-ttu-id="dd81a-185">Bei der Verwendung solcher Datenströme treten Speicherressourcenprobleme auf, wenn der Dienst sehr große Datenströme empfängt.</span><span class="sxs-lookup"><span data-stu-id="dd81a-185">When you use this kind of stream, memory resource issues will occur when the service receives very large data streams.</span></span>

- <span data-ttu-id="dd81a-186">Folgende Aspekte müssen berücksichtigt werden, wenn Medienressourcen in einer Datenbank gespeichert werden:</span><span class="sxs-lookup"><span data-stu-id="dd81a-186">The following are things to consider when storing media resources in a database:</span></span>

  - <span data-ttu-id="dd81a-187">Eine binäre Eigenschaft, die eine Medienressource ist, sollte nicht im Datenmodell enthalten sein.</span><span class="sxs-lookup"><span data-stu-id="dd81a-187">A binary property that is a media resource should not be included in the data model.</span></span> <span data-ttu-id="dd81a-188">Alle in einem Datenmodell zur Verfügung gestellten Eigenschaften werden im Eintrag in einem Antwortfeed zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="dd81a-188">All properties exposed in a data model are returned in the entry in a response feed.</span></span>

  - <span data-ttu-id="dd81a-189">Um die Leistung bei einem großen binären Datenstrom zu verbessern, empfiehlt es sich, eine benutzerdefinierte Datenstromklasse zu erstellen, um Binärdaten in der Datenbank zu speichern.</span><span class="sxs-lookup"><span data-stu-id="dd81a-189">To improve performance with a large binary stream, we recommend that you create a custom stream class to store binary data in the database.</span></span> <span data-ttu-id="dd81a-190">Diese Klasse wird von der <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A>-Implementierung zurückgegeben und sendet die Binärdaten in Blöcken an die Datenbank.</span><span class="sxs-lookup"><span data-stu-id="dd81a-190">This class is returned by your <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> implementation and sends the binary data to the database in chunks.</span></span> <span data-ttu-id="dd81a-191">Für eine SQL Server Datenbank empfiehlt es sich, einen FileStream zum Streamen von Daten in die Datenbank zu verwenden, wenn die Binärdaten größer als 1 MB sind.</span><span class="sxs-lookup"><span data-stu-id="dd81a-191">For a SQL Server database, we recommend that you use a FILESTREAM to stream data into the database when the binary data is larger than 1 MB.</span></span>

  - <span data-ttu-id="dd81a-192">Stellen Sie sicher, dass die Datenbank zum Speichern großer binärer Datenströme entworfen wurde, die vom Datendienst empfangen werden sollen.</span><span class="sxs-lookup"><span data-stu-id="dd81a-192">Ensure that your database is designed to store the binary large streams that are to be received by your data service.</span></span>

  - <span data-ttu-id="dd81a-193">Wenn ein Client eine POST-Anforderung sendet, um einen Medienlinkeintrag mit einer Medienressource in einer einzelnen Anforderung einzufügen, wird <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> aufgerufen, um den Datenstrom abzurufen, bevor der Datendienst die neue Entität in die Datenbank einfügt.</span><span class="sxs-lookup"><span data-stu-id="dd81a-193">When a client sends a POST request to insert a media link entry with a media resource in a single request, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> is called to obtain the stream before the data service inserts the new entity into the database.</span></span> <span data-ttu-id="dd81a-194">Eine Streaminganbieterimplementierung muss in der Lage sein, mit diesem Verhalten des Datendiensts umzugehen.</span><span class="sxs-lookup"><span data-stu-id="dd81a-194">A streaming provider implementation must be able to handle this data service behavior.</span></span> <span data-ttu-id="dd81a-195">Sie können die Binärdaten mithilfe einer separaten Datentabelle speichern oder den Datenstrom in einer Datei speichern, bis die Entität in die Datenbank eingefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="dd81a-195">Consider using a separate data table to store the binary data or store the data stream in a file until after the entity has been inserted into the database.</span></span>

- <span data-ttu-id="dd81a-196">Wenn Sie die Methode <xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A> oder <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> implementieren, müssen Sie die eTag- und Content-Type-Werte verwenden, die als Methodenparameter angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="dd81a-196">When you implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider.DeleteStream%2A>, <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetReadStream%2A>, or <xref:System.Data.Services.Providers.IDataServiceStreamProvider.GetWriteStream%2A> methods, you must use the eTag and Content-Type values that are supplied as method parameters.</span></span> <span data-ttu-id="dd81a-197">Legen Sie keine eTag- oder Content-Type-Header in der <xref:System.Data.Services.Providers.IDataServiceStreamProvider>-Anbieterimplementierung fest.</span><span class="sxs-lookup"><span data-stu-id="dd81a-197">Do not set eTag or Content-Type headers in your <xref:System.Data.Services.Providers.IDataServiceStreamProvider> provider implementation.</span></span>

- <span data-ttu-id="dd81a-198">Standardmäßig sendet der Client große binäre Datenströme mithilfe einer segmentierten HTTP-Übertragungscodierung.</span><span class="sxs-lookup"><span data-stu-id="dd81a-198">By default, the client sends large binary streams by using a chunked HTTP Transfer-Encoding.</span></span> <span data-ttu-id="dd81a-199">Da der ASP.NET Development Server diese Art von Codierung nicht unterstützt, können Sie diesen Webserver nicht zum Hosten eines streamingdatendiensts verwenden, der große binäre Datenströme akzeptieren muss.</span><span class="sxs-lookup"><span data-stu-id="dd81a-199">Because the ASP.NET Development Server does not support this kind of encoding, you cannot use this Web server to host a streaming data service that must accept large binary streams.</span></span> <span data-ttu-id="dd81a-200">Weitere Informationen zu ASP.NET Development Server finden Sie unter [Webserver in Visual Studio für ASP.NET-Webprojekte](https://docs.microsoft.com/previous-versions/aspnet/58wxa9w5(v=vs.120)).</span><span class="sxs-lookup"><span data-stu-id="dd81a-200">For more information on ASP.NET Development Server, see [Web Servers in Visual Studio for ASP.NET Web Projects](https://docs.microsoft.com/previous-versions/aspnet/58wxa9w5(v=vs.120)).</span></span>

<a name="versioning"></a>

## <a name="versioning-requirements"></a><span data-ttu-id="dd81a-201">Versionsanforderungen</span><span class="sxs-lookup"><span data-stu-id="dd81a-201">Versioning Requirements</span></span>

<span data-ttu-id="dd81a-202">Der streaminganbieter verfügt über die folgenden Anforderungen an die odata-Protokoll Versionsverwaltung:</span><span class="sxs-lookup"><span data-stu-id="dd81a-202">The streaming provider has the following OData protocol versioning requirements:</span></span>

- <span data-ttu-id="dd81a-203">Der streaminganbieter erfordert, dass der Datendienst Version 2,0 des odata-Protokolls und höhere Versionen unterstützt.</span><span class="sxs-lookup"><span data-stu-id="dd81a-203">The streaming provider requires that the data service support version 2.0 of the OData protocol and later versions.</span></span>

<span data-ttu-id="dd81a-204">Weitere Informationen finden Sie unter [Data Service Versioning](data-service-versioning-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="dd81a-204">For more information, see [Data Service Versioning](data-service-versioning-wcf-data-services.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="dd81a-205">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="dd81a-205">See also</span></span>

- [<span data-ttu-id="dd81a-206">Datendienstanbieter</span><span class="sxs-lookup"><span data-stu-id="dd81a-206">Data Services Providers</span></span>](data-services-providers-wcf-data-services.md)
- [<span data-ttu-id="dd81a-207">Benutzerdefinierte Datendienstanbieter</span><span class="sxs-lookup"><span data-stu-id="dd81a-207">Custom Data Service Providers</span></span>](custom-data-service-providers-wcf-data-services.md)
- [<span data-ttu-id="dd81a-208">Arbeiten mit Binärdaten</span><span class="sxs-lookup"><span data-stu-id="dd81a-208">Working with Binary Data</span></span>](working-with-binary-data-wcf-data-services.md)
