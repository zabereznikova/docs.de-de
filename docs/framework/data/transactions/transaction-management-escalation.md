---
title: Eskalation der Transaktionsverwaltung
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 1e96331e-31b6-4272-bbbd-29ed1e110460
caps.latest.revision: "3"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 5d076b93774282fbfa52acfacb6a1c9f3231a972
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/22/2017
---
# <a name="transaction-management-escalation"></a><span data-ttu-id="7072a-102">Eskalation der Transaktionsverwaltung</span><span class="sxs-lookup"><span data-stu-id="7072a-102">Transaction Management Escalation</span></span>
<span data-ttu-id="7072a-103">Windows umfasst eine Reihe von Diensten und Modulen, die zusammen einen Transaktions-Manager bilden.</span><span class="sxs-lookup"><span data-stu-id="7072a-103">Windows hosts a set of services and modules that together constitute a transaction manager.</span></span> <span data-ttu-id="7072a-104">Unter der Eskalation der Transaktionsverwaltung wird die Übertragung einer Transaktion von einer Komponente zu einer anderen Komponente des Transaktions-Managers verstanden.</span><span class="sxs-lookup"><span data-stu-id="7072a-104">Transaction management escalation describes the process of migrating a transaction from one of the transaction manager's components to another.</span></span>  
  
 <span data-ttu-id="7072a-105"><xref:System.Transactions> beinhaltet eine Transaktions-Manager-Komponente, die Transaktionen koordiniert, welche höchstens eine dauerhafte Ressource oder mehrere flüchtige Ressourcen umfassen können.</span><span class="sxs-lookup"><span data-stu-id="7072a-105"><xref:System.Transactions> includes a transaction manager component that coordinates a transaction involving at most, a single durable resource or multiple volatile resources.</span></span> <span data-ttu-id="7072a-106">Weil der Transaktions-Manager nur Aufrufe innerhalb der Anwendungsdomäne tätigt, erzielt er die optimale Leistung.</span><span class="sxs-lookup"><span data-stu-id="7072a-106">Because the transaction manager uses only intra-application domain calls, it yields the best performance.</span></span> <span data-ttu-id="7072a-107">Entwickler müssen nicht direkt mit dem Transaktions-Manager arbeiten.</span><span class="sxs-lookup"><span data-stu-id="7072a-107">Developers need not interact with the transaction manager directly.</span></span> <span data-ttu-id="7072a-108">Stattdessen wird vom <xref:System.Transactions>-Namespace eine gemeinsame Infrastruktur bereitgestellt, die Schnittstellen, gemeinsames Verhalten und Hilfsklassen definiert.</span><span class="sxs-lookup"><span data-stu-id="7072a-108">Instead, a common infrastructure that defines interfaces, common behavior, and helper classes is provided by the <xref:System.Transactions> namespace.</span></span>  
  
 <span data-ttu-id="7072a-109">Wenn Sie die Transaktion auf ein Objekt in einer anderen Anwendungsdomäne (einschließlich über Prozess- und Computergrenzen hinweg) auf demselben Computer bereitstellen möchten die <xref:System.Transactions> Infrastruktur weitet automatisch die Transaktion von Microsoft verwaltet werden Distributed Transaction Coordinator (MSDTC).</span><span class="sxs-lookup"><span data-stu-id="7072a-109">When you want to provide the transaction to an object in another application domain (including across process and machine boundaries) on the same computer, the <xref:System.Transactions> infrastructure automatically escalates the transaction to be managed by the Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="7072a-110">Die Eskalation erfolgt auch dann, wenn Sie einen anderen permanenten Ressourcen-Manager eintragen.</span><span class="sxs-lookup"><span data-stu-id="7072a-110">The escalation also occurs if you enlist another durable resource manager.</span></span> <span data-ttu-id="7072a-111">Nach der Eskalation wird die Transaktion bis zu ihrem Abschluss weiterhin in ihrem eskalierten Zustand verwaltet.</span><span class="sxs-lookup"><span data-stu-id="7072a-111">When escalated, the transaction remains managed in its elevated state until its completion.</span></span>  
  
 <span data-ttu-id="7072a-112">Zwischen der <xref:System.Transactions>-Transaktion und der MSDTC-Transaktion gibt es einen zwischengelagerten Transaktionstyp, der durch die PSPE (Promotable Single Phase Enlistment) zur Verfügung gestellt wird.</span><span class="sxs-lookup"><span data-stu-id="7072a-112">Between the <xref:System.Transactions> transaction and MSDTC transaction, there is an intermediary type of transaction that is made available through the Promotable Single Phase Enlistment (PSPE).</span></span> <span data-ttu-id="7072a-113">PSPE ist ein weiterer wichtiger Mechanismus in <xref:System.Transactions>, der zur Leistungsoptimierung dient.</span><span class="sxs-lookup"><span data-stu-id="7072a-113">PSPE is another important mechanism in <xref:System.Transactions> for performance optimization.</span></span> <span data-ttu-id="7072a-114">Er ermöglicht es, dass sich eine einzelne dauerhafte Remoteressource, die sich in einer anderen Anwendungsdomäne, einem anderen Prozess oder auf einem anderen Computer befindet, an einer <xref:System.Transactions>-Transaktion beteiligt, ohne dass diese dadurch zu einer MSDTC-Transaktion eskaliert wird.</span><span class="sxs-lookup"><span data-stu-id="7072a-114">It allows a remote durable resource, located in a different application domain, process or computer, to participate in a <xref:System.Transactions> transaction without causing it to be escalated to an MSDTC transaction.</span></span> <span data-ttu-id="7072a-115">Weitere Informationen zu PSPE, finden Sie unter [Ressourcen als Teilnehmer in einer Transaktion eintragen](../../../../docs/framework/data/transactions/enlisting-resources-as-participants-in-a-transaction.md).</span><span class="sxs-lookup"><span data-stu-id="7072a-115">For more information about PSPE, see [Enlisting Resources as Participants in a Transaction](../../../../docs/framework/data/transactions/enlisting-resources-as-participants-in-a-transaction.md).</span></span>  
  
## <a name="how-escalation-is-initiated"></a><span data-ttu-id="7072a-116">Wie die Eskalation initiiert wird</span><span class="sxs-lookup"><span data-stu-id="7072a-116">How Escalation is Initiated</span></span>  
 <span data-ttu-id="7072a-117">Die Transaktionseskalation mindert die Leistung, weil der MSDTC in einem eigenen Prozess ausgeführt wird und die Eskalation einer Transaktion an den MSDTC in einem Nachrichtenaustausch zwischen Prozessen resultiert.</span><span class="sxs-lookup"><span data-stu-id="7072a-117">Transaction escalation reduces performance because the MSDTC resides in a separate process, and escalating a transaction to the MSDTC results in messages being sent across process.</span></span> <span data-ttu-id="7072a-118">Um die Leistung zu verbessern, sollten Sie verzögern oder vermeiden Eskalation zu MSDTC; Daher müssen Sie wissen, wie und wann die Ausweitung initiiert wird.</span><span class="sxs-lookup"><span data-stu-id="7072a-118">To improve performance, you should delay or avoid escalation to MSDTC; thus, you need to know how and when the escalation is initiated.</span></span>  
  
 <span data-ttu-id="7072a-119">Solange die <xref:System.Transactions>-Infrastruktur flüchtige Ressourcen und höchstens eine dauerhafte Ressource verwaltet, die Einphasenbenachrichtigungen unterstützt, wird die Transaktion von der <xref:System.Transactions>-Infrastruktur verwaltet</span><span class="sxs-lookup"><span data-stu-id="7072a-119">As long as the <xref:System.Transactions> infrastructure handles volatile resources and at most one durable resource that supports single-phase notifications, the transaction remains in the ownership of the <xref:System.Transactions> infrastructure.</span></span> <span data-ttu-id="7072a-120">Der Transaktions-Manager wird nur denjenigen Ressourcen zur Verfügung gestellt, die sich in der gleichen Anwendungsdomäne befinden und für deren Protokollierung (Schreiben der Transaktionsergebnisse auf den Datenträger) keine Anmeldung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="7072a-120">The transaction manager avails itself only to those resources that live in the same application domain and for which logging (writing the transaction outcome to disk) is not required.</span></span> <span data-ttu-id="7072a-121">Eine Eskalation, die bewirkt, dass die <xref:System.Transactions>-Infrastruktur die Verantwortung für die Transaktion dem MSDTC überträgt, tritt unter folgenden Bedingungen auf:</span><span class="sxs-lookup"><span data-stu-id="7072a-121">An escalation that results in the <xref:System.Transactions> infrastructure transferring the ownership of the transaction to MSDTC happens when:</span></span>  
  
-   <span data-ttu-id="7072a-122">Mindestens eine dauerhafte Ressource, die keine Einphasenbenachrichtigungen unterstützt, ist in der Transaktion eingetragen.</span><span class="sxs-lookup"><span data-stu-id="7072a-122">At least one durable resource that does not support single-phase notifications is enlisted in the transaction.</span></span>  
  
-   <span data-ttu-id="7072a-123">Mindestens zwei permanente Ressourcen, die Einphasenbenachrichtigungen unterstützen, sind in der Transaktion eingetragen.</span><span class="sxs-lookup"><span data-stu-id="7072a-123">At least two durable resources that support single-phase notifications are enlisted in the transaction.</span></span> <span data-ttu-id="7072a-124">Beispielsweise wird durch das Eintragen einer einzelnen Verbindung mit [!INCLUDE[sqprsqlong](../../../../includes/sqprsqlong-md.md)] die Transaktion nicht höher gestuft.</span><span class="sxs-lookup"><span data-stu-id="7072a-124">For example, enlisting a single connection with [!INCLUDE[sqprsqlong](../../../../includes/sqprsqlong-md.md)] does not cause a transaction to be promoted.</span></span> <span data-ttu-id="7072a-125">Wenn jedoch eine zweite Verbindung mit einer [!INCLUDE[sqprsqlong](../../../../includes/sqprsqlong-md.md)]-Datenbank hergestellt und die Datenbank daher eingetragen wird, erkennt die <xref:System.Transactions>-Infrastruktur, dass eine zweite dauerhafte Ressource in der Transaktion vorhanden ist und eskaliert diese zu einer MSDTC-Transaktion.</span><span class="sxs-lookup"><span data-stu-id="7072a-125">However, whenever you open a second connection to a [!INCLUDE[sqprsqlong](../../../../includes/sqprsqlong-md.md)] database causing the database to enlist, the <xref:System.Transactions> infrastructure detects that it is the second durable resource in the transaction, and escalates it to an MSDTC transaction.</span></span>  
  
-   <span data-ttu-id="7072a-126">Daraufhin wird eine Anforderung erzeugt, um die Transaktion an eine andere Anwendungsdomäne oder einen anderen Prozess zu "marshallen".</span><span class="sxs-lookup"><span data-stu-id="7072a-126">A request to "marshal" the transaction to a different application domain or different process is invoked.</span></span> <span data-ttu-id="7072a-127">Zum Beispiel die Serialisierung des Transaktionsobjekts über eine Anwendungsdomänengrenze hinweg.</span><span class="sxs-lookup"><span data-stu-id="7072a-127">For example, the serialization of the transaction object across an application domain boundary.</span></span> <span data-ttu-id="7072a-128">Das Transaktionsobjekt wird als Wert gemarshallt, und dies bedeutet, dass das Transaktionsobjekt serialisiert wird, sobald es über eine Anwendungsdomänengrenze (auch im gleichen Prozess) hinweg übergeben werden soll.</span><span class="sxs-lookup"><span data-stu-id="7072a-128">The transaction object is marshaled-by-value, meaning that any attempt to pass it across an application domain boundary (even in the same process) results in serialization of the transaction object.</span></span> <span data-ttu-id="7072a-129">Sie können Transaktionsobjekte übergeben, indem Sie eine Remotemethode aufrufen, die ein <xref:System.Transactions.Transaction>-Objekt als Parameter übernimmt, oder Sie können versuchen, auf eine Remotekomponente zuzugreifen, die von einer Transaktion bedient wird.</span><span class="sxs-lookup"><span data-stu-id="7072a-129">You can pass the transaction objects by making a call on a remote method that takes a <xref:System.Transactions.Transaction> as a parameter or you can try to access a remote transactional-serviced component.</span></span> <span data-ttu-id="7072a-130">Dadurch wird das Transaktionsobjekt serialisiert und genauso eskaliert, wie in dem Fall, in dem die Transaktion über eine Anwendungsdomäne hinweg serialisiert wird.</span><span class="sxs-lookup"><span data-stu-id="7072a-130">This serializes the transaction object and results in an escalation, as when a transaction is serialized across an application domain.</span></span> <span data-ttu-id="7072a-131">Es wird verteilt, und der lokale Transaktions-Manager ist nicht mehr geeignet.</span><span class="sxs-lookup"><span data-stu-id="7072a-131">It is being distributed and the local transaction manager is no longer adequate.</span></span>  
  
 <span data-ttu-id="7072a-132">In der folgenden Tabelle werden alle möglichen Ausnahmen aufgelistet, die während der Eskalation ausgelöst werden können.</span><span class="sxs-lookup"><span data-stu-id="7072a-132">The following table lists all the possible exceptions that can be thrown during escalation.</span></span>  
  
|<span data-ttu-id="7072a-133">Ausnahmetyp</span><span class="sxs-lookup"><span data-stu-id="7072a-133">Exception type</span></span>|<span data-ttu-id="7072a-134">Bedingung</span><span class="sxs-lookup"><span data-stu-id="7072a-134">Condition</span></span>|  
|--------------------|---------------|  
|<xref:System.InvalidOperationException>|<span data-ttu-id="7072a-135">Es wurde versucht, eine Transaktion mit einer Isolationsebene von <xref:System.Transactions.IsolationLevel.Snapshot> zu eskalieren.</span><span class="sxs-lookup"><span data-stu-id="7072a-135">An attempt to escalate a transaction with isolation level equal to <xref:System.Transactions.IsolationLevel.Snapshot>.</span></span>|  
|<xref:System.Transactions.TransactionAbortedException>|<span data-ttu-id="7072a-136">Der Transaktions-Manager ist nicht aktiv.</span><span class="sxs-lookup"><span data-stu-id="7072a-136">The transaction manager is down.</span></span>|  
|<xref:System.Transactions.TransactionException>|<span data-ttu-id="7072a-137">Die Eskalation schlägt fehl, und die Anwendung wird abgebrochen.</span><span class="sxs-lookup"><span data-stu-id="7072a-137">The escalation fails and the application is aborted.</span></span>|
