---
title: Migrationsprobleme in .NET Framework 4
ms.date: 05/02/2017
helpviewer_keywords:
- .NET Framework 4, migration
- application compatibility
ms.assetid: df478548-8c05-4de2-8ba7-adcdbe1c2a60
ms.openlocfilehash: 200acea81b9f00c659ddceae011430983e2b5f5b
ms.sourcegitcommit: c91110ef6ee3fedb591f3d628dc17739c4a7071e
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/15/2020
ms.locfileid: "81389723"
---
# <a name="net-framework-4-migration-issues"></a>Migrationsprobleme in .NET Framework 4

In diesem Artikel werden Migrationsprobleme zwischen .NET Framework Version 3.5 Service Pack 1 und .NET Framework 4 beschrieben. Dabei werden auch Probleme aufgrund von Programmfehlerbehebungen, Änderungen zur Einhaltung von Standards und zur Gewährleistung der Sicherheit sowie Änderungen auf Grundlage von Kundenfeedback besprochen. Für die meisten dieser Änderungen sind keine Programmieränderungen in den Anwendungen erforderlich. Falls Änderungen erforderlich sind, finden Sie entsprechende Informationen in der Tabellenspalte **Empfohlene Änderungen**. Relevante Änderungen werden nach Bereich untergliedert, z.B. für ASP.NET und Windows Presentation Foundation (WPF).

Einen allgemeineren Überblick über die in diesem Artikel behandelten Probleme finden Sie im [Leitfaden zur Migration zu .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff657133%28v=vs.100%29).

Informationen zu neuen Features finden Sie unter [Neuerungen in .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms171868%28v=vs.100%29).

## <a name="aspnet-and-web"></a>ASP.NET und Web

Namespaces: <xref:System.Web>, <xref:System.Web.Mobile>, <xref:System.Web.Security>, <xref:System.Web.UI.WebControls>

Assembly: System.Web (in „System.Web.dll“)

| Feature  | Unterschiede zu 3.5 SP1 | Empfohlene Änderungen |
| -------- | ------------------------ | ------------------- |
| **Browserdefinitionsdateien** | Die Browserdefinitionsdateien wurden aktualisiert und enthalten jetzt Informationen zu neuen und aktualisierten Browsern und Geräten. Ältere Browser und Geräte wie Netscape Navigator wurden entfernt und neuere Browser und Geräte wie Google Chrome und Apple iPhone hinzugefügt.<br><br>Wenn Ihre Anwendung benutzerdefinierte Browserdefinitionen enthält, die von einer der entfernten Browserdefinitionen erben, wird ein Fehler angezeigt.<br><br>Das <xref:System.Web.HttpBrowserCapabilities>-Objekt (von der `Request.Browse`-Eigenschaft der Seite verfügbar gemacht) wird durch die Browserdefinitionsdateien gesteuert. Aus diesem Grund können die Informationen, die durch den Zugriff auf eine Eigenschaft dieses Objekts in ASP.NET 4 zurückgegeben werden, von den Informationen abweichen, die in einer früheren Version von ASP.NET zurückgegeben wurden. | Wenn Ihre Anwendung auf den alten Browserdefinitionsdateien basiert, können Sie diese aus dem folgenden Ordner kopieren:<br><br>*Windows\\Microsoft.NET\\Framework\\v2.0.50727\\CONFIG\\Browser*<br><br>Kopieren Sie die Dateien in den entsprechenden Ordner *\\CONFIG\\Browser* für ASP.NET 4. Führen Sie nach dem Kopieren der Dateien das Befehlszeilentool [Aspnet_regbrowsers.exe](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms229858(v=vs.90)) aus. Weitere Informationen finden Sie auf der Website [https://www.asp.net/mobile](/aspnet/mobile/overview). |
| **Untergeordnete Anwendungen werden unter Mischversionen von ASP.NET ausgeführt** | ASP.NET 4-Anwendungen, die als untergeordnete Anwendungen konfiguriert wurden, die frühere Versionen von ASP.NET ausführen, können möglicherweise aufgrund von Konfigurations- oder Kompilierungsfehlern nicht starten. Der genauen Fehler, der auftritt, hängt davon ab, ob die Anwendung unter IIS 6.0 oder unter IIS 7 oder IIS 7.5 ausgeführt wird. | An den Konfigurationsdateien der betroffenen Anwendungen lassen sich Änderungen vornehmen, damit das Konfigurationssystem die ASP.NET 4-Anwendung ordnungsgemäß erkennt. Informationen zu den Änderungen, die Sie vornehmen müssen, finden Sie auf der ASP.NET-Website im Dokument [ASP.NET 4 Breaking Changes (Grundlegende Änderungen in ASP.NET 4 )](/aspnet/whitepapers/aspnet4/breaking-changes) im Abschnitt „ASP.NET 4 Child Applications Fail to Start When Under ASP.NET 2.0 or ASP.NET 3.5 Applications“ (Untergeordnete ASP.NET 4-Anwendungen können unter ASP.NET 2.0 oder ASP.NET 3.5-Anwendungen nicht gestartet werden). |
| **Änderungen an der ClientID** | Mit der neuen `clientIDMode`-Einstellung in ASP.NET 4 haben Sie die Möglichkeit anzugeben, wie ASP.NET das `id`-Attribut für HTML-Elemente generiert. In früheren Versionen von ASP.NET entsprach das Standardverhalten der `AutoID`-Einstellung von `clientIDMode`. Die Standardeinstellung ist jetzt `Predictable`. Weitere Informationen finden Sie unter [Steuerelementidentifikation in Web Forms](https://docs.microsoft.com/previous-versions/aspnet/1d04y8ss%28v=vs.100%29). | Wenn Sie Ihre Anwendung mit Visual Studio von ASP.NET 2.0 oder ASP.NET 3.5 aktualisieren, fügt das Tool der Datei „Web.config“ automatisch eine Einstellung hinzu, die das Verhalten früherer Versionen von .NET Framework beibehält. Wenn Sie für eine Anwendung jedoch ein Upgrade durchführen, indem Sie .NET Framework 4 als Ziel für den Anwendungspool in IIS festlegen, verwendet ASP.NET standardmäßig den neuen Modus. Um den neuen Client-ID-Modus zu deaktivieren, fügen Sie die folgende Einstellung in der Datei „Web.config“ hinzu:<br><br>`<pages clientIDMode="AutoID" />` |
| **Codezugriffssicherheit (Code Access Security, CAS)** | ASP.NET 2.0-Funktionen, die in ASP.NET 3.5 hinzugefügt wurden, verwenden das Codezugriffssicherheitsmodell (CAS) von .NET Framework 1.1 und .NET Framework 2.0. Die Implementierung von CAS wurde in ASP.NET 4 aber erheblich überholt. Daher können teilweise vertrauenswürdige ASP.NET-Anwendungen, die vertrauenswürdigen Code verwenden, der im globalen Assemblycache ausgeführt wird, mit verschiedenen Sicherheitsausnahmen Fehler auslösen. Teilweise vertrauenswürdige Anwendungen, die umfangreiche Änderungen an den CAS-Richtlinien des Computers verwenden, lösen möglicherweise auch Fehler und Sicherheitsausnahmen aus. | Sie können das Verhalten von teilweise vertrauenswürdigen ASP.NET 4-Anwendungen auf das von ASP.NET 1.1 und 2.0 zurücksetzen. Nutzen Sie dazu das neue `legacyCasModel`-Attribut im `trust`-Konfigurationselement, wie im folgenden Beispiel gezeigt:<br><br>`<trust level= "Medium" legacyCasModel="true" />`<br><br>Wichtig: Eine Zurücksetzung auf ein älteres CAS-Modell bringt möglicherweise Sicherheitseinschränkungen mit sich.<br><br>Weitere Informationen zu dem neuen ASP.NET 4-Modell für Codezugriffssicherheit finden Sie unter [Codezugriffssicherheit für ASP.NET 4-Anwendungen](https://docs.microsoft.com/previous-versions/dd984947(v=vs.100)). |
| **Konfigurationsdateien** | Die Stammkonfigurationsdateien für .NET Framework und ASP.NET 4 (die Datei „machine.config“ und die Stammdatei „Web.config“) wurden aktualisiert und enthalten jetzt die meisten Standardkonfigurationsinformationen aus den Web.config-Dateien in ASP.NET 3.5. Wegen der Komplexität von verwalteten IIS 7 und IIS 7.5-Konfigurationssystemen kann die Ausführung von ASP.NET 3.5-Anwendungen unter ASP.NET 4 sowie unter IIS 7 und IIS 7.5 entweder ASP.NET-Fehler oder IIS-Fehler hervorrufen. | Aktualisieren Sie ASP.NET 3.5-Anwendungen mithilfe der Upgrade-Tools für Projekte in Visual Studio auf ASP.NET 4. Visual Studio 2010 ändert die „Web.config“-Datei der ASP.NET 3.5-Anwendung automatisch, sodass sie die entsprechenden Einstellungen für ASP.NET 4 enthält.<br><br>ASP.NET 3.5-Anwendungen lassen sich aber auch ohne Neukompilierung mit .NET Framework 4 ausführen. Dazu müssen Sie die Datei „Web.config“ der Anwendung möglicherweise manuell ändern, bevor die Anwendung unter .NET Framework 4 und IIS 7 oder IIS 7.5 ausgeführt wird. Die Änderung, die Sie vornehmen müssen, hängt von der Softwarekombination (einschließlich der Service Pack-Versionen (SP)) ab, mit der Sie arbeiten. Informationen zu den möglichen Softwarekombinationen, die dieser Änderung betroffen sind, finden Sie auf der ASP.NET-Website im Dokument [ASP.NET 4 Breaking Changes](/aspnet/whitepapers/aspnet4/breaking-changes) im Abschnitt „Configuration Errors Related to New ASP.NET 4 Root Configuration“ (Konfigurationsfehler im Zusammenhang mit der neuen ASP.NET 4-Stammkonfiguration). |
| **Rendern von Steuerelementen** | In früheren Versionen von ASP.NET haben einige Steuerelemente Markup ausgegeben, das nicht deaktiviert werden konnte. Diese Art von Markup wird in ASP.NET 4 standardmäßig nicht mehr generiert. Die Renderingänderungen wirken sich auf die folgenden Steuerelemente aus:<br><br>* Die Steuerelemente `Image` und `ImageButton` rendern das Attribut `border="0"` nicht mehr.<br>* Die `BaseValidator`-Klasse und die Validierungssteuerelemente, die sich davon ableiten, rendern standardmäßig keinen rot formatierten Text mehr.<br>* Das Steuerelement `HtmlForm` rendert kein `name`-Attribut.<br>* Das Steuerelement `Table` rendert nicht mehr das Attribut `border="0"`.<br><br>Steuerelemente, die nicht für Benutzereingaben entworfen wurden (z.B. das Steuerelement `Label`), rendern nicht mehr das Attribut `disabled="disabled"`, wenn ihre `Enabled`-Eigenschaftensatz auf `false` festgelegt ist (oder wenn sie diese Einstellung von einem Containersteuerelement erben). | Wenn Sie ein Upgrade Ihrer Anwendung mit Visual Studio von ASP.NET 2.0 oder ASP.NET 3.5 vornehmen, fügt das Tool der Datei „Web.config“ automatisch eine Einstellung hinzu, die das Legacyrendering beibehält. Wenn Sie für eine Anwendung jedoch ein Upgrade durchführen, indem Sie .NET Framework 4 als Ziel für den Anwendungspool in IIS festlegen, verwendet ASP.NET standardmäßig den neuen Renderingmodus. Um den neuen Renderingmodus zu deaktivieren, fügen Sie die folgende Einstellung in der Datei „Web.config“ hinzu:<br><br>`<pages controlRenderingCompatibilityVersion="3.5" />` |
| **Ereignishandler in Standarddokumenten** | ASP.NET 4 rendert den `action`-Attributwert des HTML-Formularelements (`form`-Element) als eine leere Zeichenfolge, wenn eine Anforderung an eine URL ohne Erweiterung erfolgt, der ein Standarddokument zugeordnet wurde. In früheren Versionen von ASP.NET folgte aus einer Anforderung an `http://contoso.com` eine Anforderung an „Default.aspx“. In diesem Dokument wurde das öffnende `form`-Tag wie im folgenden Beispiel gerendert:<br><br>`<form action="Default.aspx" />`<br><br>In ASP.NET 4 folgt aus einer Anforderung an `http://contoso.com` auch eine Anforderung an „Default.aspx“, allerdings rendert ASP.NET jetzt auch das öffnende HTML-`form`-Tag, wie im folgenden Beispiel gezeigt:<br><br>`<form action="" />`<br><br>Wenn das `action`-Attribut eine leere Zeichenfolge ist, erstellt das IIS-`DefaultDocumentModule`-Objekt eine untergeordnete Anforderung an „Default.aspx“. In den meisten Situationen ist diese untergeordnete Anforderung für Anwendungscode transparent, und die Seite „Default.aspx“ wird normal ausgeführt. Allerdings kann eine mögliche Interaktion zwischen verwaltetem Code und IIS 7 oder IIS 7.5 im integrierten Modus dazu führen, dass verwaltete ASPX-Seiten während der untergeordnete Anforderung nicht mehr ordnungsgemäß ausgeführt werden. Unter den folgenden Umständen ruft die untergeordnete Anforderung an ein standardmäßiges ASPX-Dokument einen Fehler oder unerwartetes Verhalten hervor:<br><br>* Eine ASPX-Seite wird an den Browser gesendet, wobei der `action`-Attributsatz des `form`-Elements auf "" festgelegt ist.<br>* Das Formular wird an ASP.NET zurückgesendet.<br>* Ein verwaltetes HTTP-Modul liest einen Teil des Einheitstextkörpers, z.B. `Request.Form` oder `Request.Params`. Aus diesem Grund wird der Einheitstextkörper der POST-Anforderung im verwalteten Arbeitsspeicher gelesen. Der Einheitstextkörper ist daher nicht mehr für native Codemodule verfügbar, die in IIS 7 oder IIS 7.5 im integrierten Modus ausgeführt werden.<br>* Das IIS-`DefaultDocumentModule`-Objekt wird schließlich ausgeführt und erstellt eine untergeordnete Anforderung an das Dokument „Default.aspx“. Da der Einheitstextkörper bereits von verwaltetem Code gelesen wurde, kann kein Einheitstextkörper an die untergeordnete Anforderung gesendet werden.<br>* Wenn die HTTP-Pipeline für die untergeordnete Anforderung ausgeführt wird, wird der Handler für ASPX-Dateien während der Handlerausführungsphase ausgeführt.<br><br>Da kein Einheitstextkörper verfügbar ist, gibt es auch keine Formularvariablen und keinen Ansichtszustand. Aus diesem Grund hat der ASPX-Seitenhandler keine Informationen dazu, welches Ereignis (sofern vorhanden) ausgelöst werden soll. Daher werden keine Postback-Ereignishandler für die betroffene ASPX-Seite ausgeführt. | Informationen zur Umgehung von Problemen, die aufgrund der Änderung auftreten können, finden Sie auf der ASP.NET-Website im Dokument [ASP.NET 4 Breaking Changes](/aspnet/whitepapers/aspnet4/breaking-changes) unter „Event Handlers Might Not Be Not Raised in a Default Document in IIS 7 or IIS 7.5 Integrated Mode“ (Ereignishandler wird in einem Standarddokument im integrierten Modus in IIS 7 oder IIS 7.5 möglicherweise nicht ausgelöst). |
| **Hashalgorithmus** | ASP.NET verwendet sowohl Verschlüsselung als auch Hashalgorithmen, um Daten wie Formularauthentifizierungscookies und den Ansichtsstatus zu sichern. Bei Hashvorgängen für Cookies und den Ansichtszustand verwendet ASP.NET 4 standardmäßig den Algorithmus <xref:System.Security.Cryptography.HMACSHA256>. Frühere Versionen von ASP.NET haben die älteren Algorithmus <xref:System.Security.Cryptography.HMACSHA1> verwendet. | Für Anwendungen, die ASP.NET 2.0 und ASP.NET 4 kombinieren und in denen Daten wie Formularauthentifizierungscookies in verschiedenen .NET Framework-Versionen unterstützt werden müssen, können Sie eine ASP.NET 4 Web-Anwendung mit dem älteren <xref:System.Security.Cryptography.HMACSHA1>-Algorithmus konfigurieren, indem Sie die folgende Einstellung in der Datei „Web.config“ hinzufügen:<br><br>`<machineKey validation="SHA1" />` |
| **Hosten von Steuerelementen in Internet Explorer** | Windows Forms-Steuerelemente können nicht mehr in Internet Explorer gehostet werden, weil es bessere Lösungen für das Hosten von Steuerelementen im Web gibt. Daher wurden die Assemblys „IEHost.dll“ und „IEExec.exe“ aus .NET Framework entfernt. | Mithilfe der folgenden Technologien lassen sich Steuerelement in Webanwendungen benutzerdefiniert entwickeln:<br><br>* Sie können eine Silverlight-Anwendung erstellen und sie so konfigurieren, dass sie außerhalb des Browsers ausgeführt wird. Weitere Informationen finden Sie unter [Out-of-Browser Support (Out-of-Browser-Unterstützung)](https://docs.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/dd550721%28v=vs.95%29).<br>* Sie haben die Möglichkeit, eine XAML-Browseranwendung (XBAP) zu erstellen, um WPF-Funktionen zu nutzen (erfordert .NET Framework auf Clientcomputern). Weitere Informationen finden Sie unter [Übersicht über WPF-XAML-Browseranwendungen](../wpf/app-development/wpf-xaml-browser-applications-overview.md). |
| **Die Methoden „HtmlEncode“ und „UrlEncode“** | Die Methoden `HtmlEncode` und `UrlEncode` der Klassen <xref:System.Web.HttpUtility> und <xref:System.Web.HttpServerUtility> wurden aktualisiert und codieren das einfache Anführungszeichen (') jetzt wie folgt:<br><br>* Die Methode `HtmlEncode` codiert Instanzen von einfachen Anführungszeichen mit `&#39;`.<br>* Die Methode `UrlEncode` codiert Instanzen von einfachen Anführungszeichen mit `%27`. | Überprüfen Sie Ihren Code auf die Methoden `HtmlEncode` und `UrlEncode`, und achten Sie darauf, dass die Änderung der Codierung keine Auswirkungen auf Ihre Anwendung hat. |
| **HttpException-Fehler in ASP.NET 2.0-Anwendungen** | Nachdem ASP.NET 4 für IIS 6 aktiviert wurde, generieren ASP.NET 2.0-Anwendungen, die auf IIS 6 (entweder unter Windows Server 2003 oder Windows Server 2003 R2) ausgeführt werden, möglicherweise Fehler wie den folgenden: `System.Web.HttpException: Path '/[yourApplicationRoot]/eurl.axd/[Value]' was not found.` | * Wenn ASP.NET 4 nicht erforderlich ist, um die Website auszuführen, ordnen Sie die Website ASP.NET 2.0 neu zu.<br><br>- oder -<br><br>* Wenn ASP.NET 4 für die Ausführung der Website erforderlich ist, verschieben Sie alle untergeordneten virtuellen ASP.NET 2.0-Verzeichnisse auf eine andere Website, die ASP.NET 2.0 zugeordnet ist.<br><br>- oder -<br><br>* Deaktivieren Sie URLs ohne Erweiterung. Weitere Informationen finden Sie auf der ASP.NET-Website im Dokument [ASP.NET 4 Breaking Changes](/aspnet/whitepapers/aspnet4/breaking-changes) unter „ASP.NET 2.0 Applications Might Generate HttpException Errors That Reference eurl.axd“ (ASP.NET 2.0-Anwendungen generieren möglicherweise HttpException-Fehler, die auf eurl.axd verweisen). |
| **Mitgliedschaftstypen** | Einige Typen (z.B. <xref:System.Web.Security.MembershipProvider>) der ASP.NET-Mitgliedschaft wurden aus der Assembly „System.Web.dll“ in „System.Web.ApplicationServices.dll“ verschoben. So sollten architektonische Schichtabhängigkeiten zwischen Typen im Client und erweiterten .NET Framework-SKUs gelöst werden. | Klassenbibliotheken, die von früheren Versionen von ASP.NET upgegradet wurden und Mitgliedschaftstypen verwenden, die verschoben wurden, können in einem ASP.NET 4-Projekt möglicherweise nicht kompiliert werden. Wenn dies der Fall ist, fügen Sie im Klassenbibliotheksprojekt „System.Web.ApplicationServices.dll“ einen Verweis hinzu. |
| **Änderungen an Menüsteuerelementen** | Änderungen am Steuerelement <xref:System.Web.UI.WebControls.Menu> rufen das folgende Verhalten hervor:<br><br>* Wenn <xref:System.Web.UI.WebControls.MenuRenderingMode> auf `List` festgelegt ist, oder wenn <xref:System.Web.UI.WebControls.MenuRenderingMode> auf `Default` und <xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> auf `4.0` oder höher festgelegt ist, hat die Eigenschaft <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> keine Auswirkungen.<br>* Wenn der Pfad, der in den Eigenschaften <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> und <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> festgelegt wird, einen umgekehrten Schrägstrich (\\) enthält, werden die Bilder nicht gerendert. (In früheren Versionen von ASP.NET durfte der Pfad einen umgekehrten Schrägstrich enthalten.) | * Anstatt die Eigenschaft <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> für einzelne Menüelemente festzulegen, sollten Sie <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> oder <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> des übergeordneten <xref:System.Web.UI.WebControls.Menu>-Steuerelements festlegen.<br><br>- oder -<br><br>Legen Sie <xref:System.Web.UI.WebControls.MenuRenderingMode> auf `Table` fest, oder legen Sie <xref:System.Web.UI.WebControls.MenuRenderingMode> auf `Default` und <xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> auf `3.5` fest. Aufgrund dieser Einstellungen verwendet das <xref:System.Web.UI.WebControls.Menu>-Steuerelement das tabellenbasierte HTML-Layout, das in früheren Versionen von ASP.NET verwendet wurde.<br>* Wenn der Pfad in den Eigenschaften <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> oder <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> einen umgekehrten Schrägstrich (\\) enthält, ersetzen Sie ihn durch einen Schrägstrich (/). |
| **Mobile Assembly in der Datei „Web.config“** | In früheren Versionen von ASP.NET war unter `system.web`/`compilation` im Abschnitt `assemblies` in der Stammdatei „Web.config“ ein Verweis auf die Assembly „System.Web.Mobile.dll“ enthalten. Um die Leistung zu verbessern, wurde der Verweis auf diese Assembly entfernt.<br><br>Hinweis: Die Assembly „System.Web.Mobile.dll“ und mobile ASP.NET-Steuerelemente sind in ASP.NET 4 enthalten, aber veraltet. | Wenn Sie die Typen aus dieser Assembly verwenden möchten, fügen Sie in der „Web.config“-Stammdatei oder in einer „Web.config“-Anwendungsdatei einen Verweis auf die Assembly hinzu. |
| **Ausgabezwischenspeicherung** | Aufgrund eines Fehlers in ASP.NET 1.0 haben zwischengespeicherte Seiten mit der Einstellung `Location="ServerAndClient"` für die Ausgabenzwischenspeicherung einen `Vary:*`-HTTP-Header in der Antwort ausgegeben. So wurde Clientbrowsern mitgeteilt, dass Seiten nie lokal zwischengespeichert werden sollen. In ASP.NET Version 1.1 wurde die Methode <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> hinzugefügt, um aufgerufen werden kann, um den `Vary:*`-Header zu unterdrücken. Allerdings legen Problemberichte nahe, dass Entwickler keine Kenntnis von dem `SetOmitVaryStar`-Verhalten haben.<br><br>In ASP.NET 4 wird der `Vary:*`-HTTP-Header nicht mehr in Antworten ausgegeben, die folgende Anweisung angeben:<br><br>`<%@ OutputCache Location="ServerAndClient" %>`<br><br>Daher wird die Methode <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> nicht mehr benötigt, um den `Vary:*`-Header zu unterdrücken. In Anwendungen, die für das `Location`-Attribut „ServerAndClient“ angeben, können Seiten im Browser zwischengespeichert werden, ohne dass <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> aufgerufen werden muss. | Wenn Seiten in der Anwendung `Vary:*` ausgeben müssen, rufen Sie die Methode <xref:System.Web.HttpResponse.AppendHeader%2A> wie im folgenden Beispiel dargestellt auf:<br><br>`System.Web.HttpResponse.AppendHeader("Vary","*");`<br><br>Alternativ können Sie den Wert des `Location`-Attribut der Ausgabezwischenspeicherung in „Server“ ändern. |
| **Seitenanalyse** | Der Seitenparser für ASP.NET-Webseiten (ASPX-Dateien) und -Benutzersteuerelemente (ASCX-Dateien) ist in ASP.NET 4 strenger und kennzeichnet mehr Markup als in früheren Versionen als ungültig als in früheren Versionen. | Nehmen wir z.B. die Fehlermeldungen, die bei der Ausführung einer Seite erstellt werden, und Fehler, die von ungültigem Markup hervorgerufen werden. |
| **Passport-Typen** | Die in ASP.NET 2.0 integrierte Unterstützung für Passport ist veraltet und aufgrund von Änderungen in Passport (jetzt Live ID SDK) wird die Unterstützung nicht weitergeführt. Daher werden die Typen im Zusammenhang mit Passport in <xref:System.Web.Security> jetzt mit dem `ObsoleteAttribute`-Attribut markiert. | Ändern Sie jeglichen Code, der Passport-Typen im <xref:System.Web.Security>-Namespace verwendet (beispielsweise <xref:System.Web.Security.PassportIdentity>), um das Windows Live ID SDK zu verwenden. |
| **PathInfo-Informationen in der FilePath-Eigenschaft** | In ASP.NET 4 ist der `PathInfo`-Wert nicht mehr in den Rückgabewerten von Eigenschaften wie <xref:System.Web.HttpRequest.FilePath>, <xref:System.Web.HttpRequest.AppRelativeCurrentExecutionFilePath> und <xref:System.Web.HttpRequest.CurrentExecutionFilePath> enthalten. Die `PathInfo`-Informationen sind stattdessen in <xref:System.Web.HttpRequest.PathInfo> verfügbar. Nehmen wir z.B. das folgenden URL-Fragment:<br><br>`/testapp/Action.mvc/SomeAction`<br><br>In früheren Versionen von ASP.NET hatten <xref:System.Web.HttpRequest>-Eigenschaften die folgenden Werte:<br><br>* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc/SomeAction`<br>* <xref:System.Web.HttpRequest.PathInfo>: (leer)<br><br>In ASP.NET 4 haben <xref:System.Web.HttpRequest>-Eigenschaften stattdessen die folgenden Werte:<br><br>* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc`<br>* <xref:System.Web.HttpRequest.PathInfo>: `SomeAction` | Prüfen Sie den Code darauf, ob Eigenschaften der <xref:System.Web.HttpRequest>-Klasse verwendet werden, um Pfadinformationen zurückgeben. Ändern Sie ggf. im Code die Art und Weise, wie Pfadinformationen zurückgegeben werden. |
| **Anforderungsvalidierung** | Um die Anforderungsvalidierung zu verbessern, wird die ASP.NET-Anforderungsvalidierung früher im Lebenszyklus aufgerufen. Daher wird die Anforderungsvalidierung für Anforderungen ausgeführt, die nicht an ASPX-Dateien gerichtet sind, z.B. für Aufrufe des Webdiensts und benutzerdefinierte Handler. Die Anforderungsvalidierung wird auch aktiv, wenn benutzerdefinierte HTTP-Module in der Pipeline zur Anforderungsverarbeitung ausgeführt werden.<br><br>Aufgrund der Änderung lösen Anforderungen von anderen Ressourcen als ASPX-Dateien unter Umständen Anforderungsvalidierungsfehler aus. Benutzerdefinierter Code, der in der Anforderungspipeline ausgeführt wird (z.B. benutzerdefinierte HTTP-Module), kann auch Anforderungsvalidierungsfehler auslösen. | Bei Bedarf können Sie das alte Verhalten wiederherstellen, bei dem nur ASPX-Seiten die Anforderungsvalidierung mithilfe der folgenden Einstellung in der Webkonfigurationsdatei auslösen:<br><br>`<httpRuntime requestValidationMode="2.0" />`<br><br>Warnung: Wenn Sie das alte Verhalten wiederherstellen, vergewissern Sie sich, dass der gesamte Code im vorhandenen Handler, in Modulen und in anderem benutzerdefinierten Code auf potenziell unsichere HTTP-Eingaben prüft, die XSS-Angriffsvektor sein können. |
| **Routing** | Wenn Sie eine Dateisystemwebsite in Visual Studio 2010 erstellen und die Website sich in einen Ordner mit einem Punkt (.) im Ordnernamen befindet, funktioniert das URL-Routing nicht zuverlässig. Einige virtuelle Pfade geben einen HTTP 404-Fehler zurück. Dies tritt auf, weil Visual Studio 2010 den Visual Studio Development Server mit einem falschen Pfad für das virtuelle Stammverzeichnis startet. | * Ändern Sie auf der Seite **Eigenschaften** für die dateibasierte Website das Attribut **Virtueller Pfad** auf „/“.<br><br>- oder -<br><br>* Erstellen Sie ein Webanwendungsprojekt statt eines Websiteprojekts. In Webanwendungsprojekten tritt dieses Problem nicht auf, und das URL-Routing funktioniert, selbst wenn der Name des Projektordners einen Punkt enthält.<br><br>- oder -<br><br>* Erstellen Sie eine in IIS gehostete, HTTP-basierte-Website. Die virtuellen Pfade und Projektdateiordner können bei in IIS-gehosteten Websites auch Punkte enthalten. |
| **SharePoint-Websites** | Wenn Sie versuchen, eine ASP.NET 4-Website auszuführen, die als untergeordnetes Element einer SharePoint-Website bereitgestellt wird, die eine benutzerdefinierte, partielle Vertrauensebene namens `WSS_Minimal` enthält, wird die folgende Fehlermeldung angezeigt:<br><br>`Could not find permission set named 'ASP.Net'.` | Derzeit sind keine Versionen von SharePoint mit ASP.NET kompatibel. Daher sollten Sie nicht versuchen, eine ASP.NET 4-Website als untergeordnetes Element einer SharePoint-Website auszuführen. |
| **XHTML 1.1-Standards** | Damit neue Websites mit XHTML 1.1 kompatibel sind, generieren die ASP.NET-Steuerelemente in .NET Framework 4 XHTML 1.1-kompatibles HTML. Dieses Rendering wird mit der folgenden Option in der Datei „Web.config“ innerhalb der `<system.Web>`-Elements aktiviert:<br><br>`<pages controlRenderingCompatibilityVersion="4.0"/>`<br><br>Diese Option ist standardmäßig auf 4.0 festgelegt. In Webprojekten, für die ein Upgrade von Visual Studio 2008 ausgeführt wurde, ist die 3.5-Einstellung aus Kompatibilitätsgründen aktiviert. | Keine |

## <a name="core"></a>Kernspeicher

### <a name="general-features"></a>Allgemeine Funktionen

| Funktion | Unterschiede zu 3.5 SP1 | Empfohlene Änderungen |
| ------- | ------------------------ | ------------------- |
| **CardSpace** | Windows CardSpace ist nicht mehr in .NET Framework enthalten, sondern wird getrennt bereitgestellt. | Sie können CardSpace im [Microsoft Download Center](https://go.microsoft.com/fwlink/?LinkId=199868) herunterladen. |
| **Konfigurationsdateien** | Es wurden Korrekturen am Zugriff von .NET Framework auf Anwendungskonfigurationsdateien vorgenommen. | Wenn Ihre Anwendungskonfigurationsdatei *application-name.config* heißt, benennen Sie sie in *application-name.exe.config* um. Benennen Sie *MyApp.config* z.B. in *MyApp.exe.config* um. |
| **C#-Codecompiler** | Die Klassen `Compiler`, `CompilerError` und `ErrorLevel` aus dem <xref:Microsoft.CSharp>-Namespace sind nicht mehr verfügbar, und die zugehörige Assembly (cscompmgd.dll) ist nicht mehr in .NET Framework enthalten. | Verwenden Sie stattdessen die <xref:System.CodeDom.Compiler.CodeDomProvider>-Klasse und andere Klassen im <xref:System.CodeDom.Compiler>-Namespace. Weitere Informationen finden Sie unter [Verwenden von CodeDOM](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/y2k85ax6%28v=vs.100%29). |
| **Hosting** (nicht verwaltete API) | Um die Hostingfunktionen zu verbessern, wurden einige der Hosting-Aktivierungs-APIs als veraltet gekennzeichnet. Funktionen zur parallelen In-Process-Ausführung ermöglichen es Anwendungen, mehrere Versionen von .NET Framework im selben Prozess zu laden und zu starten. Sie haben z. B. die Möglichkeit, Anwendungen auszuführen, die auf .NET Framework 2.0 SP1 und auf .NET Framework 4 basierende Add-Ins (oder Komponenten) im selben Prozess laden. Ältere Komponenten verwenden weiterhin die ältere Version von .NET Framework, während neue Komponenten die neue Version verwenden. | Verwenden Sie die unter [Parallele In-Process-Ausführung](../deployment/in-process-side-by-side-execution.md) beschriebene Konfigurationen. |
| **Neues Sicherheitsmodell** | Die Codezugriffssicherheitsrichtlinie wurde deaktiviert und durch ein vereinfachtes Modell ersetzt, wie in [Änderungen der Sicherheit in .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd233103%28v=vs.100%29) beschrieben. | Wenn Sie in Ihren Anwendungen von CAS abhängen, sind Änderungen unter Umständen erforderlich. Weitere Informationen finden Sie unter [Kompatibilität und Migration von Richtlinien für die Codezugriffssicherheit](../misc/code-access-security-policy-compatibility-and-migration.md). |

### <a name="date-and-time"></a>Datum und Uhrzeit

Namespace: <xref:System>

Assembly: mscorlib (in „mscorlib.dll“)

| Feature | Unterschiede zu 3.5 SP1 | Empfohlene Änderungen |
| ------- | ------------------------ | ------------------- |
| **Sommerzeit** | Um Abweichungen von der Systemuhr zu vermeiden, verwenden Zeiteigenschaften (wie <xref:System.TimeZoneInfo.Local> und <xref:System.DateTime.Now>) nun Betriebssystemregeln anstelle von anderen .NET Framework-Daten für Vorgänge hinsichtlich Sommerzeit. | Keine |
| **Formatierungszeichenfolge** | Um die kulturabhängige Formatierung zu unterstützen, enthält die <xref:System.TimeSpan>-Struktur neue Überladungen der Methoden `ToString`, `Parse` und `TryParse` sowie `ParseExact` und `TryParseExact`. | Keine |

### <a name="globalization"></a>Globalisierung

Eine Liste der neuen neutralen und spezifischen Kulturen finden Sie unter [Neues bei der Globalisierung und Lokalisierung](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd997383%28v=vs.100%29).

Namespace: <xref:System.Globalization>

Assembly: mscorlib (in „mscorlib.dll“)

| Feature | Unterschiede zu 3.5 SP1 | Empfohlene Änderungen |
| ------- | ------------------------ | ------------------- |
| **Namen von Kulturen** | Die folgenden Namensänderungen wirken sich auf die deutsch- und Divehi-sprachigen sowie auf die afrikanischen Kulturen aus:<br><br>* <xref:System.Globalization.CultureAndRegionInfoBuilder.CurrencyEnglishName>: Der Währungsname für die Kultur „Deutsch (Schweiz)“ (de-CH) wurde von „sFr.“ in „Fr.“ geändert.<br>* <xref:System.Globalization.DateTimeFormatInfo.LongDatePattern>: Das lange Datumsmuster für die ethnische Gruppe „Divehi“ (Malediven) (dv-MV) wurde von „dd/MMMM/yyyy“ in „dd/MM/yyyy“ geändert.<br>* <xref:System.Globalization.DateTimeFormatInfo.PMDesignator>: Der PM- Kennzeichner der Kultur „Afrikaans (Südafrika)“ wurde von „nm“ in „PM“ geändert. | Beachten Sie die Namensänderungen für Kulturen. |
| **LICD-Parameter** | Damit das erwartete Verhalten in den Einstellungen des Automatisierungsserver auftritt, übergibt die CLR die aktuelle Kultur für den `LCID`-Parameter nicht mehr an nicht verwaltete COM-basierte Anwendungen. Stattdessen wird 1033 (en-US) für die Kultur übergeben. | Mit Ausnahme der nativen Anwendungen, die eine angegebene Kultur erfordern,sind keine Änderungen erforderlich. |
| **Veraltete Kulturtypen** | Die Kulturtypen <xref:System.Globalization.CultureTypes> und <xref:System.Globalization.CultureTypes> sind jetzt veraltet.<br><br>Aus Gründen der Abwärtskompatibilität gibt <xref:System.Globalization.CultureTypes> jetzt neutrale und spezifische Kulturen zurück, die in früheren .NET Framework-Versionen enthalten waren, und <xref:System.Globalization.CultureTypes> gibt jetzt eine leere Liste zurück. | Verwenden Sie andere Werte der <xref:System.Globalization.CultureTypes>-Enumeration. |
| **Abrufen einer Kultur** | Ab Windows 7 ruft .NET Framework 4 Kulturinformationen vom Betriebssystem ab, anstatt die Daten selbst zu speichern. Darüber hinaus synchronisiert .NET Framework die Sortierung und Groß-/Kleinschreibung von Daten mit Windows. | Keine |
| **Unicode 5.1-Standards** | .NET Framework unterstützt jetzt alle Unicode 5.1-Zeichen, d. h. ungefähr 1.400 zusätzliche Zeichen. Diese Zeichen umfassen neue Symbole, Pfeile, diakritische Zeichen, Satzzeichen, mathematische Symbolen, CJK-Querstriche und -Ideogramme, zusätzliche numerische Zeichen aus dem Malaiischen und Telugu sowie verschiedene myanmarische, lateinische, arabische, griechische, mongolische und kyrillische Zeichen. Die folgenden neuen Skripts werden mit Unicode 5.1 unterstützt: Sudanesisch, Lepcha, Ol Chiki, Vai, Saurashtra, Kayah Li, Rejang, Gurmukhi, Odia, Tamil, Telugu, Cham und malaiische Zeichen. | Keine |

### <a name="exceptions"></a>Ausnahmen

Namespaces: <xref:System>, <xref:System.Runtime.ExceptionServices>

Assembly: mscorlib (in „mscorlib.dll“)

| Feature | Unterschiede zu 3.5 SP1 | Empfohlene Änderungen |
| ------- | ------------------------ | ------------------- |
| **Ausnahmen für beschädigte Prozessstatus** | Die CLR übergibt keine Ausnahmen mehr für beschädigte Prozessstatus an Ausnahmehandler in verwaltetem Code. | Diese Ausnahmen deuten darauf hin, dass der Status eines Prozesses beschädigt wurde. Eine Ausführung Ihrer Anwendung in diesem Zustand ist nicht empfehlenswert.<br><br>Weitere Informationen finden Sie unter <xref:System.Runtime.ExceptionServices.HandleProcessCorruptedStateExceptionsAttribute> und im Eintrag [Handling Corrupted State Exceptions (Behandeln beschädigter Statusausnahmen)](https://docs.microsoft.com/archive/msdn-magazine/2009/february/clr-inside-out-handling-corrupted-state-exceptions) im MSDN-Magazin. |
| **Ausnahmen der Ausführungs-Engine** | <xref:System.ExecutionEngineException> ist jetzt veraltet, da der Prozess aufgrund einer abfangbaren Ausnahme weiterhin ausgeführt wird. Diese Änderung verbessert die Vorhersagbarkeit und Zuverlässigkeit in der Laufzeit. | Verwenden Sie <xref:System.InvalidOperationException>, um die Bedingung zu signalisieren. |

### <a name="reflection"></a>Spiegelung

Namespace: <xref:System.Reflection>

Assembly: mscorlib (in „mscorlib.dll“)

| Feature | Unterschiede zu 3.5 SP1 | Empfohlene Änderungen |
| ------- | ------------------------ | ------------------- |
| **Assembly-Hashalgorithmen** | Die Eigenschaft <xref:System.Reflection.AssemblyName.HashAlgorithm> gibt jetzt <xref:System.Configuration.Assemblies.AssemblyHashAlgorithm> zurück, da die Laufzeit den Hashalgorithmus der Assembly, auf die verwiesen wird, nicht kennt, wenn die Assembly nicht geladen wurde. (Dies bezieht sich auf die Verwendung der Eigenschaft für eine Assembly, auf die verwiesen wird, z.B. die von der <xref:System.Reflection.Assembly.GetReferencedAssemblies%2A>-Methode zurückgegebene.) | Keine |
| **Laden von Assemblys** | Um das redundante Laden von Assemblys zu vermeiden und den virtuellen Adressraum zu speichern, lädt die CLR nun Assemblys nur mit der Win32-`MapViewOfFile`-Funktion. Die `LoadLibrary`-Funktion wird nicht mehr zusätzlich aufgerufen.<br><br>Diese Änderung betrifft Diagnoseanwendungen auf die folgende Art und Weise:<br><br>* <xref:System.Diagnostics.ProcessModuleCollection> enthält keine Module aus einer Klassenbibliothek (DLL-Datei) mehr, wie aus einem Aufruf von `Process.GetCurrentProcess().Modules` abgerufen.<br>* Für Win32-Anwendungen, die die `EnumProcessModules`-Funktion verwenden, werden nicht alle verwalteten Module aufgeführt. | Keine |
| **Deklarierender Typ** | Die Eigenschaft <xref:System.Type.DeclaringType> gibt jetzt ordnungsgemäß NULL zurück, wenn der Typ keinen deklarierenden Typ hat. | Keine |
| **Delegaten** | Ein Delegat löst jetzt eine <xref:System.ArgumentNullException> statt einer <xref:System.NullReferenceException> aus, wenn ein NULL-Wert an den Konstruktor des Delegaten übergeben wird. | Stellen Sie sicher, dass jede Ausnahmebehandlung <xref:System.ArgumentNullException> abfängt. |
| **Änderung des Speicherorts des globalen Assemblycaches** | Für .NET Framework 4-Assemblys wurde der globale Assemblycache aus dem Windows-Verzeichnis (%WINDIR%) in das Unterverzeichnis „Microsoft.Net“ ( *%WINDIR%\\Microsoft.Net*) verschoben. Assemblys aus früheren Versionen bleiben im älteren Verzeichnis.<br><br>Die nicht verwaltete [ASM_CACHE_FLAGS](../unmanaged-api/fusion/asm-cache-flags-enumeration.md)-Enumeration enthält das neue `ASM_CACHE_ROOT_EX`-Flag. Dieses Flag ruft den Cachespeicherort für .NET Framework 4-Assemblys mit der Funktion [GetCachePath](../unmanaged-api/fusion/getcachepath-function.md) ab. | Keine, vorausgesetzt dass Anwendungen keine expliziten Pfade zu Assemblys verwenden (nicht empfohlen) |
| **Globaler Assemblycache (Tool)** | [Gacutil.exe (Global Assembly Cache-Tool)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ex0ss12c%28v=vs.100%29) unterstützt den Shell-Plug-In-Viewer nicht mehr. | Keine |

### <a name="interoperability"></a>Interoperabilität

Namespace: <xref:System.Runtime.InteropServices>

Assembly: mscorlib (in „mscorlib.dll“)

| Feature | Unterschiede zu 3.5 SP1 | Empfohlene Änderungen |
| ------- | ------------------------ | ------------------- |
| **Pufferlänge** (nicht verwaltete API) | Um Arbeitsspeicher zu sparen, wurde die Funktionalität des `pBufferLengthOffset`-Parameters für die [ICorProfilerInfo2::GetStringLayout](../unmanaged-api/profiling/icorprofilerinfo2-getstringlayout-method.md)-Methode geändert und entspricht jetzt dem `pStringLengthOffset`-Parameter. Beide Parameter zeigen jetzt auf die Offsetposition der Länge der Zeichenfolge. Die Pufferlänge wurde aus der Darstellung der Zeichenfolgenklasse entfernt. | Entfernen Sie alle Abhängigkeiten von der Pufferlänge. |
| **JIT-Debuggen** | Um die Registrierung für das Just-in-Time-Debuggen (JIT) zu vereinfachen, verwendet der .NET Framework-Debugger jetzt nur den AeDebug-Registrierungsschlüssel, der das JIT-Debuggingverhalten für nativen Code steuert. Diese Änderung hat folgende Auswirkungen:<br><br>* Sie können keine zwei verschiedenen Debugger mehr für verwalteten und nativen Code registrieren.<br>* Sie können den Debugger nicht mehr automatisch bei einem nicht interaktiven Prozess starten. Sie können Benutzer aber zu einem interaktiven Prozess auffordern.<br>* Sie werden nicht mehr benachrichtigt, wenn der Debugger nicht gestartet werden kann oder wenn es ist keinen registrierten Debugger gibt, der gestartet werden soll.<br>* Automatisch gestartete Richtlinien, die von der Interaktivität von der Anwendung abhängig sind, werden nicht mehr unterstützt. | Passen Sie Debuggingvorgänge nach Bedarf an. |
| **Plattformaufruf** | Um die Leistung der Interoperabilität mit nicht verwaltetem Code zu verbessern, rufen falsche Aufrufkonventionen bei einem Plattformaufruf jetzt einen Fehler in der Anwendung hervor. In früheren Versionen behoben hat die Marshalling-Ebene diese Fehler im Stapel gelöst. | Beim Debuggen Ihrer Anwendungen in Microsoft Visual Studio werden Sie auf diese Fehler aufmerksam gemacht, damit Sie sie korrigieren können.<br><br>Bei nicht aktualisierbaren Binärdateien kann das [\<NetFx40_PInvokeStackResilience>](../configure-apps/file-schema/runtime/netfx40-pinvokestackresilience-element.md)-Element in der Anwendungskonfigurationsdatei einschließen, damit aufrufende Fehler im Stapel wie in früheren Versionen gelöst werden können. Allerdings kann dies auf die Leistung Ihrer Anwendung auswirken. |
| **Entfernte Schnittstellen** (nicht verwaltete API) | Um Verwirrung bei den Entwicklern zu vermeiden, wurden die folgenden Schnittstellen entfernt, da sie keine nützlichen Szenarios bereitstellen und die CLR keine Implementierung bereitgestellt oder übernommen hat:<br><br>* **INativeImageINativeImageDependency**<br>* **INativeImageInstallInfo**<br>* **INativeImageEvaluate**<br>* **INativeImageConverter**<br>* **ICorModule**<br>* **IMetaDataConverter** | Keine |

## <a name="data"></a>Daten

In diesem Abschnitt werden Migrationsprobleme bei der Verwendung von Datasets und SQL-Clients, dem Entity Framework, LINQ to SQL und WCF-Datenservern (früher bekannt als ADO.NET Data Services) beschrieben.

### <a name="dataset-and-sql-client"></a>Dataset und SQL Client

Die folgende Tabelle beschreibt die verbesserten Funktionen, die zuvor Einschränkungen oder andere Probleme hatten.

Namespaces: <xref:System.Data>, <xref:System.Data.Objects.DataClasses>, <xref:System.Data.SqlClient>

Assemblys: System.Data (in „System.Data.dll“), System.Data.Entity (in „System.Data.Entity.dll“)

| Feature | Unterschiede zu 3.5 SP1 |
| ------- | ------------------------ |
| **POCO-Szenarios** | Die <xref:System.Data.Objects.DataClasses.IRelatedEnd>-Schnittstelle verfügt über neue Methoden, um die Benutzerfreundlichkeit in Plain Old CLR Object-Szenarios (POCO) zu verbessern. Diese neuen Methoden akzeptiert ein <xref:System.Object> statt einer <xref:System.Data.Objects.DataClasses.IEntityWithRelationships>-Entität als Parameter. |
| **Bearbeiten von Zeilen** | Die <xref:System.Collections.IList.IndexOf%2A>-Methode, wie von der <xref:System.Data.DataView>-Klasse implementiert, gibt den Wert einer bearbeiteten Zeile jetzt richtig zurück, statt -1 zurückzugeben. |
| **Ereignisse** | Das <xref:System.Data.DataRowView.PropertyChanged>-Ereignis wird jetzt ausgelöst, wenn sich eine Zeile in einem geänderten Zustand befindet und die <xref:System.Data.DataRow.RejectChanges%2A>-Methode aufgerufen wird. Diese Änderung erleichtert es, Benutzeroberflächen-Steuerelemente zu erstellen, die den Inhalt eines <xref:System.Data.DataSet>-Objekts verfügbar machen. |
| **Ausnahmen** | Die <xref:System.Data.SqlClient.SqlCommand.Prepare%2A>-Methode löst jetzt statt einer <xref:System.NullReferenceException> eine <xref:System.InvalidOperationException> aus, wenn eine Verbindung nicht festgelegt oder offen ist. |
| **Zuordnen von Ansichten** | Zuordnungsfehler in der Abfrageansicht werden jetzt zur Entwurfszeit abgefangen, statt zur Laufzeit eine <xref:System.NullReferenceException> auszulösen.<br><br>Die Zuordnungsvalidierung fängt den Fehler jetzt ab, bei dem zwei Zurodnungssätze in konzeptionelle Schemadefinitionssprache (CSDL) der gleichen Spalte zugeordnet sind. |
| **Transaktionen** | Wenn eine Anwendung versucht, eine Anweisung für eine Verbindung auszuführen, nachdem eine Transaktion abgeschlossen wurde (einschließlich Abbruch oder Rollback zurück), wird jetzt eine <xref:System.InvalidOperationException> ausgelöst. In Vorgängerversionen wurde keine Ausnahme ausgelöst, und Sie konnten zusätzliche Befehle ausführen, auch wenn eine Transaktion abgebrochen wurde. |

### <a name="entity-framework"></a>Entity Framework

Die folgende Tabelle beschreibt die verbesserten Funktionen, die zuvor Einschränkungen oder andere Probleme hatten.

Namespaces: <xref:System.Data>, <xref:System.Data.Objects>, <xref:System.Data.Objects.DataClasses>

Assemblys: System.Data.Entity (in „System.Data.Entity.dll“)

| Feature | Unterschiede zu 3.5 SP1 |
| ------- | ------------------------ |
| **Entitätsobjekte** | Es gibt nun Parität zwischen der <xref:System.Data.Objects.ObjectContext.Detach%2A>-Methode und der Status des Entitätsobjekts, wenn der <xref:System.Data.Objects.ObjectContext.SaveChanges%2A>-Methode aufgerufen wird. Diese verbesserte Konsistenz verhindert, dass unerwartete Ausnahmen ausgelöst werden. |
| **Entity SQL** | Die Regeln für die Auflösung von Bezeichnern in Entity SQL wurden verbessert.<br><br>Die Logik des Entity SQL-Parsers wurde für das Auflösen von mehrteiligen Bezeichnern verbessert. |
| **Strukturelle Anmerkungen** | Das Entity Framework erkennt jetzt strukturelle Anmerkungen. |
| **Abfragen** | Die folgenden Verbesserungen wurden in Abfragen vorgenommen:<br><br>* Eine `GroupBy`-Abfrage, die einen NULL-Schlüssel statt einer leeren Auflistung verwendet, wird keine Zeilen zurückgeben, unabhängig davon, ob in der Abfrage zusätzliche SELECT-Anweisungen vorhanden sind.<br>* Generierte SQL in LINQ- und Entity SQL-Abfragen behandeln Zeichenfolgenparameter jetzt standardmäßig als Nicht-Unicode-Werte. |

### <a name="linq-to-sql"></a>LINQ to SQL

Die folgende Tabelle beschreibt die verbesserten Funktionen, die zuvor Einschränkungen oder andere Probleme hatten.

Namespace: <xref:System.Data.Linq>

Assembly: System.Data.Linq (in „System.Data.Linq.dll“)

| Feature | Unterschiede zu 3.5 SP1 |
| ------- | ------------------------ |
| **Ereignisse** | Eine <xref:System.Data.Linq.EntitySet%601>-Sammlung löst jetzt das Ereignis <xref:System.Data.Linq.EntitySet%601.ListChanged> für die Vorgänge „Hinzufügen“ und „Entfernen“ aus, wenn <xref:System.Data.Linq.EntitySet%601> entladen und die Sammlung geladen wird. |
| **Abfragen** | `Skip(0)` wird in LINQ to SQL-Abfragen nicht mehr ignoriert. Abfragen, die diese Methode verwenden, können sich daher anders verhalten. In einigen Fällen ist eine `OrderBy`-Klausel mit `Skip(0)` erforderlich, und die Abfrage löst jetzt eine <xref:System.NotSupportedException>-Ausnahme aus, wenn die `OrderBy`-Klausel nicht enthalten war. |

### <a name="wcf-data-services"></a>WCF Data Services

Die folgende Tabelle beschreibt die verbesserten Funktionen, die zuvor Einschränkungen oder andere Probleme hatten.

Namespaces: <xref:System.Data.Services>, <xref:System.Data.Services.Client>, <xref:System.Data.Services.Common>, <xref:System.Data.Services.Providers>

Assemblys: System.Data.Services (in „System.Data.Services.dll“), System.Data.Services.Client (in „System.Data.Services.Client.dll“)

| Feature | Unterschiede zu 3.5 SP1 |
| ------- | ------------------------ |
| **Binärer Batchinhalt** | WCF Data Services unterstützt jetzt binären Batchinhalt in Anforderungen und-Antworten. |
| **Change-Interceptors** | Change-Interceptors werden nun für eine DELETE-Anforderung ausgeführt.<br><br>Ein Change-Interceptor ist eine Methode, die immer ausgeführt wird, wenn der Server die Anforderung empfängt, eine Entität in der Entitätenmenge zu ändern. Er wird ausgeführt, bevor die eingehende Anforderung ausgeführt wird. Der Change-Interceptor ermöglicht den Zugriff auf die Entität, die geändert wird, und den Vorgang, der ausgeführt wird. |
| **Ausnahmen** | Die folgenden Bedingungen lösen nun nützlichere Ausnahmen statt einer <xref:System.NullReferenceException> aus:<br><br>* Eine <xref:System.ServiceProcess.TimeoutException>, wenn beim Aufruf eines Datendiensts ein Timeout eintritt.<br>* Eine <xref:System.Data.Services.Client.DataServiceRequestException>, wenn eine ungültige Anforderung an einen Datendienst erfolgt.<br><br>Sie sollten in Ihren Anwendungen die Behandlung von Ausnahmen ändern, um die neue Ausnahmen abzufangen. |
| **Header** | Die folgenden Verbesserungen wurden in Headern vorgenommen:<br><br>* WCF Data Services lehnt einen `eTag`-Header, der einen nicht angegebenen Wert enthält, nun ordnungsgemäß ab.<br>* WCF Data Services gibt nun einen Fehler zurück und führt die Anforderung für eine DELETE-Anforderung zu einem Link nicht aus, wenn die Anforderung einen `if-*` Header enthält.<br>* WCF Data Services gibt nun an den Client einen Fehler im Format (Atom, JSON) zurück, das der Client im Accept-Header angegeben hat. |
| **JSON-Reader** | Der JavaScript Object Notation-Reader (JSON) gibt jetzt beim Lesen ordnungsgemäß einen Fehler zurück, wenn beim Verarbeiten von JSON-Nutzlasten, die an einen WCF Data Service gesendet wurden, ein einzelnes Escapezeichen, d.h. der umgekehrter Schrägstrich (\\) gelesen wird. |
| **Merges** | Die folgenden Verbesserungen wurden an der <xref:System.Data.Services.Client.MergeOption>-Enumeration vorgenommen:<br><br>* Die Mergeoption <xref:System.Data.Services.Client.MergeOption> ändert als Ergebnis einer nachfolgenden Antwort von einem Datendienst nicht mehr die Entität auf dem Client.<br>* Die Option <xref:System.Data.Services.Client.MergeOption> stimmt jetzt in dynamischen SQL-Anweisungen und in auf gespeicherten Prozeduren basierenden Updates überein. |
| **Anforderungen** | Die Methode <xref:System.Data.Services.DataService%601.OnStartProcessingRequest%2A> wird jetzt aufgerufen, bevor eine Anforderung an Datendienste verarbeitet wird. Dadurch funktioniert die Anforderung ordnungsgemäß für <xref:System.Data.Services.Providers.ServiceOperation>-Dienste. |
| **Streams** | WCF Data Services schließt nicht mehr den zugrunde liegenden Stream für Lese- und Schreibvorgänge. |
| **URIs** | Escapevorgänge des WCF Data Services-Clients für URIs wurde korrigiert. |

## <a name="windows-communication-foundation-wcf"></a>Windows Communication Foundation (WCF)

Die folgende Tabelle beschreibt die verbesserten Funktionen, die zuvor Einschränkungen oder andere Probleme hatten.

| Feature | Unterschiede zu 3.5 SP1 |
| ------- | ------------------------ |
| **Konfigurationsdateien** | Um die Vererbung von Verhalten über die Hierarchie der Konfigurationsdatei zu aktivieren, unterstützt WCF jetzt das konfigurationsdateiübergreifende Zusammenführen.<br><br>Das Vererbungsmodell für die Konfiguration wurde erweitert, sodass Benutzer Verhalten definieren können, die auf alle Dienste auf dem Computer angewendet werden.<br><br>Es kann zu Verhaltensänderungen kommen, wenn es auf unterschiedlichen Hierarchieebenen Verhalten mit demselben Namen gibt. |
| **Diensthosting** | Sie können das Konfigurationselement `<serviceHostingEnvironment>` nicht mehr auf Dienstebene angeben, indem Sie der Elementdefinition das Attribut `allowDefinition="MachineToApplication"` hinzufügen.<br><br>Das Element `<serviceHostingEnvironment>` auf Dienstebene anzugeben, ist technisch falsch und führt zu inkonsistentem Verhalten. |

## <a name="windows-presentation-foundation-wpf"></a>Windows Presentation Foundation (WPF)

### <a name="applications"></a>Anwendungen

Namespaces: <xref:System.Windows>, <xref:System.Windows.Controls>

Assemblys: PresentationFramework (in „PresentationFramework.dll“)

| Feature | Unterschiede zu 3.5 SP1 | Empfohlene Änderungen |
| ------- | ------------------------ | ------------------- |
| **Ausnahmebehandlung** | Damit Fehler früher erkannt werden können, löst WPF eine <xref:System.Reflection.TargetInvocationException> aus und legt die Eigenschaft <xref:System.Exception.InnerException> auf kritische Ausnahmen wie <xref:System.NullReferenceException>, <xref:System.OutOfMemoryException>, <xref:System.StackOverflowException> und <xref:System.Security.SecurityException> fest, anstatt die ursprüngliche Ausnahme abzufangen. | Keine |
| **Verknüpfte Ressourcen** | Um das Verknüpfen zu vereinfachen, verwenden Ressourcendateien (z.B. Images), die sich an einem anderen Speicherort als der Ordnerstruktur des Projekts befinden, bei der Erstellung der Anwendung den vollständigen Pfad der Ressourcendatei anstelle des Dateinamens als Ressourcen-ID. So kann die Anwendung die Dateien zur Laufzeit finden. | Keine |
| **Teilweise vertrauenswürdige Anwendungen** | Aus Sicherheitsgründen lösen Windows-basierte, teilweise vertrauenswürdige Anwendungen, die die Steuerelemente <xref:System.Windows.Controls.WebBrowser> oder <xref:System.Windows.Controls.Frame> mit HTML enthalten, bei der Erstellung des Steuerelements eine <xref:System.Security.SecurityException> aus.<br><br>Browseranwendungen lösen eine Ausnahme aus und zeigen eine Meldung an, wenn alle der folgenden Bedingungen erfüllt sind:<br><br>Die Anwendung wird in Firefox ausgeführt.<br>* Die teilweise vertrauenswürdige Anwendung wird in der Internetzone von nicht vertrauenswürdigen Standorten ausgeführt.<br>* Die Anwendung enthält die Steuerelemente <xref:System.Windows.Controls.WebBrowser> oder <xref:System.Windows.Controls.Frame>, die HTML enthalten.<br><br>Anwendungen, die an vertrauenswürdigen Standorten oder in der Intranetzone ausgeführt werden, sind nicht betroffen. | Sie können die Auswirkungen dieser Änderung in Ihren Browseranwendungen wie folgt abschwächen:<br><br>* Führen Sie die Browseranwendung als voll vertrauenswürdig aus.<br>* Fordern Sie Ihre Kunden auf, den Standort der Anwendung der Zone der vertrauenswürdigen Standorte hinzuzufügen.<br>* Fordern Sie Ihre Kunden auf, die Anwendung in Internet Explorer auszuführen. |
| **Ressourcenverzeichnisse** | Um Ressourcenverzeichnis auf der Designebene zu verbessern und zu verhindern, dass sie geändert werden, werden sperrbare Ressourcen, die in einem Ressourcenverzeichnis definiert und in ein Verzeichnis auf der Designebene zusammengeführt wurden, jetzt immer als gesperrt markiert und sind damit unveränderlich. Dies ist das erwartete Verhalten von sperrbaren Ressourcen. | Anwendungen, die eine in einem zusammengeführten Verzeichnis auf der Designebene definierte Ressource ändern, sollten die Ressource klonen und die geklonte Kopie ändern. Alternativ haben Sie die Möglichkeit, die Ressource als `x:Shared="false"` zu kennzeichnen, damit <xref:System.Windows.ResourceDictionary> bei jeder Abfrage der Ressource eine neue Kopie erstellt. |
| **Windows 7** | Damit WPF-Anwendungen besser unter Windows 7 funktionieren, wurden die folgenden Verbesserungen vorgenommen, um das Verhalten eines Fensters zu korrigieren:<br><br>* Zustände beim Andocken und bei Gesten funktionieren jetzt wie entsprechend der Benutzerinteraktionen erwartet.<br>* Die Taskleistenbefehle **Überlappend, Fenster gestapelt anzeigen** und **Show windows side-by-side** (Fenster nebeneinander anzeigen) haben jetzt haben das richtige Verhalten und aktualisieren die richtigen Eigenschaften.<br>* Die Eigenschaften `Top`, `Left`, `Width` und `Height` für maximierte oder minimierte Fenster enthalten jetzt, je nach Monitor, den richtigen Wiederherstellungsort des Fensters statt anderer Werte. | Keine |
| **Fensteranordnung und -transparenz** | Wenn Sie versuchen, <xref:System.Windows.Window.WindowStyle> auf einen anderen Wert als <xref:System.Windows.WindowStyle> festzulegen, wenn <xref:System.Windows.Window.AllowsTransparency>`true` und <xref:System.Windows.WindowState> sich selbst, also <xref:System.Windows.WindowState> entspricht, wird <xref:System.InvalidOperationException> ausgelöst. | Wenn Sie <xref:System.Windows.Window.WindowStyle> ändern müssen und <xref:System.Windows.Window.AllowsTransparency>`true` entspricht, können Sie die Win32-`SetWindowLongPtr`-Funktion aufrufen. |
| **XPS-Viewer** | WPF enthält das Microsoft XML Paper Specification Essentials Pack (XPSEP) nicht. XPSEP nur ist im Lieferumfang von Windows 7 und Windows Vista enthalten.<br><br>Auf einem Computer unter Windows XP, auf dem .NET Framework 3.5 SP1 nicht installiert ist, wird für das Drucken über eine andere WPF-API als der in <xref:System.Windows.Controls.PrintDialog> WINSPOOL verwendet. Einige Funktionen des Druckers werden nicht gemeldet, und einige Druckereinstellungen werden nicht während des Druckens angewendet. | Installieren Sie bei Bedarf das [Microsoft XML Paper Specification Essentials Pack](https://www.microsoft.com/en-us/download/details.aspx?id=11816). |

### <a name="controls"></a>Steuerelemente

Namespaces: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>

Assemblys: PresentationFramework (in „PresentationFramework.dll“), PresentationCore (in „PresentationCore.dll“), WindowsBase (in „WindowsBase.dll“)

| Feature | Unterschiede zu 3.5 SP1 | Empfohlene Änderungen |
| ------- | ------------------------ | ------------------- |
| **Dialogfelder** | Zur Verbesserung der Zuverlässigkeit wird die Methode <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> im gleichen Thread aufgerufen, der erstellt das <xref:Microsoft.Win32.FileDialog>-Steuerelement erstellt hat. | Achten Sie darauf, ein <xref:Microsoft.Win32.FileDialog>-Steuerelement zu erstellen, und rufen Sie die Methode <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> im gleichen Thread auf. |
| **Unverankerte Fenster** | Um die Logik für die Fokuswiederherstellung zu beheben, die fälschlicherweise kontinuierlich ein unverankertes Fenster reaktiviert (und es wie ein modales Dialogfeld anzeigt), wird sie jetzt an der Wiederherstellung gehindert, wenn der Kandidat kein untergeordnetes Element des Fensters ist. | Keine |
| **Elemente in Auflistungen** | Wenn ein Element verschoben oder einer zugrunde liegenden Auflistung hinzugefügt wird, erscheint es in <xref:System.Windows.Data.CollectionView> am gleichen relativen Speicherort, wenn <xref:System.Windows.Data.CollectionView> nicht sortiert ist. So wird die Konsistenz zwischen der Position des Elements in der Auflistung und der zugeordneten <xref:System.Windows.Data.CollectionView> gewahrt. | Verwenden Sie bei der Suche nach dem Speicherort eines Elements in einer <xref:System.Windows.Data.CollectionView> statt einer festen Position die Methoden <xref:System.Windows.Controls.ItemContainerGenerator.ContainerFromItem%2A> oder <xref:System.Windows.Data.CollectionView.IndexOf%2A>. |
| **Layouts** | Um unnötiges erneutes Anordnen zu vermeiden, setzt das Ändern von <xref:System.Windows.Controls.Page.ShowsNavigationUI> nicht mehr das Layout außer Kraft und ruft keinen weiteren Layoutdurchlauf hervor. | Wenn Sie davon ausgehen, dass Änderungen an <xref:System.Windows.Controls.Page.ShowsNavigationUI> zu einem weiteren Layoutdurchlauf führen, rufen Sie nach dem Festlegen der Eigenschaft <xref:System.Windows.UIElement.InvalidateVisual%2A> auf. |
| **Menüs** | Um ClearType-Text in Menü-Popupelementen zu aktivieren, wurden Änderungen an der <xref:System.Windows.Controls.ControlTemplate>-Klasse, dem <xref:System.Windows.Controls.MenuItem>-Steuerelement und anderen Steuerelementen vorgenommen. | Anwendungen sollten nicht die visuelle Struktur von Steuerelementvorlagen verwenden. Nur benannte Teile einer <xref:System.Windows.Controls.ControlTemplate> sind Teil des öffentlichen Vertrags. Wenn eine Anwendung ein bestimmtes Objekt in einer <xref:System.Windows.Controls.ControlTemplate> suchen muss, suchen Sie in der visuellen Struktur nach einem bestimmten Typ statt nach einer festen Position eines Objekts in der Struktur. |
| **Navigation** | Wenn ein <xref:System.Windows.Controls.Frame> direkt zu einem Speicherort navigiert, entspricht die Eigenschaft <xref:System.Windows.Navigation.NavigatingCancelEventArgs.IsNavigationInitiator> nach der ursprünglichen Navigation `true`. Diese Änderung verhindert, dass während Startszenarios zusätzliche Ereignisse ausgelöst werden. | Keine |
| **Popupelemente** | Der Delegat <xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback> kann jetzt während einem Layoutdurchlauf mehrfach aufgerufen werden, statt nur einmal. | Wenn Ihr <xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback>-Delegat die Position von einem <xref:System.Windows.Controls.Primitives.Popup> auf Grundlage seiner vorherigen Position berechnet, berechnen Sie die Position nur neu, wenn sich die Werte der Parameter `popupSize`, `targetSize` oder `offset` ändern. |
| **Eigenschaftswerte** | Mit der Methode <xref:System.Windows.DependencyObject.SetCurrentValue%2A> lässt sich nun eine Eigenschaft auf einen effektiven Wert festlegen, obwohl auch weiterhin alle Bindungen, Stile oder Trigger berücksichtigt werden, die sich auf die Eigenschaft auswirken. | Autoren von Steuerelementen sollten immer dann <xref:System.Windows.DependencyObject.SetCurrentValue%2A> verwenden, wenn sich der Eigenschaftswert infolge einer anderen Aktion wie der Bearbeitung durch Benutzer ändert. |
| **Textfelder** | Aus Sicherheitsgründen schlagen die Methoden <xref:System.Windows.Forms.TextBoxBase.Copy%2A> und <xref:System.Windows.Forms.TextBoxBase.Cut%2A> ohne Meldung fehl, wenn sie bei partieller Vertrauenswürdigkeit aufgerufen werden.<br><br>Darüber hinaus wird die programmgesteuerte Ausführung der Eigenschaften <xref:System.Windows.Input.ApplicationCommands.Copy> oder <xref:System.Windows.Input.ApplicationCommands.Cut> für ein Steuerelement, das von <xref:System.Windows.Controls.Primitives.TextBoxBase> erbt, bei partieller Vertrauenswürdigkeit blockiert. Die von Benutzern initiierten Befehle „Kopieren“ und „Ausschneiden“ wie das Klicken auf eine Schaltfläche, deren <xref:System.Windows.Controls.Primitives.ButtonBase.Command>-Eigenschaft an einen dieser Befehle gebunden ist, funktionieren. Die Ausführung standardmäßiger Kopier- und Ausschneidebefehle über Tastenkombinationen und das Kontextmenü funktioniert weiterhin bei partieller Vertrauenswürdigkeit wie zuvor. | Binden Sie die Befehle <xref:System.Windows.Input.ApplicationCommands.Copy> oder <xref:System.Windows.Input.ApplicationCommands.Cut> an eine von Benutzern initiierte Aktion, z.B. an das Klicken auf eine Schaltfläche. |

### <a name="graphics"></a>Grafik

Namespaces: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>, <xref:System.Windows.Media.Effects>

Assemblys: PresentationFramework (in „PresentationFramework.dll“), PresentationCore (in „PresentationCore.dll“), WindowsBase (in „WindowsBase.dll“)

| Feature | Unterschiede zu 3.5 SP1 | Empfohlene Änderungen |
| ------- | ------------------------ | ------------------- |
| **Bitmapeffekte** | Zur Verbesserung der Leistung wurden die <xref:System.Windows.Media.Effects.BitmapEffect>-Klasse und die Klassen, die von der <xref:System.Windows.Media.Effects.BitmapEffect>-Klasse erben, deaktiviert, obwohl sie weiterhin vorhanden sind. Der Effekt wird mit der hardwarebeschleunigten Renderingpipeline gerendert, wenn Folgendes zutrifft:<br><br>* Die Anwendung verwendet einen <xref:System.Windows.Media.Effects.DropShadowBitmapEffect> oder einen <xref:System.Windows.Media.Effects.BlurBitmapEffect>, dessen Radius-Eigenschaft auf weniger als 100 DIU festgelegt ist.<br>* Die Grafikkarte dieses Computers, auf dem die Anwendung ausgeführt wird, unterstützt Pixelshader 2.0.<br><br>Wenn diese Bedingungen nicht erfüllt werden, hat das <xref:System.Windows.Media.Effects.BitmapEffect>-Objekt keine Auswirkungen.<br><br>Außerdem erzeugt Visual Studio eine Compilerwarnung, wenn das <xref:System.Windows.Media.Effects.BitmapEffect>-Objekt oder eine Unterklasse erkannt wird.<br><br>Die <xref:System.Windows.Media.DrawingContext.PushEffect%2A>-Methode ist als veraltet markiert. | Stellen Sie die Verwendung der Vorgängerversion <xref:System.Windows.Media.Effects.BitmapEffect> und der abgeleitete Klassen ein, und verwenden Sie stattdessen die neuen, von <xref:System.Windows.Media.Effects.Effect> abgeleiteten Klassen: <xref:System.Windows.Media.Effects.BlurEffect>, <xref:System.Windows.Media.Effects.DropShadowEffect>, und <xref:System.Windows.Media.Effects.ShaderEffect>.<br><br>Sie können durch Erben von der <xref:System.Windows.Media.Effects.ShaderEffect>-Klasse auch eigene Effekte erstellen. |
| **Bitmapframes** | Geklonte <xref:System.Windows.Media.Imaging.BitmapFrame>-Objekte empfangen jetzt die Ereignisse <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress>, <xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted> und <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed>. Dadurch funktionieren Images, die aus dem Web heruntergeladen und auf das <xref:System.Windows.Controls.Image>-Steuerelement angewendet werden, über einen <xref:System.Windows.Style> ordnungsgemäß.<br><br>Änderung am Verhalten kommen nur vor, wenn alle der folgenden Aussagen zutreffen:<br><br>* Sie abonnieren das Ereignis <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress>, <xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted> oder <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed>.<br>* Die Quelle des <xref:System.Windows.Media.Imaging.BitmapFrame> stammt aus dem Web.<br>* Das <xref:System.Windows.Media.Imaging.BitmapFrame> wird geklont, während der Download immer noch ausgeführt wird. | Überprüfen Sie den Absender im Ereignishandler, und ergreifen Sie nur Maßnahmen, wenn der Absender der ursprüngliche <xref:System.Windows.Media.Imaging.BitmapFrame> ist. |
| **Decodieren von Images** | Um sicherzustellen, dass eine <xref:System.IO.IOException> verarbeitet wird, wenn Images nicht decodiert werden können, löst die <xref:System.Windows.Media.Imaging.BitmapSource>-Klasse bei einer fehlgeschlagenen Decodierung das Ereignis <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> aus. | Entfernen Sie jede Ausnahmebehandlung für <xref:System.IO.IOException>, und verwenden Sie das <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed>-Ereignis für die Suche nach Decodierungsfehlern. |

### <a name="input"></a>Eingabe

Namespaces: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>

Assemblys: PresentationFramework (in „PresentationFramework.dll“), PresentationCore (in „PresentationCore.dll“), WindowsBase (in „WindowsBase.dll“)

| Feature | Unterschiede zu 3.5 SP1 | Empfohlene Änderungen |
| ------- | ------------------------ | ------------------- |
| **Binden von Befehlsinstanzen** | Um einen Mechanismus für das Binden von auf dem Ansichtsmodell basierten Befehlsinstanzen an ansichtsbasierte Eingabegesten bereitzustellen, erbt die <xref:System.Windows.Input.InputBinding>-Klasse jetzt von <xref:System.Windows.Freezable> statt von <xref:System.Windows.DependencyObject>. Die folgenden Eigenschaften sind jetzt Abhängigkeitseigenschaften:<br><br>* <xref:System.Windows.Input.InputBinding.Command><br>* <xref:System.Windows.Input.InputBinding.CommandParameter><br>* <xref:System.Windows.Input.InputBinding.CommandTarget><br><br>Diese Änderung hat folgende Auswirkungen:<br><br>* Ein <xref:System.Windows.Input.InputBinding>-Objekt wird jetzt gesperrt, wenn es registriert wird, statt veränderbar zu bleiben.<br>* Sie können aufgrund der Einschränkungen für die <xref:System.Windows.DependencyObject>-Klasse nicht von mehreren Threads aus auf <xref:System.Windows.Input.InputBinding>-Objekte auf Instanzebene zugreifen.<br>* Sie können aufgrund der Einschränkungen der <xref:System.Windows.Freezable>-Klasse keine Eingabebindungen auf Klassenebene nach deren Registrierung mutieren.<br>* Sie können keine Eingabebindungen auf Befehlsinstanzen angeben, die in einem Ansichtsmodell erstellt werden. | Erstellen Sie separate Instanzen einer <xref:System.Windows.Input.InputBinding>-Klasse in separaten Threads, wenn Bindungen mutierbar bleiben sollen. Sperren Sie die sie andernfalls. Mutieren Sie kein statisches <xref:System.Windows.Input.InputBinding> auf Klassenebene, nachdem es registriert wurde. |
| **Browseranwendungen** | WPF-Webbrowseranwendungen (.XBAP) verarbeiten jetzt Tastenereignisse wie eigenständige WPF-Anwendungen, sodass Objekte geroutete Tastenereignisse in der richtigen Reihenfolge empfangen. | Keine |
| **Tottastenkombinationen** | WPF verbirgt Tottasten, die kein sichtbares Zeichen erzeugen, und weist stattdessen darauf hin, dass die Taste in Kombination mit der nächsten Buchstabentaste ein Zeichen erzeugt. Tasteneingabeereignisse wie das <xref:System.Windows.Input.Keyboard.KeyDownEvent>-Ereignis melden, wenn eine Taste eine Tottaste ist, indem die <xref:System.Windows.Input.KeyEventArgs.Key>-Eigenschaft auf den <xref:System.Windows.Input.Key>-Wert festgelegt wird. Dieses Verhalten wird erwartet, da Anwendungen in der Regel nicht auf Tastatureingaben zu reagieren, die kombinierte Zeichen erzeugen. | Anwendungen, die erwarten, Tasten zu lesen, die Teil von kombinierten Zeichen waren, können verborgene Tasten jetzt mit der <xref:System.Windows.Input.KeyEventArgs.DeadCharProcessedKey>-Eigenschaft abrufen. |
| **FocusManager** | Wenn die Methode <xref:System.Windows.Input.FocusManager.GetFocusedElement(System.Windows.DependencyObject)?displayProperty=nameWithType> an ein Element übergeben wird, dessen angefügte [IsFocusScope](xref:System.Windows.Input.FocusManager.IsFocusScope%2A)-Eigenschaft auf `true` festgelegt wurde, gibt die Methode ein Element zurück, das das letzte von der Tastatur fokussierte Element innerhalb des Fokusbereichs darstellt, und nur, wenn das zurückgegebene Element zu dem gleichen <xref:System.Windows.PresentationSource>-Objekt gehört wie das Element, das an die Methode übergeben wird. | Keine |

### <a name="ui-automation"></a>Benutzeroberflächenautomatisierung

Namespaces: <xref:System.Windows>, <xref:System.Windows.Automation.Peers>, <xref:System.Windows.Automation.Provider>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>

Assemblys: PresentationFramework (in „PresentationFramework.dll“), PresentationCore (in „PresentationCore.dll“), UIAutomationProvider (in „UIAutomationProvider.dll“), WindowsBase (in „WindowsBase.dll“)

| Feature | Unterschiede zu 3.5 SP1 | Empfohlene Änderungen |
| ------- | ------------------------ | ------------------- |
| **Klassenhierarchie von Ansichten** | Die Klasse <xref:System.Windows.Automation.Peers.TreeViewAutomationPeer> und <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> erben von <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer> statt von <xref:System.Windows.Automation.Peers.FrameworkElementAutomationPeer>. | Wenn von der <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer>-Klasse geerbt und die <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer.GetChildrenCore%2A>-Methode überschrieben wird, empfiehlt es sich, ein Objekt zurückzugeben, das von der neuen <xref:System.Windows.Automation.Peers.TreeViewDataItemAutomationPeer>-Klasse erbt. |
| **Container außerhalb des Bildschirms** | Um einen falschen Rückgabewert zu korrigieren, gibt die <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.IsOffscreenCore%2A>-Methode jetzt ordnungsgemäß `false` für Elementcontainer zurück, die außerhalb der Ansicht gescrollt werden. Darüber hinaus ist der Wert der Methode nicht durch Okklusion anderer Fenster oder davon betroffen, ob das Element auf einen bestimmten Monitor angezeigt wird. | Keine |
| **Menüs und untergeordnete Objekte** | Um die UI-Automatisierung von Menüs zu ermöglichen, die andere untergeordnete Elemente als <xref:System.Windows.Controls.MenuItem>-Objekte enthalten, gibt die <xref:System.Windows.Automation.Peers.MenuItemAutomationPeer.GetChildrenCore%2A>-Methode jetzt das <xref:System.Windows.Automation.Peers.AutomationPeer>-Objekt eines untergeordneten <xref:System.Windows.UIElement>-Objekts statt eines <xref:System.Windows.Automation.Peers.MenuItemAutomationPeer>-Objekts zurück. | Keine |
| **Neue Schnittstellen und Assembly** | Um neue Funktionen für die UI-Automatisierung einzubinden, wurden die folgenden Schnittstellen hinzugefügt:<br><br>* <xref:System.Windows.Automation.Provider.IItemContainerProvider><br>* <xref:System.Windows.Automation.Provider.ISynchronizedInputProvider><br>* <xref:System.Windows.Automation.Provider.IVirtualizedItemProvider> | Jedes Projekt, das WPF-Automatisierungspeers erstellt, muss einen expliziten Verweis auf „UIAutomationProvider.dll“ hinzufügen. |
| **Ziehpunkte** | Die <xref:System.Windows.Automation.Peers.ThumbAutomationPeer.GetClassNameCore%2A>-Methode gibt einen Wert anstelle von NULL zurück. Aus diesem Grund melden Steuerelemente wie <xref:System.Windows.Controls.GridSplitter>, die von der <xref:System.Windows.Controls.Primitives.Thumb>-Klasse erben, einen Namen an die UI-Automatisierung. | Keine |
| **Virtualisierte Elemente** | Zur Verbesserung der Leistung gibt die <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetChildrenCore%2A>-Methode nur die untergeordneten Objekte zurück, die tatsächlich in der visuellen Struktur enthalten sind, statt aller untergeordneten Objekte unabhängig vom Virtualisierungsort. | Verwenden Sie <xref:System.Windows.Automation.ItemContainerPattern>, um eine Iteration für alle Elemente von <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer> durchzuführen. |

### <a name="xaml"></a>XAML

Namespaces: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>, <xref:System.Windows.Markup>

Assemblys: PresentationFramework (in „PresentationFramework.dll“), PresentationCore (in „PresentationCore.dll“), WindowsBase (in „WindowsBase.dll“)

| Feature | Unterschiede zu 3.5 SP1 | Empfohlene Änderungen |
| ------- | ------------------------ | ------------------- |
| **Markuperweiterung** | WPF verwendet jetzt ordnungsgemäß immer den Wert der <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A>-Methode, statt in bestimmten Fällen das <xref:System.Windows.Markup.MarkupExtension>-Objekt zurückzugeben, wenn mit einer Markuperweiterung Eigenschaften festgelegt oder ein Element in einer Auflistung erstellt wird. Eine Markuperweiterung kann sich in einigen Fällen selbst zurückgeben. | Wenn Ihre Anwendung auf eine Ressource zugreift, die in einer früheren Version ein <xref:System.Windows.Markup.MarkupExtension>-Objekt zurückgegeben hat, verweisen Sie nicht auf das <xref:System.Windows.Markup.MarkupExtension>-Objekt, sondern auf das von <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A> zurückgegebene Objekt. |
| **Analyseattribute** | Attribute dürfen in XAML jetzt nur einen Punkt haben. Alle folgenden Attribute sind z.B. gültig:<br><br>`<Button Background="Red"/>` (keine Punkte)<br><br>`<Button Button.Background = "Red"/>` (ein Punkt)<br><br>Das folgende Attribut ist nicht mehr gültig:<br><br>`<Button Control.Button.Background = "Red"/>` (mehr als ein Punkt) | Richtige XAML-Attribute mit mehr als einem Punkt |

## <a name="xml"></a>XML

Die folgende Tabelle beschreibt die verbesserten Funktionen, die zuvor Einschränkungen oder andere Probleme hatten.

### <a name="schema-and-transforms"></a>Schemas und Transformationen

Namespaces: <xref:System.Xml.Linq>, <xref:System.Xml.Schema>, <xref:System.Xml.XPath>

Assemblys: System.xml (in „System.Xml.dll“), System.Xml.Linq (in „System.Xml.Linq.dll“)

| Feature | Unterschiede zu 3.5 SP1 |
| ------- | ------------------------ |
| **Chamäleonschemas** | Um Datenbeschädigung zu verhindern, werden Chamäleonschemas jetzt ordnungsgemäß geklont, wenn sie in mehreren Schemas enthalten sind.<br><br>Chamäleonschemas sind Schemas ohne Zielnamespace, und wenn sie in einem anderen XSD-Schema eingeschlossen werden, übernehmen sie den Zielnamespace des importierenden Schemas. Sie werden häufig dazu verwendet, um allgemeine Typen in einem Schema einzuschließen. |
| **ID-Funktionen** | Die XSLT-[id-Funktion](/sql/xquery/functions-on-sequences-id) gibt nun den richtigen Wert statt NULL zurück, wenn ein <xref:System.Xml.XmlReader>-Objekt an eine XSL-Transformation übergeben wird.<br><br>Wenn der Benutzer aus einer LINQ to XML-Klasse mit der <xref:System.Xml.Linq.XNode.CreateReader%2A>-Methode ein <xref:System.Xml.XmlReader>-Objekt erstellt hat, und dieses <xref:System.Xml.XmlReader>-Objekt an eine XSL-Transformation übergeben wurde, haben alle Instanzen der `id`-Funktion in XSLT zuvor NULL zurückgegeben. Dies ist kein zulässiger Rückgabewert für die `id`-Funktion. |
| **Namespaceattribut** | Um Datenbeschädigung zu verhindern, gibt ein <xref:System.Xml.XPath.XPathNavigator>-Objekt nun den lokalen Namen des `x:xmlns`-Attribut richtig zurück. |
| **Namespacedeklarationen** | Ein <xref:System.Xml.XmlReader>-Objekt in einer Teilstruktur führt nicht länger zur Erstellung doppelter Namespacedeklarationen innerhalb eines XML-Elements. |
| **Schemavalidierung** | Um eine fehlerhafte Schemavalidierung zu verhindern, lässt die <xref:System.Xml.Schema.XmlSchemaSet>-Klasse nun zu, dass XSD-Schemas richtig und konsistent kompiliert werden. Diese Schemas können andere Schemas enthalten. `A.xsd` kann z.B. `B.xsd` enthalten, das wiederum `C.xsd` enthalten kann. Das Kompilieren dieser Schemas führt dazu, dass der Graph mit den Abhängigkeiten durchsucht wird. |
| **Skriptfunktionen** | Die [function-available-Funktion](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms256124(v=vs.100)) gibt nicht mehr fälschlicherweise `false` zurück, wenn die Funktion tatsächlich verfügbar ist. |
| **URIs** | Die <xref:System.Xml.Linq.XElement.Load%2A>-Methode gibt nun den richtigen BaseURI in LINQ-Abfragen zurück. |

### <a name="validation"></a>Validierung

Namespaces: <xref:System.Xml.Linq>, <xref:System.Xml.Schema>, <xref:System.Xml.XPath>

Assemblys: System.xml (in „System.Xml.dll“), System.Xml.Linq (in „System.Xml.Linq.dll“)

| Feature | Unterschiede zu 3.5 SP1 |
| ------- | ------------------------ |
| **Namespace-Resolver** | Die <xref:System.Xml.XmlReader.ReadContentAs%2A>-Methode ignoriert nicht mehr den empfangenen<xref:System.Xml.IXmlNamespaceResolver>-Resolver.<br><br>In früheren Versionen wurde der angegebene Namespace-Resolver ignoriert, und stattdessen wurde <xref:System.Xml.XmlReader> verwendet. |
| **Leerraum** | Um beim Erstellen eines Readers Datenverluste zu vermeiden, verwirft die <xref:System.Xml.XmlReader.Create%2A>-Methode keinen signifikanten Leerraum mehr.<br><br>Die XML-Validierung erkennt den Modus mit gemischtem Inhalt, in dem Text mit XML-Markup gemischt werden kann. Im gemischten Modus sind jeder Leerraum wichtig und muss gemeldet werden. |

### <a name="writing"></a>Schreiben

Namespaces: <xref:System.Xml.Linq>, <xref:System.Xml.Schema>, <xref:System.Xml.XPath>

Assemblys: System.xml (in „System.Xml.dll“), System.Xml.Linq (in „System.Xml.Linq.dll“)

| Feature | Unterschiede zu 3.5 SP1 |
| ------- | ------------------------ |
| **Entitätsverweise** | Um Datenbeschädigung zu verhindern, werden Entitätsverweise in XML-Attribute nicht mehr zweimal in Entitäten geändert.<br><br>Wenn der Benutzer versucht hat, eine Entität in ein `xmlns`-Attribut oder mit der <xref:System.Xml.XmlWriter.WriteEntityRef%2A>-Methode in ein `xml:lang`- oder `xml:space`-Attribut zu schreiben, wird die Entität zweimal in der Ausgabe in Entitäten geändert. Dabei werden die Daten beschädigt. |
| **Neue Zeilenbehandlung** | Um Datenbeschädigung zu verhindern, berücksichtigen <xref:System.Xml.XmlWriter>-Objekte nun die Option <xref:System.Xml.NewLineHandling>. |

## <a name="see-also"></a>Siehe auch

- [Neue Typen und Member in .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff641764%28v=vs.100%29)
- [Leitfaden zur Migration zu .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ff657133%28v=vs.100%29)
- [Neuerungen in .NET Framework 4](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ms171868%28v=vs.100%29)
- [Versionskompatibilität in .NET Framework](version-compatibility.md)
- [Migrieren von Office-Projektmappen zu .NET Framework 4](/visualstudio/vsto/migrating-office-solutions-to-the-dotnet-framework-4-or-later)
- [Veraltete Elemente in der .NET Framework-Klassenbibliothek](../whats-new/whats-obsolete.md)
