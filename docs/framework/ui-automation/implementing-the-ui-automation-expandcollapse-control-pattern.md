---
title: Implementieren des ExpandCollapse-Steuerelementmusters der Benutzeroberflächenautomatisierung
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, ExpandCollapse control pattern
- ExpandCollapse control pattern
- control patterns, ExpandCollapse
ms.assetid: 1dbabb8c-0d68-47c1-a35e-1c01cb01af26
ms.openlocfilehash: 073ff0727fc6aab1189f73a254aa95da60820cc3
ms.sourcegitcommit: 9a39f2a06f110c9c7ca54ba216900d038aa14ef3
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/23/2019
ms.locfileid: "74447147"
---
# <a name="implementing-the-ui-automation-expandcollapse-control-pattern"></a><span data-ttu-id="da539-102">Implementieren des ExpandCollapse-Steuerelementmusters der Benutzeroberflächenautomatisierung</span><span class="sxs-lookup"><span data-stu-id="da539-102">Implementing the UI Automation ExpandCollapse Control Pattern</span></span>

> [!NOTE]
> <span data-ttu-id="da539-103">Diese Dokumentation ist für .NET Framework-Entwickler vorgesehen, die die verwalteten [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]-Klassen verwenden möchten, die im <xref:System.Windows.Automation>-Namespace definiert sind.</span><span class="sxs-lookup"><span data-stu-id="da539-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="da539-104">Aktuelle Informationen zur [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]finden Sie auf der Seite zur [Windows-Automatisierungs-API: UI-Automatisierung](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="da539-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>

<span data-ttu-id="da539-105">Dieses Thema enthält Richtlinien und Konventionen für das Implementieren von <xref:System.Windows.Automation.Provider.IExpandCollapseProvider>, einschließlich Informationen über Eigenschaften, Methoden und Ereignissen.</span><span class="sxs-lookup"><span data-stu-id="da539-105">This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IExpandCollapseProvider>, including information about properties, methods, and events.</span></span> <span data-ttu-id="da539-106">Links zu zusätzlichen Referenzen sind am Ende dieser Übersicht aufgelistet.</span><span class="sxs-lookup"><span data-stu-id="da539-106">Links to additional references are listed at the end of the overview.</span></span>

<span data-ttu-id="da539-107">Das <xref:System.Windows.Automation.ExpandCollapsePattern> -Steuerelementmuster dient zur Unterstützung von Steuerelementen, die für das Anzeigen von mehr Inhalt erweitert bzw. für das Ausblenden von Inhalt reduziert werden.</span><span class="sxs-lookup"><span data-stu-id="da539-107">The <xref:System.Windows.Automation.ExpandCollapsePattern> control pattern is used to support controls that visually expand to display more content and collapse to hide content.</span></span> <span data-ttu-id="da539-108">Beispiele für Steuerelemente, die dieses Steuerelementmuster implementieren, finden Sie unter [Control Pattern Mapping for UI Automation Clients](control-pattern-mapping-for-ui-automation-clients.md).</span><span class="sxs-lookup"><span data-stu-id="da539-108">For examples of controls that implement this control pattern, see [Control Pattern Mapping for UI Automation Clients](control-pattern-mapping-for-ui-automation-clients.md).</span></span>

<a name="Implementation_Guidelines_and_Conventions"></a>

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="da539-109">Implementierungsrichtlinien und -konventionen</span><span class="sxs-lookup"><span data-stu-id="da539-109">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="da539-110">Beachten Sie beim Implementieren des „ExpandCollapse“-Steuerelementmusters die folgenden Richtlinien und Konventionen:</span><span class="sxs-lookup"><span data-stu-id="da539-110">When implementing the ExpandCollapse control pattern, note the following guidelines and conventions:</span></span>

- <span data-ttu-id="da539-111">Aggregierte Steuerelemente (mit untergeordneten Objekten erstellt, die die Benutzeroberfläche mit Funktionen zum Erweitern/Reduzieren bereitstellen) müssen das <xref:System.Windows.Automation.ExpandCollapsePattern> -Steuerelementmuster unterstützen, während deren untergeordnete Elemente dies nicht müssen.</span><span class="sxs-lookup"><span data-stu-id="da539-111">Aggregate controls—built with child objects that provide the UI with expand/collapse functionality—must support the <xref:System.Windows.Automation.ExpandCollapsePattern> control pattern whereas their child elements do not.</span></span> <span data-ttu-id="da539-112">Beispielsweise wird ein Kombinationsfeld-Steuerelement mit einer Kombination aus einem Listenfeld, einer Schaltfläche und Bearbeitungssteuerelementen erstellt, aber es handelt es sich nur um das übergeordnete Kombinationsfeld, das <xref:System.Windows.Automation.ExpandCollapsePattern>unterstützen muss.</span><span class="sxs-lookup"><span data-stu-id="da539-112">For example, a combo box control is built with a combination of list box, button, and edit controls, but it is only the parent combo box that must support the <xref:System.Windows.Automation.ExpandCollapsePattern>.</span></span>

  > [!NOTE]
  > <span data-ttu-id="da539-113">Eine Ausnahme stellt das Menüsteuerelement dar. Hierbei handelt es sich um ein Aggregat von einzelnen „MenuItem“-Objekten.</span><span class="sxs-lookup"><span data-stu-id="da539-113">An exception is the menu control, which is an aggregate of individual MenuItem objects.</span></span> <span data-ttu-id="da539-114">Die „MenuItem“-Objekte können das <xref:System.Windows.Automation.ExpandCollapsePattern> -Steuerelementmuster unterstützen, das übergeordnete Menüsteuerelement ist dazu jedoch nicht in der Lage.</span><span class="sxs-lookup"><span data-stu-id="da539-114">The MenuItem objects can support the <xref:System.Windows.Automation.ExpandCollapsePattern> control pattern, but the parent Menu control cannot.</span></span> <span data-ttu-id="da539-115">Eine ähnliche Ausnahme gilt für die Gesamtstruktur- und Gesamtstrukturelement-Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="da539-115">A similar exception applies to the Tree and Tree Item controls.</span></span>

- <span data-ttu-id="da539-116">Wenn der <xref:System.Windows.Automation.ExpandCollapseState> eines Steuerelements auf <xref:System.Windows.Automation.ExpandCollapseState.LeafNode>festgelegt ist, sind die <xref:System.Windows.Automation.ExpandCollapsePattern> -Funktionalitäten aktuell inaktiv für das Steuerelement, und <xref:System.Windows.Automation.ExpandCollapseState>sind die einzigen Informationen, die mithilfe dieses Steuerelementmusters abgerufen werden können.</span><span class="sxs-lookup"><span data-stu-id="da539-116">When the <xref:System.Windows.Automation.ExpandCollapseState> of a control is set to <xref:System.Windows.Automation.ExpandCollapseState.LeafNode>, any <xref:System.Windows.Automation.ExpandCollapsePattern> functionality is currently inactive for the control and the only information that can be obtained using this control pattern is the <xref:System.Windows.Automation.ExpandCollapseState>.</span></span> <span data-ttu-id="da539-117">Wenn untergeordnete Objekte später hinzugefügt werden, wird <xref:System.Windows.Automation.ExpandCollapseState> geändert, und die <xref:System.Windows.Automation.ExpandCollapsePattern> -Funktionalität wird aktiviert.</span><span class="sxs-lookup"><span data-stu-id="da539-117">If any child objects are subsequently added, the <xref:System.Windows.Automation.ExpandCollapseState> changes and <xref:System.Windows.Automation.ExpandCollapsePattern> functionality is activated.</span></span>

- <span data-ttu-id="da539-118"><xref:System.Windows.Automation.ExpandCollapseState> verweist nur auf die Sichtbarkeit der unmittelbaren untergeordneten Objekte und nicht auf die Sichtbarkeit sämtlicher Nachfolgerobjekte.</span><span class="sxs-lookup"><span data-stu-id="da539-118"><xref:System.Windows.Automation.ExpandCollapseState> refers to the visibility of immediate child objects only; it does not refer to the visibility of all descendant objects.</span></span>

- <span data-ttu-id="da539-119">Die Funktionalität zum Erweitern und Reduzieren ist steuerelementspezifisch.</span><span class="sxs-lookup"><span data-stu-id="da539-119">Expand and Collapse functionality is control-specific.</span></span> <span data-ttu-id="da539-120">Im Folgenden finden Sie Beispiele dieses Verhaltens.</span><span class="sxs-lookup"><span data-stu-id="da539-120">The following are examples of this behavior.</span></span>

  - <span data-ttu-id="da539-121">Das persönliche Office-Menü kann ein aus drei Status bestehendes „MenuItem“ (<xref:System.Windows.Automation.ExpandCollapseState.Expanded>, <xref:System.Windows.Automation.ExpandCollapseState.Collapsed> und <xref:System.Windows.Automation.ExpandCollapseState.PartiallyExpanded>) sein, wobei das Steuerelement den zu verwendenden Status angibt, wenn eine <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> - oder <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> -Funktion aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="da539-121">The Office Personal Menu can be a tri-state MenuItem (<xref:System.Windows.Automation.ExpandCollapseState.Expanded>, <xref:System.Windows.Automation.ExpandCollapseState.Collapsed> and <xref:System.Windows.Automation.ExpandCollapseState.PartiallyExpanded>) where the control specifies the state to adopt when an <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> or <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> is called.</span></span>

  - <span data-ttu-id="da539-122">Durch das Aufrufen von <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> in einem „TreeItem“ werden möglicherweise alle Nachfolger oder nur das unmittelbar untergeordnete Element angezeigt.</span><span class="sxs-lookup"><span data-stu-id="da539-122">Calling <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> on a TreeItem may display all descendants or only immediate children.</span></span>

  - <span data-ttu-id="da539-123">Durch das Aufrufen von <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> oder <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> in einem Steuerelement wird der Status der entsprechenden Nachfolger beibehalten, es sollte ein Sichtbarkeitsänderungsereignis gesendet werden und kein Statusänderungsereignis. Wenn das übergeordnete Steuerelement den Status seiner Nachfolger nicht beibehalten kann, wenn es reduziert ist, zerstört das Steuerelement möglicherweise alle Nachfolger, die nicht mehr sichtbar sind und löst ein Ereignis über eine Zerstörung aus oder es ändert <xref:System.Windows.Automation.Provider.IExpandCollapseProvider.ExpandCollapseState%2A> für jeden Nachfolger und löst ein Sichtbarkeitsänderungsereignis aus.</span><span class="sxs-lookup"><span data-stu-id="da539-123">If calling <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> or <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> on a control maintains the state of its descendants, a visibility change event should be sent, not a state change event If the parent control does not maintain the state of its descendants when collapsed, the control may destroy all the descendants that are no longer visible and raise a destroyed event; or it may change the <xref:System.Windows.Automation.Provider.IExpandCollapseProvider.ExpandCollapseState%2A> for each descendant and raise a visibility change event.</span></span>

- <span data-ttu-id="da539-124">Zum Garantieren der Navigation ist es für ein Objekt wünschenswert, wenn es sich in der [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -Gesamtstruktur (mit dem entsprechenden Sichtbarkeitsstatus) befindet, und zwar unabhängig von seinen übergeordneten <xref:System.Windows.Automation.ExpandCollapseState>.</span><span class="sxs-lookup"><span data-stu-id="da539-124">To guarantee navigation, it is desirable for an object to be in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree (with appropriate visibility state) regardless of its parents <xref:System.Windows.Automation.ExpandCollapseState>.</span></span> <span data-ttu-id="da539-125">Wenn Nachfolger bedarfsgesteuert generiert werden, werden sie möglicherweise nur dann in der [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -Gesamtstruktur angezeigt, nachdem sie das erste Mal angezeigt wurden, oder nur während sie sichtbar sind.</span><span class="sxs-lookup"><span data-stu-id="da539-125">If descendants are generated on demand, they may only appear in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree after being displayed for the first time or only while they are visible.</span></span>

<a name="Required_Members_for_the_IValueProvider_Interface"></a>

## <a name="required-members-for-iexpandcollapseprovider"></a><span data-ttu-id="da539-126">Erforderliche Member für „IExpandCollapseProvider“</span><span class="sxs-lookup"><span data-stu-id="da539-126">Required Members for IExpandCollapseProvider</span></span>

<span data-ttu-id="da539-127">Die folgenden Eigenschaften und Methoden sind für das Implementieren von <xref:System.Windows.Automation.Provider.IExpandCollapseProvider>erforderlich.</span><span class="sxs-lookup"><span data-stu-id="da539-127">The following properties and methods are required for implementing <xref:System.Windows.Automation.Provider.IExpandCollapseProvider>.</span></span>

|<span data-ttu-id="da539-128">Erforderliche Member</span><span class="sxs-lookup"><span data-stu-id="da539-128">Required members</span></span>|<span data-ttu-id="da539-129">Memberart</span><span class="sxs-lookup"><span data-stu-id="da539-129">Member type</span></span>|<span data-ttu-id="da539-130">Notizen</span><span class="sxs-lookup"><span data-stu-id="da539-130">Notes</span></span>|
|----------------------|-----------------|-----------|
|<xref:System.Windows.Automation.Provider.IExpandCollapseProvider.ExpandCollapseState%2A>|<span data-ttu-id="da539-131">property</span><span class="sxs-lookup"><span data-stu-id="da539-131">Property</span></span>|<span data-ttu-id="da539-132">Keiner</span><span class="sxs-lookup"><span data-stu-id="da539-132">None</span></span>|
|<xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A>|<span data-ttu-id="da539-133">Methode</span><span class="sxs-lookup"><span data-stu-id="da539-133">Method</span></span>|<span data-ttu-id="da539-134">Keiner</span><span class="sxs-lookup"><span data-stu-id="da539-134">None</span></span>|
|<xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A>|<span data-ttu-id="da539-135">Methode</span><span class="sxs-lookup"><span data-stu-id="da539-135">Method</span></span>|<span data-ttu-id="da539-136">Keiner</span><span class="sxs-lookup"><span data-stu-id="da539-136">None</span></span>|
|<xref:System.Windows.Automation.AutomationPropertyChangedEventHandler>|<span data-ttu-id="da539-137">event</span><span class="sxs-lookup"><span data-stu-id="da539-137">Event</span></span>|<span data-ttu-id="da539-138">Dieses Steuerelement verfügt über keine zugeordneten Ereignisse. Verwenden Sie diesen generischen Delegaten.</span><span class="sxs-lookup"><span data-stu-id="da539-138">This control has no associated events; use this generic delegate.</span></span>|

<a name="Exceptions"></a>

## <a name="exceptions"></a><span data-ttu-id="da539-139">Ausnahmen</span><span class="sxs-lookup"><span data-stu-id="da539-139">Exceptions</span></span>

<span data-ttu-id="da539-140">Anbieter müssen die folgenden Ausnahmen auslösen.</span><span class="sxs-lookup"><span data-stu-id="da539-140">Providers must throw the following exceptions.</span></span>

|<span data-ttu-id="da539-141">Ausnahmetyp</span><span class="sxs-lookup"><span data-stu-id="da539-141">Exception type</span></span>|<span data-ttu-id="da539-142">Bedingung</span><span class="sxs-lookup"><span data-stu-id="da539-142">Condition</span></span>|
|--------------------|---------------|
|<xref:System.InvalidOperationException>|<span data-ttu-id="da539-143">Es wird <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> - oder <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> aufgerufen, wenn <xref:System.Windows.Automation.ExpandCollapseState> = <xref:System.Windows.Automation.ExpandCollapseState.LeafNode>.</span><span class="sxs-lookup"><span data-stu-id="da539-143">Either <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> or <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> is called when the <xref:System.Windows.Automation.ExpandCollapseState> = <xref:System.Windows.Automation.ExpandCollapseState.LeafNode>.</span></span>|

## <a name="see-also"></a><span data-ttu-id="da539-144">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="da539-144">See also</span></span>

- [<span data-ttu-id="da539-145">Übersicht über Steuerelementmuster für Benutzeroberflächenautomatisierung</span><span class="sxs-lookup"><span data-stu-id="da539-145">UI Automation Control Patterns Overview</span></span>](ui-automation-control-patterns-overview.md)
- [<span data-ttu-id="da539-146">Unterstützung von Steuerelementmustern in einem Benutzeroberflächenautomatisierungs-Anbieter</span><span class="sxs-lookup"><span data-stu-id="da539-146">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)
- [<span data-ttu-id="da539-147">Steuerelementmuster für Benutzeroberflächenautomatisierung für Clients</span><span class="sxs-lookup"><span data-stu-id="da539-147">UI Automation Control Patterns for Clients</span></span>](ui-automation-control-patterns-for-clients.md)
- [<span data-ttu-id="da539-148">Navigieren zwischen Benutzeroberflächenautomatisierungs-Elementen mit TreeWalker</span><span class="sxs-lookup"><span data-stu-id="da539-148">Navigate Among UI Automation Elements with TreeWalker</span></span>](navigate-among-ui-automation-elements-with-treewalker.md)
- [<span data-ttu-id="da539-149">Übersicht über die Benutzeroberflächenautomatisierungs-Struktur</span><span class="sxs-lookup"><span data-stu-id="da539-149">UI Automation Tree Overview</span></span>](ui-automation-tree-overview.md)
- [<span data-ttu-id="da539-150">Verwenden der Zwischenspeicherung in der Benutzeroberflächenautomatisierung</span><span class="sxs-lookup"><span data-stu-id="da539-150">Use Caching in UI Automation</span></span>](use-caching-in-ui-automation.md)
