---
title: Sicherheitsaspekte bei der Reflektionsausgabe
ms.date: 03/30/2017
helpviewer_keywords:
- partially trusted code
- emitting dynamic assemblies, security
- reflection emit, security
- reflection emit, partial trust scenarios
- partial trust,emitting dynamic methods
- anonymously hosted dynamic methods [.NET Framework]
- emitting dynamic assemblies,partial trust scenarios
- dynamic assemblies, security
ms.assetid: 0f8bf8fa-b993-478f-87ab-1a1a7976d298
ms.openlocfilehash: 11eb4c9bc4ba1b1fe9051a04d12f893e693fb175
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/12/2020
ms.locfileid: "79180459"
---
# <a name="security-issues-in-reflection-emit"></a><span data-ttu-id="86658-102">Sicherheitsaspekte bei der Reflektionsausgabe</span><span class="sxs-lookup"><span data-stu-id="86658-102">Security Issues in Reflection Emit</span></span>
<span data-ttu-id="86658-103">.NET Framework bietet drei Möglichkeiten zum Ausgeben der Microsoft Intermediate Language (MSIL), die jeweils mit eigenen Sicherheitsproblemen verbunden sind:</span><span class="sxs-lookup"><span data-stu-id="86658-103">The .NET Framework provides three ways to emit Microsoft intermediate language (MSIL), each with its own security issues:</span></span>  
  
- [<span data-ttu-id="86658-104">Dynamische Assemblys</span><span class="sxs-lookup"><span data-stu-id="86658-104">Dynamic assemblies</span></span>](#Dynamic_Assemblies)  
  
- [<span data-ttu-id="86658-105">Anonym gehostete dynamische Methoden</span><span class="sxs-lookup"><span data-stu-id="86658-105">Anonymously hosted dynamic methods</span></span>](#Anonymously_Hosted_Dynamic_Methods)  
  
- [<span data-ttu-id="86658-106">Vorhandenen Assemblys zugeordnete dynamische Methoden</span><span class="sxs-lookup"><span data-stu-id="86658-106">Dynamic methods associated with existing assemblies</span></span>](#Dynamic_Methods_Associated_with_Existing_Assemblies)  
  
 <span data-ttu-id="86658-107">Unabhängig davon, wie Sie dynamischen Code generieren, erfordert die Ausführung des generierten Codes alle Berechtigungen, die für die Typen und Methoden erforderlich sind, die von dem generierten Code verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="86658-107">Regardless of the way you generate dynamic code, executing the generated code requires all the permissions that are required by the types and methods the generated code uses.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="86658-108">Die Berechtigungen, die für das Reflektieren und Ausgeben von Code erforderlich sind, haben sich mit den Nachfolgeversionen von .NET Framework geändert.</span><span class="sxs-lookup"><span data-stu-id="86658-108">The permissions that are required for reflecting on code and emitting code have changed with succeeding releases of the .NET Framework.</span></span> <span data-ttu-id="86658-109">Siehe weiter unten in diesem Thema unter [Versionsinformationen](#Version_Information).</span><span class="sxs-lookup"><span data-stu-id="86658-109">See [Version Information](#Version_Information), later in this topic.</span></span>  
  
<a name="Dynamic_Assemblies"></a>
## <a name="dynamic-assemblies"></a><span data-ttu-id="86658-110">Dynamische Assemblys</span><span class="sxs-lookup"><span data-stu-id="86658-110">Dynamic Assemblies</span></span>  
 <span data-ttu-id="86658-111">Dynamische Assemblys werden unter Verwendung von Überladungen der <xref:System.AppDomain.DefineDynamicAssembly%2A?displayProperty=nameWithType>-Methode erstellt.</span><span class="sxs-lookup"><span data-stu-id="86658-111">Dynamic assemblies are created by using overloads of the <xref:System.AppDomain.DefineDynamicAssembly%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="86658-112">Die meisten Überladungen dieser Methode werden in .NET Framework 4 nicht mehr unterstützt, weil computerweite Sicherheitsrichtlinien beseitigt wurden.</span><span class="sxs-lookup"><span data-stu-id="86658-112">Most overloads of this method are deprecated in the .NET Framework 4, because of the elimination of machine-wide security policy.</span></span> <span data-ttu-id="86658-113">(Siehe [Sicherheitsänderungen](../security/security-changes.md).) Die verbleibenden Überladungen können von jedem Code ausgeführt werden, unabhängig von der Vertrauensstufe.</span><span class="sxs-lookup"><span data-stu-id="86658-113">(See [Security Changes](../security/security-changes.md).) The remaining overloads can be executed by any code, regardless of trust level.</span></span> <span data-ttu-id="86658-114">Diese Überladungen fallen in zwei Gruppen: solche, die eine Liste mit Attributen angeben, die auf die dynamische Assembly angewendet werden sollen, wenn sie erstellt wird, und solche, die dies unterlassen.</span><span class="sxs-lookup"><span data-stu-id="86658-114">These overloads fall into two groups: those that specify a list of attributes to apply to the dynamic assembly when it is created, and those that do not.</span></span> <span data-ttu-id="86658-115">Wenn Sie das Transparenzmodell für die Assembly beim Erstellen nicht durch Anwendung des <xref:System.Security.SecurityRulesAttribute>-Attributs angeben, wird das Transparenzmodell von der ausgebenden Assembly geerbt.</span><span class="sxs-lookup"><span data-stu-id="86658-115">If you do not specify the transparency model for the assembly, by applying the <xref:System.Security.SecurityRulesAttribute> attribute when you create it, the transparency model is inherited from the emitting assembly.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="86658-116">Attribute, die Sie mithilfe von <xref:System.Reflection.Emit.AssemblyBuilder.SetCustomAttribute%2A> auf die dynamische Assembly nach deren Erstellung anwenden, werden erst wirksam, nachdem die Assembly auf dem Datenträger gespeichert und wieder in den Arbeitsspeicher geladen wurde.</span><span class="sxs-lookup"><span data-stu-id="86658-116">Attributes that you apply to the dynamic assembly after it is created, by using the <xref:System.Reflection.Emit.AssemblyBuilder.SetCustomAttribute%2A> method, do not take effect until the assembly has been saved to disk and loaded into memory again.</span></span>  
  
 <span data-ttu-id="86658-117">Code in einer dynamischen Assembly kann auf sichtbare Typen und Member in anderen Assemblys zugreifen.</span><span class="sxs-lookup"><span data-stu-id="86658-117">Code in a dynamic assembly can access visible types and members in other assemblies.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="86658-118">Dynamische Assemblys verwenden nicht die Flags <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> und <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, die es dynamischen Methoden gestatten, auf nicht öffentliche Typen und Member zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="86658-118">Dynamic assemblies do not use the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> and <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flags that allow dynamic methods to access nonpublic types and members.</span></span>  
  
 <span data-ttu-id="86658-119">Flüchtige dynamische Assemblys werden im Arbeitsspeicher erstellt und nie auf dem Datenträger gespeichert, weshalb sie keine Berechtigungen für den Dateizugriff benötigen.</span><span class="sxs-lookup"><span data-stu-id="86658-119">Transient dynamic assemblies are created in memory and never saved to disk, so they require no file access permissions.</span></span> <span data-ttu-id="86658-120">Für das Speichern einer dynamischen Assembly auf dem Datenträger ist <xref:System.Security.Permissions.FileIOPermission> mit den geeigneten Flags erforderlich.</span><span class="sxs-lookup"><span data-stu-id="86658-120">Saving a dynamic assembly to disk requires <xref:System.Security.Permissions.FileIOPermission> with the appropriate flags.</span></span>  
  
### <a name="generating-dynamic-assemblies-from-partially-trusted-code"></a><span data-ttu-id="86658-121">Generieren von dynamischen Assemblys aus teilweise vertrauenswürdigem Code</span><span class="sxs-lookup"><span data-stu-id="86658-121">Generating Dynamic Assemblies from Partially Trusted Code</span></span>  
 <span data-ttu-id="86658-122">Beachten Sie die Bedingungen, unter denen eine Assembly mit Internetberechtigungen eine flüchtige dynamische Assembly generieren und deren Code ausführen kann:</span><span class="sxs-lookup"><span data-stu-id="86658-122">Consider the conditions in which an assembly with Internet permissions can generate a transient dynamic assembly and execute its code:</span></span>  
  
- <span data-ttu-id="86658-123">Die dynamische Assembly verwendet nur öffentliche Typen und Member aus anderen Assemblys.</span><span class="sxs-lookup"><span data-stu-id="86658-123">The dynamic assembly uses only public types and members of other assemblies.</span></span>  
  
- <span data-ttu-id="86658-124">Die für diese Typen und Member erforderlichen Berechtigungen sind im Berechtigungssatz der teilweise vertrauenswürdigen Assembly enthalten.</span><span class="sxs-lookup"><span data-stu-id="86658-124">The permissions demanded by those types and members are included in the grant set of the partially trusted assembly.</span></span>  
  
- <span data-ttu-id="86658-125">Die Assembly wird nicht auf den Datenträger gespeichert.</span><span class="sxs-lookup"><span data-stu-id="86658-125">The assembly is not saved to disk.</span></span>  
  
- <span data-ttu-id="86658-126">Es werden keine Debugsymbole generiert.</span><span class="sxs-lookup"><span data-stu-id="86658-126">Debug symbols are not generated.</span></span> <span data-ttu-id="86658-127">(`Internet`- und `LocalIntranet`-Berechtigungssätze enthalten nicht die notwendigen Berechtigungen.)</span><span class="sxs-lookup"><span data-stu-id="86658-127">(`Internet` and `LocalIntranet` permission sets do not include the necessary permissions.)</span></span>  
  
<a name="Anonymously_Hosted_Dynamic_Methods"></a>
## <a name="anonymously-hosted-dynamic-methods"></a><span data-ttu-id="86658-128">Anonym gehostete dynamische Methoden</span><span class="sxs-lookup"><span data-stu-id="86658-128">Anonymously Hosted Dynamic Methods</span></span>  
 <span data-ttu-id="86658-129">Anonym gehostete dynamische Methoden werden mithilfe der zwei <xref:System.Reflection.Emit.DynamicMethod>-Konstruktoren erstellt, die kein zugeordnetes Modul und keinen zugeordneten Typ angeben, <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%29> und <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%2CSystem.Boolean%29>.</span><span class="sxs-lookup"><span data-stu-id="86658-129">Anonymously hosted dynamic methods are created by using the two <xref:System.Reflection.Emit.DynamicMethod> constructors that do not specify an associated type or module, <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%29> and <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%2CSystem.Boolean%29>.</span></span> <span data-ttu-id="86658-130">Diese Konstruktoren fügen die dynamischen Methoden in eine vom System bereitgestellte, vollständig vertrauenswürdige, sicherheitstransparente Assembly ein.</span><span class="sxs-lookup"><span data-stu-id="86658-130">These constructors place the dynamic methods in a system-provided, fully trusted, security-transparent assembly.</span></span> <span data-ttu-id="86658-131">Es sind keine Berechtigungen erforderlich, um diese Konstruktoren zu verwenden oder Code für die dynamischen Methoden auszugeben.</span><span class="sxs-lookup"><span data-stu-id="86658-131">No permissions are required to use these constructors or to emit code for the dynamic methods.</span></span>  
  
 <span data-ttu-id="86658-132">Stattdessen wird, wenn eine anonym gehostete dynamische Methode erstellt wird, wird die Aufrufliste erfasst.</span><span class="sxs-lookup"><span data-stu-id="86658-132">Instead, when an anonymously hosted dynamic method is created, the call stack is captured.</span></span> <span data-ttu-id="86658-133">Wenn die Methode erstellt wird, werden anhand der erfassten Aufrufliste Sicherheitsanforderungen aufgestellt.</span><span class="sxs-lookup"><span data-stu-id="86658-133">When the method is constructed, security demands are made against the captured call stack.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="86658-134">Konzeptionell werden Anforderungen während der Erstellung der Methode gestellt.</span><span class="sxs-lookup"><span data-stu-id="86658-134">Conceptually, demands are made during the construction of the method.</span></span> <span data-ttu-id="86658-135">Das heißt, dass bei jeder Ausgabe einer MSIL-Anweisung Anforderungen gestellt werden könnten.</span><span class="sxs-lookup"><span data-stu-id="86658-135">That is, demands could be made as each MSIL instruction is emitted.</span></span> <span data-ttu-id="86658-136">In der aktuellen Implementierung werden alle Forderungen gestellt, wenn die <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A?displayProperty=nameWithType>-Methode aufgerufen wird oder wenn der JIT-Compiler (Just-in-Time) aufgerufen wird, falls die Methode ohne Aufruf von <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A> aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="86658-136">In the current implementation, all demands are made when the <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A?displayProperty=nameWithType> method is called or when the just-in-time (JIT) compiler is invoked, if the method is invoked without calling <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>.</span></span>  
  
 <span data-ttu-id="86658-137">Wenn die Anwendungsdomäne dies zulässt, können anonym gehostete dynamische Methoden JIT-Sichtbarkeitsprüfungen gemäß der folgenden Einschränkung überspringen: Die nicht öffentliche Typen und Member, auf die von einer anonym gehosteten dynamischen Methode zugegriffen wird, muss sich in Assemblys befinden, deren Berechtigungssätze mit dem Berechtigungssatz der ausgebenden Aufrufliste übereinstimmen oder eine Teilmenge davon darstellen.</span><span class="sxs-lookup"><span data-stu-id="86658-137">If the application domain permits it, anonymously hosted dynamic methods can skip JIT visibility checks, subject to the following restriction: The nonpublic types and members accessed by an anonymously hosted dynamic method must be in assemblies whose grant sets are equal to, or subsets of, the grant set of the emitting call stack.</span></span> <span data-ttu-id="86658-138">Diese eingeschränkte Fähigkeit zum Überspringen von JIT-Sichtbarkeitsprüfungen wird aktiviert, wenn die Anwendungsdomäne mit dem <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>-Flag <xref:System.Security.Permissions.ReflectionPermission> erteilt.</span><span class="sxs-lookup"><span data-stu-id="86658-138">This restricted ability to skip JIT visibility checks is enabled if the application domain grants <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="86658-139">Wenn Ihre Methode nur öffentliche Typen und Member verwendet, sind während der Erstellung keine Berechtigungen erforderlich.</span><span class="sxs-lookup"><span data-stu-id="86658-139">If your method uses only public types and members, no permissions are required during construction.</span></span>  
  
- <span data-ttu-id="86658-140">Wenn Sie angeben, dass JIT-Sichtbarkeitsprüfungen übersprungen werden sollen, enthält die Anforderung, die gestellt wird, wenn die Methode erstellt wird, <xref:System.Security.Permissions.ReflectionPermission> mit dem <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>-Flag und dem Berechtigungssatz der Assembly, die den nicht öffentlichen Member enthält, auf den zugegriffen wird.</span><span class="sxs-lookup"><span data-stu-id="86658-140">If you specify that JIT visibility checks should be skipped, the demand that is made when the method is constructed includes <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag and the grant set of the assembly that contains the nonpublic member that is being accessed.</span></span>  
  
 <span data-ttu-id="86658-141">Da der Berechtigungssatz des nicht öffentlichen Members berücksichtigt wird, kann teilweise vertrauenswürdiger Code, dem <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> gewährt wurde, seine Rechte nicht durch die Ausführung nicht öffentlicher Member vertrauenswürdiger Assemblys erhöhen.</span><span class="sxs-lookup"><span data-stu-id="86658-141">Because the grant set of the nonpublic member is taken into consideration, partially trusted code that has been granted <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> cannot elevate its privileges by executing nonpublic members of trusted assemblies.</span></span>  
  
 <span data-ttu-id="86658-142">Wie bei jedem anderen ausgegebenen Code auch, erfordert die Ausführung der dynamischen Methode alle Berechtigungen, die von den Methoden angefordert werden, die die dynamische Methode verwendet.</span><span class="sxs-lookup"><span data-stu-id="86658-142">As with any other emitted code, executing the dynamic method requires whatever permissions are demanded by the methods the dynamic method uses.</span></span>  
  
 <span data-ttu-id="86658-143">Die Systemassembly, die anonym gehostete dynamische Methoden hostet, verwendet das Transparenzmodell <xref:System.Security.SecurityRuleSet.Level1?displayProperty=nameWithType>. Hierbei handelt es sich um das Transparenzmodell, das in .NET Framework vor .NET Framework 4 verwendet wurde.</span><span class="sxs-lookup"><span data-stu-id="86658-143">The system assembly that hosts anonymously-hosted dynamic methods uses the <xref:System.Security.SecurityRuleSet.Level1?displayProperty=nameWithType> transparency model, which is the transparency model that was used in the .NET Framework before the .NET Framework 4.</span></span>  
  
 <span data-ttu-id="86658-144">Weitere Informationen finden Sie in den Ausführungen zur <xref:System.Reflection.Emit.DynamicMethod>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="86658-144">For more information, see the <xref:System.Reflection.Emit.DynamicMethod> class.</span></span>  
  
### <a name="generating-anonymously-hosted-dynamic-methods-from-partially-trusted-code"></a><span data-ttu-id="86658-145">Generieren von anonym gehosteten dynamischen Methoden aus teilweise vertrauenswürdigem Code</span><span class="sxs-lookup"><span data-stu-id="86658-145">Generating Anonymously Hosted Dynamic Methods from Partially Trusted Code</span></span>  
 <span data-ttu-id="86658-146">Beachten Sie die Bedingungen, unter denen eine Assembly mit Internetberechtigungen eine anonym gehostete dynamische Methode generieren und ausführen kann:</span><span class="sxs-lookup"><span data-stu-id="86658-146">Consider the conditions in which an assembly with Internet permissions can generate an anonymously hosted dynamic method and execute it:</span></span>  
  
- <span data-ttu-id="86658-147">Die dynamische Methode verwendet nur öffentliche Typen und Member.</span><span class="sxs-lookup"><span data-stu-id="86658-147">The dynamic method uses only public types and members.</span></span> <span data-ttu-id="86658-148">Wenn ihr Berechtigungssatz <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> enthält, kann sie nicht öffentliche Typen und Member jeder Assembly verwenden, deren Berechtigungssatz mit dem Berechtigungssatz der ausgebenden Assembly übereinstimmt oder eine Teilmenge davon darstellt.</span><span class="sxs-lookup"><span data-stu-id="86658-148">If its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, it can use nonpublic types and members of any assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly.</span></span>  
  
- <span data-ttu-id="86658-149">Die für alle von der dynamischen Methode verwendeten Typen und Member erforderlichen Berechtigungen sind in dem Berechtigungssatz der teilweise vertrauenswürdigen Assembly enthalten.</span><span class="sxs-lookup"><span data-stu-id="86658-149">The permissions that are required by all the types and members used by the dynamic method are included in the grant set of the partially trusted assembly.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="86658-150">Dynamische Methoden unterstützen keine Debugsymbole.</span><span class="sxs-lookup"><span data-stu-id="86658-150">Dynamic methods do not support debug symbols.</span></span>  
  
<a name="Dynamic_Methods_Associated_with_Existing_Assemblies"></a>
## <a name="dynamic-methods-associated-with-existing-assemblies"></a><span data-ttu-id="86658-151">Vorhandenen Assemblys zugeordnete dynamische Methoden</span><span class="sxs-lookup"><span data-stu-id="86658-151">Dynamic Methods Associated with Existing Assemblies</span></span>  
 <span data-ttu-id="86658-152">Um eine dynamische Methode einem Typ oder Modul in einer vorhandenen Assembly zuzuordnen, verwenden Sie einen der <xref:System.Reflection.Emit.DynamicMethod>-Konstruktoren, die den zugeordneten Typ bzw. das zugeordnete Modul angeben.</span><span class="sxs-lookup"><span data-stu-id="86658-152">To associate a dynamic method with a type or module in an existing assembly, use any of the <xref:System.Reflection.Emit.DynamicMethod> constructors that specify the associated type or module.</span></span> <span data-ttu-id="86658-153">Die Berechtigungen, die erforderlich sind, um diese Konstruktoren aufzurufen, variieren, da das Zuordnen einer dynamischen Methode zu einem vorhandenen Typ oder Modul der dynamischen Methode den Zugriff auf nicht öffentliche Typen und Member gewährt:</span><span class="sxs-lookup"><span data-stu-id="86658-153">The permissions that are required to call these constructors vary, because associating a dynamic method with an existing type or module gives the dynamic method access to nonpublic types and members:</span></span>  
  
- <span data-ttu-id="86658-154">Eine dynamische Methode, die einem Typ zugeordnet ist, hat Zugriff auf alle Member dieses Typs, einschließlich privater Member, sowie auf alle internen Typen und Member in der Assembly, die den zugeordneten Typ enthält.</span><span class="sxs-lookup"><span data-stu-id="86658-154">A dynamic method that is associated with a type has access to all members of that type, even private members, and to all internal types and members in the assembly that contains the associated type.</span></span>  
  
- <span data-ttu-id="86658-155">Eine dynamische Methode, die einem Modul zugeordnet ist, hat Zugriff auf alle `internal`-Typen und -Member (`Friend` in Visual Basic, `assembly` in Common Language Runtime-Metadaten) in dem Modul.</span><span class="sxs-lookup"><span data-stu-id="86658-155">A dynamic method that is associated with a module has access to all the `internal` types and members (`Friend` in Visual Basic, `assembly` in common language runtime metadata) in the module.</span></span>  
  
 <span data-ttu-id="86658-156">Darüber hinaus können Sie einen Konstruktor verwenden, der die Fähigkeit zum Überspringen der Sichtbarkeitsprüfungen des JIT-Compilers angibt.</span><span class="sxs-lookup"><span data-stu-id="86658-156">In addition, you can use a constructor that specifies the ability to skip the visibility checks of the JIT compiler.</span></span> <span data-ttu-id="86658-157">Auf diese Weise erhält Ihre dynamische Methode Zugriff auf alle Typen und Member in allen Assemblys, unabhängig von der Zugriffsebene.</span><span class="sxs-lookup"><span data-stu-id="86658-157">Doing so gives your dynamic method access to all types and members in all assemblies, regardless of access level.</span></span>  
  
 <span data-ttu-id="86658-158">Die vom Konstruktor angeforderten Berechtigungen sind davon abhängig, in welchem Umfang Sie Ihrer dynamischen Methode Zugriff erteilen möchten:</span><span class="sxs-lookup"><span data-stu-id="86658-158">The permissions demanded by the constructor depend on how much access you decide to give your dynamic method:</span></span>  
  
- <span data-ttu-id="86658-159">Wenn Ihre Methode nur öffentliche Typen und Member verwendet, und Sie sie Ihrem eigenen Typ bzw. Modul zuordnen, sind keine Berechtigungen erforderlich.</span><span class="sxs-lookup"><span data-stu-id="86658-159">If your method uses only public types and members, and you associate it with your own type or your own module, no permissions are required.</span></span>  
  
- <span data-ttu-id="86658-160">Wenn Sie angeben, dass JIT-Sichtbarkeitsprüfungen übersprungen werden sollen, erfordert der Konstruktor <xref:System.Security.Permissions.ReflectionPermission> mit dem <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType>-Flag.</span><span class="sxs-lookup"><span data-stu-id="86658-160">If you specify that JIT visibility checks should be skipped, the constructor demands <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="86658-161">Wenn Sie die dynamische Methode einem anderen Typ zuordnen, auch wenn es ein anderer Typ in Ihrer eigenen Assembly sein sollte, erfordert der Konstruktor <xref:System.Security.Permissions.ReflectionPermission> mit dem <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType>-Flag sowie <xref:System.Security.Permissions.SecurityPermission> mit dem <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType>-Flag.</span><span class="sxs-lookup"><span data-stu-id="86658-161">If you associate the dynamic method with another type, even another type in your own assembly, the constructor demands <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag and <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="86658-162">Wenn Sie die dynamische Methode einem Typ oder Modul in einer anderen Assembly zuordnen, erfordert der Konstruktor zwei Dinge: <xref:System.Security.Permissions.ReflectionPermission> mit dem <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>-Flag sowie den Berechtigungssatz der Assembly, die das andere Modul enthält.</span><span class="sxs-lookup"><span data-stu-id="86658-162">If you associate the dynamic method with a type or module in another assembly, the constructor demands two things: <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag, and the grant set of the assembly that contains the other module.</span></span> <span data-ttu-id="86658-163">Das heißt, Ihre Aufrufliste muss alle Berechtigungen aus dem Berechtigungssatz des Zielmoduls enthalten, zuzüglich <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="86658-163">That is, your call stack must include all the permissions in the grant set of the target module, plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="86658-164">Um Abwärtskompatibilität zu gewährleisten, wenn die Anforderung des Zielberechtigungssatzes zuzüglich <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> fehlschlägt, erfordert der Konstruktor <xref:System.Security.Permissions.SecurityPermission> mit dem <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType>-Flag.</span><span class="sxs-lookup"><span data-stu-id="86658-164">For backward compatibility, if the demand for the target grant set plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> fails, the constructor demands <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flag.</span></span>  
  
 <span data-ttu-id="86658-165">Obgleich die Elemente in dieser Liste unter dem Aspekt des Berechtigungssatzes der ausgebenden Assembly beschrieben werden, sollten Sie daran denken, dass die Anforderungen an die gesamte Aufrufliste, einschließlich der Grenze der Anwendungsdomäne, gestellt werden.</span><span class="sxs-lookup"><span data-stu-id="86658-165">Although the items in this list are described in terms of the grant set of the emitting assembly, remember that the demands are made against the full call stack, including the application domain boundary.</span></span>  
  
 <span data-ttu-id="86658-166">Weitere Informationen finden Sie in den Ausführungen zur <xref:System.Reflection.Emit.DynamicMethod>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="86658-166">For more information, see the <xref:System.Reflection.Emit.DynamicMethod> class.</span></span>  
  
### <a name="generating-dynamic-methods-from-partially-trusted-code"></a><span data-ttu-id="86658-167">Generieren von dynamischen Methoden aus teilweise vertrauenswürdigem Code</span><span class="sxs-lookup"><span data-stu-id="86658-167">Generating Dynamic Methods from Partially Trusted Code</span></span>  
  
> [!NOTE]
> <span data-ttu-id="86658-168">Die empfohlene Vorgehensweise zum Generieren dynamischer Methoden aus teilweise vertrauenswürdigem Code besteht in der Verwendung [anonym gehosteter dynamischer Methoden](#Anonymously_Hosted_Dynamic_Methods).</span><span class="sxs-lookup"><span data-stu-id="86658-168">The recommended way to generate dynamic methods from partially trusted code is to use [anonymously hosted dynamic methods](#Anonymously_Hosted_Dynamic_Methods).</span></span>  
  
 <span data-ttu-id="86658-169">Beachten Sie die Bedingungen, unter denen eine Assembly mit Internetberechtigungen eine dynamische Methode generieren und ausführen kann:</span><span class="sxs-lookup"><span data-stu-id="86658-169">Consider the conditions in which an assembly with Internet permissions can generate a dynamic method and execute it:</span></span>  
  
- <span data-ttu-id="86658-170">Entweder ist die dynamische Methode dem Modul oder Typ zugeordnet, das/den sie ausgibt, oder ihr Berechtigungssatz enthält <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> und dieser ist einem Modul in einer Assembly zugeordnet, deren Berechtigungssatz mit dem Berechtigungssatz der ausgebenden Assembly übereinstimmt oder eine Teilmenge davon darstellt.</span><span class="sxs-lookup"><span data-stu-id="86658-170">Either the dynamic method is associated with the module or type that emits it, or its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> and it is associated with a module in an assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly.</span></span>  
  
- <span data-ttu-id="86658-171">Die dynamische Methode verwendet nur öffentliche Typen und Member.</span><span class="sxs-lookup"><span data-stu-id="86658-171">The dynamic method uses only public types and members.</span></span> <span data-ttu-id="86658-172">Wenn ihr Berechtigungssatz <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> enthält und dieser einem Modul in einer Assembly zugeordnet ist, deren Berechtigungssatz mit dem Berechtigungssatz der ausgebenden Assembly übereinstimmt oder eine Teilmenge davon darstellt, kann sie Typen und Member verwenden, die in dem zugeordneten Modul als `internal` (`Friend` in Visual Basic, `assembly` in Common Language Runtime-Metadaten) markiert sind.</span><span class="sxs-lookup"><span data-stu-id="86658-172">If its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> and it is associated with a module in an assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly, it can use types and members marked `internal` (`Friend` in Visual Basic, `assembly` in common language runtime metadata) in the associated module.</span></span>  
  
- <span data-ttu-id="86658-173">Die für alle von der dynamischen Methode verwendeten Typen und Member angeforderten Berechtigungen sind in dem Berechtigungssatz der teilweise vertrauenswürdigen Assembly enthalten.</span><span class="sxs-lookup"><span data-stu-id="86658-173">The permissions demanded by all the types and members used by the dynamic method are included in the grant set of the partially trusted assembly.</span></span>  
  
- <span data-ttu-id="86658-174">Die dynamische Methode überspringt keine JIT-Sichtbarkeitsprüfungen.</span><span class="sxs-lookup"><span data-stu-id="86658-174">The dynamic method does not skip JIT visibility checks.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="86658-175">Dynamische Methoden unterstützen keine Debugsymbole.</span><span class="sxs-lookup"><span data-stu-id="86658-175">Dynamic methods do not support debug symbols.</span></span>  
  
<a name="Version_Information"></a>
## <a name="version-information"></a><span data-ttu-id="86658-176">Versionsinformationen</span><span class="sxs-lookup"><span data-stu-id="86658-176">Version Information</span></span>  
 <span data-ttu-id="86658-177">Ab .NET Framework 4 wurde die computerweite Sicherheitsrichtlinie beseitigt, und Sicherheitstransparenz wird zum standardmäßigen Erzwingungsmechanismus.</span><span class="sxs-lookup"><span data-stu-id="86658-177">Starting with the .NET Framework 4, machine-wide security policy is eliminated and security transparency becomes the default enforcement mechanism.</span></span> <span data-ttu-id="86658-178">Weitere Informationen finden Sie unter [Sicherheitsänderungen](../security/security-changes.md).</span><span class="sxs-lookup"><span data-stu-id="86658-178">See [Security Changes](../security/security-changes.md).</span></span>  
  
 <span data-ttu-id="86658-179">Ab .NET Framework 2.0 Service Pack 1 ist <xref:System.Security.Permissions.ReflectionPermission> mit dem <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType>-Flag beim Ausgeben von dynamischen Assemblys und dynamischen Methoden nicht mehr erforderlich.</span><span class="sxs-lookup"><span data-stu-id="86658-179">Starting with the .NET Framework 2.0 Service Pack 1, <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flag is no longer required when emitting dynamic assemblies and dynamic methods.</span></span> <span data-ttu-id="86658-180">In allen früheren Versionen von .NET Framework ist dieses Flag erforderlich.</span><span class="sxs-lookup"><span data-stu-id="86658-180">This flag is required in all earlier versions of the .NET Framework.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="86658-181"><xref:System.Security.Permissions.ReflectionPermission> mit dem <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType>-Flag ist standardmäßig in den benannten Berechtigungsätzen `FullTrust` und `LocalIntranet` enthalten, aber nicht im `Internet`-Berechtigungssatz.</span><span class="sxs-lookup"><span data-stu-id="86658-181"><xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flag is included by default in the `FullTrust` and `LocalIntranet` named permission sets, but not in the `Internet` permission set.</span></span> <span data-ttu-id="86658-182">Aus diesem Grund kann in früheren Versionen von .NET Framework eine Bibliothek mit Internetberechtigungen nur dann verwendet werden, wenn dafür ein <xref:System.Security.PermissionSet.Assert%2A>-Element für <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit> ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="86658-182">Therefore, in earlier versions of the .NET Framework, a library can be used with Internet permissions only if it executes an <xref:System.Security.PermissionSet.Assert%2A> for <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>.</span></span> <span data-ttu-id="86658-183">Diese Bibliotheken erfordern einen sorgfältigen Sicherheitsreview, da Codierungsfehler zu Sicherheitslücken führen können.</span><span class="sxs-lookup"><span data-stu-id="86658-183">Such libraries require careful security review because coding errors could result in security holes.</span></span> <span data-ttu-id="86658-184">In .NET Framework 2.SP1 0 ist es möglich, Code in teilweise vertrauenswürdigen Szenarios ohne Sicherheitsanforderungen auszugeben, da das Generieren von Code an sich keinen privilegierten Vorgang darstellt.</span><span class="sxs-lookup"><span data-stu-id="86658-184">The .NET Framework 2.0 SP1 allows code to be emitted in partial trust scenarios without issuing any security demands, because generating code is not inherently a privileged operation.</span></span> <span data-ttu-id="86658-185">Das bedeutet, dass der generierte Code nicht mehr Berechtigungen aufweist als die Assembly, die ihn ausgibt.</span><span class="sxs-lookup"><span data-stu-id="86658-185">That is, the generated code has no more permissions than the assembly that emits it.</span></span> <span data-ttu-id="86658-186">Dies ermöglicht es, dass Bibliotheken, die Code ausgeben, sicherheitstransparent sein können, und beseitigt die Notwendigkeit der Assertion von <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>, was das Schreiben einer sicheren Bibliothek vereinfacht.</span><span class="sxs-lookup"><span data-stu-id="86658-186">This allows libraries that emit code to be security transparent and removes the need to assert <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>, which simplifies the task of writing a secure library.</span></span>  
  
 <span data-ttu-id="86658-187">Darüber hinaus wurde in .NET Framework 2.0 SP1 das <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>-Flag für den Zugriff auf nicht öffentliche Typen und Member aus teilweise vertrauenswürdigen dynamischen Methoden eingeführt.</span><span class="sxs-lookup"><span data-stu-id="86658-187">In addition, the .NET Framework 2.0 SP1 introduces the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag for accessing nonpublic types and members from partially trusted dynamic methods.</span></span> <span data-ttu-id="86658-188">Frühere Versionen von .NET Framework erfordern das <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType>-Flag für dynamische Methoden, die auf nicht öffentliche Typen und Member zugreifen. Diese Berechtigung sollte niemals teilweise vertrauenswürdigem Code erteilt werden.</span><span class="sxs-lookup"><span data-stu-id="86658-188">Earlier versions of the .NET Framework require the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag for dynamic methods that access nonpublic types and members; this is a permission that should never be granted to partially trusted code.</span></span>  
  
 <span data-ttu-id="86658-189">Schließlich wurden in .NET Framework 2.0 SP1 anonym gehostete Methoden eingeführt.</span><span class="sxs-lookup"><span data-stu-id="86658-189">Finally, the .NET Framework 2.0 SP1 introduces anonymously hosted methods.</span></span>  
  
### <a name="obtaining-information-on-types-and-members"></a><span data-ttu-id="86658-190">Abrufen von Informationen zu Typen und Member</span><span class="sxs-lookup"><span data-stu-id="86658-190">Obtaining Information on Types and Members</span></span>  
 <span data-ttu-id="86658-191">Ab .NET Framework 2.0 sind keine Berechtigungen erforderlich, um Informationen über nicht öffentliche Typen und Member abzurufen.</span><span class="sxs-lookup"><span data-stu-id="86658-191">Starting with the .NET Framework 2.0, no permissions are required to obtain information about nonpublic types and members.</span></span> <span data-ttu-id="86658-192">Reflektion wird verwendet, um Informationen abzurufen, die zum Ausgeben dynamischer Methoden erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="86658-192">Reflection is used to obtain information needed to emit dynamic methods.</span></span> <span data-ttu-id="86658-193">Beispielsweise werden <xref:System.Reflection.MethodInfo>-Objekte verwendet, um Methodenaufrufe auszugeben.</span><span class="sxs-lookup"><span data-stu-id="86658-193">For example, <xref:System.Reflection.MethodInfo> objects are used to emit method calls.</span></span> <span data-ttu-id="86658-194">Frühere Versionen von .NET Framework erfordern <xref:System.Security.Permissions.ReflectionPermission> mit dem <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType>-Flag.</span><span class="sxs-lookup"><span data-stu-id="86658-194">Earlier versions of the .NET Framework require <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType> flag.</span></span> <span data-ttu-id="86658-195">Weitere Informationen finden Sie unter [Sicherheitsüberlegungen für die Reflektion](security-considerations-for-reflection.md).</span><span class="sxs-lookup"><span data-stu-id="86658-195">For more information, see [Security Considerations for Reflection](security-considerations-for-reflection.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="86658-196">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="86658-196">See also</span></span>

- [<span data-ttu-id="86658-197">Sicherheitsüberlegungen für die Reflektion</span><span class="sxs-lookup"><span data-stu-id="86658-197">Security Considerations for Reflection</span></span>](security-considerations-for-reflection.md)
- [<span data-ttu-id="86658-198">Ausgeben von dynamischen Methoden und Assemblys</span><span class="sxs-lookup"><span data-stu-id="86658-198">Emitting Dynamic Methods and Assemblies</span></span>](emitting-dynamic-methods-and-assemblies.md)
