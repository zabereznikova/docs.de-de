---
title: Übersicht über das Drucken
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print path [WPF], XPS
- printers [WPF], XPSDrv-based
- printing [WPF]
- PrintQueue class PrintServer class [WPF]
- XML Paper Specification (XPS) file format
- XPS (XML Paper Specification) file format
- XPSDrv-based printers
- GDI print path [WPF]
ms.assetid: 0de8ac41-9aa6-413d-a121-7aa6f41539b1
ms.openlocfilehash: 5204165370459466b1258897e72c488ab7e7fadb
ms.sourcegitcommit: f348c84443380a1959294cdf12babcb804cfa987
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/12/2019
ms.locfileid: "73975778"
---
# <a name="printing-overview"></a><span data-ttu-id="a7c49-102">Übersicht über das Drucken</span><span class="sxs-lookup"><span data-stu-id="a7c49-102">Printing Overview</span></span>
<span data-ttu-id="a7c49-103">Mit Microsoft .NET Framework verfügen Anwendungsentwickler, die Windows Presentation Foundation (WPF) verwenden, über einen umfangreichen neuen Satz von Druck-und drucksystemverwaltungs-APIs.</span><span class="sxs-lookup"><span data-stu-id="a7c49-103">With Microsoft .NET Framework, application developers using Windows Presentation Foundation (WPF) have a rich new set of printing and print system management APIs.</span></span> <span data-ttu-id="a7c49-104">Mit Windows Vista sind einige dieser Erweiterungen des Drucksystems auch für Entwickler verfügbar, die [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] Anwendungen und Entwicklern mit nicht verwaltetem Code erstellen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-104">With Windows Vista, some of these print system enhancements are also available to developers creating [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] applications and developers using unmanaged code.</span></span> <span data-ttu-id="a7c49-105">Der Kern dieser neuen Funktionalität ist das neue XPS-Dateiformat (XML Paper Specification) und der XPS-Druckpfad.</span><span class="sxs-lookup"><span data-stu-id="a7c49-105">At the core of this new functionality is the new XML Paper Specification (XPS) file format and the XPS print path.</span></span>  
  
 <span data-ttu-id="a7c49-106">Dieses Thema enthält folgende Abschnitte:</span><span class="sxs-lookup"><span data-stu-id="a7c49-106">This topic contains the following sections.</span></span>  
  
<a name="introduction_to_XPS"></a>   
## <a name="about-xps"></a><span data-ttu-id="a7c49-107">Info über XPS</span><span class="sxs-lookup"><span data-stu-id="a7c49-107">About XPS</span></span>  
 <span data-ttu-id="a7c49-108">XPS ist ein elektronisches Dokumentformat, ein spooldateiformat und eine Seitenbeschreibungssprache.</span><span class="sxs-lookup"><span data-stu-id="a7c49-108">XPS is an electronic document format, a spool file format and a page description language.</span></span> <span data-ttu-id="a7c49-109">Es handelt sich um ein offenes Dokumentformat, in dem XML, Open Packaging Conventions (OPC) und andere Industriestandards zum Erstellen von plattformübergreifenden Dokumenten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="a7c49-109">It is an open document format that uses XML, Open Packaging Conventions (OPC), and other industry standards to create cross-platform documents.</span></span> <span data-ttu-id="a7c49-110">XPS vereinfacht den Prozess, mit dem digitale Dokumente erstellt, freigegeben, gedruckt, angezeigt und archiviert werden.</span><span class="sxs-lookup"><span data-stu-id="a7c49-110">XPS simplifies the process by which digital documents are created, shared, printed, viewed, and archived.</span></span> <span data-ttu-id="a7c49-111">Weitere Informationen zu XPS finden Sie unter [XPS-Dokumente](/windows/desktop/printdocs/documents).</span><span class="sxs-lookup"><span data-stu-id="a7c49-111">For additional information on XPS, see [XPS Documents](/windows/desktop/printdocs/documents).</span></span>  
  
 <span data-ttu-id="a7c49-112">Verschiedene Verfahren zum Drucken von XPS-basiertem Inhalt mithilfe von [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] werden in Programm gesteuertes [Drucken von XPS-Dateien](how-to-programmatically-print-xps-files.md)veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="a7c49-112">Several techniques for printing XPS-based content using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] are demonstrated in [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="a7c49-113">Es kann sinnvoll sein, diese Beispiele beim Durcharbeiten der in diesem Thema enthaltenen Inhalte hinzuzuziehen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-113">You may find it useful to reference these samples during review of content contained in this topic.</span></span> <span data-ttu-id="a7c49-114">(Entwickler von nicht verwaltetem Code sollten die Dokumentation für die [MXDC_ESCAPE-Funktion](/windows/desktop/printdocs/mxdc-escape)sehen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-114">(Unmanaged code developers should see documentation for the [MXDC_ESCAPE function](/windows/desktop/printdocs/mxdc-escape).</span></span> <span data-ttu-id="a7c49-115">Windows Forms Entwickler müssen die API im <xref:System.Drawing.Printing>-Namespace verwenden, der nicht den vollständigen XPS-Druckpfad unterstützt, aber einen Hybriden GDI-zu-XPS-Druckpfad unterstützt.</span><span class="sxs-lookup"><span data-stu-id="a7c49-115">Windows Forms developers must use the API in the <xref:System.Drawing.Printing> namespace which does not support the full XPS print path, but does support a hybrid GDI-to-XPS print path.</span></span> <span data-ttu-id="a7c49-116">Weitere Informationen finden Sie unter **Druckpfadarchitektur** unten.)</span><span class="sxs-lookup"><span data-stu-id="a7c49-116">See **Print Path Architecture** below.)</span></span>  
  
<a name="XPS_print_path_intro"></a>   
## <a name="xps-print-path"></a><span data-ttu-id="a7c49-117">XPS-Druckpfad</span><span class="sxs-lookup"><span data-stu-id="a7c49-117">XPS Print Path</span></span>  
 <span data-ttu-id="a7c49-118">Der XML Paper Specification (XPS)-Druckpfad ist ein neues Windows-Feature, mit dem die Behandlung von Druck Vorgängen in Windows-Anwendungen neu definiert wird.</span><span class="sxs-lookup"><span data-stu-id="a7c49-118">The XML Paper Specification (XPS) print path is a new Windows feature that redefines how printing is handled in Windows applications.</span></span> <span data-ttu-id="a7c49-119">Da XPS eine Dokument Präsentations Sprache (z. b. RTF), ein druckerspoolerformat (z. b. WMF) und eine Seitenbeschreibungssprache (z. b. PCL oder PostScript) ersetzen kann, der neue Druckpfad behält das XPS-Format von der Anwendungs Veröffentlichung bis zur abschließenden Verarbeitung im Druckertreiber oder-Gerät bei.</span><span class="sxs-lookup"><span data-stu-id="a7c49-119">Because XPS can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the XPS format from application publication to the final processing in the print driver or device.</span></span>  
  
 <span data-ttu-id="a7c49-120">Der XPS-Druckpfad basiert auf dem XPS-Druckertreiber Modell (XPSDrv), das Entwicklern einige Vorteile bietet, wie z. b. "was Sie sehen, was Sie erhalten" (WYSIWYG) Druck, verbesserte Farbunterstützung und erheblich verbesserte Druckleistung.</span><span class="sxs-lookup"><span data-stu-id="a7c49-120">The XPS print path is built upon the XPS printer driver model (XPSDrv), which provides several benefits for developers such as "what you see is what you get" (WYSIWYG) printing, improved color support, and significantly improved print performance.</span></span> <span data-ttu-id="a7c49-121">(Weitere Informationen zu XPSDrv finden Sie in der [Dokumentation zum Windows-Treiberkit](/windows-hardware/drivers/).)</span><span class="sxs-lookup"><span data-stu-id="a7c49-121">(For more on XPSDrv, see the [Windows Driver Kit documentation](/windows-hardware/drivers/).)</span></span>  
  
 <span data-ttu-id="a7c49-122">Der Vorgang des Druck Spoolers für XPS-Dokumente entspricht im Wesentlichen dem in früheren Versionen von Windows.</span><span class="sxs-lookup"><span data-stu-id="a7c49-122">The operation of the print spooler for XPS documents is essentially the same as in previous versions of Windows.</span></span> <span data-ttu-id="a7c49-123">Es wurde jedoch verbessert, um den XPS-Druck Pfad zusätzlich zum vorhandenen GDI-Druckpfad zu unterstützen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-123">However, it has been enhanced to support the XPS print path in addition to the existing GDI print path.</span></span> <span data-ttu-id="a7c49-124">Der neue Druckpfad nutzt nativ eine XPS-Spooldatei.</span><span class="sxs-lookup"><span data-stu-id="a7c49-124">The new print path natively consumes an XPS spool file.</span></span> <span data-ttu-id="a7c49-125">Obwohl für frühere Versionen von Windows geschriebene Druckertreiber für den Benutzermodus weiterhin funktionieren, ist ein XPS-Druckertreiber (XPSDrv) erforderlich, um den XPS-Druckpfad zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="a7c49-125">While user-mode printer drivers written for previous versions of Windows will continue to work, an XPS printer driver (XPSDrv) is required in order to use the XPS print path.</span></span>  
  
 <span data-ttu-id="a7c49-126">Die Vorteile des XPS-Druck Pfads sind erheblich und umfassen Folgendes:</span><span class="sxs-lookup"><span data-stu-id="a7c49-126">The benefits of the XPS print path are significant, and include:</span></span>  
  
- <span data-ttu-id="a7c49-127">WYSIWYG-Druckunterstützung</span><span class="sxs-lookup"><span data-stu-id="a7c49-127">WYSIWYG print support</span></span>  
  
- <span data-ttu-id="a7c49-128">Systemeigene Unterstützung für erweiterte Farbprofile, die auch 32 Bit pro Kanal (bpc), CMYK, benannte Farben, n-Tinten und systemeigene Unterstützung von Transparenz und Farbverläufen einschließen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-128">Native support of advanced color profiles, which include 32 bits per channel (bpc), CMYK, named-colors, n-inks, and native support of transparency and gradients.</span></span>  
  
- <span data-ttu-id="a7c49-129">Verbesserte Druckleistung für .NET Framework und [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] basierte Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-129">Improved print performance for both .NET Framework and [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] based applications.</span></span>  
  
- <span data-ttu-id="a7c49-130">Industriestandard-XPS-Format.</span><span class="sxs-lookup"><span data-stu-id="a7c49-130">Industry standard XPS format.</span></span>  
  
 <span data-ttu-id="a7c49-131">Für einfache Druck Szenarien ist eine einfache und intuitive API mit einem einzelnen Einstiegspunkt für die Benutzeroberfläche, die Konfiguration und die Auftrags Übermittlung verfügbar.</span><span class="sxs-lookup"><span data-stu-id="a7c49-131">For basic print scenarios, a simple and intuitive API is available with a single entry point for user interface, configuration and job submission.</span></span> <span data-ttu-id="a7c49-132">Für erweiterte Szenarien steht jetzt zusätzlich Unterstützung für [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]-Anpassung (oder Verzicht auf die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]), synchronen oder asynchronen Druck und Funktionen zum Druck von Batchaufträgen zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="a7c49-132">For advanced scenarios, an additional support is added for [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] customization (or no [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] at all), synchronous or asynchronous printing, and batch printing capabilities.</span></span> <span data-ttu-id="a7c49-133">Beide Optionen bieten Druckunterstützung mit vollständigen oder eingeschränkten Vertrauensstellungen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-133">Both options provide print support in full or partial trust mode.</span></span>  
  
 <span data-ttu-id="a7c49-134">XPS wurde mit Erweiterbarkeit konzipiert.</span><span class="sxs-lookup"><span data-stu-id="a7c49-134">XPS was designed with extensibility in mind.</span></span> <span data-ttu-id="a7c49-135">Mithilfe des Erweiterbarkeits Frameworks können Features und Funktionen in einer modularen Weise zu XPS hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="a7c49-135">By using the extensibility framework, features and capabilities can be added to XPS in a modular manner.</span></span> <span data-ttu-id="a7c49-136">Zu den Erweiterungsfunktionen gehören:</span><span class="sxs-lookup"><span data-stu-id="a7c49-136">Extensibility features include:</span></span>  
  
- <span data-ttu-id="a7c49-137">Druckschema.</span><span class="sxs-lookup"><span data-stu-id="a7c49-137">Print Schema.</span></span> <span data-ttu-id="a7c49-138">Das öffentliche Schema wird regelmäßig aktualisiert und ermöglicht die schnelle Erweiterung von Gerätefunktionen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-138">The public schema is updated regularly and enables rapid extension of device capabilities.</span></span> <span data-ttu-id="a7c49-139">(Siehe dazu **PrintTicket und PrintCapabilities** unten.)</span><span class="sxs-lookup"><span data-stu-id="a7c49-139">(See **PrintTicket and PrintCapabilities** below.)</span></span>  
  
- <span data-ttu-id="a7c49-140">Erweiterbare Filterpipeline.</span><span class="sxs-lookup"><span data-stu-id="a7c49-140">Extensible Filter Pipeline.</span></span> <span data-ttu-id="a7c49-141">Die Filter Pipeline des XPS-Druckertreibers (XPSDrv) wurde entwickelt, um das direkte und skalierbare Drucken von XPS-Dokumenten zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-141">The XPS printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of XPS documents.</span></span> <span data-ttu-id="a7c49-142">Weitere Informationen finden Sie unter [XPSDrv-Druckertreiber](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span><span class="sxs-lookup"><span data-stu-id="a7c49-142">For more information, see [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span> 
  
### <a name="print-path-architecture"></a><span data-ttu-id="a7c49-143">Druckpfadarchitektur</span><span class="sxs-lookup"><span data-stu-id="a7c49-143">Print Path Architecture</span></span>  
 <span data-ttu-id="a7c49-144">Während sowohl [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] als auch .NET Framework Anwendungen XPS unterstützen, verwenden [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] und Windows Forms Anwendungen eine GDI-zu-XPS-Konvertierung, um XPS-formatierten Inhalt für den XPS-Druckertreiber (XPSDrv) zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-144">While both [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and .NET Framework applications support XPS, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and Windows Forms applications use a GDI to XPS conversion in order to create XPS formatted content for the XPS printer driver (XPSDrv).</span></span> <span data-ttu-id="a7c49-145">Diese Anwendungen sind nicht erforderlich, um den XPS-Druckpfad zu verwenden, und können den erweiterten Metafile (EMF)-basierten Druck weiterhin verwenden.</span><span class="sxs-lookup"><span data-stu-id="a7c49-145">These applications are not required to use the XPS print path, and can continue to use Enhanced Metafile (EMF) based printing.</span></span> <span data-ttu-id="a7c49-146">Die meisten XPS-Features und-Erweiterungen sind jedoch nur für Anwendungen verfügbar, die auf den XPS-Druckpfad abzielen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-146">However, most XPS features and enhancements are only available to applications that target the XPS print path.</span></span>  
  
 <span data-ttu-id="a7c49-147">Um die Verwendung von XPSDrv-basierten Druckern durch [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]-und Windows Forms-Anwendungen zu ermöglichen, unterstützt der XPS-Druckertreiber (XPSDrv) die Konvertierung von GDI in das XPS-Format.</span><span class="sxs-lookup"><span data-stu-id="a7c49-147">To enable the use of XPSDrv-based printers by [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and Windows Forms applications, the XPS printer driver (XPSDrv) supports conversion of GDI to XPS format.</span></span> <span data-ttu-id="a7c49-148">Das XPSDrv-Modell stellt außerdem einen Konverter für das XPS-zu-GDI-Format bereit, sodass [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Anwendungen XPS-Dokumente drucken können.</span><span class="sxs-lookup"><span data-stu-id="a7c49-148">The XPSDrv model also provides a converter for XPS to GDI format so that [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications can print XPS Documents.</span></span> <span data-ttu-id="a7c49-149">Bei [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]-Anwendungen erfolgt die Konvertierung von XPS in das GDI-Format automatisch durch die Methoden <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> und <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> der <xref:System.Windows.Xps.XpsDocumentWriter>-Klasse, wenn die Ziel Druck Warteschlange des Schreibvorgangs nicht über einen XPSDrv-Treiber verfügt.</span><span class="sxs-lookup"><span data-stu-id="a7c49-149">For [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications, conversion of XPS to GDI format is done automatically by the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class whenever the target print queue of the write operation does not have an XPSDrv driver.</span></span> <span data-ttu-id="a7c49-150">(Windows Forms Anwendungen können keine XPS-Dokumente drucken.)</span><span class="sxs-lookup"><span data-stu-id="a7c49-150">(Windows Forms applications cannot print XPS Documents.)</span></span>  
  
 <span data-ttu-id="a7c49-151">In der folgenden Abbildung ist das Druck Subsystem dargestellt und die von Microsoft bereitgestellten Teile sowie die von Software-und Hardwareanbietern definierten Teile definiert:</span><span class="sxs-lookup"><span data-stu-id="a7c49-151">The following illustration depicts the print subsystem and defines the portions provided by Microsoft, and the portions defined by software and hardware vendors:</span></span>  
  
 ![Screenshot zeigt das XPS-Drucksystem.](./media/printing-overview/xml-paper-specification-print-system.png)  
  
### <a name="basic-xps-printing"></a><span data-ttu-id="a7c49-153">Einfacher XPS-Druck</span><span class="sxs-lookup"><span data-stu-id="a7c49-153">Basic XPS Printing</span></span>  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="a7c49-154">definiert sowohl eine einfache als auch eine erweiterte API.</span><span class="sxs-lookup"><span data-stu-id="a7c49-154">defines both a basic and advanced API.</span></span> <span data-ttu-id="a7c49-155">Für Anwendungen, für die keine umfangreiche Druckanpassung oder der vollständige Zugriff auf die vollständige XPS-Funktion erforderlich ist, ist die grundlegende Druckunterstützung verfügbar.</span><span class="sxs-lookup"><span data-stu-id="a7c49-155">For those applications that do not require extensive print customization or access to the complete XPS feature set, basic print support is available.</span></span> <span data-ttu-id="a7c49-156">Die einfache Druckunterstützung wird über ein Druckdialogfeld-Steuerelement verfügbar gemacht, das nur minimale Konfiguration erfordert und eine vertraute [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] bietet.</span><span class="sxs-lookup"><span data-stu-id="a7c49-156">Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="a7c49-157">Viele XPS-Features sind mit diesem vereinfachten Druck Modell verfügbar.</span><span class="sxs-lookup"><span data-stu-id="a7c49-157">Many XPS features are available using this simplified print model.</span></span>  
  
#### <a name="printdialog"></a><span data-ttu-id="a7c49-158">PrintDialog</span><span class="sxs-lookup"><span data-stu-id="a7c49-158">PrintDialog</span></span>  
 <span data-ttu-id="a7c49-159">Das <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType>-Steuerelement stellt einen einzelnen Einstiegspunkt für die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]-, Konfigurations-und XPS-Auftrags Übermittlung bereit.</span><span class="sxs-lookup"><span data-stu-id="a7c49-159">The <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> control provides a single entry point for [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuration, and XPS job submission.</span></span> <span data-ttu-id="a7c49-160">Informationen zum Instanziieren und Verwenden des Steuerelements finden Sie unter [Aufrufen eines Druckdialogfelds](how-to-invoke-a-print-dialog.md).</span><span class="sxs-lookup"><span data-stu-id="a7c49-160">For information about how to instantiate and use the control, see [Invoke a Print Dialog](how-to-invoke-a-print-dialog.md).</span></span>  
  
### <a name="advanced-xps-printing"></a><span data-ttu-id="a7c49-161">Erweiterter XPS-Druck</span><span class="sxs-lookup"><span data-stu-id="a7c49-161">Advanced XPS Printing</span></span>  
 <span data-ttu-id="a7c49-162">Für den Zugriff auf den vollständigen Satz von XPS-Funktionen muss die erweiterte Druck-API verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="a7c49-162">To access the complete set of XPS features, the advanced print API must be used.</span></span> <span data-ttu-id="a7c49-163">Einige relevante APIs werden im folgenden ausführlicher beschrieben.</span><span class="sxs-lookup"><span data-stu-id="a7c49-163">Several relevant API are described in greater detail below.</span></span> <span data-ttu-id="a7c49-164">Eine vollständige Liste der XPS-Druckpfad-APIs finden Sie in den <xref:System.Windows.Xps>-und <xref:System.Printing>-Namespace verweisen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-164">For a complete list of XPS print path APIs, see the <xref:System.Windows.Xps> and <xref:System.Printing> namespace references.</span></span>  
  
#### <a name="printticket-and-printcapabilities"></a><span data-ttu-id="a7c49-165">PrintTicket und PrintCapabilities</span><span class="sxs-lookup"><span data-stu-id="a7c49-165">PrintTicket and PrintCapabilities</span></span>  
 <span data-ttu-id="a7c49-166">Die Klassen <xref:System.Printing.PrintTicket> und <xref:System.Printing.PrintCapabilities> sind die Grundlage der erweiterten XPS-Funktionen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-166">The <xref:System.Printing.PrintTicket> and <xref:System.Printing.PrintCapabilities> classes are the foundation of the advanced XPS features.</span></span> <span data-ttu-id="a7c49-167">Beide Objekttypen sind XML-formatierte Strukturen von Druck orientierten Features, wie z. b. Sortierung, zweiseitiger Druck, Heftung usw. Diese Strukturen werden durch das Druck Schema definiert.</span><span class="sxs-lookup"><span data-stu-id="a7c49-167">Both types of objects are XML formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema.</span></span> <span data-ttu-id="a7c49-168">Ein <xref:System.Printing.PrintTicket> weist einen Drucker an, wie ein Druckauftrag verarbeitet werden muss.</span><span class="sxs-lookup"><span data-stu-id="a7c49-168">A <xref:System.Printing.PrintTicket> instructs a printer how to process a print job.</span></span> <span data-ttu-id="a7c49-169">Die <xref:System.Printing.PrintCapabilities> -Klasse definiert die Fähigkeiten eines Druckers.</span><span class="sxs-lookup"><span data-stu-id="a7c49-169">The <xref:System.Printing.PrintCapabilities> class defines the capabilities of a printer.</span></span> <span data-ttu-id="a7c49-170">Durch Abfragen der Funktionen eines Druckers kann ein <xref:System.Printing.PrintTicket> erstellt werden, das die von einem Drucker unterstützten Funktionen in vollem Umfang nutzt.</span><span class="sxs-lookup"><span data-stu-id="a7c49-170">By querying the capabilities of a printer, a <xref:System.Printing.PrintTicket> can be created that takes full advantage of a printer's supported features.</span></span> <span data-ttu-id="a7c49-171">Analog dazu können nicht unterstützte Funktionen vermieden werden.</span><span class="sxs-lookup"><span data-stu-id="a7c49-171">Similarly, unsupported features can be avoided.</span></span>  
  
 <span data-ttu-id="a7c49-172">Im folgenden Beispiel wird das Abfragen der <xref:System.Printing.PrintCapabilities> eines Druckers und das Erstellen eines <xref:System.Printing.PrintTicket> mithilfe von Code gezeigt.</span><span class="sxs-lookup"><span data-stu-id="a7c49-172">The following example demonstrates how to query the <xref:System.Printing.PrintCapabilities> of a printer and create a <xref:System.Printing.PrintTicket> using code.</span></span>  
  
 [!code-cpp[xpscreate#PrinterCapabilities](~/samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)]
 [!code-csharp[xpscreate#PrinterCapabilities](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)]
 [!code-vb[xpscreate#PrinterCapabilities](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)]  
  
#### <a name="printserver-and-printqueue"></a><span data-ttu-id="a7c49-173">PrintServer und PrintQueue</span><span class="sxs-lookup"><span data-stu-id="a7c49-173">PrintServer and PrintQueue</span></span>  
 <span data-ttu-id="a7c49-174">Die <xref:System.Printing.PrintServer>-Klasse stellt einen Netzwerkdruckerserver und die <xref:System.Printing.PrintQueue>-Klasse einen Drucker mit zugeordneter Auftragswarteschlange dar.</span><span class="sxs-lookup"><span data-stu-id="a7c49-174">The <xref:System.Printing.PrintServer> class represents a network print server and the <xref:System.Printing.PrintQueue> class represents a printer and the output job queue associated with it.</span></span> <span data-ttu-id="a7c49-175">Diese APIs ermöglichen die Erweiterte Verwaltung der Druckaufträge eines Servers.</span><span class="sxs-lookup"><span data-stu-id="a7c49-175">Together, these APIs allow advanced management of a server's print jobs.</span></span> <span data-ttu-id="a7c49-176">Ein <xref:System.Printing.PrintServer> oder eine davon abgeleitete Klasse wird verwendet, um eine <xref:System.Printing.PrintQueue> zu verwalten.</span><span class="sxs-lookup"><span data-stu-id="a7c49-176">A <xref:System.Printing.PrintServer>, or one of its derived classes, is used to manage a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="a7c49-177">Die <xref:System.Printing.PrintQueue.AddJob%2A>-Methode wird verwendet, um einen neuen Druckauftrag in die Warteschlange einzustellen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-177">The <xref:System.Printing.PrintQueue.AddJob%2A> method is used to insert a new print job into the queue.</span></span>  
  
 <span data-ttu-id="a7c49-178">Das folgende Beispiel zeigt, wie ein <xref:System.Printing.LocalPrintServer> erstellt und mithilfe von Code auf seine Standard-<xref:System.Printing.PrintQueue> zugegriffen wird.</span><span class="sxs-lookup"><span data-stu-id="a7c49-178">The following example demonstrates how to create a <xref:System.Printing.LocalPrintServer> and access its default <xref:System.Printing.PrintQueue> by using code.</span></span>  
  
 [!code-csharp[xpsprint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[xpsprint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
#### <a name="xpsdocumentwriter"></a><span data-ttu-id="a7c49-179">XpsDocumentWriter</span><span class="sxs-lookup"><span data-stu-id="a7c49-179">XpsDocumentWriter</span></span>  
 <span data-ttu-id="a7c49-180">Ein-<xref:System.Windows.Xps.XpsDocumentWriter>, dessen zahlreiche <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A>-und <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A>-Methoden verwendet werden, um XPS-Dokumente in ein <xref:System.Printing.PrintQueue>zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="a7c49-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, with its many the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods, is used to write XPS documents to a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="a7c49-181">Beispielsweise wird die <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29>-Methode verwendet, um ein XPS-Dokument auszugeben und synchron <xref:System.Printing.PrintTicket>.</span><span class="sxs-lookup"><span data-stu-id="a7c49-181">For example, the <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> synchronously.</span></span> <span data-ttu-id="a7c49-182">Die <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29>-Methode wird verwendet, um ein XPS-Dokument auszugeben und asynchron <xref:System.Printing.PrintTicket>.</span><span class="sxs-lookup"><span data-stu-id="a7c49-182">The <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> asynchronously.</span></span>  
  
 <span data-ttu-id="a7c49-183">Im folgenden Beispiel wird veranschaulicht, wie ein <xref:System.Windows.Xps.XpsDocumentWriter> mithilfe von Code erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="a7c49-183">The following example demonstrates how to create an <xref:System.Windows.Xps.XpsDocumentWriter> using code.</span></span>  
  
 [!code-csharp[XpsPrint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[XpsPrint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
 <span data-ttu-id="a7c49-184">Die <xref:System.Printing.PrintQueue.AddJob%2A>-Methoden stellen ebenfalls Druckmöglichkeiten bereit.</span><span class="sxs-lookup"><span data-stu-id="a7c49-184">The <xref:System.Printing.PrintQueue.AddJob%2A> methods also provide ways to print.</span></span> <span data-ttu-id="a7c49-185">Weitere Informationen finden Sie unter [Programmgesteuertes Drucken von XPS-Dateien](how-to-programmatically-print-xps-files.md).</span><span class="sxs-lookup"><span data-stu-id="a7c49-185">See [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="a7c49-186">.</span><span class="sxs-lookup"><span data-stu-id="a7c49-186">for details.</span></span>  
  
<a name="GDI_Print_Path_intro"></a>   
## <a name="gdi-print-path"></a><span data-ttu-id="a7c49-187">GDI-Druckpfad</span><span class="sxs-lookup"><span data-stu-id="a7c49-187">GDI Print Path</span></span>  
 <span data-ttu-id="a7c49-188">Während [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] Anwendungen den XPS-Druckpfad nativ unterstützen, können [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] und Windows Forms Anwendungen auch einige XPS-Funktionen nutzen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-188">While [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications natively support the XPS print path, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and Windows Forms applications can also take advantage of some XPS features.</span></span> <span data-ttu-id="a7c49-189">Der XPS-Druckertreiber (XPSDrv) kann eine GDI-basierte Ausgabe in das XPS-Format konvertieren.</span><span class="sxs-lookup"><span data-stu-id="a7c49-189">The XPS printer driver (XPSDrv) can convert GDI based output to XPS format.</span></span> <span data-ttu-id="a7c49-190">Für erweiterte Szenarien wird die benutzerdefinierte Konvertierung von Inhalten mithilfe von [Microsoft XPS Document Converter (mxdc)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)unterstützt.</span><span class="sxs-lookup"><span data-stu-id="a7c49-190">For advanced scenarios, custom conversion of content is supported using the [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span></span> <span data-ttu-id="a7c49-191">Ebenso können [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] Anwendungen auch in den GDI-Druck Pfad ausgeben, indem Sie eine der Methoden <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> oder <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> der <xref:System.Windows.Xps.XpsDocumentWriter> Klasse aufrufen und einen nicht-XPSDrv-Drucker als Ziel Drucker Warteschlange festlegen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-191">Similarly, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications can also output to the GDI print path by calling one of the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> or <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class and designating a non-XpsDrv printer as the target print queue.</span></span>  

<span data-ttu-id="a7c49-192">Bei Anwendungen, für die keine XPS-Funktionalität oder-Unterstützung erforderlich ist, bleibt der aktuelle GDI-Druckpfad unverändert.</span><span class="sxs-lookup"><span data-stu-id="a7c49-192">For applications that do not require XPS functionality or support, the current GDI print path remains unchanged.</span></span>  
  
- <span data-ttu-id="a7c49-193">Zusätzliches Referenzmaterial zum GDI-Druckpfad und den verschiedenen XPS-Konvertierungsoptionen finden Sie unter [Microsoft XPS Document Converter (mxdc)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) und [XPSDrv-Druckertreiber](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span><span class="sxs-lookup"><span data-stu-id="a7c49-193">For additional reference material on the GDI print path and the various XPS conversion options, see [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) and [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>  
  
<a name="XPS_Driver_Model_intro"></a>   
## <a name="xpsdrv-driver-model"></a><span data-ttu-id="a7c49-194">XPSDrv-Treibermodell</span><span class="sxs-lookup"><span data-stu-id="a7c49-194">XPSDrv Driver Model</span></span>  
 <span data-ttu-id="a7c49-195">Der XPS-Druckpfad verbessert die Effizienz des Spoolers durch die Verwendung von XPS als System eigenes druckspoolformat beim Drucken auf einen XPS-fähigen Drucker oder Treiber.</span><span class="sxs-lookup"><span data-stu-id="a7c49-195">The XPS print path improves spooler efficiency by using XPS as the native print spool format when printing to an XPS -enabled printer or driver.</span></span> <span data-ttu-id="a7c49-196">Durch den vereinfachten Spoolvorgang entfällt die Notwendigkeit, eine zwischenspooldatei (z. b. eine EMF-Datendatei) zu generieren, bevor das Dokument gespoolert wird.</span><span class="sxs-lookup"><span data-stu-id="a7c49-196">The simplified spooling process eliminates the need to generate an intermediate spool file, such as an EMF data file, before the document is spooled.</span></span> <span data-ttu-id="a7c49-197">Durch kleinere Spooldateien kann der XPS-Druckpfad den Netzwerkverkehr verringern und die Druckleistung verbessern.</span><span class="sxs-lookup"><span data-stu-id="a7c49-197">Through smaller spool file sizes, the XPS print path can reduce network traffic and improve print performance.</span></span>  
  
 <span data-ttu-id="a7c49-198">EMF ist ein geschlossenes Format, das die Anwendungs Ausgabe als eine Reihe von Aufrufen an GDI für Renderingdienste darstellt.</span><span class="sxs-lookup"><span data-stu-id="a7c49-198">EMF is a closed format that represents application output as a series of calls into GDI for rendering services.</span></span> <span data-ttu-id="a7c49-199">Anders als EMF stellt das XPS-Spoolformat das tatsächliche Dokument dar, ohne dass eine weitere Interpretation erforderlich ist, wenn es an einen XPS-basierten Druckertreiber (XPSDrv) ausgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="a7c49-199">Unlike EMF, the XPS spool format represents the actual document without requiring further interpretation when output to an XPS-based printer driver (XPSDrv).</span></span> <span data-ttu-id="a7c49-200">Die Treiber können direkt mit den Daten im vorliegenden Format arbeiten.</span><span class="sxs-lookup"><span data-stu-id="a7c49-200">The drivers can operate directly on the data in the format.</span></span> <span data-ttu-id="a7c49-201">Durch diese Funktion werden die Daten-und Farb Raum Konvertierungen vermieden, die bei der Verwendung von EMF-Dateien und GDI-basierten Druckertreibern erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="a7c49-201">This capability eliminates the data and color space conversions required when you use EMF files and GDI-based print drivers.</span></span>  
  
 <span data-ttu-id="a7c49-202">Spooldateigrößen werden normalerweise reduziert, wenn Sie XPS-Dokumente verwenden, die auf einen XPS-Druckertreiber (XPSDrv) abzielen, verglichen mit den EMF-Entsprechungen Allerdings gibt es Ausnahmen:</span><span class="sxs-lookup"><span data-stu-id="a7c49-202">Spool file sizes are usually reduced when you use XPS Documents that target an XPS printer driver (XPSDrv) compared with their EMF equivalents; however, there are exceptions:</span></span>  
  
- <span data-ttu-id="a7c49-203">Eine Vektorgrafik, die sehr komplex ist, viele Ebenen aufweist oder ineffizient geschrieben wurde, kann größer als die Bitmapversion der gleichen Grafik sein.</span><span class="sxs-lookup"><span data-stu-id="a7c49-203">A vector graphic that is very complex, multi-layered, or inefficiently written can be larger than a bitmapped version of the same graphic.</span></span>  
  
- <span data-ttu-id="a7c49-204">Zum Zweck der Anzeige am Bildschirm werden in XPS-Dateien Geräteschriftarten sowie computerbasierte Schriftarten eingebettet, während in GDI-Spooldateien keine Geräteschriftarten eingebettet sind.</span><span class="sxs-lookup"><span data-stu-id="a7c49-204">For screen display purposes, XPS files embed device fonts as well as computer-based fonts; whereas GDI spool files do not embed device fonts.</span></span> <span data-ttu-id="a7c49-205">Beide Schriftarten sind jedoch in Teilmengen gegliedert (siehe unten), und Druckertreiber können die Geräteschriftarten vor der Übertragung der Datei an den Drucker entfernen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-205">But both kinds of fonts are subsetted (see below) and printer drivers can remove the device fonts before transmitting the file to the printer.</span></span>  
  
 <span data-ttu-id="a7c49-206">Die Reduzierung der Spoolgröße erfolgt mithilfe mehrerer Mechanismen:</span><span class="sxs-lookup"><span data-stu-id="a7c49-206">Spool size reduction is performed through several mechanisms:</span></span>  
  
- <span data-ttu-id="a7c49-207">**Unterklassen von Schriftarten**.</span><span class="sxs-lookup"><span data-stu-id="a7c49-207">**Font subsetting**.</span></span> <span data-ttu-id="a7c49-208">Nur Zeichen, die innerhalb des eigentlichen Dokuments verwendet werden, werden in der XPS-Datei gespeichert.</span><span class="sxs-lookup"><span data-stu-id="a7c49-208">Only characters used within the actual document are stored in the XPS file.</span></span>  
  
- <span data-ttu-id="a7c49-209">**Erweiterte Grafikunterstützung**.</span><span class="sxs-lookup"><span data-stu-id="a7c49-209">**Advanced Graphics Support**.</span></span> <span data-ttu-id="a7c49-210">Durch die systemeigene Unterstützung von Transparenz und Farbverlaufs primitiven wird die rasterisierung von Inhalten im XPS-Dokument vermieden.</span><span class="sxs-lookup"><span data-stu-id="a7c49-210">Native support for transparency and gradient primitives avoids rasterization of content in the XPS Document.</span></span>  
  
- <span data-ttu-id="a7c49-211">**Erkennung gemeinsamer Ressourcen**.</span><span class="sxs-lookup"><span data-stu-id="a7c49-211">**Identification of common resources**.</span></span> <span data-ttu-id="a7c49-212">Ressourcen, die mehrfach verwendet werden (wie etwa ein Bild, das ein Firmenlogo darstellt) werden als freigegebene Ressourcen behandelt und nur einmal geladen.</span><span class="sxs-lookup"><span data-stu-id="a7c49-212">Resources that are used multiple times (such as an image that represents a corporate logo) are treated as shared resources and are loaded only once.</span></span>  
  
- <span data-ttu-id="a7c49-213">**ZIP-Komprimierung**.</span><span class="sxs-lookup"><span data-stu-id="a7c49-213">**ZIP compression**.</span></span> <span data-ttu-id="a7c49-214">Alle XPS-Dokumente verwenden die ZIP-Komprimierung.</span><span class="sxs-lookup"><span data-stu-id="a7c49-214">All XPS documents use ZIP compression.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a7c49-215">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="a7c49-215">See also</span></span>

- <xref:System.Windows.Controls.PrintDialog>
- <xref:System.Windows.Xps.XpsDocumentWriter>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.Printing.PrintTicket>
- <xref:System.Printing.PrintCapabilities>
- <xref:System.Printing.PrintServer>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="a7c49-216">Themen zu Vorgehensweisen</span><span class="sxs-lookup"><span data-stu-id="a7c49-216">How-to Topics</span></span>](printing-how-to-topics.md)
- [<span data-ttu-id="a7c49-217">Dokumente in WPF</span><span class="sxs-lookup"><span data-stu-id="a7c49-217">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="a7c49-218">XPS-Dokumente</span><span class="sxs-lookup"><span data-stu-id="a7c49-218">XPS Documents</span></span>](/windows/desktop/printdocs/documents)
- [<span data-ttu-id="a7c49-219">Serialisierung und Speicherung von Dokumenten</span><span class="sxs-lookup"><span data-stu-id="a7c49-219">Document Serialization and Storage</span></span>](document-serialization-and-storage.md)
- [<span data-ttu-id="a7c49-220">Microsoft XPS Document Converter (mxdc)</span><span class="sxs-lookup"><span data-stu-id="a7c49-220">Microsoft XPS Document Converter (MXDC)</span></span>](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)
