---
title: 'Optimieren der Leistung: Layout und Entwurf'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- layout [WPF], optimizing performance
- design considerations [WPF]
- layout pass [WPF]
ms.assetid: 005f4cda-a849-448b-916b-38d14d9a96fe
ms.openlocfilehash: e62b439926465aa1a61abd39c7c942acf26732c4
ms.sourcegitcommit: 0c48191d6d641ce88d7510e319cf38c0e35697d0
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/05/2019
ms.locfileid: "57367942"
---
# <a name="optimizing-performance-layout-and-design"></a><span data-ttu-id="28268-102">Optimieren der Leistung: Layout und Entwurf</span><span class="sxs-lookup"><span data-stu-id="28268-102">Optimizing Performance: Layout and Design</span></span>
<span data-ttu-id="28268-103">Der Entwurf Ihrer [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Anwendung kann die Leistung durch unnötigen Mehraufwand durch die Berechnung des Layouts und das Überprüfung von Objektverweisen beeinträchtigen.</span><span class="sxs-lookup"><span data-stu-id="28268-103">The design of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application can impact its performance by creating unnecessary overhead in calculating layout and validating object references.</span></span> <span data-ttu-id="28268-104">Das Erstellen von Objekten, insbesondere zur Laufzeit, kann sich auf die Leistungsmerkmale Ihrer Anwendung auswirken.</span><span class="sxs-lookup"><span data-stu-id="28268-104">The construction of objects, particularly at run time, can affect the performance characteristics of your application.</span></span>  
  
 <span data-ttu-id="28268-105">In diesem Thema erhalten Sie Empfehlungen bezüglich der Leistung in diesen Bereichen.</span><span class="sxs-lookup"><span data-stu-id="28268-105">This topic provides performance recommendations in these areas.</span></span>  
  
## <a name="layout"></a><span data-ttu-id="28268-106">Layout</span><span class="sxs-lookup"><span data-stu-id="28268-106">Layout</span></span>  
 <span data-ttu-id="28268-107">Der Begriff "Layoutdurchlauf" beschreibt den Prozess des Messens und Anordnens von Membern einer <xref:System.Windows.Controls.Panel>-abgeleiteten Auflistung der untergeordneten Elemente, und zeichnen Sie dann auf dem Bildschirm dargestellt.</span><span class="sxs-lookup"><span data-stu-id="28268-107">The term "layout pass" describes the process of measuring and arranging the members of a <xref:System.Windows.Controls.Panel>-derived object's collection of children, and then drawing them onscreen.</span></span> <span data-ttu-id="28268-108">Ein Layoutdurchlauf ist ein mathematisch aufwändiger Prozess; je mehr untergeordnete Elementen sich in der Auflistung befinden, desto mehr Berechnungen sind erforderlich.</span><span class="sxs-lookup"><span data-stu-id="28268-108">The layout pass is a mathematically-intensive process—the larger the number of children in the collection, the greater the number of calculations required.</span></span> <span data-ttu-id="28268-109">Beispielsweise jedes Mal, wenn ein untergeordnetes Element <xref:System.Windows.UIElement> Objekt in der Auflistung seine Position ändert, müssen sie einen neuen Durchlauf des Layoutsystems auslösen.</span><span class="sxs-lookup"><span data-stu-id="28268-109">For example, each time a child <xref:System.Windows.UIElement> object in the collection changes its position, it has the potential to trigger a new pass by the layout system.</span></span> <span data-ttu-id="28268-110">Aufgrund der engen Verbindung zwischen den Merkmalen des Objekts und dem Layoutverhalten ist es unumgänglich, den Ereignistyp zu verstehen, der das Layoutsystem aufrufen kann.</span><span class="sxs-lookup"><span data-stu-id="28268-110">Because of the close relationship between object characteristics and layout behavior, it's important to understand the type of events that can invoke the layout system.</span></span> <span data-ttu-id="28268-111">Die Leistung Ihrer Anwendung wird optimiert, wenn Sie unnötige Aufrufe des Layoutdurchlaufs so weit wie möglich reduzieren.</span><span class="sxs-lookup"><span data-stu-id="28268-111">Your application will perform better by reducing as much as possible any unnecessary invocations of the layout pass.</span></span>  
  
 <span data-ttu-id="28268-112">Das Layoutsystem führt zwei Durchläufe für jeden untergeordneten Member in einer Auflistung durch: einen Messdurchlauf und einen Anordnungsdurchlauf.</span><span class="sxs-lookup"><span data-stu-id="28268-112">The layout system completes two passes for each child member in a collection: a measure pass, and an arrange pass.</span></span> <span data-ttu-id="28268-113">Jedes Objekt verfügt über seine eigene überschriebene Implementierung von der <xref:System.Windows.UIElement.Measure%2A> und <xref:System.Windows.UIElement.Arrange%2A> Methoden, um sein eigenes spezifisches Layoutverhalten bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="28268-113">Each child object provides its own overridden implementation of the <xref:System.Windows.UIElement.Measure%2A> and <xref:System.Windows.UIElement.Arrange%2A> methods in order to provide its own specific layout behavior.</span></span> <span data-ttu-id="28268-114">Ganz einfach ausgedrückt bedeutet dies, dass Layout ein rekursives System ist, das die Größe und Position eines Elements anpasst und dieses auf dem Bildschirm zeichnet.</span><span class="sxs-lookup"><span data-stu-id="28268-114">At its simplest, layout is a recursive system that leads to an element being sized, positioned, and drawn onscreen.</span></span>  
  
-   <span data-ttu-id="28268-115">Ein untergeordnetes Element <xref:System.Windows.UIElement> Objekt startet den Layoutvorgang, indem zuerst dessen Kerneigenschaften gemessen.</span><span class="sxs-lookup"><span data-stu-id="28268-115">A child <xref:System.Windows.UIElement> object begins the layout process by first having its core properties measured.</span></span>  
  
-   <span data-ttu-id="28268-116">Des Objekts <xref:System.Windows.FrameworkElement> Eigenschaften, die der Größe,, z. B. verknüpft sind <xref:System.Windows.FrameworkElement.Width%2A>, <xref:System.Windows.FrameworkElement.Height%2A>, und <xref:System.Windows.FrameworkElement.Margin%2A>, ausgewertet werden.</span><span class="sxs-lookup"><span data-stu-id="28268-116">The object's <xref:System.Windows.FrameworkElement> properties that are related to size, such as <xref:System.Windows.FrameworkElement.Width%2A>, <xref:System.Windows.FrameworkElement.Height%2A>, and <xref:System.Windows.FrameworkElement.Margin%2A>, are evaluated.</span></span>  
  
-   <span data-ttu-id="28268-117"><xref:System.Windows.Controls.Panel>-spezifische Logik angewendet wird, wie z. B. die <xref:System.Windows.Controls.DockPanel.Dock%2A> Eigenschaft der <xref:System.Windows.Controls.DockPanel>, oder die <xref:System.Windows.Controls.StackPanel.Orientation%2A> Eigenschaft der <xref:System.Windows.Controls.StackPanel>.</span><span class="sxs-lookup"><span data-stu-id="28268-117"><xref:System.Windows.Controls.Panel>-specific logic is applied, such as the <xref:System.Windows.Controls.DockPanel.Dock%2A> property of the <xref:System.Windows.Controls.DockPanel>, or the <xref:System.Windows.Controls.StackPanel.Orientation%2A> property of the <xref:System.Windows.Controls.StackPanel>.</span></span>  
  
-   <span data-ttu-id="28268-118">Nachdem alle untergeordneten Objekte ausgemessen wurden, wird der Inhalt angeordnet oder positioniert.</span><span class="sxs-lookup"><span data-stu-id="28268-118">Content is arranged, or positioned, after all child objects have been measured.</span></span>  
  
-   <span data-ttu-id="28268-119">Die Auflistung der untergeordneten Objekte wird auf dem Bildschirm dargestellt.</span><span class="sxs-lookup"><span data-stu-id="28268-119">The collection of child objects is drawn to the screen.</span></span>  
  
 <span data-ttu-id="28268-120">Der Layoutdurchlauf wird erneut aufgerufen, wenn eine der folgenden Aktionen ausgeführt wird:</span><span class="sxs-lookup"><span data-stu-id="28268-120">The layout pass process is invoked again if any of the following actions occur:</span></span>  
  
-   <span data-ttu-id="28268-121">Ein untergeordnetes Objekt wird der Auflistung hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="28268-121">A child object is added to the collection.</span></span>  
  
-   <span data-ttu-id="28268-122">Ein <xref:System.Windows.FrameworkElement.LayoutTransform%2A> auf das untergeordnete Objekt angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="28268-122">A <xref:System.Windows.FrameworkElement.LayoutTransform%2A> is applied to the child object.</span></span>  
  
-   <span data-ttu-id="28268-123">Die <xref:System.Windows.UIElement.UpdateLayout%2A> Methode für das untergeordnete Objekt aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="28268-123">The <xref:System.Windows.UIElement.UpdateLayout%2A> method is called for the child object.</span></span>  
  
-   <span data-ttu-id="28268-124">Wenn sich der Wert einer Abhängigkeitseigenschaft ändert, die mit Metadaten markiert ist, die die Messungs- oder Anordnungsdurchläufe beeinflussen</span><span class="sxs-lookup"><span data-stu-id="28268-124">When a change occurs to the value of a dependency property that is marked with metadata affecting the measure or arrange passes.</span></span>  
  
### <a name="use-the-most-efficient-panel-where-possible"></a><span data-ttu-id="28268-125">Verwenden Sie das effizienteste Panel soweit möglich</span><span class="sxs-lookup"><span data-stu-id="28268-125">Use the Most Efficient Panel where Possible</span></span>  
 <span data-ttu-id="28268-126">Die Komplexität im Layoutprozess basiert direkt auf das Layoutverhalten der <xref:System.Windows.Controls.Panel>-abgeleitete Elemente, die Sie verwenden.</span><span class="sxs-lookup"><span data-stu-id="28268-126">The complexity of the layout process is directly based on the layout behavior of the <xref:System.Windows.Controls.Panel>-derived elements you use.</span></span> <span data-ttu-id="28268-127">Z. B. eine <xref:System.Windows.Controls.Grid> oder <xref:System.Windows.Controls.StackPanel> Steuerelement bietet viel mehr Funktionen als ein <xref:System.Windows.Controls.Canvas> Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="28268-127">For example, a <xref:System.Windows.Controls.Grid> or <xref:System.Windows.Controls.StackPanel> control provides much more functionality than a <xref:System.Windows.Controls.Canvas> control.</span></span> <span data-ttu-id="28268-128">Für diese erhöhte Funktionalität büßen Sie an Leistung ein.</span><span class="sxs-lookup"><span data-stu-id="28268-128">The price for this greater increase in functionality is a greater increase in performance costs.</span></span> <span data-ttu-id="28268-129">Jedoch wenn Sie nicht die Funktionalität benötigen, die eine <xref:System.Windows.Controls.Grid> Steuerelement bereitgestellt werden, sollten Sie weniger leistungsaufwändige alternativen verwenden, z. B. Verwenden einer <xref:System.Windows.Controls.Canvas> oder ein benutzerdefiniertes Panel.</span><span class="sxs-lookup"><span data-stu-id="28268-129">However, if you do not require the functionality that a <xref:System.Windows.Controls.Grid> control provides, you should use the less costly alternatives, such as a <xref:System.Windows.Controls.Canvas> or a custom panel.</span></span>  
  
 <span data-ttu-id="28268-130">Weitere Informationen finden Sie unter [Übersicht über Panel-Elemente](../controls/panels-overview.md).</span><span class="sxs-lookup"><span data-stu-id="28268-130">For more information, see [Panels Overview](../controls/panels-overview.md).</span></span>  
  
### <a name="update-rather-than-replace-a-rendertransform"></a><span data-ttu-id="28268-131">Aktualisieren Sie RenderTransform, statt es zu ersetzen</span><span class="sxs-lookup"><span data-stu-id="28268-131">Update Rather than Replace a RenderTransform</span></span>  
 <span data-ttu-id="28268-132">Möglicherweise zum Aktualisieren einer <xref:System.Windows.Media.Transform> statt zu ersetzen es als Wert für eine <xref:System.Windows.UIElement.RenderTransform%2A> Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="28268-132">You may be able to update a <xref:System.Windows.Media.Transform> rather than replacing it as the value of a <xref:System.Windows.UIElement.RenderTransform%2A> property.</span></span> <span data-ttu-id="28268-133">Dies gilt besonders für Szenarios mit Animation.</span><span class="sxs-lookup"><span data-stu-id="28268-133">This is particularly true in scenarios that involve animation.</span></span> <span data-ttu-id="28268-134">Durch das Aktualisieren einer vorhandenen <xref:System.Windows.Media.Transform>, Sie vermeiden, Initiieren einer unnötigen layoutberechnung.</span><span class="sxs-lookup"><span data-stu-id="28268-134">By updating an existing <xref:System.Windows.Media.Transform>, you avoid initiating an unnecessary layout calculation.</span></span>  
  
### <a name="build-your-tree-top-down"></a><span data-ttu-id="28268-135">Erstellen Sie Ihre Struktur von oben nach unten</span><span class="sxs-lookup"><span data-stu-id="28268-135">Build Your Tree Top-Down</span></span>  
 <span data-ttu-id="28268-136">Wenn der logischen Struktur ein Knoten hinzugefügt oder dieser entfernt wird, werden Eigenschafteninvalidierungen auf dem übergeordneten und allen untergeordneten Elementen des Knotens ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="28268-136">When a node is added or removed from the logical tree, property invalidations are raised on the node's parent and all its children.</span></span> <span data-ttu-id="28268-137">Demzufolge sollte immer ein Oben-nach-unten-Erstellmuster eingehalten werden, um unnötige Invalidierungen auf Knoten zu verhindern, die bereits validiert wurden.</span><span class="sxs-lookup"><span data-stu-id="28268-137">As a result, a top-down construction pattern should always be followed to avoid the cost of unnecessary invalidations on nodes that have already been validated.</span></span> <span data-ttu-id="28268-138">Die folgende Tabelle zeigt den Unterschied in der ausführungsgeschwindigkeit zwischen dem Erstellen einer Struktur von oben nach unten und von unten nach oben, in denen die Struktur 150 Ebenen mit einem einzelnen ist <xref:System.Windows.Controls.TextBlock> und <xref:System.Windows.Controls.DockPanel> auf jeder Ebene.</span><span class="sxs-lookup"><span data-stu-id="28268-138">The following table shows the difference in execution speed between building a tree top-down versus bottom-up, where the tree is 150 levels deep with a single <xref:System.Windows.Controls.TextBlock> and <xref:System.Windows.Controls.DockPanel> at each level.</span></span>  
  
|<span data-ttu-id="28268-139">**Aktion**</span><span class="sxs-lookup"><span data-stu-id="28268-139">**Action**</span></span>|<span data-ttu-id="28268-140">**Strukturerstellung (in ms)**</span><span class="sxs-lookup"><span data-stu-id="28268-140">**Tree building (in ms)**</span></span>|<span data-ttu-id="28268-141">**Rendern, einschließlich Strukturerstellung (in ms)**</span><span class="sxs-lookup"><span data-stu-id="28268-141">**Render—includes tree building (in ms)**</span></span>|  
|----------------|---------------------------------|-------------------------------------------------|  
|<span data-ttu-id="28268-142">Unten-nach-oben</span><span class="sxs-lookup"><span data-stu-id="28268-142">Bottom-up</span></span>|<span data-ttu-id="28268-143">366</span><span class="sxs-lookup"><span data-stu-id="28268-143">366</span></span>|<span data-ttu-id="28268-144">454</span><span class="sxs-lookup"><span data-stu-id="28268-144">454</span></span>|  
|<span data-ttu-id="28268-145">Oben-nach-unten</span><span class="sxs-lookup"><span data-stu-id="28268-145">Top-down</span></span>|<span data-ttu-id="28268-146">11</span><span class="sxs-lookup"><span data-stu-id="28268-146">11</span></span>|<span data-ttu-id="28268-147">96</span><span class="sxs-lookup"><span data-stu-id="28268-147">96</span></span>|  
  
 <span data-ttu-id="28268-148">Im folgenden Code wird veranschaulicht, wie Sie eine Struktur von oben nach unten erstellen können.</span><span class="sxs-lookup"><span data-stu-id="28268-148">The following code example demonstrates how to create a tree top down.</span></span>  
  
 [!code-csharp[Performance#PerformanceSnippet1](~/samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Window1.xaml.cs#performancesnippet1)]
 [!code-vb[Performance#PerformanceSnippet1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/Performance/visualbasic/window1.xaml.vb#performancesnippet1)]  
  
 <span data-ttu-id="28268-149">Weitere Informationen über die logische Struktur finden Sie unter [Strukturen in WPF](trees-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="28268-149">For more information on the logical tree, see [Trees in WPF](trees-in-wpf.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="28268-150">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="28268-150">See also</span></span>
- [<span data-ttu-id="28268-151">Optimieren der WPF-Anwendungsleistung</span><span class="sxs-lookup"><span data-stu-id="28268-151">Optimizing WPF Application Performance</span></span>](optimizing-wpf-application-performance.md)
- [<span data-ttu-id="28268-152">Planen der Anwendungsleistung</span><span class="sxs-lookup"><span data-stu-id="28268-152">Planning for Application Performance</span></span>](planning-for-application-performance.md)
- [<span data-ttu-id="28268-153">Vorteile der Hardware nutzen</span><span class="sxs-lookup"><span data-stu-id="28268-153">Taking Advantage of Hardware</span></span>](optimizing-performance-taking-advantage-of-hardware.md)
- [<span data-ttu-id="28268-154">2D-Grafiken und Bildverarbeitung</span><span class="sxs-lookup"><span data-stu-id="28268-154">2D Graphics and Imaging</span></span>](optimizing-performance-2d-graphics-and-imaging.md)
- [<span data-ttu-id="28268-155">Objektverhalten</span><span class="sxs-lookup"><span data-stu-id="28268-155">Object Behavior</span></span>](optimizing-performance-object-behavior.md)
- [<span data-ttu-id="28268-156">Anwendungsressourcen</span><span class="sxs-lookup"><span data-stu-id="28268-156">Application Resources</span></span>](optimizing-performance-application-resources.md)
- [<span data-ttu-id="28268-157">Text</span><span class="sxs-lookup"><span data-stu-id="28268-157">Text</span></span>](optimizing-performance-text.md)
- [<span data-ttu-id="28268-158">Datenbindung</span><span class="sxs-lookup"><span data-stu-id="28268-158">Data Binding</span></span>](optimizing-performance-data-binding.md)
- [<span data-ttu-id="28268-159">Weitere Leistungsempfehlungen</span><span class="sxs-lookup"><span data-stu-id="28268-159">Other Performance Recommendations</span></span>](optimizing-performance-other-recommendations.md)
- [<span data-ttu-id="28268-160">Layout</span><span class="sxs-lookup"><span data-stu-id="28268-160">Layout</span></span>](layout.md)
