---
title: 'Exemplarische Vorgehensweise: Hosten von WPF-Inhalt in Win32'
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: cpp
helpviewer_keywords: hosting WPF content in Win32 window [WPF]
ms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc
caps.latest.revision: "24"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: fce70ab1571602fb046d3ccde9e7c014834ae6a0
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 11/21/2017
---
# <a name="walkthrough-hosting-wpf-content-in-win32"></a><span data-ttu-id="56c0a-102">Exemplarische Vorgehensweise: Hosten von WPF-Inhalt in Win32</span><span class="sxs-lookup"><span data-stu-id="56c0a-102">Walkthrough: Hosting WPF Content in Win32</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]<span data-ttu-id="56c0a-103"> stellt eine umfangreiche Umgebung zum Erstellen von Anwendungen bereit.</span><span class="sxs-lookup"><span data-stu-id="56c0a-103"> provides a rich environment for creating applications.</span></span> <span data-ttu-id="56c0a-104">Wenn Sie allerdings bereits erheblichen Aufwand für [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)]-Code betrieben haben, kann es effektiver sein, zumindest einen Teil dieses Codes in Ihrer [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Anwendung wieder zu verwenden, anstatt ihn vollständig neu zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="56c0a-104">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="56c0a-105">bietet ein einfaches Verfahren zum Hosten von [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalte in einem [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Fenster.</span><span class="sxs-lookup"><span data-stu-id="56c0a-105"> provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span>  
  
 <span data-ttu-id="56c0a-106">In diesem Lernprogramm wird beschrieben, wie eine beispielanwendung, schreiben [Hosten von WPF-Inhalt in einem Win32-Fenster](http://go.microsoft.com/fwlink/?LinkID=160004), die Hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalte in einem [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Fenster.</span><span class="sxs-lookup"><span data-stu-id="56c0a-106">This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](http://go.microsoft.com/fwlink/?LinkID=160004), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="56c0a-107">Dieses Beispiel kann auf das Hosten beliebiger [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]-Fenster erweitert werden. </span><span class="sxs-lookup"><span data-stu-id="56c0a-107">You can extend this sample to host any [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="56c0a-108">Da verwalteter und nicht verwalteter Code kombiniert werden muss, wird die Anwendung in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] geschrieben.</span><span class="sxs-lookup"><span data-stu-id="56c0a-108">Because it involves mixing managed and unmanaged code, the application is written in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span>  
  
 
  
<a name="requirements"></a>   
## <a name="requirements"></a><span data-ttu-id="56c0a-109">Anforderungen</span><span class="sxs-lookup"><span data-stu-id="56c0a-109">Requirements</span></span>  
 <span data-ttu-id="56c0a-110">In diesem Lernprogramm wird vorausgesetzt, dass Sie mit den Grundlagen der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Programmierung und der [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]-Programmierung vertraut sind.</span><span class="sxs-lookup"><span data-stu-id="56c0a-110">This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming.</span></span> <span data-ttu-id="56c0a-111">Eine grundlegende Einführung in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Programmierung, finden Sie unter [Einstieg](../../../../docs/framework/wpf/getting-started/index.md).</span><span class="sxs-lookup"><span data-stu-id="56c0a-111">For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../../../../docs/framework/wpf/getting-started/index.md).</span></span> <span data-ttu-id="56c0a-112">Eine Einführung in die [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Programmierung, Sie sollten verweisen zahlreiche Büchern zu diesem Thema, insbesondere *Windows-Programmierung* von Charles Petzold.</span><span class="sxs-lookup"><span data-stu-id="56c0a-112">For an introduction to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.</span></span>  
  
 <span data-ttu-id="56c0a-113">Da in das Beispiel, das dieses Lernprogramm implementiert ist [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], dieses Lernprogramm setzt Kenntnisse über die Verwendung von [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] Programm die [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] sowie einen Überblick über die Programmierung von verwaltetem Code.</span><span class="sxs-lookup"><span data-stu-id="56c0a-113">Because the sample that accompanies this tutorial is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], this tutorial assumes familiarity with the use of [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] to program the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)][!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] plus an understanding of managed code programming.</span></span> <span data-ttu-id="56c0a-114">Grundkenntnisse in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] sind hilfreich, aber keine Voraussetzung.</span><span class="sxs-lookup"><span data-stu-id="56c0a-114">Familiarity with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] is helpful but not essential.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="56c0a-115">Dieses Lernprogramm enthält eine Reihe von Codebeispielen aus dem genannten Beispiel.</span><span class="sxs-lookup"><span data-stu-id="56c0a-115">This tutorial includes a number of code examples from the associated sample.</span></span> <span data-ttu-id="56c0a-116">Aus Gründen der besseren Lesbarkeit wird jedoch nicht der gesamte Beispielcode aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-116">However, for readability, it does not include the complete sample code.</span></span> <span data-ttu-id="56c0a-117">Den vollständigen Beispielcode finden Sie unter [WPF-Inhalt in einem Win32-Fenster](http://go.microsoft.com/fwlink/?LinkID=160004).</span><span class="sxs-lookup"><span data-stu-id="56c0a-117">For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](http://go.microsoft.com/fwlink/?LinkID=160004).</span></span>  
  
<a name="basic_procedure"></a>   
## <a name="the-basic-procedure"></a><span data-ttu-id="56c0a-118">Das grundlegende Verfahren</span><span class="sxs-lookup"><span data-stu-id="56c0a-118">The Basic Procedure</span></span>  
 <span data-ttu-id="56c0a-119">Dieser Abschnitt beschreibt das grundlegende Verfahren, die Sie, um verwenden Host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalte in einem [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Fenster.</span><span class="sxs-lookup"><span data-stu-id="56c0a-119">This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="56c0a-120">In den weiteren Abschnitten werden die einzelnen Schritte näher erläutert.</span><span class="sxs-lookup"><span data-stu-id="56c0a-120">The remaining sections explain the details of each step.</span></span>  
  
 <span data-ttu-id="56c0a-121">Der Schlüssel zum Hosten der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalten auf einen [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Fenster ist die <xref:System.Windows.Interop.HwndSource> Klasse.</span><span class="sxs-lookup"><span data-stu-id="56c0a-121">The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="56c0a-122">Diese Klasse dient als Wrapper für die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalte in einer [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Fenster, sodass er integriert werden soll Ihre [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] als untergeordnetes Fenster.</span><span class="sxs-lookup"><span data-stu-id="56c0a-122">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="56c0a-123">Bei folgender Vorgehensweise werden [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] und [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in einer einzigen Anwendung zusammengefasst.</span><span class="sxs-lookup"><span data-stu-id="56c0a-123">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1.  <span data-ttu-id="56c0a-124">Implementieren der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt als eine verwaltete Klasse.</span><span class="sxs-lookup"><span data-stu-id="56c0a-124">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class.</span></span>  
  
2.  <span data-ttu-id="56c0a-125">Implementieren Sie eine [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]-Anwendung mit [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="56c0a-125">Implement a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="56c0a-126">Wenn Sie mit einer vorhandenen Anwendung und nicht verwaltetem [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)]-Code beginnen, können Sie diese in der Regel verwalteten Code aufrufen lassen, indem Sie das `/clr`-Compilerflag in die Projekteinstellungen aufnehmen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-126">If you are starting with an existing application and unmanaged [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag.</span></span>  
  
3.  <span data-ttu-id="56c0a-127">Legen Sie das Threadingmodell auf Singlethread-Apartment (STA) fest.</span><span class="sxs-lookup"><span data-stu-id="56c0a-127">Set the threading model to single-threaded apartment (STA).</span></span>  
  
4.  <span data-ttu-id="56c0a-128">Behandeln der [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx)Benachrichtigung in der Fensterprozedur und führen Sie folgende Schritte:</span><span class="sxs-lookup"><span data-stu-id="56c0a-128">Handle the [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx)notification in your window procedure and do the following:</span></span>  
  
    1.  <span data-ttu-id="56c0a-129">Erstellen Sie ein neues <xref:System.Windows.Interop.HwndSource>-Objekt, und verwenden Sie das übergeordnete Fenster als `parent`-Parameter.</span><span class="sxs-lookup"><span data-stu-id="56c0a-129">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter.</span></span>  
  
    2.  <span data-ttu-id="56c0a-130">Erstellen Sie eine Instanz der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhaltsklasse.</span><span class="sxs-lookup"><span data-stu-id="56c0a-130">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3.  <span data-ttu-id="56c0a-131">Weisen Sie einen Verweis auf die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhaltsobjekte der <xref:System.Windows.Interop.HwndSource.RootVisual%2A> Eigenschaft von der <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="56c0a-131">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
    4.  <span data-ttu-id="56c0a-132">Rufen Sie HWND für den Inhalt ab.</span><span class="sxs-lookup"><span data-stu-id="56c0a-132">Get the HWND for the content.</span></span> <span data-ttu-id="56c0a-133">Die <xref:System.Windows.Interop.HwndSource.Handle%2A>-Eigenschaft des <xref:System.Windows.Interop.HwndSource>-Objekts enthält das Fensterhandle (HWND).</span><span class="sxs-lookup"><span data-stu-id="56c0a-133">The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND).</span></span> <span data-ttu-id="56c0a-134">Um ein HWND zu erhalten, das Sie im nicht verwalteten Teil der Anwendung verwenden können, wandeln Sie `Handle.ToPointer()` in ein HWND um.</span><span class="sxs-lookup"><span data-stu-id="56c0a-134">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
5.  <span data-ttu-id="56c0a-135">Implementieren Sie eine verwaltete Klasse, die ein statisches Feld mit einem Verweis auf den [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt enthält.</span><span class="sxs-lookup"><span data-stu-id="56c0a-135">Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="56c0a-136">Diese Klasse ermöglicht Ihnen, einen Verweis auf den [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt vom [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]-Code abzurufen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-136">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>  
  
6.  <span data-ttu-id="56c0a-137">Weisen Sie dem statischen Feld den [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt zu.</span><span class="sxs-lookup"><span data-stu-id="56c0a-137">Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field.</span></span>  
  
7.  <span data-ttu-id="56c0a-138">Empfangen von Benachrichtigungen von der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] -Inhalt um einen Handler für eine oder mehrere der Anfügen der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="56c0a-138">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events.</span></span>  
  
8.  <span data-ttu-id="56c0a-139">Kommunizieren Sie mithilfe des im statischen Feld gespeicherten Verweises mit dem [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt, um Eigenschaften festzulegen usw.</span><span class="sxs-lookup"><span data-stu-id="56c0a-139">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="56c0a-140">Sie können auch [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] zum Implementieren Ihrer [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-140">You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="56c0a-141">Sie müssen ihn allerdings separat als eine [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] kompilieren und auf diese [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] aus Ihrer [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]-Anwendung heraus verweisen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-141">However, you will have to compile it separately as a [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] and reference that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="56c0a-142">Die übrigen Schritte ähneln dem oben beschriebenen Verfahren. </span><span class="sxs-lookup"><span data-stu-id="56c0a-142">The remainder of the procedure is similar to that outlined above.</span></span>  
  
<a name="implementing_the_application"></a>   
## <a name="implementing-the-host-application"></a><span data-ttu-id="56c0a-143">Implementieren der Hostanwendung</span><span class="sxs-lookup"><span data-stu-id="56c0a-143">Implementing the Host Application</span></span>  
 <span data-ttu-id="56c0a-144">In diesem Abschnitt wird beschrieben, wie Sie Host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalte in einer grundlegenden [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Anwendung.</span><span class="sxs-lookup"><span data-stu-id="56c0a-144">This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="56c0a-145">Der Inhalt selbst wird in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] als verwaltete Klasse implementiert.</span><span class="sxs-lookup"><span data-stu-id="56c0a-145">The content itself is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] as a managed class.</span></span> <span data-ttu-id="56c0a-146">Größtenteils handelt es sich um eine einfache [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Programmierung.</span><span class="sxs-lookup"><span data-stu-id="56c0a-146">For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming.</span></span> <span data-ttu-id="56c0a-147">Die wichtigsten Aspekte der Content-Implementierung werden im erläutert [Implementieren des WPF-Inhalts](#implementing_the_wpf_page).</span><span class="sxs-lookup"><span data-stu-id="56c0a-147">The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page).</span></span>  
  
<a name="autoNestedSectionsOUTLINE1"></a>   
-   [<span data-ttu-id="56c0a-148">Die grundlegende Anwendung</span><span class="sxs-lookup"><span data-stu-id="56c0a-148">The Basic Application</span></span>](#the_basic_application)  
  
-   [<span data-ttu-id="56c0a-149">Hosten des WPF-Inhalts</span><span class="sxs-lookup"><span data-stu-id="56c0a-149">Hosting the WPF Content</span></span>](#hosting_the_wpf_page)  
  
-   [<span data-ttu-id="56c0a-150">Verweisen auf den WPF-Inhalt</span><span class="sxs-lookup"><span data-stu-id="56c0a-150">Holding a Reference to the WPF Content</span></span>](#holding_a_reference)  
  
-   [<span data-ttu-id="56c0a-151">Kommunizieren mit dem WPF-Inhalt</span><span class="sxs-lookup"><span data-stu-id="56c0a-151">Communicating with the WPF Content</span></span>](#communicating_with_the_page)  
  
<a name="the_basic_application"></a>   
### <a name="the-basic-application"></a><span data-ttu-id="56c0a-152">Die grundlegende Anwendung</span><span class="sxs-lookup"><span data-stu-id="56c0a-152">The Basic Application</span></span>  
 <span data-ttu-id="56c0a-153">Der Ausgangspunkt für die Hostanwendung bestand darin, eine [!INCLUDE[TLA#tla_visualstu2005](../../../../includes/tlasharptla-visualstu2005-md.md)]-Vorlage zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-153">The starting point for the host application was to create a [!INCLUDE[TLA#tla_visualstu2005](../../../../includes/tlasharptla-visualstu2005-md.md)] template.</span></span>  
  
1.  <span data-ttu-id="56c0a-154">Open [!INCLUDE[TLA2#tla_visualstu2005](../../../../includes/tla2sharptla-visualstu2005-md.md)], und wählen Sie **neues Projekt** aus der **Datei** Menü.</span><span class="sxs-lookup"><span data-stu-id="56c0a-154">Open [!INCLUDE[TLA2#tla_visualstu2005](../../../../includes/tla2sharptla-visualstu2005-md.md)], and select **New Project** from the **File** menu.</span></span>  
  
2.  <span data-ttu-id="56c0a-155">Wählen Sie **Win32** aus der Liste der [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] Projekttypen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-155">Select **Win32** from the list of [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] project types.</span></span> <span data-ttu-id="56c0a-156">Wenn Sie nicht die Standardsprache ist [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], finden Sie diese Projekttypen unter **andere Sprachen**.</span><span class="sxs-lookup"><span data-stu-id="56c0a-156">If your default language is not [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], you will find these project types under **Other Languages**.</span></span>  
  
3.  <span data-ttu-id="56c0a-157">Wählen Sie eine **Win32-Projekt** Vorlage, weisen Sie einen Namen für das Projekt, und klicken Sie auf **OK** zum Starten der **Win32-Anwendung-Assistent**.</span><span class="sxs-lookup"><span data-stu-id="56c0a-157">Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**.</span></span>  
  
4.  <span data-ttu-id="56c0a-158">Akzeptieren Sie die Standardeinstellungen des Assistenten, und klicken Sie auf **Fertig stellen** auf das Projekt zu starten.</span><span class="sxs-lookup"><span data-stu-id="56c0a-158">Accept the wizard's default settings and click **Finish** to start the project.</span></span>  
  
 <span data-ttu-id="56c0a-159">Mit der Vorlage wird eine grundlegende [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]-Anwendung erstellt, die Folgendes enthält:</span><span class="sxs-lookup"><span data-stu-id="56c0a-159">The template creates a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application, including:</span></span>  
  
-   <span data-ttu-id="56c0a-160">Einen Einstiegspunkt für die Anwendung.</span><span class="sxs-lookup"><span data-stu-id="56c0a-160">An entry point for the application.</span></span>  
  
-   <span data-ttu-id="56c0a-161">Ein Fenster mit einer zugeordneten Fensterprozedur (WndProc).</span><span class="sxs-lookup"><span data-stu-id="56c0a-161">A window, with an associated window procedure (WndProc).</span></span>  
  
-   <span data-ttu-id="56c0a-162">Ein Menü mit **Datei** und **Hilfe** Überschriften.</span><span class="sxs-lookup"><span data-stu-id="56c0a-162">A menu with **File** and **Help** headings.</span></span> <span data-ttu-id="56c0a-163">Die **Datei** Menü enthält eine **beenden** Element, das die Anwendung geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="56c0a-163">The **File** menu has an **Exit** item that closes the application.</span></span> <span data-ttu-id="56c0a-164">Die **Hilfe** Menü enthält eine **zu** Element, ein einfaches Dialogfeld gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="56c0a-164">The **Help** menu has an **About** item that launches a simple dialog box.</span></span>  
  
 <span data-ttu-id="56c0a-165">Bevor Sie Code schreiben zu Host die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt, müssen Sie zwei Änderungen, damit die Basisvorlage vornehmen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-165">Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template.</span></span>  
  
 <span data-ttu-id="56c0a-166">Die erste besteht darin, das Projekt als verwalteten Code zu kompilieren.</span><span class="sxs-lookup"><span data-stu-id="56c0a-166">The first is to compile the project as managed code.</span></span> <span data-ttu-id="56c0a-167">Standardmäßig wird das Projekt als nicht verwalteter Code kompiliert.</span><span class="sxs-lookup"><span data-stu-id="56c0a-167">By default, the project compiles as unmanaged code.</span></span> <span data-ttu-id="56c0a-168">Da aber [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in verwaltetem Code implementiert wird, muss das Projekt entsprechend kompiliert werden.</span><span class="sxs-lookup"><span data-stu-id="56c0a-168">However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly.</span></span>  
  
1.  <span data-ttu-id="56c0a-169">Mit der rechten Maustaste in des Namens des Projekts **Projektmappen-Explorer** , und wählen Sie **Eigenschaften** aus dem Kontextmenü zum Starten der **Eigenschaftenseiten** (Dialogfeld).</span><span class="sxs-lookup"><span data-stu-id="56c0a-169">Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box.</span></span>  
  
2.  <span data-ttu-id="56c0a-170">Wählen Sie **Konfigurationseigenschaften** aus der Strukturansicht im linken Bereich.</span><span class="sxs-lookup"><span data-stu-id="56c0a-170">Select **Configuration Properties** from the tree view in the left pane.</span></span>  
  
3.  <span data-ttu-id="56c0a-171">Wählen Sie **Common Language Runtime** aus unterstützen, die die **Projektstandards** Liste im rechten Bereich.</span><span class="sxs-lookup"><span data-stu-id="56c0a-171">Select **Common Language Runtime** support from the **Project Defaults** list in the right pane.</span></span>  
  
4.  <span data-ttu-id="56c0a-172">Wählen Sie **Common Language Runtime-Unterstützung (/ Clr)** aus dem Dropdown-Listenfeld.</span><span class="sxs-lookup"><span data-stu-id="56c0a-172">Select **Common Language Runtime Support (/clr)** from the drop-down list box.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="56c0a-173">Das Compilerflag ermöglicht Ihnen, in der Anwendung verwalteten Code zu verwenden. Der nicht verwaltete Code wird jedoch wie zuvor kompiliert.</span><span class="sxs-lookup"><span data-stu-id="56c0a-173">This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="56c0a-174"> verwendet das Threadingmodell Singlethread-Apartment (STA).</span><span class="sxs-lookup"><span data-stu-id="56c0a-174"> uses the single-threaded apartment (STA) threading model.</span></span> <span data-ttu-id="56c0a-175">Die ordnungsgemäße Ausführung mit der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt Code müssen Sie festlegen Threadingmodell für die Anwendung auf STA durch Anwenden eines Attributs für den Einstiegspunkt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-175">In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WinMain](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#winmain)]  
  
<a name="hosting_the_wpf_page"></a>   
### <a name="hosting-the-wpf-content"></a><span data-ttu-id="56c0a-176">Hosten des WPF-Inhalts</span><span class="sxs-lookup"><span data-stu-id="56c0a-176">Hosting the WPF Content</span></span>  
 <span data-ttu-id="56c0a-177">Die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt ist eine einfache Anwendung Eintrag.</span><span class="sxs-lookup"><span data-stu-id="56c0a-177">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application.</span></span> <span data-ttu-id="56c0a-178">Sie besteht aus mehreren <xref:System.Windows.Controls.TextBox>-Steuerelementen zum Erfassen von Benutzername, Adresse usw.</span><span class="sxs-lookup"><span data-stu-id="56c0a-178">It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on.</span></span> <span data-ttu-id="56c0a-179">Es gibt auch zwei <xref:System.Windows.Controls.Button> Steuerelemente **OK** und **"Abbrechen"**.</span><span class="sxs-lookup"><span data-stu-id="56c0a-179">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**.</span></span> <span data-ttu-id="56c0a-180">Wenn der Benutzer klickt **OK**, der Schaltfläche <xref:System.Windows.Controls.Primitives.ButtonBase.Click> Ereignishandler erfasst die Daten aus der <xref:System.Windows.Controls.TextBox> steuert, weist sie den entsprechenden Eigenschaften und löst ein benutzerdefiniertes Ereignis `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="56c0a-180">When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`.</span></span> <span data-ttu-id="56c0a-181">Wenn der Benutzer klickt **"Abbrechen"**, löst der Handler einfach `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="56c0a-181">When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`.</span></span> <span data-ttu-id="56c0a-182">Das Ereignisargumentobjekt für `OnButtonClicked` enthält ein boolesches Feld, das angibt, auf welche Schaltfläche geklickt wurde.</span><span class="sxs-lookup"><span data-stu-id="56c0a-182">The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked.</span></span>  
  
 <span data-ttu-id="56c0a-183">Der Code zum Hosten der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt wird implementiert, in einem Ereignishandler für das [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx) Benachrichtigung auf das Hostfenster.</span><span class="sxs-lookup"><span data-stu-id="56c0a-183">The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx) notification on the host window.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WMCreate](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcreate)]  
  
 <span data-ttu-id="56c0a-184">Die `GetHwnd` Methode verwendet Fensterhandle Größe und Position Informationen sowie das übergeordnete Element und gibt das Fensterhandle des gehosteten [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-184">The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="56c0a-185">Sie können keine `#using`-Direktive für den `System::Windows::Interop`-Namespace verwenden.</span><span class="sxs-lookup"><span data-stu-id="56c0a-185">You cannot use a `#using` directive for the `System::Windows::Interop` namespace.</span></span> <span data-ttu-id="56c0a-186">Dies würde zu einem Namenskonflikt zwischen der <xref:System.Windows.Interop.MSG>-Struktur in diesem Namespace und der in winuser.h deklarierten MSG-Struktur führen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-186">Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h.</span></span> <span data-ttu-id="56c0a-187">Verwenden Sie stattdessen vollqualifizierte Namen, um auf den Inhalt dieses Namespace zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-187">You must instead use fully-qualified names to access the contents of that namespace.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#GetHwnd](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#gethwnd)]  
  
 <span data-ttu-id="56c0a-188">Sie können keine hosten die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt direkt im Anwendungsfenster.</span><span class="sxs-lookup"><span data-stu-id="56c0a-188">You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window.</span></span> <span data-ttu-id="56c0a-189">Stattdessen müssen Sie zuerst ein <xref:System.Windows.Interop.HwndSource>-Objekt erstellen, um den [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt zu umschließen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-189">Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="56c0a-190">Dieses Objekt ist im Grunde genommen ein Fenster, das zum Hosten einer [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-190">This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="56c0a-191">Sie hosten die <xref:System.Windows.Interop.HwndSource> in das übergeordnete Fenster erstellen als untergeordnetes Element des Objekts ein [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Fenster, das Teil der Anwendung ist.</span><span class="sxs-lookup"><span data-stu-id="56c0a-191">You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window that is part of your application.</span></span> <span data-ttu-id="56c0a-192">Die <xref:System.Windows.Interop.HwndSource>-Konstruktorparameter enthalten größtenteils dieselben Informationen, die Sie beim Erstellen eines untergeordneten [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]-Fensters an CreateWindow übergeben würden. </span><span class="sxs-lookup"><span data-stu-id="56c0a-192">The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] child window.</span></span>  
  
 <span data-ttu-id="56c0a-193">Als Nächstes erstellen Sie eine Instanz von der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Content-Objekt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-193">You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="56c0a-194">In diesem Fall wird der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt unter Verwendung von `WPFPage` als separate Klasse, nämlich [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], implementiert.</span><span class="sxs-lookup"><span data-stu-id="56c0a-194">In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="56c0a-195">Sie können den [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt auch mit [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] implementieren.</span><span class="sxs-lookup"><span data-stu-id="56c0a-195">You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="56c0a-196">Allerdings dazu müssen Sie ein separates Projekt eingerichtet und erstellen die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt als eine [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span><span class="sxs-lookup"><span data-stu-id="56c0a-196">However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span></span> <span data-ttu-id="56c0a-197">Sie können dem Projekt einen Verweis auf diese [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] hinzufügen und ihn zum Erstellen einer Instanz des [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalts verwenden.</span><span class="sxs-lookup"><span data-stu-id="56c0a-197">You can add a reference to that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>  
  
 <span data-ttu-id="56c0a-198">Sie Anzeigen der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalte in Ihr untergeordnetes Fenster durch Zuweisen der einen Verweis auf die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt an die <xref:System.Windows.Interop.HwndSource.RootVisual%2A> Eigenschaft von der <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="56c0a-198">You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
 <span data-ttu-id="56c0a-199">Durch die nächste Codezeile wird ein Ereignishandler (`WPFButtonClicked`) an das [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Ereignis des `OnButtonClicked`-Inhalts angefügt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-199">The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event.</span></span> <span data-ttu-id="56c0a-200">Dieser Handler wird aufgerufen, wenn der Benutzer klickt auf die **OK** oder **"Abbrechen"** Schaltfläche.</span><span class="sxs-lookup"><span data-stu-id="56c0a-200">This handler is called when the user clicks the **OK** or **Cancel** button.</span></span> <span data-ttu-id="56c0a-201">Finden Sie unter [kommunizieren mit dem WPF-Inhalt](#communicating_with_the_page) weitere Erläuterung dieses ereignishandlers.</span><span class="sxs-lookup"><span data-stu-id="56c0a-201">See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler.</span></span>  
  
 <span data-ttu-id="56c0a-202">Durch die letzte angezeigte Codezeile wird das Fensterhandle (HWND) zurückgegeben, das dem <xref:System.Windows.Interop.HwndSource>-Objekt zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="56c0a-202">The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object.</span></span> <span data-ttu-id="56c0a-203">Sie können dieses Handle vom [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]-Code zum Senden von Meldungen an das gehostete Fenster verwenden, auch wenn das in diesem Beispiel nicht gezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="56c0a-203">You can use this handle from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code to send messages to the hosted window, although the sample does not do so.</span></span> <span data-ttu-id="56c0a-204">Das <xref:System.Windows.Interop.HwndSource>-Objekt löst jedes Mal ein Ereignis aus, wenn es eine Meldung empfängt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-204">The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message.</span></span> <span data-ttu-id="56c0a-205">Rufen Sie zum Verarbeiten der Meldungen die <xref:System.Windows.Interop.HwndSource.AddHook%2A>-Methode auf, um einen Meldungshandler anzufügen und anschließend die Meldungen in diesem Handler zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="56c0a-205">To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler.</span></span>  
  
<a name="holding_a_reference"></a>   
### <a name="holding-a-reference-to-the-wpf-content"></a><span data-ttu-id="56c0a-206">Verweisen auf den WPF-Inhalt</span><span class="sxs-lookup"><span data-stu-id="56c0a-206">Holding a Reference to the WPF Content</span></span>  
 <span data-ttu-id="56c0a-207">Bei vielen Anwendungen möchten Sie zu einem späteren Zeitpunkt mit dem [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="56c0a-207">For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later.</span></span> <span data-ttu-id="56c0a-208">Angenommen, Sie möchten die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhaltseigenschaften ändern oder vom <xref:System.Windows.Interop.HwndSource>-Objekt andere [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalte hosten lassen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-208">For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="56c0a-209">Dazu benötigen Sie einen Verweis auf das <xref:System.Windows.Interop.HwndSource>-Objekt oder den [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-209">To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="56c0a-210">Das <xref:System.Windows.Interop.HwndSource>-Objekt und der zugehörige [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt bleiben im Arbeitsspeicher, bis Sie das Fensterhandle zerstören.</span><span class="sxs-lookup"><span data-stu-id="56c0a-210">The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle.</span></span> <span data-ttu-id="56c0a-211">Die Variable, die Sie dem <xref:System.Windows.Interop.HwndSource>-Objekt zuweisen, verlässt jedoch den Gültigkeitsbereich, sobald die Steuerung von der Fensterprozedur zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="56c0a-211">However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure.</span></span> <span data-ttu-id="56c0a-212">Eine übliche Methode, dieses Problem bei [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]-Anwendungen zu umgehen, besteht in der Verwendung einer statischen oder globalen Variablen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-212">The customary way to handle this issue with [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications is to use a static or global variable.</span></span> <span data-ttu-id="56c0a-213">Leider können Sie diesen Variablentypen kein verwaltetes Objekt zuweisen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-213">Unfortunately, you cannot assign a managed object to those types of variables.</span></span> <span data-ttu-id="56c0a-214">Sie können das Fensterhandle, das dem <xref:System.Windows.Interop.HwndSource>-Objekt zugeordnet ist, einer globalen oder statischen Variablen zuweisen. Dadurch erhalten Sie aber noch keinen Zugriff auf das Objekt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-214">You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself.</span></span>  
  
 <span data-ttu-id="56c0a-215">Die einfachste Lösung für dieses Problem besteht darin, eine verwaltete Klasse zu implementieren, die eine Reihe von statischen Feldern mit Verweisen auf alle verwalteten Objekte enthält, auf die Sie zugreifen müssen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-215">The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to.</span></span> <span data-ttu-id="56c0a-216">Im Beispiel wird die `WPFPageHost`-Klasse für einen Verweis auf den [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt verwendet. Außerdem soll sie die Anfangswerte einiger Eigenschaften enthalten, die später vom Benutzer geändert werden können.</span><span class="sxs-lookup"><span data-stu-id="56c0a-216">The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user.</span></span> <span data-ttu-id="56c0a-217">Dies wird im Header definiert.</span><span class="sxs-lookup"><span data-stu-id="56c0a-217">This is defined in the header.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageHost](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.h#wpfpagehost)]  
  
 <span data-ttu-id="56c0a-218">Der letzte Teil der `GetHwnd`-Funktion weist diesen Feldern Werte zur späteren Verwendung zu, während `myPage` im Gültigkeitsbereich verbleibt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-218">The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope.</span></span>  
  
<a name="communicating_with_the_page"></a>   
### <a name="communicating-with-the-wpf-content"></a><span data-ttu-id="56c0a-219">Kommunizieren mit dem WPF-Inhalt</span><span class="sxs-lookup"><span data-stu-id="56c0a-219">Communicating with the WPF Content</span></span>  
 <span data-ttu-id="56c0a-220">Es gibt zwei Arten der Kommunikation mit dem [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-220">There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="56c0a-221">Die Anwendung empfängt Informationen aus der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalten, wenn der Benutzer klickt auf die **OK** oder **"Abbrechen"** Schaltflächen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-221">The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons.</span></span> <span data-ttu-id="56c0a-222">Die Anwendung verfügt auch über eine [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], die es dem Benutzer ermöglicht, zahlreiche [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhaltseigenschaften zu ändern, z. B. Hintergrundfarbe oder Standardschriftgröße.</span><span class="sxs-lookup"><span data-stu-id="56c0a-222">The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size.</span></span>  
  
 <span data-ttu-id="56c0a-223">Wie oben erwähnt, löst der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt ein `OnButtonClicked`-Ereignis aus, wenn der Benutzer auf eine der beiden Schaltflächen klickt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-223">As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event.</span></span> <span data-ttu-id="56c0a-224">Die Anwendung fügt einen Handler an dieses Ereignis an, um die entsprechenden Benachrichtigungen zu empfangen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-224">The application attaches a handler to this event to receive these notifications.</span></span> <span data-ttu-id="56c0a-225">Wenn die **OK** Schaltfläche geklickt wurde, der Handler Ruft die Benutzerinformationen von der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt und zeigt ihn in einen Satz von statischen Steuerelementen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-225">If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFButtonClicked](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wpfbuttonclicked)]  
  
 <span data-ttu-id="56c0a-226">Der Handler empfängt ein benutzerdefiniertes Ereignisargumentobjekt vom [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt: `MyPageEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="56c0a-226">The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`.</span></span> <span data-ttu-id="56c0a-227">Des Objekts `IsOK` -Eigenschaftensatz auf `true` Wenn die **OK** Schaltfläche geklickt wurde, und `false` Wenn die **"Abbrechen"** Schaltfläche geklickt wurde.</span><span class="sxs-lookup"><span data-stu-id="56c0a-227">The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked.</span></span>  
  
 <span data-ttu-id="56c0a-228">Wenn die **OK** Schaltfläche geklickt wurde, der Handler Ruft einen Verweis auf die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt aus dem Container-Klasse.</span><span class="sxs-lookup"><span data-stu-id="56c0a-228">If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class.</span></span> <span data-ttu-id="56c0a-229">Anschließend ruft er die Benutzerinformationen ab, die in den zugeordneten [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhaltseigenschaften enthalten sind. Dabei werden die statischen Steuerelemente zum Anzeigen der Informationen im übergeordneten Fenster verwendet.</span><span class="sxs-lookup"><span data-stu-id="56c0a-229">It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window.</span></span> <span data-ttu-id="56c0a-230">Da die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhaltsdaten in Form einer verwalteten Zeichenfolge vorliegen, müssen Sie gemarshallt werden, damit sie von einem [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]-Steuerelement verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="56c0a-230">Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control.</span></span> <span data-ttu-id="56c0a-231">Wenn die **"Abbrechen"** Schaltfläche geklickt wurde, löscht der Handler die Daten aus den statischen Steuerelementen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-231">If the **Cancel** button was clicked, the handler clears the data from the static controls.</span></span>  
  
 <span data-ttu-id="56c0a-232">Die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] der Anwendung stellt eine Reihe von Optionsfeldern bereit, mit denen der Benutzer die Hintergrundfarbe des [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalts und verschiedene Schriftarteigenschaften ändern kann.</span><span class="sxs-lookup"><span data-stu-id="56c0a-232">The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties.</span></span> <span data-ttu-id="56c0a-233">Das folgende Beispiel ist ein Auszug aus der Fensterprozedur der Anwendung (WndProc) und deren Meldungsbehandlung, die zahlreiche Eigenschaften für verschiedene Meldungen festlegt, darunter die Hintergrundfarbe.</span><span class="sxs-lookup"><span data-stu-id="56c0a-233">The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color.</span></span> <span data-ttu-id="56c0a-234">Die anderen sind ähnlich und werden nicht angezeigt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-234">The others are similar, and are not shown.</span></span> <span data-ttu-id="56c0a-235">Sehen Sie sich das vollständige Beispiel an, um ausführliche Informationen, auch zum Kontext, zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="56c0a-235">See the complete sample for details and context.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WMCommandToBG](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcommandtobg)]  
  
 <span data-ttu-id="56c0a-236">Wenn Sie die Hintergrundfarbe festlegen möchten, rufen Sie einen Verweis auf den [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt (`hostedPage`) von `WPFPageHost` ab, und legen Sie die Eigenschaft für die Hintergrundfarbe auf die entsprechende Farbe fest.</span><span class="sxs-lookup"><span data-stu-id="56c0a-236">To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color.</span></span> <span data-ttu-id="56c0a-237">Im Beispiel werden drei Farboptionen verwendet: die ursprüngliche Farbe, hellgrün oder helle Lachsfarbe.</span><span class="sxs-lookup"><span data-stu-id="56c0a-237">The sample uses three color options: the original color, light green, or light salmon.</span></span> <span data-ttu-id="56c0a-238">Die ursprüngliche Hintergrundfarbe wird als statisches Feld in der `WPFPageHost`-Klasse gespeichert.</span><span class="sxs-lookup"><span data-stu-id="56c0a-238">The original background color is stored as a static field in the `WPFPageHost` class.</span></span> <span data-ttu-id="56c0a-239">Um die anderen beiden festzulegen, erstellen Sie ein neues <xref:System.Windows.Media.SolidColorBrush>-Objekt und übergeben dem Konstruktor einen statischen Farbwert aus dem <xref:System.Windows.Media.Colors>-Objekt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-239">To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object.</span></span>  
  
<a name="implementing_the_wpf_page"></a>   
## <a name="implementing-the-wpf-page"></a><span data-ttu-id="56c0a-240">Implementieren der WPF-Seite</span><span class="sxs-lookup"><span data-stu-id="56c0a-240">Implementing the WPF Page</span></span>  
 <span data-ttu-id="56c0a-241">Sie hosten können, und verwenden die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt ohne Kenntnis von der tatsächlichen Implementierung.</span><span class="sxs-lookup"><span data-stu-id="56c0a-241">You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation.</span></span> <span data-ttu-id="56c0a-242">Wenn die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt in einem separaten gepackt [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], es wurden konnte in keinem integriert [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] Sprache.</span><span class="sxs-lookup"><span data-stu-id="56c0a-242">If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], it could have been built in any [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] language.</span></span> <span data-ttu-id="56c0a-243">Es folgt eine kurze exemplarische Vorgehensweise zur [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)]-Implementierung, die in diesem Beispiel verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="56c0a-243">Following is a brief walkthrough of the [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] implementation that is used in the sample.</span></span> <span data-ttu-id="56c0a-244">Dieser Abschnitt enthält folgende Unterabschnitte:</span><span class="sxs-lookup"><span data-stu-id="56c0a-244">This section contains the following subsections.</span></span>  
  
<a name="autoNestedSectionsOUTLINE2"></a>   
-   [<span data-ttu-id="56c0a-245">Layout</span><span class="sxs-lookup"><span data-stu-id="56c0a-245">Layout</span></span>](#page_layout)  
  
-   [<span data-ttu-id="56c0a-246">Zurückgeben der Daten an das Hostfenster</span><span class="sxs-lookup"><span data-stu-id="56c0a-246">Returning the Data to the Host Window</span></span>](#returning_data_to_window)  
  
-   [<span data-ttu-id="56c0a-247">Festlegen der WPF-Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="56c0a-247">Setting the WPF Properties</span></span>](#set_page_properties)  
  
<a name="page_layout"></a>   
### <a name="layout"></a><span data-ttu-id="56c0a-248">Layout</span><span class="sxs-lookup"><span data-stu-id="56c0a-248">Layout</span></span>  
 <span data-ttu-id="56c0a-249">Die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Elemente in der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt bestehen aus fünf <xref:System.Windows.Controls.TextBox> steuert, zugeordnete <xref:System.Windows.Controls.Label> Steuerelemente: Name, Adresse, Ort, Bundesland und PLZ.</span><span class="sxs-lookup"><span data-stu-id="56c0a-249">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip.</span></span> <span data-ttu-id="56c0a-250">Es gibt auch zwei <xref:System.Windows.Controls.Button> Steuerelemente **OK** und **"Abbrechen"**</span><span class="sxs-lookup"><span data-stu-id="56c0a-250">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**</span></span>  
  
 <span data-ttu-id="56c0a-251">Der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalt wird in der `WPFPage`-Klasse implementiert.</span><span class="sxs-lookup"><span data-stu-id="56c0a-251">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class.</span></span> <span data-ttu-id="56c0a-252">Das Layout wird mit einem <xref:System.Windows.Controls.Grid>-Layoutelement behandelt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-252">Layout is handled with a <xref:System.Windows.Controls.Grid> layout element.</span></span> <span data-ttu-id="56c0a-253">Die Klasse erbt von <xref:System.Windows.Controls.Grid>, wodurch sie zum Stammelement des [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhalts wird.</span><span class="sxs-lookup"><span data-stu-id="56c0a-253">The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element.</span></span>  
  
 <span data-ttu-id="56c0a-254">Die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Content Konstruktor übernimmt die erforderliche Breite und Höhe und Größe der <xref:System.Windows.Controls.Grid> entsprechend.</span><span class="sxs-lookup"><span data-stu-id="56c0a-254">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly.</span></span> <span data-ttu-id="56c0a-255">Anschließend wird das grundlegende Layout definiert, durch Erstellen eines Satzes von <xref:System.Windows.Controls.ColumnDefinition> und <xref:System.Windows.Controls.RowDefinition> Objekte und Hinzufügen der <xref:System.Windows.Controls.Grid> Objekt Basis <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> und <xref:System.Windows.Controls.Grid.RowDefinitions%2A> Sammlungen, bzw.</span><span class="sxs-lookup"><span data-stu-id="56c0a-255">It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively.</span></span> <span data-ttu-id="56c0a-256">Dadurch wird ein Raster von fünf Zeilen und sieben Spalten definiert. Die Abmessungen werden durch den Inhalt der Zellen bestimmt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-256">This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorToGridDef](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortogriddef)]  
  
 <span data-ttu-id="56c0a-257">Anschließend fügt der Konstruktor die [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]-Elemente zu <xref:System.Windows.Controls.Grid> hinzu.</span><span class="sxs-lookup"><span data-stu-id="56c0a-257">Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>.</span></span> <span data-ttu-id="56c0a-258">Das erste Element ist der Titeltext. Dabei handelt es sich um ein <xref:System.Windows.Controls.Label>-Steuerelement, das in der ersten Zeile des Rasters zentriert ist.</span><span class="sxs-lookup"><span data-stu-id="56c0a-258">The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorTitle](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortitle)]  
  
 <span data-ttu-id="56c0a-259">Die nächste Zeile enthält das <xref:System.Windows.Controls.Label>-Steuerelement für den Namen und das zugehörige <xref:System.Windows.Controls.TextBox>-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="56c0a-259">The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control.</span></span> <span data-ttu-id="56c0a-260">Da für jedes aus Beschriftung und Textfeld bestehende Paar derselbe Code verwendet wird, wird er in einem Paar privater Methoden platziert und für alle fünf Paare aus Beschriftung/Textfeld verwendet.</span><span class="sxs-lookup"><span data-stu-id="56c0a-260">Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs.</span></span> <span data-ttu-id="56c0a-261">Durch die Methoden wird das entsprechende Steuerelement erstellt, und es werden die statischen Methoden <xref:System.Windows.Controls.Grid> und <xref:System.Windows.Controls.Grid.SetColumn%2A> der <xref:System.Windows.Controls.Grid.SetRow%2A>-Klasse aufgerufen, um die Steuerelemente in der entsprechenden Zelle zu platzieren.</span><span class="sxs-lookup"><span data-stu-id="56c0a-261">The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell.</span></span> <span data-ttu-id="56c0a-262">Nachdem das Steuerelement erstellt wurde, wird im Beispiel die <xref:System.Windows.Controls.UIElementCollection.Add%2A>-Methode für die <xref:System.Windows.Controls.Panel.Children%2A>-Eigenschaft von <xref:System.Windows.Controls.Grid> aufgerufen, um das Steuerelement zum Raster hinzuzufügen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-262">After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid.</span></span> <span data-ttu-id="56c0a-263">Der Code zum Hinzufügen der übrigen Beschriftung/Textfeld-Paare ist ähnlich.</span><span class="sxs-lookup"><span data-stu-id="56c0a-263">The code to add the remaining label/textbox pairs is similar.</span></span> <span data-ttu-id="56c0a-264">Sehen Sie sich den Beispielcode an, um ausführliche Informationen zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="56c0a-264">See the sample code for details.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorName](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorname)]  
  
 <span data-ttu-id="56c0a-265">Die Implementierung der beiden Methoden wird wie folgt durchgeführt:</span><span class="sxs-lookup"><span data-stu-id="56c0a-265">The implementation of the two methods is as follows:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCreateHelpers](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagecreatehelpers)]  
  
 <span data-ttu-id="56c0a-266">Zum Schluss das Beispiel fügt die **OK** und **"Abbrechen"** Schaltflächen und fügt einen Ereignishandler, um ihre <xref:System.Windows.Controls.Primitives.ButtonBase.Click> Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="56c0a-266">Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorButtonsEvents](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorbuttonsevents)]  
  
<a name="returning_data_to_window"></a>   
### <a name="returning-the-data-to-the-host-window"></a><span data-ttu-id="56c0a-267">Zurückgeben der Daten an das Hostfenster</span><span class="sxs-lookup"><span data-stu-id="56c0a-267">Returning the Data to the Host Window</span></span>  
 <span data-ttu-id="56c0a-268">Das <xref:System.Windows.Controls.Primitives.ButtonBase.Click>-Ereignis wird durch Klicken auf eine der Schaltflächen ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="56c0a-268">When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised.</span></span> <span data-ttu-id="56c0a-269">Das Hostfenster könnte einfach Handler an diese Ereignisse anfügen und die Daten direkt aus den <xref:System.Windows.Controls.TextBox>-Steuerelementen abrufen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-269">The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls.</span></span> <span data-ttu-id="56c0a-270">In diesem Beispiel wird ein weniger direkter Ansatz verwendet.</span><span class="sxs-lookup"><span data-stu-id="56c0a-270">The sample uses a somewhat less direct approach.</span></span> <span data-ttu-id="56c0a-271">Verarbeitet die <xref:System.Windows.Controls.Primitives.ButtonBase.Click> innerhalb der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalte und löst anschließend ein benutzerdefiniertes Ereignis `OnButtonClicked`, benachrichtigen die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhalt.</span><span class="sxs-lookup"><span data-stu-id="56c0a-271">It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="56c0a-272">Dies ermöglicht die [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Content möchten einige Parametervalidierungsfunktionen, bevor Sie den Host zu benachrichtigen.</span><span class="sxs-lookup"><span data-stu-id="56c0a-272">This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host.</span></span> <span data-ttu-id="56c0a-273">Der Handler fragt den Text aus den <xref:System.Windows.Controls.TextBox>-Steuerelementen ab und weist ihn öffentlichen Eigenschaften zu, aus denen der Host die Informationen abrufen kann.</span><span class="sxs-lookup"><span data-stu-id="56c0a-273">The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information.</span></span>  
  
 <span data-ttu-id="56c0a-274">Die Ereignisdeklaration in WPFPage.h:</span><span class="sxs-lookup"><span data-stu-id="56c0a-274">The event declaration, in WPFPage.h:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageEventDecl](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpageeventdecl)]  
  
 <span data-ttu-id="56c0a-275">Der <xref:System.Windows.Controls.Primitives.ButtonBase.Click>-Ereignishandler in WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="56c0a-275">The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageButtonClicked](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagebuttonclicked)]  
  
<a name="set_page_properties"></a>   
### <a name="setting-the-wpf-properties"></a><span data-ttu-id="56c0a-276">Festlegen der WPF-Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="56c0a-276">Setting the WPF Properties</span></span>  
 <span data-ttu-id="56c0a-277">Die [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Host ermöglicht dem Benutzer mehrere ändern [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Inhaltseigenschaften.</span><span class="sxs-lookup"><span data-stu-id="56c0a-277">The [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties.</span></span> <span data-ttu-id="56c0a-278">In [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] müssen lediglich Eigenschaften geändert werden.</span><span class="sxs-lookup"><span data-stu-id="56c0a-278">From the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] side, it is simply a matter of changing the properties.</span></span> <span data-ttu-id="56c0a-279">Die Implementierung in der [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-Inhaltsklasse ist etwas komplizierter, da es keine einzelne globale Eigenschaft gibt, mit der die Schriftarten für alle Steuerelemente gesteuert werden.</span><span class="sxs-lookup"><span data-stu-id="56c0a-279">The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls.</span></span> <span data-ttu-id="56c0a-280">Stattdessen wird die entsprechende Eigenschaft für die einzelnen Steuerelemente in den set-Accessoren der Eigenschaften geändert.</span><span class="sxs-lookup"><span data-stu-id="56c0a-280">Instead, the appropriate property for each control is changed in the properties' set accessors.</span></span> <span data-ttu-id="56c0a-281">Das folgende Beispiel zeigt den Code für die `DefaultFontFamily` Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="56c0a-281">The following example shows the code for the `DefaultFontFamily` property.</span></span> <span data-ttu-id="56c0a-282">Durch Festlegen der Eigenschaft wird eine private Methode aufgerufen, mit der die <xref:System.Windows.Controls.Control.FontFamily%2A>-Eigenschaften für die verschiedenen Steuerelemente festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="56c0a-282">Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls.</span></span>  
  
 <span data-ttu-id="56c0a-283">Aus WPFPage.h:</span><span class="sxs-lookup"><span data-stu-id="56c0a-283">From WPFPage.h:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageFontFamilyProperty](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpagefontfamilyproperty)]  
  
 <span data-ttu-id="56c0a-284">Aus WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="56c0a-284">From WPFPage.cpp:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageSetFontFamily](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagesetfontfamily)]  
  
## <a name="see-also"></a><span data-ttu-id="56c0a-285">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="56c0a-285">See Also</span></span>  
 <xref:System.Windows.Interop.HwndSource>  
 [<span data-ttu-id="56c0a-286">Interaktion zwischen WPF und Win32</span><span class="sxs-lookup"><span data-stu-id="56c0a-286">WPF and Win32 Interoperation</span></span>](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md)
