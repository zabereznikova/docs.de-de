---
title: Grundlagen der Codezugriffssicherheit
description: 'Erlernen Sie die Grundlagen der Code Zugriffssicherheit für apps, die auf die CLR abzielen: typsicherer Code, imperative und deklarative Syntax, sichere Klassenbibliotheken und transparenter Code.'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- security [.NET Framework], code access security
ms.assetid: 4eaa6535-d9fe-41a1-91d8-b437cfc16921
ms.openlocfilehash: 9d1f2e35c79ca32595711316885991717c4c1696
ms.sourcegitcommit: 97ce5363efa88179dd76e09de0103a500ca9b659
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 07/13/2020
ms.locfileid: "86281747"
---
# <a name="code-access-security-basics"></a><span data-ttu-id="0a472-103">Grundlagen der Codezugriffssicherheit</span><span class="sxs-lookup"><span data-stu-id="0a472-103">Code Access Security Basics</span></span>

[!INCLUDE[net_security_note](../../../includes/net-security-note-md.md)]

<span data-ttu-id="0a472-104">Jede Anwendung für die Common Language Runtime (also jede verwaltete Anwendung) muss mit dem Sicherheitssystem der Runtime interagieren.</span><span class="sxs-lookup"><span data-stu-id="0a472-104">Every application that targets the common language runtime (that is, every managed application) must interact with the runtime's security system.</span></span> <span data-ttu-id="0a472-105">Wenn eine verwaltete Anwendung geladen wird, gewährt der Host ihr automatisch einen Satz von Berechtigungen.</span><span class="sxs-lookup"><span data-stu-id="0a472-105">When a managed application is loaded, its host automatically grants it a set of permissions.</span></span> <span data-ttu-id="0a472-106">Diese Berechtigungen werden von den lokalen Sicherheitseinstellungen des Hosts oder von der Sandbox bestimmt, in der die Anwendung enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="0a472-106">These permissions are determined by the host's local security settings or by the sandbox the application is in.</span></span> <span data-ttu-id="0a472-107">In Abhängigkeit von diesen Berechtigungen wird die Anwendung ordnungsgemäß ausgeführt, oder es wird eine Sicherheitsausnahme generiert.</span><span class="sxs-lookup"><span data-stu-id="0a472-107">Depending on these permissions, the application either runs properly or generates a security exception.</span></span>

<span data-ttu-id="0a472-108">Der Standardhost für Desktopanwendungen ermöglicht, dass Code mit voller Vertrauenswürdigkeit ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="0a472-108">The default host for desktop applications allows code to run in full trust.</span></span> <span data-ttu-id="0a472-109">Wenn die Anwendung für den Desktop konzipiert ist, hat sie daher einen uneingeschränkten Berechtigungssatz.</span><span class="sxs-lookup"><span data-stu-id="0a472-109">Therefore, if your application targets the desktop, it has an unrestricted permission set.</span></span> <span data-ttu-id="0a472-110">Andere Hosts oder Sandboxes stellen für Anwendungen einen eingeschränkten Berechtigungssatz bereit.</span><span class="sxs-lookup"><span data-stu-id="0a472-110">Other hosts or sandboxes provide a limited permission set for applications.</span></span> <span data-ttu-id="0a472-111">Da sich der Berechtigungssatz von Host zu Host unterscheiden kann, müssen Sie Ihre Anwendung so entwerfen, dass sie nur die vom Zielhost zugelassenen Berechtigungen verwendet.</span><span class="sxs-lookup"><span data-stu-id="0a472-111">Because the permission set can change from host to host, you must design your application to use only the permissions that your target host allows.</span></span>

<span data-ttu-id="0a472-112">Sie müssen mit den folgenden Konzepten der Codezugriffssicherheit vertraut sein, um effiziente Anwendungen für die Common Language Runtime schreiben zu können:</span><span class="sxs-lookup"><span data-stu-id="0a472-112">You must be familiar with the following code access security concepts in order to write effective applications that target the common language runtime:</span></span>

- <span data-ttu-id="0a472-113">**Typsicherer**Code: typsicherer Code ist Code, der nur auf genau definierte, zulässige Weise auf Typen zugreift.</span><span class="sxs-lookup"><span data-stu-id="0a472-113">**Type-safe code**: Type-safe code is code that accesses types only in well-defined, allowable ways.</span></span> <span data-ttu-id="0a472-114">Beispielsweise kann typsicherer Code, wenn ein gültiger Objektverweis angegeben ist, an festen Offsets, die tatsächlichen Feldmembern entsprechen, auf Speicher zugreifen.</span><span class="sxs-lookup"><span data-stu-id="0a472-114">For example, given a valid object reference, type-safe code can access memory at fixed offsets that correspond to actual field members.</span></span> <span data-ttu-id="0a472-115">Greift der Code auf Speicher an beliebigen Offsets zu, die sich außerhalb des Speicherbereichs befinden, der zu den öffentlich verfügbar gemachten Feldern dieses Objekts gehört, ist er nicht typsicher.</span><span class="sxs-lookup"><span data-stu-id="0a472-115">If the code accesses memory at arbitrary offsets outside the range of memory that belongs to that object's publicly exposed fields, it is not type-safe.</span></span> <span data-ttu-id="0a472-116">Um für Code ein Profitieren von Codezugriffssicherheit zu ermöglichen, müssen Sie einen Compiler verwenden, der nachweisbar typsicheren Code generiert.</span><span class="sxs-lookup"><span data-stu-id="0a472-116">To enable code to benefit from code access security, you must use a compiler that generates verifiably type-safe code.</span></span> <span data-ttu-id="0a472-117">Weitere Informationen finden Sie im Abschnitt Schreiben von überprüfbar [typsicherem Code](#typesafe_code) weiter unten in diesem Thema.</span><span class="sxs-lookup"><span data-stu-id="0a472-117">For more information, see the [Writing Verifiably Type-Safe Code](#typesafe_code) section later in this topic.</span></span>

- <span data-ttu-id="0a472-118">**Imperative und deklarative Syntax**: der Code für den Common Language Runtime kann mit dem Sicherheitssystem interagieren, indem er Berechtigungen anfordert, Aufrufer anfordert, Berechtigungen festzulegen und bestimmte Sicherheitseinstellungen außer Kraft zu setzen (bei ausreichenden Berechtigungen).</span><span class="sxs-lookup"><span data-stu-id="0a472-118">**Imperative and declarative syntax**: Code that targets the common language runtime can interact with the security system by requesting permissions, demanding that callers have specified permissions, and overriding certain security settings (given enough privileges).</span></span> <span data-ttu-id="0a472-119">Für die programmgesteuerte Interaktion mit dem Sicherheitssystem von .NET Framework verwenden Sie zwei verschiedene Syntaxformen: die deklarative und die imperative Syntax.</span><span class="sxs-lookup"><span data-stu-id="0a472-119">You use two forms of syntax to programmatically interact with the .NET Framework security system: declarative syntax and imperative syntax.</span></span> <span data-ttu-id="0a472-120">Deklarative Aufrufe werden mithilfe von Attributen ausgeführt, imperative Aufrufe werden mit neuen Instanzen von Klassen im Code ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="0a472-120">Declarative calls are performed using attributes; imperative calls are performed using new instances of classes within your code.</span></span> <span data-ttu-id="0a472-121">Einige Aufrufe können nur imperativ ausgeführt werden, andere können nur deklarativ ausgeführt werden, und einige Aufrufe können auf beide Arten ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="0a472-121">Some calls can be performed only imperatively, others can be performed only declaratively, and some calls can be performed in either manner.</span></span>

- <span data-ttu-id="0a472-122">**Sichere Klassenbibliotheken**: eine sichere Klassenbibliothek verwendet Sicherheitsanforderungen, um sicherzustellen, dass die Aufrufer der Bibliothek über die Berechtigung verfügen, auf die von der Bibliothek verfügbar gemachten Ressourcen zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="0a472-122">**Secure class libraries**: A secure class library uses security demands to ensure that the library's callers have permission to access the resources that the library exposes.</span></span> <span data-ttu-id="0a472-123">Eine sichere Klassenbibliothek kann z. B. eine Methode zum Erstellen von Dateien haben, in der gefordert wird, dass ihre Aufrufer Berechtigungen zum Erstellen von Dateien haben.</span><span class="sxs-lookup"><span data-stu-id="0a472-123">For example, a secure class library might have a method for creating files that would demand that its callers have permissions to create files.</span></span> <span data-ttu-id="0a472-124">.NET Framework besteht aus sicheren Klassenbibliotheken.</span><span class="sxs-lookup"><span data-stu-id="0a472-124">The .NET Framework consists of secure class libraries.</span></span> <span data-ttu-id="0a472-125">Sie müssen die Berechtigungen berücksichtigen, die für Zugriffe auf jede Bibliothek erforderlich sind, die in Ihrem Code verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="0a472-125">You should be aware of the permissions required to access any library that your code uses.</span></span> <span data-ttu-id="0a472-126">Weitere Informationen finden Sie im Abschnitt [Verwenden von sicheren Klassenbibliotheken](#secure_library) weiter unten in diesem Thema.</span><span class="sxs-lookup"><span data-stu-id="0a472-126">For more information, see the [Using Secure Class Libraries](#secure_library) section later in this topic.</span></span>

- <span data-ttu-id="0a472-127">**Transparenter Code**: beginnend mit dem .NET Framework 4 müssen Sie zusätzlich zum Identifizieren bestimmter Berechtigungen auch bestimmen, ob der Code als Sicherheits transparent ausgeführt werden soll.</span><span class="sxs-lookup"><span data-stu-id="0a472-127">**Transparent code**: Starting with the .NET Framework 4, in addition to identifying specific permissions, you must also determine whether your code should run as security-transparent.</span></span> <span data-ttu-id="0a472-128">Aus sicherheitstransparentem Code können weder Typen oder Member aufgerufen werden, die als sicherheitskritisch gekennzeichnet sind.</span><span class="sxs-lookup"><span data-stu-id="0a472-128">Security-transparent code cannot call types or members that are identified as security-critical.</span></span> <span data-ttu-id="0a472-129">Diese Regel gilt sowohl für voll vertrauenswürdige Anwendungen als auch für teilweise vertrauenswürdige Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="0a472-129">This rule applies to full-trust applications as well as partially trusted applications.</span></span> <span data-ttu-id="0a472-130">Weitere Informationen finden Sie unter [Sicherheits transparenter Code](security-transparent-code.md).</span><span class="sxs-lookup"><span data-stu-id="0a472-130">For more information, see [Security-Transparent Code](security-transparent-code.md).</span></span>

<a name="typesafe_code"></a>

## <a name="writing-verifiably-type-safe-code"></a><span data-ttu-id="0a472-131">Schreiben von überprüfbar typsicherem Code</span><span class="sxs-lookup"><span data-stu-id="0a472-131">Writing Verifiably Type-Safe Code</span></span>

<span data-ttu-id="0a472-132">Bei der Just-in-Time-Kompilierung (JIT) wird ein Überprüfungsverfahren angewendet, in dem Code untersucht und versucht wird, zu ermitteln, ob der Code typsicher ist.</span><span class="sxs-lookup"><span data-stu-id="0a472-132">Just-in-time (JIT) compilation performs a verification process that examines code and tries to determine whether the code is type-safe.</span></span> <span data-ttu-id="0a472-133">Code, der sich während der Überprüfung als typsicher bewährt hat, wird als überprüfbar *typsicherer Code*bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="0a472-133">Code that is proven during verification to be type-safe is called *verifiably type-safe code*.</span></span> <span data-ttu-id="0a472-134">Wegen der Beschränkungen des Überprüfungsverfahrens oder des Compilers kann Code typsicher, jedoch möglicherweise nicht überprüfbar typsicher sein.</span><span class="sxs-lookup"><span data-stu-id="0a472-134">Code can be type-safe, yet might not be verifiably type-safe because of the limitations of the verification process or of the compiler.</span></span> <span data-ttu-id="0a472-135">Nicht alle Sprachen sind typsicher, und einige Sprachcompiler, z. B. Microsoft Visual C++, können keinen überprüfbar typsicheren verwalteten Code generieren.</span><span class="sxs-lookup"><span data-stu-id="0a472-135">Not all languages are type-safe, and some language compilers, such as Microsoft Visual C++, cannot generate verifiably type-safe managed code.</span></span> <span data-ttu-id="0a472-136">Um festzustellen, ob der von Ihnen verwendete Sprachcompiler überprüfbar typsicheren Code generiert, lesen Sie die entsprechenden Informationen in der Dokumentation des Compilers.</span><span class="sxs-lookup"><span data-stu-id="0a472-136">To determine whether the language compiler you use generates verifiably type-safe code, consult the compiler's documentation.</span></span> <span data-ttu-id="0a472-137">Wenn Sie einen sprach Compiler verwenden, der überprüfbar typsicheren Code nur dann generiert, wenn Sie bestimmte Sprachkonstrukte vermeiden, können Sie das [Tool "Peer Verify](../tools/peverify-exe-peverify-tool.md) " verwenden, um zu bestimmen, ob der Code überprüfbar typsicher ist.</span><span class="sxs-lookup"><span data-stu-id="0a472-137">If you use a language compiler that generates verifiably type-safe code only when you avoid certain language constructs, you might want to use the [PEVerify tool](../tools/peverify-exe-peverify-tool.md) to determine whether your code is verifiably type-safe.</span></span>

<span data-ttu-id="0a472-138">Code, der nicht überprüfbar typsicher ist, kann versuchen, ausgeführt zu werden, wenn die Sicherheitsrichtlinie zulässt, dass der Code die Überprüfung umgeht.</span><span class="sxs-lookup"><span data-stu-id="0a472-138">Code that is not verifiably type-safe can attempt to execute if security policy allows the code to bypass verification.</span></span> <span data-ttu-id="0a472-139">Da Typsicherheit aber ein wesentlicher Bestandteil des Runtime-Mechanismus zur Isolation von Assemblys ist, kann Sicherheit nicht zuverlässig erzwungen werden, wenn die Regeln für die Typsicherheit durch Code verletzt werden.</span><span class="sxs-lookup"><span data-stu-id="0a472-139">However, because type safety is an essential part of the runtime's mechanism for isolating assemblies, security cannot be reliably enforced if code violates the rules of type safety.</span></span> <span data-ttu-id="0a472-140">In der Standardeinstellung kann Code, der nicht typsicher ist, nur ausgeführt werden, wenn er vom lokalen Computer stammt.</span><span class="sxs-lookup"><span data-stu-id="0a472-140">By default, code that is not type-safe is allowed to run only if it originates from the local computer.</span></span> <span data-ttu-id="0a472-141">Aus diesem Grund sollte mobiler Code typsicher sein.</span><span class="sxs-lookup"><span data-stu-id="0a472-141">Therefore, mobile code should be type-safe.</span></span>

<a name="secure_library"></a>

## <a name="using-secure-class-libraries"></a><span data-ttu-id="0a472-142">Verwenden von sicheren Klassenbibliotheken</span><span class="sxs-lookup"><span data-stu-id="0a472-142">Using Secure Class Libraries</span></span>

<span data-ttu-id="0a472-143">Wenn Ihr Code die Berechtigungen anfordert und erhält, die von der Klassenbibliothek gefordert werden, wird ihm der Zugriff auf die Bibliothek gewährt, und die Ressourcen, die von der Bibliothek verfügbar gemacht werden, werden vor nicht autorisiertem Zugriff geschützt.</span><span class="sxs-lookup"><span data-stu-id="0a472-143">If your code requests and is granted the permissions required by the class library, it will be allowed to access the library and the resources that the library exposes will be protected from unauthorized access.</span></span> <span data-ttu-id="0a472-144">Wenn Ihr Code nicht die entsprechenden Berechtigungen hat, wird ihm kein Zugriff auf die Klassenbibliothek gewährt, und Schadsoftware ist nicht in der Lage, den Code zu verwenden, um indirekt auf geschützte Ressourcen zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="0a472-144">If your code does not have the appropriate permissions, it will not be allowed to access the class library, and malicious code will not be able to use your code to indirectly access protected resources.</span></span> <span data-ttu-id="0a472-145">Anderer Code, der Ihren Code aufruft, muss ebenfalls die Berechtigung zum Zugriff auf die Bibliothek haben.</span><span class="sxs-lookup"><span data-stu-id="0a472-145">Other code that calls your code must also have permission to access the library.</span></span> <span data-ttu-id="0a472-146">Ist dies nicht der Fall ist, wird auch die Ausführung Ihres Code entsprechend eingeschränkt.</span><span class="sxs-lookup"><span data-stu-id="0a472-146">If it does not, your code will be restricted from running as well.</span></span>

<span data-ttu-id="0a472-147">Codezugriffssicherheit verhindert nicht, dass Sie möglicherweise fehlerhaften Code schreiben.</span><span class="sxs-lookup"><span data-stu-id="0a472-147">Code access security does not eliminate the possibility of human error in writing code.</span></span> <span data-ttu-id="0a472-148">Wenn Ihre Anwendung jedoch mithilfe von sicheren Klassenbibliotheken auf geschützte Ressourcen zugreift, ist das Sicherheitsrisiko für Anwendungscode geringer, da Klassenbibliotheken eingehend auf mögliche Sicherheitsprobleme überprüft werden.</span><span class="sxs-lookup"><span data-stu-id="0a472-148">However, if your application uses secure class libraries to access protected resources, the security risk for application code is decreased, because class libraries are closely scrutinized for potential security problems.</span></span>

## <a name="declarative-security"></a><span data-ttu-id="0a472-149">Deklarative Sicherheit</span><span class="sxs-lookup"><span data-stu-id="0a472-149">Declarative Security</span></span>

<span data-ttu-id="0a472-150">Deklarative Sicherheits Syntax verwendet [Attribute](../../standard/attributes/index.md) , um Sicherheitsinformationen in die [Metadaten](../../standard/metadata-and-self-describing-components.md) Ihres Codes zu platzieren.</span><span class="sxs-lookup"><span data-stu-id="0a472-150">Declarative security syntax uses [attributes](../../standard/attributes/index.md) to place security information into the [metadata](../../standard/metadata-and-self-describing-components.md) of your code.</span></span> <span data-ttu-id="0a472-151">Attribute können auf Assembly-, Klassen- oder Memberebene platziert werden, um den Typ der Anforderung, Forderung oder Überschreibung zu kennzeichnen, die Sie verwenden möchten.</span><span class="sxs-lookup"><span data-stu-id="0a472-151">Attributes can be placed at the assembly, class, or member level, to indicate the type of request, demand, or override you want to use.</span></span> <span data-ttu-id="0a472-152">Anforderungen werden in Anwendungen für die Common Language Runtime verwendet, um das Runtime-Sicherheitssystem über die Berechtigungen zu informieren, die Ihre Anwendung benötigt bzw. nicht wünscht.</span><span class="sxs-lookup"><span data-stu-id="0a472-152">Requests are used in applications that target the common language runtime to inform the runtime security system about the permissions that your application needs or does not want.</span></span> <span data-ttu-id="0a472-153">Forderungen und Überschreibungen werden in Bibliotheken verwendet, um Ressourcen vor Aufrufern zu schützen oder Standardsicherheitsverhalten zu überschreiben.</span><span class="sxs-lookup"><span data-stu-id="0a472-153">Demands and overrides are used in libraries to help protect resources from callers or to override default security behavior.</span></span>

> [!NOTE]
> <span data-ttu-id="0a472-154">In .NET Framework 4 gab es wichtige Änderungen am .NET Framework Sicherheitsmodell und der Terminologie.</span><span class="sxs-lookup"><span data-stu-id="0a472-154">In the .NET Framework 4, there have been important changes to the .NET Framework security model and terminology.</span></span> <span data-ttu-id="0a472-155">Weitere Informationen zu diesen Änderungen finden Sie unter [Sicherheitsänderungen](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes).</span><span class="sxs-lookup"><span data-stu-id="0a472-155">For more information about these changes, see [Security Changes](https://docs.microsoft.com/previous-versions/dotnet/framework/security/security-changes).</span></span>

<span data-ttu-id="0a472-156">Damit Sie Aufrufe für deklarative Sicherheit verwenden können, müssen Sie die Zustandsdaten des Berechtigungsobjekts so initialisieren, dass sie der bestimmten Form von Berechtigung entsprechen, die Sie benötigen.</span><span class="sxs-lookup"><span data-stu-id="0a472-156">In order to use declarative security calls, you must initialize the state data of the permission object so that it represents the particular form of permission you need.</span></span> <span data-ttu-id="0a472-157">Jede integrierte Berechtigung hat ein Attribut, das als eine <xref:System.Security.Permissions.SecurityAction>-Enumeration übergeben wird, um den Typ des Sicherheitsvorgangs zu beschreiben, den Sie ausführen möchten.</span><span class="sxs-lookup"><span data-stu-id="0a472-157">Every built-in permission has an attribute that is passed a <xref:System.Security.Permissions.SecurityAction> enumeration to describe the type of security operation you want to perform.</span></span> <span data-ttu-id="0a472-158">Berechtigungen akzeptieren auch ihre eigenen Parameter, die ihnen exklusiv zugewiesen sind.</span><span class="sxs-lookup"><span data-stu-id="0a472-158">However, permissions also accept their own parameters that are exclusive to them.</span></span>

<span data-ttu-id="0a472-159">Das folgende Codefragment veranschaulicht deklarative Syntax zum Anfordern, dass Aufrufer Ihres Codes eine benutzerdefinierte Berechtigung namens `MyPermission` haben.</span><span class="sxs-lookup"><span data-stu-id="0a472-159">The following code fragment shows declarative syntax for requesting that your code's callers have a custom permission called `MyPermission`.</span></span> <span data-ttu-id="0a472-160">Diese Berechtigung ist eine hypothetische benutzerdefinierte Berechtigung und nicht in .NET Framework vorhanden.</span><span class="sxs-lookup"><span data-stu-id="0a472-160">This permission is a hypothetical custom permission and does not exist in the .NET Framework.</span></span> <span data-ttu-id="0a472-161">In diesem Beispiel befindet sich der deklarative Aufruf direkt vor der Klassendefinition, wodurch angegeben ist, dass diese Berechtigung auf Klassenebene angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="0a472-161">In this example, the declarative call is placed directly before the class definition, specifying that this permission be applied to the class level.</span></span> <span data-ttu-id="0a472-162">An das Attribut wird eine **SecurityAction. Demand** -Struktur übermittelt, um anzugeben, dass Aufrufer über diese Berechtigung verfügen müssen, um ausgeführt zu werden.</span><span class="sxs-lookup"><span data-stu-id="0a472-162">The attribute is passed a **SecurityAction.Demand** structure to specify that callers must have this permission in order to run.</span></span>

```vb
<MyPermission(SecurityAction.Demand, Unrestricted = True)> Public Class MyClass1

   Public Sub New()
      'The constructor is protected by the security call.
   End Sub

   Public Sub MyMethod()
      'This method is protected by the security call.
   End Sub

   Public Sub YourMethod()
      'This method is protected by the security call.
   End Sub
End Class
```

```csharp
[MyPermission(SecurityAction.Demand, Unrestricted = true)]
public class MyClass
{
   public MyClass()
   {
      //The constructor is protected by the security call.
   }

   public void MyMethod()
   {
      //This method is protected by the security call.
   }

   public void YourMethod()
   {
      //This method is protected by the security call.
   }
}
```

## <a name="imperative-security"></a><span data-ttu-id="0a472-163">Imperative Sicherheit</span><span class="sxs-lookup"><span data-stu-id="0a472-163">Imperative Security</span></span>

<span data-ttu-id="0a472-164">Imperative Sicherheitssyntax gibt einen Sicherheitsaufruf aus, indem eine neuen Instanz des Berechtigungsobjekts erstellt wird, das Sie aufrufen möchten.</span><span class="sxs-lookup"><span data-stu-id="0a472-164">Imperative security syntax issues a security call by creating a new instance of the permission object you want to invoke.</span></span> <span data-ttu-id="0a472-165">Über imperative Syntax können Sie Forderungen und Überschreibungen, aber keine Anforderungen ausführen.</span><span class="sxs-lookup"><span data-stu-id="0a472-165">You can use imperative syntax to perform demands and overrides, but not requests.</span></span>

<span data-ttu-id="0a472-166">Bevor Sie den Sicherheitsaufruf vornehmen, müssen Sie die Zustandsdaten des Berechtigungsobjekts so initialisieren, dass sie der bestimmten Form von Berechtigung entsprechen, die Sie benötigen.</span><span class="sxs-lookup"><span data-stu-id="0a472-166">Before you make the security call, you must initialize the state data of the permission object so that it represents the particular form of the permission you need.</span></span> <span data-ttu-id="0a472-167">Wenn Sie z. b. ein- <xref:System.Security.Permissions.FileIOPermission> Objekt erstellen, können Sie den-Konstruktor verwenden, um das **FileIOPermission** -Objekt zu initialisieren, sodass es entweder den uneingeschränkten Zugriff auf alle Dateien oder keinen Zugriff auf Dateien darstellt.</span><span class="sxs-lookup"><span data-stu-id="0a472-167">For example, when creating a <xref:System.Security.Permissions.FileIOPermission> object, you can use the constructor to initialize the **FileIOPermission** object so that it represents either unrestricted access to all files or no access to files.</span></span> <span data-ttu-id="0a472-168">Oder Sie können ein anderes **FileIOPermission** -Objekt verwenden und Parameter übergeben, die den Zugriffstyp angeben, den das Objekt darstellen soll (d. h. lesen, anfügen oder schreiben) und welche Dateien das Objekt schützen soll.</span><span class="sxs-lookup"><span data-stu-id="0a472-168">Or, you can use a different **FileIOPermission** object, passing parameters that indicate the type of access you want the object to represent (that is, read, append, or write) and what files you want the object to protect.</span></span>

<span data-ttu-id="0a472-169">Imperative Sicherheitssyntax kann nicht nur zum Aufrufen eines einzelnen Sicherheitsobjekts verwendet werden, sondern auch dazu, eine Gruppe von Berechtigungen in einem Berechtigungssatz zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="0a472-169">In addition to using imperative security syntax to invoke a single security object, you can use it to initialize a group of permissions in a permission set.</span></span> <span data-ttu-id="0a472-170">Diese Technik ist beispielsweise die einzige Möglichkeit, [Assert](using-the-assert-method.md) -Aufrufe für mehrere Berechtigungen in einer Methode zuverlässig auszuführen.</span><span class="sxs-lookup"><span data-stu-id="0a472-170">For example, this technique is the only way to reliably perform [assert](using-the-assert-method.md) calls on multiple permissions in one method.</span></span> <span data-ttu-id="0a472-171">Verwenden Sie die Klassen <xref:System.Security.PermissionSet> und <xref:System.Security.NamedPermissionSet>, um eine Gruppe von Berechtigungen zu erstellen, und rufen Sie anschließend die entsprechende Methode auf, um den gewünschten Sicherheitsaufruf auszuführen.</span><span class="sxs-lookup"><span data-stu-id="0a472-171">Use the <xref:System.Security.PermissionSet> and <xref:System.Security.NamedPermissionSet> classes to create a group of permissions and then call the appropriate method to invoke the desired security call.</span></span>

<span data-ttu-id="0a472-172">Über imperative Syntax können Sie Forderungen und Überschreibungen, aber keine Anforderungen ausführen.</span><span class="sxs-lookup"><span data-stu-id="0a472-172">You can use imperative syntax to perform demands and overrides, but not requests.</span></span> <span data-ttu-id="0a472-173">Sie können imperative Syntax für Forderungen und Überschreibungen anstelle von deklarativer Syntax verwenden, wenn die Informationen, die Sie benötigen, um den Berechtigungsstatus initialisieren, nur zur Laufzeit bekannt sind.</span><span class="sxs-lookup"><span data-stu-id="0a472-173">You might use imperative syntax for demands and overrides instead of declarative syntax when information that you need in order to initialize the permission state becomes known only at run time.</span></span> <span data-ttu-id="0a472-174">Wenn Sie beispielsweise sicherstellen möchten, dass Aufrufer die Berechtigung zum Lesen einer bestimmten Datei haben, der Name dieser Datei aber erst zur Laufzeit bekannt ist, verwenden Sie eine imperative Forderung.</span><span class="sxs-lookup"><span data-stu-id="0a472-174">For example, if you want to ensure that callers have permission to read a certain file, but you do not know the name of that file until run time, use an imperative demand.</span></span> <span data-ttu-id="0a472-175">Sie können auch imperative Überprüfungen anstelle von deklarativen Überprüfungen verwenden, wenn Sie zur Laufzeit bestimmen müssen, ob eine Bedingung zutrifft, und dann basierend auf dem Ergebnis des Tests eine Sicherheitsforderung stellen (oder nicht).</span><span class="sxs-lookup"><span data-stu-id="0a472-175">You might also choose to use imperative checks instead of declarative checks when you need to determine at run time whether a condition holds and, based on the result of the test, make a security demand (or not).</span></span>

<span data-ttu-id="0a472-176">Das folgende Codefragment veranschaulicht imperative Syntax zum Anfordern, dass Aufrufer Ihres Codes eine benutzerdefinierte Berechtigung namens `MyPermission` haben.</span><span class="sxs-lookup"><span data-stu-id="0a472-176">The following code fragment shows imperative syntax for requesting that your code's callers have a custom permission called `MyPermission`.</span></span> <span data-ttu-id="0a472-177">Diese Berechtigung ist eine hypothetische benutzerdefinierte Berechtigung und nicht in .NET Framework vorhanden.</span><span class="sxs-lookup"><span data-stu-id="0a472-177">This permission is a hypothetical custom permission and does not exist in the .NET Framework.</span></span> <span data-ttu-id="0a472-178">Es wird eine neue Instanz von `MyPermission` erstellt, `MyMethod`, die ausschließlich diese Methode mit dem Sicherheitsaufruf schützt.</span><span class="sxs-lookup"><span data-stu-id="0a472-178">A new instance of `MyPermission` is created in `MyMethod`, guarding only this method with the security call.</span></span>

```vb
Public Class MyClass1

   Public Sub New()

   End Sub

   Public Sub MyMethod()
      'MyPermission is demanded using imperative syntax.
      Dim Perm As New MyPermission()
      Perm.Demand()
      'This method is protected by the security call.
   End Sub

   Public Sub YourMethod()
      'YourMethod 'This method is not protected by the security call.
   End Sub
End Class
```

```csharp
public class MyClass {
   public MyClass(){

   }

   public void MyMethod() {
       //MyPermission is demanded using imperative syntax.
       MyPermission Perm = new MyPermission();
       Perm.Demand();
       //This method is protected by the security call.
   }

   public void YourMethod() {
       //This method is not protected by the security call.
   }
}
```

## <a name="using-managed-wrapper-classes"></a><span data-ttu-id="0a472-179">Verwenden von verwalteten Wrapperklassen</span><span class="sxs-lookup"><span data-stu-id="0a472-179">Using Managed Wrapper Classes</span></span>

<span data-ttu-id="0a472-180">Die meisten Anwendungen und Komponenten (mit Ausnahme von sicheren Bibliotheken) sollten nicht verwalteten Code nicht direkt aufrufen.</span><span class="sxs-lookup"><span data-stu-id="0a472-180">Most applications and components (except secure libraries) should not directly call unmanaged code.</span></span> <span data-ttu-id="0a472-181">Hierfür gibt es mehrere Gründe:</span><span class="sxs-lookup"><span data-stu-id="0a472-181">There are several reasons for this.</span></span> <span data-ttu-id="0a472-182">Wenn Code nicht verwalteten Code direkt aufruft, wird seine Ausführung häufig nicht zugelassen, weil Code ein hohes Maß an Vertrauenswürdigkeit gewährt werden muss, damit er nativen Code aufrufen kann.</span><span class="sxs-lookup"><span data-stu-id="0a472-182">If code calls unmanaged code directly, it will not be allowed to run in many circumstances because code must be granted a high level of trust to call native code.</span></span> <span data-ttu-id="0a472-183">Wird die Richtlinie so geändert, dass sie das Ausführen einer solchen Anwendung zulässt, kann die Sicherheit des Systems deutlich geschwächt werden, weil die Anwendung Gelegenheit erhält, nahezu jede Operation auszuführen.</span><span class="sxs-lookup"><span data-stu-id="0a472-183">If policy is modified to allow such an application to run, it can significantly weaken the security of the system, leaving the application free to perform almost any operation.</span></span>

<span data-ttu-id="0a472-184">Darüber hinaus kann Code, der die Berechtigung zum Zugriff auf nicht verwalteten Code hat, wahrscheinlich fast jeden Vorgang ausführen, indem er Code in einer nicht verwalteten API aufruft.</span><span class="sxs-lookup"><span data-stu-id="0a472-184">Additionally, code that has permission to access unmanaged code can probably perform almost any operation by calling into an unmanaged API.</span></span> <span data-ttu-id="0a472-185">Beispielsweise muss Code, der über die Berechtigung zum Aufrufen von nicht verwaltetem Code verfügt, nicht <xref:System.Security.Permissions.FileIOPermission> auf eine Datei zugreifen können. er kann einfach eine nicht verwaltete Datei-API (Win32) direkt aufrufen, wobei die verwaltete Datei-API umgangen wird, die **FileIOPermission**erfordert.</span><span class="sxs-lookup"><span data-stu-id="0a472-185">For example, code that has permission to call unmanaged code does not need <xref:System.Security.Permissions.FileIOPermission> to access a file; it can just call an unmanaged (Win32) file API directly, bypassing the managed file API that requires **FileIOPermission**.</span></span> <span data-ttu-id="0a472-186">Wenn verwalteter Code die Berechtigung zum Aufrufen von nicht verwaltetem Code hat, kann das Sicherheitssystem Sicherheitsbeschränkungen nicht zuverlässig erzwingen, da die Runtime solche Beschränkungen für nicht verwalteten Code nicht erzwingen kann.</span><span class="sxs-lookup"><span data-stu-id="0a472-186">If managed code has permission to call into unmanaged code and does call directly into unmanaged code, the security system will be unable to reliably enforce security restrictions, since the runtime cannot enforce such restrictions on unmanaged code.</span></span>

<span data-ttu-id="0a472-187">Soll Ihre Anwendung einen Vorgang ausführen, der Zugriff auf nicht verwalteten Code erfordert, sollte dieser Zugriff über eine vertrauenswürdige verwaltete Klasse erfolgen, die die benötigten Funktionalität umschließt (sofern eine solche Klasse vorhanden ist).</span><span class="sxs-lookup"><span data-stu-id="0a472-187">If you want your application to perform an operation that requires accessing unmanaged code, it should do so through a trusted managed class that wraps the required functionality (if such a class exists).</span></span> <span data-ttu-id="0a472-188">Sie sollten nicht selbst eine Wrapperklasse erstellen, wenn es eine solche bereits in einer sicheren Klassenbibliothek gibt.</span><span class="sxs-lookup"><span data-stu-id="0a472-188">Do not create a wrapper class yourself if one already exists in a secure class library.</span></span> <span data-ttu-id="0a472-189">Die Wrapperklasse, der ein hohes Maß an Vertrauenswürdigkeit gewährt werden muss, damit Sie den Aufruf von nicht verwaltetem Code vornehmen darf, ist dafür verantwortlich, von ihren Aufrufern zu fordern, dass sie die entsprechenden Berechtigungen haben.</span><span class="sxs-lookup"><span data-stu-id="0a472-189">The wrapper class, which must be granted a high degree of trust to be allowed to make the call into unmanaged code, is responsible for demanding that its callers have the appropriate permissions.</span></span> <span data-ttu-id="0a472-190">Wenn Sie die Wrapperklasse verwenden, muss der Code nur die Berechtigungen anfordern und erhalten, die von der Wrapperklasse gefordert werden.</span><span class="sxs-lookup"><span data-stu-id="0a472-190">If you use the wrapper class, your code only needs to request and be granted the permissions that the wrapper class demands.</span></span>

## <a name="see-also"></a><span data-ttu-id="0a472-191">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="0a472-191">See also</span></span>

- <xref:System.Security.PermissionSet>
- <xref:System.Security.Permissions.FileIOPermission>
- <xref:System.Security.NamedPermissionSet>
- <xref:System.Security.Permissions.SecurityAction>
- [<span data-ttu-id="0a472-192">Assert</span><span class="sxs-lookup"><span data-stu-id="0a472-192">Assert</span></span>](using-the-assert-method.md)
- [<span data-ttu-id="0a472-193">Codezugriffssicherheit</span><span class="sxs-lookup"><span data-stu-id="0a472-193">Code Access Security</span></span>](code-access-security.md)
- [<span data-ttu-id="0a472-194">Grundlagen der Codezugriffssicherheit</span><span class="sxs-lookup"><span data-stu-id="0a472-194">Code Access Security Basics</span></span>](code-access-security-basics.md)
- [<span data-ttu-id="0a472-195">Attribute</span><span class="sxs-lookup"><span data-stu-id="0a472-195">Attributes</span></span>](../../standard/attributes/index.md)
- [<span data-ttu-id="0a472-196">Metadaten und selbstbeschreibende Komponenten</span><span class="sxs-lookup"><span data-stu-id="0a472-196">Metadata and Self-Describing Components</span></span>](../../standard/metadata-and-self-describing-components.md)
