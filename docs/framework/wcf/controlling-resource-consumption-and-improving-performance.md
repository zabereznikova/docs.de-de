---
title: Kontrollieren des Ressourcenverbrauchs und Verbessern der Leistung
ms.date: 03/30/2017
ms.assetid: 9a829669-5f76-4c88-80ec-92d0c62c0660
ms.openlocfilehash: 16d6f29235455ff30e115b7aff3425412bc7ba6a
ms.sourcegitcommit: 32a575bf4adccc901f00e264f92b759ced633379
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/04/2019
ms.locfileid: "74802261"
---
# <a name="controlling-resource-consumption-and-improving-performance"></a><span data-ttu-id="2f69c-102">Kontrollieren des Ressourcenverbrauchs und Verbessern der Leistung</span><span class="sxs-lookup"><span data-stu-id="2f69c-102">Controlling Resource Consumption and Improving Performance</span></span>
<span data-ttu-id="2f69c-103">In diesem Thema werden verschiedene Eigenschaften in verschiedenen Bereichen der Windows Communication Foundation (WCF)-Architektur beschrieben, die zum Steuern des Ressourcenverbrauchs und beeinflussen der Leistungsmetriken verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="2f69c-103">This topic describes various properties in different areas of the Windows Communication Foundation (WCF) architecture that work to control resource consumption and affect performance metrics.</span></span>

## <a name="properties-that-constrain-resource-consumption-in-wcf"></a><span data-ttu-id="2f69c-104">Eigenschaften, die den Ressourcenverbrauch in WCF einschränken</span><span class="sxs-lookup"><span data-stu-id="2f69c-104">Properties that Constrain Resource Consumption in WCF</span></span>
 <span data-ttu-id="2f69c-105">Windows Communication Foundation (WCF) wendet Einschränkungen für bestimmte Arten von Prozessen entweder zu Sicherheits-oder Leistungs Zwecken an.</span><span class="sxs-lookup"><span data-stu-id="2f69c-105">Windows Communication Foundation (WCF) applies constraints on certain types of processes for either security or performance purposes.</span></span> <span data-ttu-id="2f69c-106">Diese Einschränkungen treten in zwei Hauptformen auf, jeweils als Kontingente und Drosselungen.</span><span class="sxs-lookup"><span data-stu-id="2f69c-106">These constraints come in two main forms, either quotas and throttles.</span></span> <span data-ttu-id="2f69c-107">*Kontingente* sind Grenzwerte, die zu einem bestimmten Zeitpunkt im System eine unmittelbare Ausnahme ausgelöst haben, wenn erreicht oder überschritten wird.</span><span class="sxs-lookup"><span data-stu-id="2f69c-107">*Quotas* are limits that when reached or exceeded trigger an immediate exception at some point in the system.</span></span> <span data-ttu-id="2f69c-108">*Drosselungen* sind Limits, die nicht sofort bewirken, dass eine Ausnahme ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="2f69c-108">*Throttles* are limits that do not immediately cause an exception to be thrown.</span></span> <span data-ttu-id="2f69c-109">Stattdessen wird beim Erreichen einer Drosselungsbeschränkung der Prozess fortgesetzt, jedoch innerhalb der durch den Drosselungswert festgelegten Grenzen.</span><span class="sxs-lookup"><span data-stu-id="2f69c-109">Instead, when a throttle limit is reached, processing continues but within the limits set by that throttle value.</span></span> <span data-ttu-id="2f69c-110">Diese eingeschränkte Verarbeitung löst möglicherweise an anderer Stelle eine Ausnahme aus, dies hängt jedoch von der jeweiligen Anwendung ab.</span><span class="sxs-lookup"><span data-stu-id="2f69c-110">This limited processing might trigger an exception elsewhere, but this depends upon the application.</span></span>

 <span data-ttu-id="2f69c-111">Zusätzlich zu der Unterscheidung zwischen Kontingenten und Drosselungen befinden sich einige einschränkende Eigenschaften auf der Serialisierungsebene, auf der Transportebene und auf der Anwendungsebene.</span><span class="sxs-lookup"><span data-stu-id="2f69c-111">In addition to the distinction between quotas and throttles, some constraining properties are located at the serialization level, some at the transport level, and some at the application level.</span></span> <span data-ttu-id="2f69c-112">Beispielsweise wird das Kontingent <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>, das von allen vom System bereitgestellten Transportbindungselementen implementiert wird, standardmäßig auf 65.536 Byte festgelegt, um böswillige Clients daran zu hindern, Denial-of-Service-Angriffe gegen einen bestimmten Dienst zu starten und dadurch einen überhöhten Speicherbedarf zu verursachen.</span><span class="sxs-lookup"><span data-stu-id="2f69c-112">For example, the quota <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>, which is implemented by all system-supplied transport binding elements, is set to 65,536 bytes by default to hinder malicious clients from engaging in denial-of-service attacks against a service by causing excessive memory consumption.</span></span> <span data-ttu-id="2f69c-113">(I. d. R. können Sie die Leistung erhöhen, indem Sie diesen Wert herabsetzen.)</span><span class="sxs-lookup"><span data-stu-id="2f69c-113">(Typically, you can increase performance by lowering this value.)</span></span>

 <span data-ttu-id="2f69c-114">Ein Beispiel für ein Serialisierungskontingent ist die <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType>-Eigenschaft, die die maximale Anzahl an Objekten angibt, die das Serialisierungsprogramm in einem einzigen <xref:System.Runtime.Serialization.DataContractSerializer.ReadObject%2A>-Methodenaufruf serialisiert oder deserialisiert.</span><span class="sxs-lookup"><span data-stu-id="2f69c-114">An example of a serialization quota is the <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property, which specifies the maximum number of objects that the serializer serializes or deserializes in a single <xref:System.Runtime.Serialization.DataContractSerializer.ReadObject%2A> method call.</span></span> <span data-ttu-id="2f69c-115">Ein Beispiel für eine Drosselung auf Anwendungsebene ist die <xref:System.ServiceModel.Dispatcher.ServiceThrottle.MaxConcurrentSessions%2A?displayProperty=nameWithType>-Eigenschaft, die standardmäßig die Anzahl der gleichzeitigen sitzungsbasierten Kanalverbindungen auf "10" beschränkt.</span><span class="sxs-lookup"><span data-stu-id="2f69c-115">An example of an application-level throttle is the <xref:System.ServiceModel.Dispatcher.ServiceThrottle.MaxConcurrentSessions%2A?displayProperty=nameWithType> property, which by default restricts the number of concurrent sessionful channel connections to 10.</span></span> <span data-ttu-id="2f69c-116">(Anders als bei den Kontingenten setzt die Anwendung die Verarbeitung fort, wenn dieser Drosselungswert erreicht ist, jedoch akzeptiert sie keine neuen sitzungsbasierten Kanäle, was bedeutet, dass neue Clients erst dann eine Verbindung herstellen können, wenn einer der anderen sitzungsbasierten Kanäle beendet wurde.)</span><span class="sxs-lookup"><span data-stu-id="2f69c-116">(Unlike the quotas, if this throttle value is reached, the application continues processing but accepts no new sessionful channels, which means that new clients cannot connect until one of the other sessionful channels is ended.)</span></span>

 <span data-ttu-id="2f69c-117">Diese Steuerelemente wurden dafür entwickelt, eine übliche Entschärfung gegen bestimmte Arten von Angriffen einzuleiten oder die Leistungsmetriken wie Speicherbeanspruchung, Startzeit usw. zu verbessern.</span><span class="sxs-lookup"><span data-stu-id="2f69c-117">These controls are designed to provide an out-of-the-box mitigation against certain types of attacks or to improve performance metrics such as memory footprint, start-up time, and so on.</span></span> <span data-ttu-id="2f69c-118">Jedoch können diese Steuerelemente, je nach Anwendung, auch eine Beeinträchtigung der Anwendungsleistung zur Folge haben oder dazu führen, dass die Anwendung gar nicht mehr funktioniert.</span><span class="sxs-lookup"><span data-stu-id="2f69c-118">However, depending on the application, these controls can impede service application performance or prevent the application from working at all.</span></span> <span data-ttu-id="2f69c-119">Zum Beispiel kann eine Anwendung, die für das Videostreaming entworfen wurde, die standardmäßige <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>-Eigenschaft leicht überschreiten.</span><span class="sxs-lookup"><span data-stu-id="2f69c-119">For example, an application designed to stream video can easily exceed the default <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="2f69c-120">Dieses Thema bietet einen Überblick über die verschiedenen Steuerelemente, die auf allen Ebenen von WCF auf Anwendungen angewendet werden, und beschreibt verschiedene Möglichkeiten, weitere Informationen dazu zu erhalten, ob eine Einstellung Ihre Anwendung behindert und wie verschiedene Probleme behoben werden können.</span><span class="sxs-lookup"><span data-stu-id="2f69c-120">This topic provides an overview of the various controls applied to applications at all levels of WCF, describes various ways to obtain more information about whether a setting is hindering your application, and describes ways to correct various problems.</span></span> <span data-ttu-id="2f69c-121">Die meisten Drosselungen und einige Kontingente sind auf der Anwendungsebene verfügbar, auch wenn die Basiseigenschaft eine Serialisierungs- oder Transportbeschränkung ist.</span><span class="sxs-lookup"><span data-stu-id="2f69c-121">Most throttles and some quotas are available at the application level, even when the base property is a serialization or transport constraint.</span></span> <span data-ttu-id="2f69c-122">So können Sie z. B. die <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType>-Eigenschaft mithilfe der <xref:System.ServiceModel.ServiceBehaviorAttribute.MaxItemsInObjectGraph%2A?displayProperty=nameWithType>-Eigenschaft der Dienstklasse festlegen.</span><span class="sxs-lookup"><span data-stu-id="2f69c-122">For example, you can set the <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property using the <xref:System.ServiceModel.ServiceBehaviorAttribute.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property on the service class.</span></span>

> [!NOTE]
> <span data-ttu-id="2f69c-123">Wenn Sie ein bestimmtes Problem haben, lesen Sie zunächst den [Schnellstart](wcf-troubleshooting-quickstart.md) für die WCF-Problembehandlung, um zu sehen, ob Ihr Problem (und eine Lösung) hier aufgeführt ist.</span><span class="sxs-lookup"><span data-stu-id="2f69c-123">If you have a particular problem, you should first read the [WCF Troubleshooting Quickstart](wcf-troubleshooting-quickstart.md) to see whether your problem (and a solution) is listed there.</span></span>

 <span data-ttu-id="2f69c-124">Eigenschaften, die Serialisierungsprozesse einschränken, werden unter [Sicherheitsüberlegungen für Daten](./feature-details/security-considerations-for-data.md)aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="2f69c-124">Properties that restrict serialization processes are listed in [Security Considerations for Data](./feature-details/security-considerations-for-data.md).</span></span> <span data-ttu-id="2f69c-125">Eigenschaften, die den Verbrauch von Ressourcen einschränken, die sich auf Transporte beziehen, werden unter [Transport Kontingente](./feature-details/transport-quotas.md)aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="2f69c-125">Properties that restrict the consumption of resources related to transports are listed in [Transport Quotas](./feature-details/transport-quotas.md).</span></span> <span data-ttu-id="2f69c-126">Eigenschaften, die den Verbrauch von Ressourcen auf der Anwendungsschicht einschränken, gehören zur <xref:System.ServiceModel.Dispatcher.ServiceThrottle>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="2f69c-126">Properties that restrict the consumption of resources at the application layer are the members of the <xref:System.ServiceModel.Dispatcher.ServiceThrottle> class.</span></span>

## <a name="detecting-application-and-performance-issues-related-to-quota-settings"></a><span data-ttu-id="2f69c-127">Erkennen von Anwendungs- und Leistungsproblemen in Zusammenhang mit den Kontingenteinstellungen</span><span class="sxs-lookup"><span data-stu-id="2f69c-127">Detecting Application and Performance Issues Related to Quota Settings</span></span>
 <span data-ttu-id="2f69c-128">Die Standardeinstellungen für die vorangehenden Werte wurden ausgewählt, um eine grundlegende Funktionalität für viele verschiedene Anwendungstypen zu ermöglichen und gleichzeitig einen Schutz vor häufig auftretenden Sicherheitsproblemen zu bieten.</span><span class="sxs-lookup"><span data-stu-id="2f69c-128">The defaults of the preceding values have been chosen to enable basic application functionality across a wide range of application types while providing basic protection against common security issues.</span></span> <span data-ttu-id="2f69c-129">Jedoch überschreiten die verschiedenen Anwendungs-Designs möglicherweise eine oder mehrere Drosselungseinstellungen, obwohl die Anwendung ansonsten sicher ist und wie gewünscht funktionieren würde.</span><span class="sxs-lookup"><span data-stu-id="2f69c-129">However, different application designs might exceed one or more throttle settings although the application otherwise is secure and would work as designed.</span></span> <span data-ttu-id="2f69c-130">In einem solchen Fall müssen Sie feststellen, welche Drosselungswerte auf welcher Ebene überschritten werden. Legen Sie anschließend angemessene Maßnahmen zur Erhöhung des Anwendungsdurchsatzes fest.</span><span class="sxs-lookup"><span data-stu-id="2f69c-130">In these cases, you must identify which throttle values are being exceeded and at what level, and decide on the appropriate course of action to increase application throughput.</span></span>

 <span data-ttu-id="2f69c-131">In der Regel wird beim Schreiben und Debuggen der Anwendung die <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType>-Eigenschaft in der Konfigurationsdatei oder programmgesteuert auf `true` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="2f69c-131">Typically, when writing the application and debugging it, you set the <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> property to `true` in the configuration file or programmatically.</span></span> <span data-ttu-id="2f69c-132">Dies weist WCF an, Dienst Ausnahme Stapel-Ablauf Verfolgungen zur Anzeige an die Client Anwendung zurückzugeben.</span><span class="sxs-lookup"><span data-stu-id="2f69c-132">This instructs WCF to return service exception stack traces to the client application for viewing.</span></span> <span data-ttu-id="2f69c-133">Diese Funktion meldet die meisten Ausnahmen auf Anwendungsebene so, dass angezeigt wird, welche Kontingenteinstellungen möglicherweise beteiligt sind, falls das Problem hierdurch verursacht wurde.</span><span class="sxs-lookup"><span data-stu-id="2f69c-133">This feature reports most application-level exceptions in such a way as to display which quota settings might be involved, if that is the problem.</span></span>

 <span data-ttu-id="2f69c-134">Einige Ausnahmen treten während der Laufzeit außerhalb der Sichtbarkeit der Anwendungsschicht auf und werden nicht mithilfe dieses Mechanismus zurückgegeben. Möglicherweise werden sie auch nicht von einer benutzerdefinierten <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType>-Implementierung gehandhabt.</span><span class="sxs-lookup"><span data-stu-id="2f69c-134">Some exceptions happen at run time below the visibility of the application layer and are not returned using this mechanism, and they might not be handled by a custom <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType> implementation.</span></span> <span data-ttu-id="2f69c-135">Wenn Sie in einer Entwicklungsumgebung wie Microsoft Visual Studio arbeiten, werden die meisten dieser Ausnahmen automatisch angezeigt.</span><span class="sxs-lookup"><span data-stu-id="2f69c-135">If you are in a development environment like Microsoft Visual Studio, most of these exceptions are displayed automatically.</span></span> <span data-ttu-id="2f69c-136">Einige Ausnahmen können jedoch von den Einstellungen der Entwicklungsumgebung wie [nur eigenen Code](/visualstudio/debugger/just-my-code) Visual Studio maskiert werden.</span><span class="sxs-lookup"><span data-stu-id="2f69c-136">However, some exceptions can be masked by development environment settings such as [Just My Code](/visualstudio/debugger/just-my-code) Visual Studio.</span></span>

 <span data-ttu-id="2f69c-137">Unabhängig von den Funktionen der Entwicklungsumgebung können Sie die Funktionen der WCF-Ablauf Verfolgung und der Nachrichten Protokollierung verwenden, um alle Ausnahmen zu Debuggen und die Leistung Ihrer Anwendungen zu optimieren.</span><span class="sxs-lookup"><span data-stu-id="2f69c-137">Regardless of the capabilities of your development environment, you can use capabilities of WCF tracing and message logging to debug all exceptions and tune the performance of your applications.</span></span> <span data-ttu-id="2f69c-138">Weitere Informationen finden Sie unter [Verwenden der Ablauf Verfolgung zum Beheben von Problemen mit Ihrer Anwendung](./diagnostics/tracing/using-tracing-to-troubleshoot-your-application.md).</span><span class="sxs-lookup"><span data-stu-id="2f69c-138">For more information, see [Using Tracing to Troubleshoot Your Application](./diagnostics/tracing/using-tracing-to-troubleshoot-your-application.md).</span></span>

## <a name="performance-issues-and-xmlserializer"></a><span data-ttu-id="2f69c-139">Leistungsprobleme und XmlSerializer</span><span class="sxs-lookup"><span data-stu-id="2f69c-139">Performance Issues and XmlSerializer</span></span>
 <span data-ttu-id="2f69c-140">Dienste und Clientanwendungen, die Datentypen verwenden, die mit dem <xref:System.Xml.Serialization.XmlSerializer> serialisiert werden können, generieren und kompilieren für diese Datentypen während der Laufzeit Code, was zu einem verlangsamten Start führen kann.</span><span class="sxs-lookup"><span data-stu-id="2f69c-140">Services and client applications that use data types that are serializable using the <xref:System.Xml.Serialization.XmlSerializer> generate and compile serialization code for those data types at run time, which can result in slow start-up performance.</span></span>

> [!NOTE]
> <span data-ttu-id="2f69c-141">Vorab generierter Serialisierungscode kann nur in Clientanwendungen und nicht in Diensten verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="2f69c-141">Pre-generated serialization code can be used only in client applications and not in services.</span></span>

 <span data-ttu-id="2f69c-142">Das [Service Model Metadata Utility-Tool (Svcutil. exe)](servicemodel-metadata-utility-tool-svcutil-exe.md) kann die Startleistung für diese Anwendungen verbessern, indem der erforderliche Serialisierungscode aus den kompilierten Assemblys für die Anwendung erzeugt wird.</span><span class="sxs-lookup"><span data-stu-id="2f69c-142">The [ServiceModel Metadata Utility Tool (Svcutil.exe)](servicemodel-metadata-utility-tool-svcutil-exe.md) can improve start-up performance for these applications by generating the necessary serialization code from the compiled assemblies for the application.</span></span> <span data-ttu-id="2f69c-143">Weitere Informationen finden Sie unter Vorgehens [Weise: verbessern der Startzeit von WCF-Client Anwendungen mit dem XmlSerializer](./feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md).</span><span class="sxs-lookup"><span data-stu-id="2f69c-143">For more information, see [How to: Improve the Startup Time of WCF Client Applications using the XmlSerializer](./feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md).</span></span>

## <a name="performance-issues-when-hosting-wcf-services-under-aspnet"></a><span data-ttu-id="2f69c-144">Leistungsprobleme beim Hosten von WCF-Diensten unter ASP.NET</span><span class="sxs-lookup"><span data-stu-id="2f69c-144">Performance Issues When Hosting WCF Services Under ASP.NET</span></span>

<span data-ttu-id="2f69c-145">Wird ein WCF-Dienst unter IIS und ASP.NET gehostet, können sich die Konfigurationseinstellungen von IIS und ASP.NET auf den Durchsatz und die Speicherbeanspruchung des WCF-Diensts auswirken.</span><span class="sxs-lookup"><span data-stu-id="2f69c-145">When a WCF service is hosted under IIS and ASP.NET, the configuration settings of IIS and ASP.NET can affect the throughput and memory footprint of the WCF service.</span></span>  <span data-ttu-id="2f69c-146">Weitere Informationen zur ASP.net-Leistung finden Sie unter [verbessern der Leistung von ASP.net](https://docs.microsoft.com/previous-versions/msp-n-p/ff647787(v=pandp.10)).</span><span class="sxs-lookup"><span data-stu-id="2f69c-146">For more information about ASP.NET performance, see [Improving ASP.NET Performance](https://docs.microsoft.com/previous-versions/msp-n-p/ff647787(v=pandp.10)).</span></span> <span data-ttu-id="2f69c-147">Eine Einstellung, durch die sich unbeabsichtigte Folgen ergeben können, ist <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A>. Hierbei handelt es sich um eine Eigenschaft der <xref:System.Web.Configuration.ProcessModelSection>.</span><span class="sxs-lookup"><span data-stu-id="2f69c-147">One setting that might have unintended consequences is <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A>, which is a property of the <xref:System.Web.Configuration.ProcessModelSection>.</span></span> <span data-ttu-id="2f69c-148">Verfügt die Anwendung über eine feste oder über eine geringe Anzahl von Clients, lässt sich durch Festlegen von <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A> auf "2" bei einem Computer mit mehreren Prozessoren, dessen CPU-Auslastung sich nahe bei 100 Prozent bewegt, möglicherweise ein Leistungsschub beim Durchsatz erzielen.</span><span class="sxs-lookup"><span data-stu-id="2f69c-148">If your application has a fixed or small number of clients, setting <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A> to 2 might provide a throughput boost on a multiprocessor machine that has a CPU utilization close to 100%.</span></span> <span data-ttu-id="2f69c-149">Dieser Leistungszuwachs bringt jedoch auch einen Nachteil mit sich, da sich dadurch auch eine erhöhte Speicherauslastung ergibt, was zu einer geringeren Skalierbarkeit führt.</span><span class="sxs-lookup"><span data-stu-id="2f69c-149">This increase in performance comes with a cost: it will also cause an increase in memory usage, which could reduce scalability.</span></span>

## <a name="see-also"></a><span data-ttu-id="2f69c-150">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="2f69c-150">See also</span></span>

- [<span data-ttu-id="2f69c-151">Verwaltung und Diagnose</span><span class="sxs-lookup"><span data-stu-id="2f69c-151">Administration and Diagnostics</span></span>](./diagnostics/index.md)
- [<span data-ttu-id="2f69c-152">Umfangreiche Daten und Streaming</span><span class="sxs-lookup"><span data-stu-id="2f69c-152">Large Data and Streaming</span></span>](./feature-details/large-data-and-streaming.md)
