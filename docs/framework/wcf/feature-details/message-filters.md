---
title: Nachrichtenfilter
ms.date: 03/30/2017
helpviewer_keywords:
- routing [WCF], message filters
ms.assetid: cb33ba49-8b1f-4099-8acb-240404a46d9a
ms.openlocfilehash: a953dea9224d75907c593d87f06a0b0888f0af2d
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/12/2020
ms.locfileid: "79184658"
---
# <a name="message-filters"></a><span data-ttu-id="367f9-102">Nachrichtenfilter</span><span class="sxs-lookup"><span data-stu-id="367f9-102">Message Filters</span></span>
<span data-ttu-id="367f9-103">Um das inhaltsbasierte Routing zu implementieren, verwendet der Routingdienst <xref:System.ServiceModel.Dispatcher.MessageFilter>-Implementierungen, die bestimmte Abschnitte einer Nachricht überprüfen, z. B. Adresse, Endpunktname oder eine bestimmte XPath-Anweisung.</span><span class="sxs-lookup"><span data-stu-id="367f9-103">To implement content-based routing, the Routing Service uses <xref:System.ServiceModel.Dispatcher.MessageFilter> implementations that inspect specific sections of a message, such as the address, endpoint name, or a specific XPath statement.</span></span> <span data-ttu-id="367f9-104">Wenn keiner der von [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)] bereitgestellten Nachrichtenfilter Ihren Anforderungen entspricht, können Sie einen benutzerdefinierten Filter erstellen, indem Sie eine neue Implementierung der <xref:System.ServiceModel.Dispatcher.MessageFilter>-Basisklasse erstellen.</span><span class="sxs-lookup"><span data-stu-id="367f9-104">If none of the message filters provided with [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)] meet your needs, you can create a custom filter by creating a new implementation of the base <xref:System.ServiceModel.Dispatcher.MessageFilter> class.</span></span>  
  
 <span data-ttu-id="367f9-105">Beim Konfigurieren des Routingdienstes müssen Sie<xref:System.ServiceModel.Routing.Configuration.FilterElement> Filterelemente (Objekte) definieren, die den Typ von **MessageFilter** und alle unterstützenden Daten beschreiben, die zum Erstellen des Filters erforderlich sind, z. B. bestimmte Zeichenfolgenwerte, nach denen in der Nachricht gesucht werden soll.</span><span class="sxs-lookup"><span data-stu-id="367f9-105">When configuring the Routing Service, you must define filter elements (<xref:System.ServiceModel.Routing.Configuration.FilterElement> objects) that describe the type of **MessageFilter** and any supporting data required to create the filter, such as specific string values to search for within the message.</span></span> <span data-ttu-id="367f9-106">Beachten Sie, dass beim Erstellen der Filterelemente nur die einzelnen Nachrichtenfilter definiert werden. Um die Filter zum Auswerten und Weiterleiten von Nachrichten zu verwenden, müssen Sie zusätzlich eine Filtertabelle definieren (<xref:System.ServiceModel.Routing.Configuration.FilterTableEntryCollection>).</span><span class="sxs-lookup"><span data-stu-id="367f9-106">Note that creating the filter elements only defines the individual message filters; to use the filters to evaluate and route messages you must also define a filter table (<xref:System.ServiceModel.Routing.Configuration.FilterTableEntryCollection>).</span></span>  
  
 <span data-ttu-id="367f9-107">Jeder Eintrag in der Filtertabelle verweist auf ein Filterelement und gibt den Clientendpunkt an, an den eine Nachricht weitergeleitet wird, wenn sich für die Nachricht eine Übereinstimmung mit dem Filter ergibt.</span><span class="sxs-lookup"><span data-stu-id="367f9-107">Each entry in the filter table references a filter element and specifies the client endpoint that a message will be routed to if the message matches the filter.</span></span> <span data-ttu-id="367f9-108">Die Filtertabelleneinträge ermöglichen Ihnen auch das Angeben einer Auflistung von Sicherungsendpunkten (<xref:System.ServiceModel.Routing.Configuration.BackupEndpointCollection>). Damit wird eine Liste von Endpunkten definiert, an die die Nachricht im Falle eines Übertragungsfehlers gesendet wird, sofern das Senden an den primären Endpunkt erfolgt.</span><span class="sxs-lookup"><span data-stu-id="367f9-108">The filter table entries also allow you to specify a collection of backup endpoints (<xref:System.ServiceModel.Routing.Configuration.BackupEndpointCollection>), which defines a list of endpoints that the message will be transmitted to in the event of a transmission failure when sending to the primary endpoint.</span></span> <span data-ttu-id="367f9-109">Diese Endpunkte werden in der angegebenen Reihefolge abgearbeitet, bis ein Sendevorgang erfolgreich ist.</span><span class="sxs-lookup"><span data-stu-id="367f9-109">These endpoints will be tried in the order specified until one succeeds.</span></span>  
  
## <a name="message-filters"></a><span data-ttu-id="367f9-110">Nachrichtenfilter</span><span class="sxs-lookup"><span data-stu-id="367f9-110">Message Filters</span></span>  
 <span data-ttu-id="367f9-111">Die vom Routingdienst verwendeten Nachrichtenfilter stellen allgemeine Funktionen zur Auswahl von Nachrichten bereit. Beispiele hierfür sind das Auswerten des Namens eines Endpunkts, an den eine Nachricht gesendet wurde, die SOAP-Aktion oder die Adresse bzw. das Adresspräfix, an die bzw. das die Nachricht gesendet wurde.</span><span class="sxs-lookup"><span data-stu-id="367f9-111">The message filters used by the Routing Service provide common message selection functionality, such as evaluating the name of the endpoint that a message was sent to, the SOAP action, or the address or address prefix that the message was sent to.</span></span> <span data-ttu-id="367f9-112">Filter können auch mit einer `AND`-Bedingung verknüpft werden, sodass Nachrichten nur dann an einen Endpunkt weitergeleitet werden, wenn die Nachricht mit beiden Filtern zu Übereinstimmungen führt.</span><span class="sxs-lookup"><span data-stu-id="367f9-112">Filters can also be joined with an `AND` condition, so that messages will only be routed to an endpoint if the message matches both filters.</span></span> <span data-ttu-id="367f9-113">Sie können benutzerdefinierte Filter auch erstellen, indem Sie eine eigene Implementierung von <xref:System.ServiceModel.Dispatcher.MessageFilter> erstellen.</span><span class="sxs-lookup"><span data-stu-id="367f9-113">You can also create custom filters by creating your own implementation of <xref:System.ServiceModel.Dispatcher.MessageFilter>.</span></span>  
  
 <span data-ttu-id="367f9-114">In der folgenden Tabelle sind der jeweils vom Routingdienst verwendete <xref:System.ServiceModel.Routing.Configuration.FilterType> und die Klasse aufgeführt, die den spezifischen Nachrichtenfilter implementiert. Außerdem ist der erforderliche <xref:System.ServiceModel.Routing.Configuration.FilterElement.FilterData%2A>-Parameter angegeben.</span><span class="sxs-lookup"><span data-stu-id="367f9-114">The following table lists the <xref:System.ServiceModel.Routing.Configuration.FilterType> used by the Routing Service, the class that implements the specific message filter, and the required <xref:System.ServiceModel.Routing.Configuration.FilterElement.FilterData%2A> parameters.</span></span>  
  
|<span data-ttu-id="367f9-115">Filtertyp</span><span class="sxs-lookup"><span data-stu-id="367f9-115">Filter  Type</span></span>|<span data-ttu-id="367f9-116">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="367f9-116">Description</span></span>|<span data-ttu-id="367f9-117">Bedeutung der Filterdaten</span><span class="sxs-lookup"><span data-stu-id="367f9-117">Filter Data Meaning</span></span>|<span data-ttu-id="367f9-118">Beispielfilter</span><span class="sxs-lookup"><span data-stu-id="367f9-118">Example Filter</span></span>|  
|------------------|-----------------|-------------------------|--------------------|  
|<span data-ttu-id="367f9-119">Aktion</span><span class="sxs-lookup"><span data-stu-id="367f9-119">Action</span></span>|<span data-ttu-id="367f9-120">Verwendet die <xref:System.ServiceModel.Dispatcher.ActionMessageFilter>-Klasse, um eine Übereinstimmung für Nachrichten zu erzielen, die eine bestimmte Aktion enthalten.</span><span class="sxs-lookup"><span data-stu-id="367f9-120">Uses the <xref:System.ServiceModel.Dispatcher.ActionMessageFilter> class to match messages containing a specific action.</span></span>|<span data-ttu-id="367f9-121">Die Aktion, nach der gefiltert werden soll.</span><span class="sxs-lookup"><span data-stu-id="367f9-121">The action to filter upon.</span></span>|<span data-ttu-id="367f9-122">\<filter name="action1" filterType="Action" filterData="http://namespace/contract/operation" /></span><span class="sxs-lookup"><span data-stu-id="367f9-122">\<filter name="action1" filterType="Action" filterData="http://namespace/contract/operation" /></span></span>|  
|<span data-ttu-id="367f9-123">EndpointAddress</span><span class="sxs-lookup"><span data-stu-id="367f9-123">EndpointAddress</span></span>|<span data-ttu-id="367f9-124">Verwendet <xref:System.ServiceModel.Dispatcher.EndpointAddressMessageFilter> die Klasse, mit, <xref:System.ServiceModel.Dispatcher.EndpointAddressMessageFilter.IncludeHostNameInComparison%2A>  ==  `true` um Nachrichten abzugleichen, die eine bestimmte Adresse enthalten.</span><span class="sxs-lookup"><span data-stu-id="367f9-124">Uses the <xref:System.ServiceModel.Dispatcher.EndpointAddressMessageFilter> class, with <xref:System.ServiceModel.Dispatcher.EndpointAddressMessageFilter.IncludeHostNameInComparison%2A> == `true` to match messages containing a specific address.</span></span>|<span data-ttu-id="367f9-125">Die Adresse, nach der gefiltert werden soll (im To-Header).</span><span class="sxs-lookup"><span data-stu-id="367f9-125">The address to filter upon (in the To header).</span></span>|<span data-ttu-id="367f9-126">\<filter name="address1" filterType="EndpointAddress" filterData="http://host/vdir/s.svc/b" /></span><span class="sxs-lookup"><span data-stu-id="367f9-126">\<filter name="address1" filterType="EndpointAddress" filterData="http://host/vdir/s.svc/b"  /></span></span>|  
|<span data-ttu-id="367f9-127">EndpointAddressPrefix</span><span class="sxs-lookup"><span data-stu-id="367f9-127">EndpointAddressPrefix</span></span>|<span data-ttu-id="367f9-128">Verwendet <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter> die Klasse, mit, <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter.IncludeHostNameInComparison%2A>  ==  `true` um Nachrichten abzugleichen, die ein bestimmtes Adresspräfix enthalten.</span><span class="sxs-lookup"><span data-stu-id="367f9-128">Uses the <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter> class, with <xref:System.ServiceModel.Dispatcher.PrefixEndpointAddressMessageFilter.IncludeHostNameInComparison%2A> == `true` to match messages containing a specific address prefix.</span></span>|<span data-ttu-id="367f9-129">Die Adresse, nach der unter Verwendung der längsten Präfixübereinstimmung gefiltert werden soll.</span><span class="sxs-lookup"><span data-stu-id="367f9-129">The address to filter upon using longest prefix matching.</span></span>|<span data-ttu-id="367f9-130">\<filter name="prefix1" filterType="EndpointAddressPrefix" filterData="http://host/" /></span><span class="sxs-lookup"><span data-stu-id="367f9-130">\<filter name="prefix1" filterType="EndpointAddressPrefix" filterData="http://host/" /></span></span>|  
|<span data-ttu-id="367f9-131">And</span><span class="sxs-lookup"><span data-stu-id="367f9-131">And</span></span>|<span data-ttu-id="367f9-132">Verwendet die <xref:System.ServiceModel.Dispatcher.StrictAndMessageFilter>-Klasse, die vor der Rückgabe immer beide Bedingungen auswertet.</span><span class="sxs-lookup"><span data-stu-id="367f9-132">Uses the <xref:System.ServiceModel.Dispatcher.StrictAndMessageFilter> class that always evaluates both conditions before returning.</span></span>|<span data-ttu-id="367f9-133">filterData wird nicht verwendet; stattdessen haben filter1 und filter2 die Namen der entsprechenden Nachrichtenfilter (auch in der Tabelle), die zusammen **UND**ed werden sollen.</span><span class="sxs-lookup"><span data-stu-id="367f9-133">filterData is not used; instead filter1 and filter2 have the names of the corresponding message filters (also in the table), which should be **AND**ed together.</span></span>|<span data-ttu-id="367f9-134">\<filter name="and1" filterType="And" filter1="address1" filter2="action1" /></span><span class="sxs-lookup"><span data-stu-id="367f9-134">\<filter name="and1" filterType="And" filter1="address1" filter2="action1" /></span></span>|  
|<span data-ttu-id="367f9-135">Benutzerdefiniert</span><span class="sxs-lookup"><span data-stu-id="367f9-135">Custom</span></span>|<span data-ttu-id="367f9-136">Ein benutzerdefinierter Typ, der die <xref:System.ServiceModel.Dispatcher.MessageFilter>-Klasse erweitert und über einen Konstruktor verfügt, der eine Zeichenfolge verwendet.</span><span class="sxs-lookup"><span data-stu-id="367f9-136">A user-defined type that extends the <xref:System.ServiceModel.Dispatcher.MessageFilter> class and has a constructor taking a string.</span></span>|<span data-ttu-id="367f9-137">Das customType-Attribut ist der vollqualifizierte Typname der zu erstellenden Klasse. "filterData" ist die Zeichenfolge, die beim Erstellen des Filters an den Konstruktor übergeben werden soll.</span><span class="sxs-lookup"><span data-stu-id="367f9-137">The customType attribute is the fully qualified type name of the class to create; filterData is the string to pass to the constructor when creating the filter.</span></span>|<span data-ttu-id="367f9-138">\<filter name="custom1" filterType="Custom" customType="CustomAssembly.CustomMsgFilter, CustomAssembly" filterData="Custom Data" /></span><span class="sxs-lookup"><span data-stu-id="367f9-138">\<filter name="custom1" filterType="Custom" customType="CustomAssembly.CustomMsgFilter, CustomAssembly" filterData="Custom Data" /></span></span>|  
|<span data-ttu-id="367f9-139">EndpointName</span><span class="sxs-lookup"><span data-stu-id="367f9-139">EndpointName</span></span>|<span data-ttu-id="367f9-140">Verwendet die <xref:System.ServiceModel.Dispatcher.EndpointNameMessageFilter>-Klasse, um für Nachrichten basierend auf dem Namen des Dienstendpunkts, an dem diese empfangen wurden, eine Übereinstimmung zu erzielen.</span><span class="sxs-lookup"><span data-stu-id="367f9-140">Uses the <xref:System.ServiceModel.Dispatcher.EndpointNameMessageFilter> class to match messages based on the name of the service endpoint they arrived on.</span></span>|<span data-ttu-id="367f9-141">Der Name des Dienstendpunkts, z. B. "serviceEndpoint1".</span><span class="sxs-lookup"><span data-stu-id="367f9-141">The name of the service endpoint, for example: "serviceEndpoint1".</span></span>  <span data-ttu-id="367f9-142">Hierbei sollte es sich um einen der Endpunkte handeln, die vom Routingdienst verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="367f9-142">This should be one of the endpoints exposed on the Routing Service.</span></span>|<span data-ttu-id="367f9-143">\<filter name="stock1" filterType="Endpoint" filterData="SvcEndpoint" /></span><span class="sxs-lookup"><span data-stu-id="367f9-143">\<filter name="stock1" filterType="Endpoint" filterData="SvcEndpoint" /></span></span>|  
|<span data-ttu-id="367f9-144">MatchAll</span><span class="sxs-lookup"><span data-stu-id="367f9-144">MatchAll</span></span>|<span data-ttu-id="367f9-145">Verwendet die <xref:System.ServiceModel.Dispatcher.MatchAllMessageFilter>-Klasse.</span><span class="sxs-lookup"><span data-stu-id="367f9-145">Uses the <xref:System.ServiceModel.Dispatcher.MatchAllMessageFilter> class.</span></span> <span data-ttu-id="367f9-146">Dieser Filter führt für alle eingehenden Nachrichten zu Übereinstimmungen.</span><span class="sxs-lookup"><span data-stu-id="367f9-146">This filter matches all arriving messages.</span></span>|<span data-ttu-id="367f9-147">"filterData" wird nicht verwendet.</span><span class="sxs-lookup"><span data-stu-id="367f9-147">filterData is not used.</span></span> <span data-ttu-id="367f9-148">Dieser Filter führt immer zu Übereinstimmungen mit allen Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="367f9-148">This filter will always match all messages.</span></span>|<span data-ttu-id="367f9-149">\<filter name="matchAll1" filterType="MatchAll" /></span><span class="sxs-lookup"><span data-stu-id="367f9-149">\<filter name="matchAll1" filterType="MatchAll" /></span></span>|  
|<span data-ttu-id="367f9-150">XPath</span><span class="sxs-lookup"><span data-stu-id="367f9-150">XPath</span></span>|<span data-ttu-id="367f9-151">Verwendet die <xref:System.ServiceModel.Dispatcher.XPathMessageFilter>-Klasse, um für bestimmte XPath-Abfragen in der Nachricht Übereinstimmungen zu ermitteln.</span><span class="sxs-lookup"><span data-stu-id="367f9-151">Uses the <xref:System.ServiceModel.Dispatcher.XPathMessageFilter> class to match specific XPath queries within the message.</span></span>|<span data-ttu-id="367f9-152">Die XPath-Abfrage, die beim Ermitteln von Übereinstimmungen für Nachrichten verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="367f9-152">The XPath query to use when matching messages.</span></span>|<span data-ttu-id="367f9-153">\<filter name="XPath1" filterType="XPath" filterData="/ns:element" /></span><span class="sxs-lookup"><span data-stu-id="367f9-153">\<filter name="XPath1" filterType="XPath" filterData="//ns:element" /></span></span>|  
  
 <span data-ttu-id="367f9-154">Im folgenden Beispiel werden Filtereinträge definiert, die die Nachrichtenfilter „XPath“, „EndpointName“ und „PrefixEndpointAddress“ verwenden.</span><span class="sxs-lookup"><span data-stu-id="367f9-154">The following example defines filter entries that use the XPath, EndpointName, and PrefixEndpointAddress message filters.</span></span> <span data-ttu-id="367f9-155">Dieses Beispiel veranschaulicht außerdem die Verwendung eines benutzerdefinierten Filters für die Einträge RoundRobinFilter1 und RoundRobinFilter2.</span><span class="sxs-lookup"><span data-stu-id="367f9-155">This example also demonstrates using a custom filter for the RoundRobinFilter1 and RoundRobinFilter2 entries.</span></span>  
  
```xml  
<filters>  
     <filter name="XPathFilter" filterType="XPath"
             filterData="/s12:Envelope/s12:Header/custom:RoundingCalculator = 1"/>  
     <filter name="EndpointNameFilter" filterType="EndpointName"
             filterData="calculatorEndpoint"/>  
     <filter name="PrefixAddressFilter" filterType="PrefixEndpointAddress"
             filterData="http://localhost/routingservice/router/rounding/"/>  
     <filter name="RoundRobinFilter1" filterType="Custom"
             customType="RoutingServiceFilters.RoundRobinMessageFilter,
             RoutingService" filterData="group1"/>  
     <filter name="RoundRobinFilter2" filterType="Custom"
             customType="RoutingServiceFilters.RoundRobinMessageFilter,
             RoutingService" filterData="group1"/>  
</filters>  
```  
  
> [!NOTE]
> <span data-ttu-id="367f9-156">Wenn Sie einfach nur einen Filter definieren, führt dies noch nicht dazu, dass Nachrichten mit diesem Filter ausgewertet werden.</span><span class="sxs-lookup"><span data-stu-id="367f9-156">Simply defining a filter does not cause messages to be evaluated against the filter.</span></span> <span data-ttu-id="367f9-157">Sie müssen den Filter einer Filtertabelle hinzufügen, die dann dem Dienstendpunkt zugeordnet wird, der vom Routingdienst verfügbar gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="367f9-157">The filter must be added to a filter table, which is then associated with the service endpoint exposed by the Routing Service.</span></span>  
  
### <a name="namespace-table"></a><span data-ttu-id="367f9-158">Namespacetabelle</span><span class="sxs-lookup"><span data-stu-id="367f9-158">Namespace Table</span></span>  
 <span data-ttu-id="367f9-159">Bei einem XPath-Filter können die Filterdaten, die die XPath-Abfrage enthalten, aufgrund der Verwendung von Namespaces sehr umfangreich werden.</span><span class="sxs-lookup"><span data-stu-id="367f9-159">When using an XPath filter, the filter data that contains the XPath query can become extremely large due to the use of namespaces.</span></span> <span data-ttu-id="367f9-160">Um dieses Problem zu umgehen, ermöglicht der Routingdienst das Definieren Ihrer eigenen Namespacepräfixe mithilfe der Namespacetabelle.</span><span class="sxs-lookup"><span data-stu-id="367f9-160">To alleviate this problem the Routing Service provides the ability to define your own namespace prefixes by using the namespace table.</span></span>  
  
 <span data-ttu-id="367f9-161">Die Namespacetabelle ist eine Auflistung von <xref:System.ServiceModel.Routing.Configuration.NamespaceElement>-Objekten, in der die Namespacepräfixe für allgemeine Namespaces definiert sind, die in einem XPath verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="367f9-161">The namespace table is a collection of <xref:System.ServiceModel.Routing.Configuration.NamespaceElement> objects that defines the namespace prefixes for common namespaces that can be used in an XPath.</span></span> <span data-ttu-id="367f9-162">Unten sind die standardmäßigen Namespaces und Namespacepräfixe aufgeführt, die in der Namespacetabelle enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="367f9-162">The following are the default namespaces and namespace prefixes that are contained in the namespace table.</span></span>  
  
|<span data-ttu-id="367f9-163">Präfix</span><span class="sxs-lookup"><span data-stu-id="367f9-163">Prefix</span></span>|<span data-ttu-id="367f9-164">Namespace</span><span class="sxs-lookup"><span data-stu-id="367f9-164">Namespace</span></span>|  
|------------|---------------|  
|<span data-ttu-id="367f9-165">s11</span><span class="sxs-lookup"><span data-stu-id="367f9-165">s11</span></span>|`http://schemas.xmlsoap.org/soap/envelope`|  
|<span data-ttu-id="367f9-166">s12</span><span class="sxs-lookup"><span data-stu-id="367f9-166">s12</span></span>|`http://www.w3.org/2003/05/soap-envelope`|  
|<span data-ttu-id="367f9-167">wsaAugust2004</span><span class="sxs-lookup"><span data-stu-id="367f9-167">wsaAugust2004</span></span>|`http://schemas.xmlsoap.org/ws/2004/08/addressing`|  
|<span data-ttu-id="367f9-168">wsa10</span><span class="sxs-lookup"><span data-stu-id="367f9-168">wsa10</span></span>|`http://www.w3.org/2005/08/addressing`|  
|<span data-ttu-id="367f9-169">sm</span><span class="sxs-lookup"><span data-stu-id="367f9-169">sm</span></span>|`http://schemas.microsoft.com/serviceModel/2004/05/xpathfunctions`|  
|<span data-ttu-id="367f9-170">tempuri</span><span class="sxs-lookup"><span data-stu-id="367f9-170">tempuri</span></span>|`http://tempuri.org`|  
|<span data-ttu-id="367f9-171">ser</span><span class="sxs-lookup"><span data-stu-id="367f9-171">ser</span></span>|`http://schemas.microsoft.com/2003/10/Serialization`|  
  
 <span data-ttu-id="367f9-172">Wenn Sie wissen, dass Sie in den XPath-Abfragen einen bestimmten Namespace verwenden, können Sie diesen der Namespacetabelle zusammen mit einem eindeutigen Namespacepräfix hinzufügen und das Präfix statt des vollständigen Namespaces in XPath-Abfragen verwenden.</span><span class="sxs-lookup"><span data-stu-id="367f9-172">When you know that you will be using a specific namespace in your XPath queries, you can add it to the namespace table along with a unique namespace prefix and use the prefix in any XPath query instead of the full namespace.</span></span> <span data-ttu-id="367f9-173">Im folgenden Beispiel wird ein Präfix "custom" `"http://my.custom.namespace"`für den Namespace definiert, das dann in der xPath-Abfrage in filterData verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="367f9-173">The following example defines a prefix of "custom" for the namespace `"http://my.custom.namespace"`, which is then used in the XPath query contained in filterData.</span></span>  
  
```xml  
<namespaceTable>  
     <add prefix="custom" namespace="http://my.custom.namespace/"/>  
</namespaceTable>  
<filters>  
     <filter name="XPathFilter" filterType="XPath" filterData="/s12:Envelope/s12:Header/custom:RoundingCalculator = 1"/>  
</filters>  
```  
  
## <a name="filter-tables"></a><span data-ttu-id="367f9-174">Filtertabellen</span><span class="sxs-lookup"><span data-stu-id="367f9-174">Filter Tables</span></span>  
 <span data-ttu-id="367f9-175">Während jedes Filterelement einen logischen Vergleich definiert, der auf eine Nachricht angewendet werden kann, stellt die Filtertabelle die Zuordnung zwischen dem Filterelement und dem Zielclientendpunkt bereit.</span><span class="sxs-lookup"><span data-stu-id="367f9-175">While each filter element defines a logical comparison that can be applied to a message, the filter table provides the association between the filter element and the destination client endpoint.</span></span> <span data-ttu-id="367f9-176">Bei einer Filtertabelle handelt es sich um eine benannte Auflistung von <xref:System.ServiceModel.Routing.Configuration.FilterTableEntryElement>-Objekten, die die Zuordnung zwischen einem Filter, einem primären Zielendpunkt und einer Liste alternativer Sicherungsendpunkte definieren.</span><span class="sxs-lookup"><span data-stu-id="367f9-176">A filter table is a named collection of <xref:System.ServiceModel.Routing.Configuration.FilterTableEntryElement> objects that define the association between a filter, a primary destination endpoint, and a list of alternative backup endpoints.</span></span> <span data-ttu-id="367f9-177">Die Filtertabelleneinträge ermöglichen es Ihnen auch, eine optionale Priorität für jede Filterbedingung anzugeben.</span><span class="sxs-lookup"><span data-stu-id="367f9-177">The filter table entries also allow you to specify an optional priority for each filter condition.</span></span> <span data-ttu-id="367f9-178">Im folgenden Beispiel werden zwei Filter definiert. Anschließend wird eine Filtertabelle definiert, in der jedem Filter ein Zielendpunkt zugeordnet wird.</span><span class="sxs-lookup"><span data-stu-id="367f9-178">The following example defines two filters and then defines a filter table that associates each filter with a destination endpoint.</span></span>  
  
```xml  
<routing>  
     <filters>  
       <filter name="AddAction" filterType="Action" filterData="Add" />  
       <filter name="SubtractAction" filterType="Action" filterData="Subtract" />  
     </filters>  
     <filterTables>  
       <table name="routingTable1">  
         <filters>  
           <add filterName="AddAction" endpointName="Addition" />  
           <add filterName="SubtractAction" endpointName="Subtraction" />  
         </filters>  
       </table>  
     </filterTables>
</routing>  
```  
  
### <a name="filter-evaluation-priority"></a><span data-ttu-id="367f9-179">Priorität bei der Filterauswertung</span><span class="sxs-lookup"><span data-stu-id="367f9-179">Filter Evaluation Priority</span></span>  
 <span data-ttu-id="367f9-180">Standardmäßig werden alle Einträge in der Filtertabelle gleichzeitig ausgewertet, und die jeweils ausgewertete Nachricht wird an die Endpunkte weitergeleitet, die den einzelnen übereinstimmenden Filtereinträgen zugeordnet sind.</span><span class="sxs-lookup"><span data-stu-id="367f9-180">By default, all entries in the filter table are evaluated simultaneously, and the message being evaluated is routed to the endpoint(s) associated with each matching filter entry.</span></span> <span data-ttu-id="367f9-181">Wenn sich für die Auswertung mehrerer Filter `true` ergibt und die Nachricht den Typ unidirektional oder duplex aufweist, wird die Nachricht per Multicast an die Endpunkte für alle übereinstimmenden Filter übermittelt.</span><span class="sxs-lookup"><span data-stu-id="367f9-181">If multiple filters evaluate to `true`, and the message is one-way or duplex, the message is multicast to the endpoints for all matching filters.</span></span> <span data-ttu-id="367f9-182">Anforderung-Antwort-Nachrichten können nicht per Multicast gesendet werden, weil nur eine Antwort an den Client zurückgegeben werden kann.</span><span class="sxs-lookup"><span data-stu-id="367f9-182">Request-reply messages cannot be multicast because only one reply can be returned to the client.</span></span>  
  
 <span data-ttu-id="367f9-183">Sie können eine komplexere Routinglogik implementieren, indem Sie für jeden Filter Prioritätsstufen angeben. Der Routingdienst wertet zuerst alle Filter auf höchster Prioritätsstufe aus.</span><span class="sxs-lookup"><span data-stu-id="367f9-183">More complex routing logic can be implemented by specifying priority levels for each filter; the Routing Service evaluates all filters at the highest priority level first.</span></span> <span data-ttu-id="367f9-184">Wenn eine Nachricht auf dieser Stufe eine Übereinstimmung mit einem Filter ergibt, werden keine Filter mit einer niedrigeren Priorität verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="367f9-184">If a message matches a filter of this level, no filters of a lower priority are processed.</span></span> <span data-ttu-id="367f9-185">Zum Beispiel wird eine eingehende unidirektionale Nachricht zuerst für alle Filter mit der Priorität 2 ausgewertet.</span><span class="sxs-lookup"><span data-stu-id="367f9-185">For example, an incoming one-way message is first evaluated against all filters with a priority of 2.</span></span> <span data-ttu-id="367f9-186">Die Nachricht ergibt auf dieser Prioritätsstufe keine Übereinstimmung. Als Nächstes wird die Nachricht also mit Filtern mit der Priorität 1 verglichen.</span><span class="sxs-lookup"><span data-stu-id="367f9-186">The message does not match any filter at this priority level, so next the message is compared against filters with a priority of 1.</span></span> <span data-ttu-id="367f9-187">Für zwei Filter mit der Priorität 1 ergibt sich für die Nachricht eine Übereinstimmung, und da es sich um eine unidirektionale Nachricht handelt, wird diese an beide Zielendpunkte weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="367f9-187">Two priority 1 filters match the message, and because it is a one-way message it is routed to both destination endpoints.</span></span>  <span data-ttu-id="367f9-188">Da für die Filter der Priorität 1 eine Übereinstimmung ermittelt wurde, werden keine Filter der Priorität 0 ausgewertet.</span><span class="sxs-lookup"><span data-stu-id="367f9-188">Because a match was found among the priority 1 filters, no filters of priority 0 are evaluated.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="367f9-189">Wenn keine Priorität angegeben wird, wird die Standardpriorität 0 verwendet.</span><span class="sxs-lookup"><span data-stu-id="367f9-189">If no priority is specified, the default priority of 0 is used.</span></span>  
  
 <span data-ttu-id="367f9-190">Im folgenden Beispiel wird eine Filtertabelle definiert, in der für die Filter, auf die in der Tabelle verwiesen wird, die Prioritäten von 2, 1 und 0 angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="367f9-190">The following example defines a filter table that specifies priorities of 2, 1, and 0 for the filters referenced in the table.</span></span>  
  
```xml  
<filterTables>  
     <filterTable name="filterTable1">  
          <add filterName="XPathFilter" endpointName="roundingCalcEndpoint"
               priority="2"/>  
          <add filterName="EndpointNameFilter" endpointName="regularCalcEndpoint"
               priority="1"/>  
          <add filterName="PrefixAddressFilter" endpointName="roundingCalcEndpoint"
               priority="1"/>  
          <add filterName="MatchAllMessageFilter" endpointName="defaultCalcEndpoint"
               priority="0"/>  
     </filterTable>  
</filterTables>  
```  
  
 <span data-ttu-id="367f9-191">Falls sich im vorangehenden Beispiel für eine Nachricht eine Übereinstimmung mit dem XPathFilter ergibt, wird diese an den roundingCalcEndpoint weitergeleitet. Es werden dann keine weiteren Filter der Tabelle ausgewertet, weil alle anderen Filter über eine niedrigere Priorität verfügen.</span><span class="sxs-lookup"><span data-stu-id="367f9-191">In the preceding example, if a message matches the XPathFilter, it will be routed to the roundingCalcEndpoint and no further filters in the table will be evaluated because all other filters are of a lower priority.</span></span> <span data-ttu-id="367f9-192">Falls die Nachricht jedoch nicht zu einer Übereinstimmung mit XPathFilter führt, wird sie mit allen Filtern der nächstniedrigeren Priorität ausgewertet, also EndpointNameFilter und PrefixAddressFilter.</span><span class="sxs-lookup"><span data-stu-id="367f9-192">However, if the message does not match the XPathFilter it will then be evaluated against all filters of the next lower priority, EndpointNameFilter and PrefixAddressFilter.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="367f9-193">Nach Möglichkeit sollten Sie anstelle einer Priorität exklusive Filter verwenden, weil die Prioritätsauswertung die Leistung beeinträchtigen kann.</span><span class="sxs-lookup"><span data-stu-id="367f9-193">When possible, use exclusive filters instead of specifying a priority because priority evaluation can result in performance degradation.</span></span>  
  
### <a name="backup-lists"></a><span data-ttu-id="367f9-194">Sicherungslisten</span><span class="sxs-lookup"><span data-stu-id="367f9-194">Backup Lists</span></span>  
 <span data-ttu-id="367f9-195">Für jeden Filter in der Filtertabelle kann optional eine Sicherungsliste angegeben werden, bei der es sich um eine benannte Auflistung von Endpunkten handelt (<xref:System.ServiceModel.Routing.Configuration.BackupEndpointCollection>).</span><span class="sxs-lookup"><span data-stu-id="367f9-195">Each filter in the filter table can optionally specify a backup list, which is a named collection of endpoints (<xref:System.ServiceModel.Routing.Configuration.BackupEndpointCollection>).</span></span> <span data-ttu-id="367f9-196">Diese Auflistung enthält eine sortierte Liste von Endpunkten, an die die Nachricht bei Auftreten einer <xref:System.ServiceModel.CommunicationException> gesendet wird, sofern das Senden an unter <xref:System.ServiceModel.Routing.Configuration.FilterTableEntryElement.EndpointName%2A> angegebenen primären Endpunkt erfolgt.</span><span class="sxs-lookup"><span data-stu-id="367f9-196">This collection contains an ordered list of endpoints that the message will be transmitted to in the event of a <xref:System.ServiceModel.CommunicationException> when sending to the primary endpoint specified in <xref:System.ServiceModel.Routing.Configuration.FilterTableEntryElement.EndpointName%2A>.</span></span> <span data-ttu-id="367f9-197">Im folgenden Beispiel wird eine Sicherungsliste mit dem Namen "backupServiceEndpoints" definiert, die zwei Endpunkte enthält.</span><span class="sxs-lookup"><span data-stu-id="367f9-197">The following example defines a backup list named "backupServiceEndpoints" that contains two endpoints.</span></span>  
  
```xml  
<filterTables>  
     <filterTable name="filterTable1">  
          <add filterName="MatchAllFilter1" endpointName="Destination" backupList="backupEndpointList"/>  
     </filterTable>  
</filterTables>  
<backupLists>  
     <backupList name="backupEndpointList">  
          <add endpointName="backupServiceQueue" />  
          <add endpointName="alternateServiceQueue" />  
     </backupList>  
</backupLists>  
```  
  
 <span data-ttu-id="367f9-198">Wenn im vorherigen Beispiel ein Senden an den primären Endpunkt "Destination" fehlschlägt, versucht der Routingdienst, an jeden Endpunkt in der Sequenz zu senden, die er aufgelistet hat, zuerst an backupServiceQueue und anschließend an alternateServiceQueue zu senden, wenn die an backupServiceQueue senden schlägt fehl.</span><span class="sxs-lookup"><span data-stu-id="367f9-198">In the preceding example, if a send to the primary endpoint "Destination" fails, the Routing Service will try sending to each endpoint in the sequence they are listed, first sending to backupServiceQueue and subsequently sending to alternateServiceQueue if the send to backupServiceQueue fails.</span></span> <span data-ttu-id="367f9-199">Falls für alle Sicherungsendpunkte ein Fehler auftritt, wird ein Fehler zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="367f9-199">If all backup endpoints fail, a fault is returned.</span></span>
