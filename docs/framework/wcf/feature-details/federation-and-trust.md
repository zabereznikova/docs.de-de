---
title: Verbund und Vertrauenswürdigkeit
ms.date: 03/30/2017
helpviewer_keywords:
- federation [WCF], and trust
ms.assetid: 4bdec4f2-f8a2-4512-bdcf-14ef54b5877a
ms.openlocfilehash: 8b924a4aeb9c667592e99d65666cd8f048d34c22
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/09/2020
ms.locfileid: "84595478"
---
# <a name="federation-and-trust"></a><span data-ttu-id="c8f3f-102">Verbund und Vertrauenswürdigkeit</span><span class="sxs-lookup"><span data-stu-id="c8f3f-102">Federation and Trust</span></span>
<span data-ttu-id="c8f3f-103">In diesem Thema werden verschiedene Aspekte im Zusammenhang mit Verbund Anwendungen, Vertrauensstellungs Grenzen und-Konfiguration sowie die Verwendung von ausgestellten Token in Windows Communication Foundation (WCF) behandelt.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-103">This topic covers various aspects related to federated applications, trust boundaries and configuration, and use of issued tokens in Windows Communication Foundation (WCF).</span></span>  
  
## <a name="services-security-token-services-and-trust"></a><span data-ttu-id="c8f3f-104">Dienste, Sicherheitstokendienste und Vertrauenswürdigkeit</span><span class="sxs-lookup"><span data-stu-id="c8f3f-104">Services, Security Token Services, and Trust</span></span>  
 <span data-ttu-id="c8f3f-105">Dienste, die Verbundendpunkte verfügbar machen, erwarten normalerweise von den Clients, dass sie sich über ein Token authentifizieren, das von einem bestimmten Aussteller bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-105">Services that expose federated endpoints typically expect clients to authenticate using a token provided by a specific issuer.</span></span> <span data-ttu-id="c8f3f-106">Der Dienst muss mit den richtigen Anmeldeinformationen für den Aussteller konfiguriert werden. Andernfalls kann er keine Signaturen über die ausgestellten Token überprüfen, und der Client kann nicht mit dem Dienst kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-106">It is important that the service is configured with the correct credentials for the issuer; otherwise, it will not be able to verify signatures over the issued tokens, and the client will be unable to communicate with the service.</span></span> <span data-ttu-id="c8f3f-107">Weitere Informationen zum Konfigurieren von Aussteller Anmelde Informationen für den Dienst finden [Sie unter Vorgehensweise: Konfigurieren von Anmelde Informationen auf einem Verbunddienst](how-to-configure-credentials-on-a-federation-service.md).</span><span class="sxs-lookup"><span data-stu-id="c8f3f-107">For more information about configuring issuer credentials on the service, see [How to: Configure Credentials on a Federation Service](how-to-configure-credentials-on-a-federation-service.md).</span></span>  
  
 <span data-ttu-id="c8f3f-108">Ähnlich verhält es sich mit Nutzung von symmetrischen Schlüsseln. Die Schlüssel werden für den Zieldienst verschlüsselt, d. h. der Sicherheitstokendienst muss mit den korrekten Anmeldeinformationen für den Zieldienst konfiguriert werden. Sonst kann er den Schlüssel für den Zieldienst nicht verschlüsseln und der Client kann auch hier nicht mit dem Dienst kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-108">Similarly, when using symmetric keys, the keys are encrypted for the target service, so you must configure the security token service with the correct credentials for the target service; otherwise, it will be unable to encrypt the key for the target service, and again, the client will be unable to communicate with the service.</span></span>  
  
 <span data-ttu-id="c8f3f-109">WCF-Dienste verwenden den Wert der- <xref:System.ServiceModel.Channels.LocalServiceSecuritySettings.MaxClockSkew%2A> Eigenschaft im [SecurityBindingElement](../diagnostics/wmi/securitybindingelement.md) , um die Zeit Abweichung zwischen dem Client und dem Dienst zuzulassen.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-109">WCF services use the value of the <xref:System.ServiceModel.Channels.LocalServiceSecuritySettings.MaxClockSkew%2A> property on the [SecurityBindingElement](../diagnostics/wmi/securitybindingelement.md) to allow for clock skew between the client and service.</span></span> <span data-ttu-id="c8f3f-110">In einem Verbund gilt die Einstellung `MaxClockSkew` für Taktverschiebungen zwischen dem Client und dem Sicherheitstokendienst, von dem der Client das ausgestellte Token erhalten hat.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-110">In federation, the `MaxClockSkew` setting applies to clock skews between both the client and the security token service from where the client obtained the issued token.</span></span> <span data-ttu-id="c8f3f-111">Daher müssen die Sicherheitstokendienste keine Toleranz für Taktverschiebungen einberechnen, wenn die tatsächlichen Zeiten und die Ablaufzeiten des ausgestellten Tokens festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-111">Therefore, security token services need not make clock-skew allowances when setting the issued token's effective and expiration times.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="c8f3f-112">Die Bedeutung der Taktverschiebung wächst mit abnehmender Lebensdauer des ausgestellten Tokens.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-112">The importance of clock skew increases as the lifetime of the issued token shortens.</span></span> <span data-ttu-id="c8f3f-113">In den meisten Fällen ist die Taktverschiebung kein großes Problem, wenn die Tokenlebensdauer 30 Minuten oder mehr beträgt.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-113">In most cases, clock skew is not a significant issue if the token lifetime is 30 minutes or more.</span></span> <span data-ttu-id="c8f3f-114">Szenarien mit kürzeren Lebensdauern oder Szenarien, bei denen die genaue Prüfzeit des Tokens wichtig ist, sollten so ausgelegt werden, dass sie die Taktverschiebung berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-114">Scenarios with shorter lifetimes or where the exact validity time of the token is important should be designed to take clock skew into account.</span></span>  
  
## <a name="federated-endpoints-and-time-outs"></a><span data-ttu-id="c8f3f-115">Verbundendpunkte und Timeouts</span><span class="sxs-lookup"><span data-stu-id="c8f3f-115">Federated Endpoints and Time-Outs</span></span>  
 <span data-ttu-id="c8f3f-116">Wenn ein Client mit einem Verbundendpunkt kommuniziert, muss er zunächst ein angemessenes Token von einem Sicherheitstokendienst erhalten.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-116">When a client communicates with a federated endpoint, it must first acquire an appropriate token from a security token service.</span></span> <span data-ttu-id="c8f3f-117">Wenn der Sicherheitstokendienst einen Verbundendpunkt verfügbar macht, muss der Client zunächst ein Token von dem Aussteller dieses Endpunkts anfordern.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-117">If the security token service exposes a federated endpoint, the client must first obtain a token from the issuer for that endpoint.</span></span> <span data-ttu-id="c8f3f-118">Jeder Tokenerwerb dauert eine gewisse Zeit, und während dieser Zeit fällt er unter das Gesamttimeout für das Senden der tatsächlichen Nachricht an den finalen Endpunkt.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-118">Each token acquisition takes time, and that time is subject to the overall time-out for sending the actual message to the final endpoint.</span></span>  
  
 <span data-ttu-id="c8f3f-119">Auf dem clientseitigen Kanal wird das Timeout z. B. auf 30 Sekunden festgelegt.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-119">For example, the time-out on the client-side channel is set to 30 seconds.</span></span> <span data-ttu-id="c8f3f-120">Zwei Tokenaussteller müssen aufgefordert werden, Tokens abzurufen, bevor die Nachricht an den finalen Endpunkt verschickt wird; jeder benötigt für das Ausstellen eines Tokens 15 Sekunden.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-120">Two token issuers need to be called to retrieve tokens before sending the message to the final endpoint, and each takes 15 seconds to issue a token.</span></span> <span data-ttu-id="c8f3f-121">In diesem Fall schlägt der Versuch fehl, und eine <xref:System.TimeoutException> wird ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-121">In this case, the attempt will fail and a <xref:System.TimeoutException> is thrown.</span></span> <span data-ttu-id="c8f3f-122">Daher müssen Sie den Wert für <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> auf dem Clientkanal hoch genug festlegen, damit er auch die Zeit berücksichtigt, die das Abrufen aller ausgestellten Token in Anspruch nimmt.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-122">Thus, you need to set the <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> value on the client channel to a value large enough to include the time taken to retrieve all issued tokens.</span></span> <span data-ttu-id="c8f3f-123">Sollte kein Wert für die Eigenschaft <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> festgelegt sein, muss die Eigenschaft <xref:System.ServiceModel.Channels.Binding.OpenTimeout%2A> oder die Eigenschaft <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A> (oder beide) auf einen Wert festgelegt werden, der hoch genug ist, um die Zeit, die das Abrufen aller ausgestellten Token beansprucht, zu berücksichtigen.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-123">In the case where a value is not specified for the <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> property, the <xref:System.ServiceModel.Channels.Binding.OpenTimeout%2A> property or the <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A> property (or both) need to be set to a value large enough to include the time taken to retrieve all issued tokens.</span></span>  
  
## <a name="token-lifetime-and-renewal"></a><span data-ttu-id="c8f3f-124">Tokenlebensdauer und Erneuerung</span><span class="sxs-lookup"><span data-stu-id="c8f3f-124">Token Lifetime and Renewal</span></span>  
 <span data-ttu-id="c8f3f-125">WCF-Clients überprüfen das ausgestellte Token nicht, wenn Sie eine anfängliche Anforderung an einen Dienst senden.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-125">WCF clients do not check the issued token when making an initial request to a service.</span></span>  <span data-ttu-id="c8f3f-126">Stattdessen vertraut WCF dem Sicherheitstokendienst, ein Token mit den entsprechenden Gültigkeits-und Ablaufzeiten auszugeben.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-126">Rather, WCF trusts the security token service to issue a token with appropriate effective and expiration times.</span></span> <span data-ttu-id="c8f3f-127">Wenn das Token vom Client zwischengespeichert und wiederverwendet wird, wird die Tokenlebensdauer bei den folgenden Anforderungen überprüft, und der Client erneuert das Token ggf. automatisch.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-127">If the token is cached by the client and reused, the token lifetime is checked on subsequent requests and the client automatically renews the token if necessary.</span></span> <span data-ttu-id="c8f3f-128">Weitere Informationen zum Zwischenspeichern von Token finden [Sie unter Gewusst wie: Erstellen eines Verbund Clients](how-to-create-a-federated-client.md).</span><span class="sxs-lookup"><span data-stu-id="c8f3f-128">For more information about token caching, see [How to: Create a Federated Client](how-to-create-a-federated-client.md).</span></span>  
  
 <span data-ttu-id="c8f3f-129">Wenn Sie eine kurze Lebensdauer angeben (in der Reihenfolge von 30 Sekunden oder weniger für ausgestellte Token oder Sicherheitskontext Token), kann es zu Aushandlungs Timeouts oder anderen Ausnahmen kommen, die von WCF-Clients beim Anfordern ausgestellter Token oder beim Aushandeln oder Erneuern von Sicherheitskontext Token ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-129">Specifying short lifetimes, on the order of 30 seconds or less for issued tokens or security context tokens, may result in negotiation time-outs or other exceptions being thrown by WCF clients when requesting issued tokens or when negotiating or renewing security context tokens.</span></span>  
  
## <a name="issued-tokens-and-inclusionmode"></a><span data-ttu-id="c8f3f-130">Ausgestellte Token und InclusionMode</span><span class="sxs-lookup"><span data-stu-id="c8f3f-130">Issued Tokens and InclusionMode</span></span>  
 <span data-ttu-id="c8f3f-131">Ob ein ausgestelltes Token in einer Nachricht, die von einem Client an einen Verbundendpunkt gesendet wird, serialisiert wird, hängt von der Einstellung der Eigenschaft <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters.InclusionMode%2A> der Klasse <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters> ab.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-131">Whether an issued token is serialized in a message sent from a client to a federated endpoint or not is controlled by setting the <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters.InclusionMode%2A> property of the <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters> class.</span></span> <span data-ttu-id="c8f3f-132">Diese Eigenschaft kann auf einen der <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode>-Enumerationwerte festgelegt werden, ist aber in den meisten Verbundszenarien nutzlos.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-132">This property can be set to one of the <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode> enumeration values, but it is not useful in most federated scenarios.</span></span> <span data-ttu-id="c8f3f-133">Die Werte `SecurityTokenInclusionMode.Never` und `SecurityTokenInclusionMode.AlwaysToInitiator` sorgen dafür, dass der Client einen Bezug an das Token sendet, das der Sicherheitstokendienst der vertrauenden Seite ausgestellt hat.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-133">The `SecurityTokenInclusionMode.Never` and `SecurityTokenInclusionMode.AlwaysToInitiator` values cause the client to send a reference to the token issued by the security token service to the relying party.</span></span> <span data-ttu-id="c8f3f-134">Wenn die vertrauende Seite keine Kopie des ausgestellten Tokens besitzt, schlägt die Authentifizierung fehl, da der Tokenverweis nicht aufgelöst werden kann.</span><span class="sxs-lookup"><span data-stu-id="c8f3f-134">Unless the relying party possesses a copy of the issued token, authentication will fail because the token reference is not resolvable.</span></span> <span data-ttu-id="c8f3f-135">WCF behandelt `SecurityTokenInclusionMode.Once` als äquivalent zu `SecurityTokenInclusionMode.AlwaysToRecipient` .</span><span class="sxs-lookup"><span data-stu-id="c8f3f-135">WCF treats `SecurityTokenInclusionMode.Once` as equivalent to `SecurityTokenInclusionMode.AlwaysToRecipient`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c8f3f-136">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="c8f3f-136">See also</span></span>

- <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode>
- [<span data-ttu-id="c8f3f-137">Vorgehensweise: Erstellen eines Verbundclients</span><span class="sxs-lookup"><span data-stu-id="c8f3f-137">How to: Create a Federated Client</span></span>](how-to-create-a-federated-client.md)
- [<span data-ttu-id="c8f3f-138">Vorgehensweise: Konfigurieren von Anmeldeinformationen auf einem Verbunddienst</span><span class="sxs-lookup"><span data-stu-id="c8f3f-138">How to: Configure Credentials on a Federation Service</span></span>](how-to-configure-credentials-on-a-federation-service.md)
- [<span data-ttu-id="c8f3f-139">Vorgehensweise: Erstellen einer WSFederationHttpBinding</span><span class="sxs-lookup"><span data-stu-id="c8f3f-139">How to: Create a WSFederationHttpBinding</span></span>](how-to-create-a-wsfederationhttpbinding.md)
