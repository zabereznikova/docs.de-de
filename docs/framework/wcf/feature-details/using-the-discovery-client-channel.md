---
title: Verwenden des Suchclientchannels
ms.date: 03/30/2017
ms.assetid: 1494242a-1d64-4035-8ecd-eb4f06c8d2ba
ms.openlocfilehash: 2d9dd68d233541f4d8cb3185adc1023cd5a19de1
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/12/2020
ms.locfileid: "79184267"
---
# <a name="using-the-discovery-client-channel"></a><span data-ttu-id="a8f83-102">Verwenden des Suchclientchannels</span><span class="sxs-lookup"><span data-stu-id="a8f83-102">Using the Discovery Client Channel</span></span>
<span data-ttu-id="a8f83-103">Beim Schreiben einer WCF-Clientanwendung müssen Sie die Endpunktadresse des Diensts kennen, den Sie aufrufen.</span><span class="sxs-lookup"><span data-stu-id="a8f83-103">When writing a WCF client application you need to know the endpoint address of the service you are calling.</span></span> <span data-ttu-id="a8f83-104">In vielen Situationen ist die Endpunktadresse eines Diensts nicht im Voraus bekannt, oder die Adresse des Diensts ändert sich im Laufe der Zeit.</span><span class="sxs-lookup"><span data-stu-id="a8f83-104">In many situations the endpoint address of a service is not known in advance or the address of the service changes over time.</span></span> <span data-ttu-id="a8f83-105">Mithilfe des Discovery-Clientchannels können Sie eine WCF-Clientanwendung schreiben und den aufzurufenden Dienst beschreiben. Der Client sendet dann automatisch eine Überprüfungsanforderung.</span><span class="sxs-lookup"><span data-stu-id="a8f83-105">The Discovery Client Channel allows you to write a WCF client application, describe the service you want to call, and the client channel automatically sends a probe request.</span></span> <span data-ttu-id="a8f83-106">Wenn ein Dienst antwortet, ruft der Discovery-Clientchannel die Endpunktadresse für den Dienst aus der Überprüfungsantwort ab und verwendet diese zum Aufrufen des Diensts.</span><span class="sxs-lookup"><span data-stu-id="a8f83-106">When a service responds, the discovery client channel retrieves the endpoint address for the service from the probe response and uses it to call the service.</span></span>  
  
## <a name="using-the-discovery-client-channel"></a><span data-ttu-id="a8f83-107">Verwenden des Suchclientchannels</span><span class="sxs-lookup"><span data-stu-id="a8f83-107">Using the Discovery Client Channel</span></span>  
 <span data-ttu-id="a8f83-108">Um den Discovery-Clientchannel zu verwenden, fügen Sie dem Clientchannelstapel eine <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement>-Instanz hinzu.</span><span class="sxs-lookup"><span data-stu-id="a8f83-108">To use the Discovery Client Channel, add an instance of the <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement> to your client channel stack.</span></span> <span data-ttu-id="a8f83-109">Alternativ dazu können Sie das <xref:System.ServiceModel.Discovery.DynamicEndpoint>-Objekt verwenden. Der Bindung wird dann automatisch ein <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement>-Objekt hinzugefügt, falls diese nicht bereits vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="a8f83-109">Alternatively you can use the <xref:System.ServiceModel.Discovery.DynamicEndpoint> and a <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement> is automatically added to your binding if not already present.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="a8f83-110">Es wird empfohlen, das <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement>-Objekt im Clientchannelstapel als oberstes Element zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="a8f83-110">It is recommended that the <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement> is the top-most element on your client channel stack.</span></span> <span data-ttu-id="a8f83-111">Für jedes Bindungselement, das zusätzlich zum <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement>-Objekt hinzugefügt wird, muss sichergestellt sein, dass das <xref:System.ServiceModel.ChannelFactory>-Objekt bzw. der erstellte Channel nicht die Endpunktadresse oder die `Via`-Adresse (die an die `CreateChannel`-Methode übergeben wird) verwendet. Es kann nämlich sein, dass darin nicht die richtige Adresse enthalten ist.</span><span class="sxs-lookup"><span data-stu-id="a8f83-111">Any binding element that is added on top of the <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement> must make sure that the <xref:System.ServiceModel.ChannelFactory> or channel it creates does not use the endpoint address or `Via` address (passed to the `CreateChannel` method) because they may not contain the correct address.</span></span>  
  
 <span data-ttu-id="a8f83-112">Die <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement>-Klasse enthält zwei öffentliche Eigenschaften:</span><span class="sxs-lookup"><span data-stu-id="a8f83-112">The <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement> class contains two public properties:</span></span>  
  
1. <span data-ttu-id="a8f83-113"><xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement.FindCriteria%2A> wird verwendet, um den Dienst zu beschreiben, den Sie aufrufen möchten.</span><span class="sxs-lookup"><span data-stu-id="a8f83-113"><xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement.FindCriteria%2A>, which is used to describe the service you want to call.</span></span>  
  
2. <span data-ttu-id="a8f83-114"><xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement.DiscoveryEndpointProvider%2A>die den Ermittlungsendpunkt angibt, an den Ermittlungsnachrichten gesendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="a8f83-114"><xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement.DiscoveryEndpointProvider%2A> which specifies the discovery endpoint to send discovery messages to.</span></span>  
  
 <span data-ttu-id="a8f83-115">Mit der <xref:System.ServiceModel.Discovery.FindCriteria.%23ctor%2A>-Eigenschaft können Sie den Dienstvertrag angeben, nach dem Sie suchen, sowie alle erforderlichen Bereichs-URIs und den maximalen Zeitraum, wie lange versucht wird, den Channel zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="a8f83-115">The <xref:System.ServiceModel.Discovery.FindCriteria.%23ctor%2A> property allows you to specify the service contract you are searching for, any required scope URIs, and the maximum number of time to attempt to open the channel.</span></span> <span data-ttu-id="a8f83-116">Der Vertragstyp wird durch Aufrufen <xref:System.ServiceModel.Discovery.FindCriteria>des Konstruktors angegeben.</span><span class="sxs-lookup"><span data-stu-id="a8f83-116">The contract type is specified by calling the constructor  <xref:System.ServiceModel.Discovery.FindCriteria>.</span></span> <span data-ttu-id="a8f83-117">Der <xref:System.ServiceModel.Discovery.FindCriteria.Scopes%2A>-Eigenschaft können Bereichs-URIs hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="a8f83-117">Scope URIs can be added to the <xref:System.ServiceModel.Discovery.FindCriteria.Scopes%2A> property.</span></span> <span data-ttu-id="a8f83-118">Mithilfe der <xref:System.ServiceModel.Discovery.FindCriteria.MaxResults%2A>-Eigenschaft können Sie die maximale Anzahl von Ergebnissen angeben, für die der Client das Herstellen einer Verbindung versucht.</span><span class="sxs-lookup"><span data-stu-id="a8f83-118">The <xref:System.ServiceModel.Discovery.FindCriteria.MaxResults%2A> property allows you to specify the maximum number of results to which the client tries to connect to.</span></span> <span data-ttu-id="a8f83-119">Wenn eine Überprüfungsantwort empfangen wird, versucht der Client, den Channel mit der Endpunktadresse aus der Überprüfungsantwort zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="a8f83-119">When a probe response is received the client attempts to open the channel using the endpoint address from the probe response.</span></span> <span data-ttu-id="a8f83-120">Wenn eine Ausnahme auftritt, fährt der Client mit der nächsten Überprüfungsantwort fort und wartet auf weitere Antworten, sofern dies erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="a8f83-120">If an exception occurs the client moves on to the next probe response, waiting for more responses to be received if necessary.</span></span> <span data-ttu-id="a8f83-121">Dies dauert so lange an, bis der Channel erfolgreich geöffnet oder die maximale Anzahl an Ergebnissen erreicht wurde.</span><span class="sxs-lookup"><span data-stu-id="a8f83-121">It continues to do this until the channel is successfully opened or the maximum number of results is reached.</span></span> <span data-ttu-id="a8f83-122">Weitere Informationen zu diesen Einstellungen finden Sie unter <xref:System.ServiceModel.Discovery.FindCriteria>.</span><span class="sxs-lookup"><span data-stu-id="a8f83-122">For more information about these settings, see <xref:System.ServiceModel.Discovery.FindCriteria>.</span></span>  
  
 <span data-ttu-id="a8f83-123">Mit der <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement.DiscoveryEndpointProvider%2A>-Eigenschaft können Sie den zu verwendenden Suchendpunkt angeben.</span><span class="sxs-lookup"><span data-stu-id="a8f83-123">The <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement.DiscoveryEndpointProvider%2A> property allows you to specify the discovery endpoint to use.</span></span> <span data-ttu-id="a8f83-124">Normalerweise ist dies ein <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint>-Objekt, aber es kann sich um jeden gültigen Endpunkt handeln.</span><span class="sxs-lookup"><span data-stu-id="a8f83-124">Normally this is a <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint>, but it can be any valid endpoint.</span></span>  
  
 <span data-ttu-id="a8f83-125">Wenn Sie die Bindung für die Kommunikation mit dem Dienst erstellen, müssen Sie darauf achten, genau die gleiche Bindung wie der Dienst zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="a8f83-125">When you are creating the binding to use to communicate with the service, you must be careful to use the exact same binding as the service.</span></span> <span data-ttu-id="a8f83-126">Der einzige Unterschied besteht darin, dass die Clientbindung oben im Stapel über ein <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement>-Objekt verfügt.</span><span class="sxs-lookup"><span data-stu-id="a8f83-126">The only difference is the client binding has a <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement> on the top of the stack.</span></span> <span data-ttu-id="a8f83-127">Falls der Dienst eine der vom System bereitgestellten Bindungen verwendet, erstellen Sie ein neues <xref:System.ServiceModel.Channels.CustomBinding>-Objekt und übergeben die vom System bereitgestellte Bindung an den <xref:System.ServiceModel.Channels.CustomBinding.%23ctor%2A>-Konstruktor.</span><span class="sxs-lookup"><span data-stu-id="a8f83-127">If service is using one of the system-provided bindings, create a new <xref:System.ServiceModel.Channels.CustomBinding> and pass in the system-provided binding to the <xref:System.ServiceModel.Channels.CustomBinding.%23ctor%2A> constructor.</span></span> <span data-ttu-id="a8f83-128">Anschließend können Sie <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement> hinzufügen, indem Sie `Insert` für die <xref:System.ServiceModel.Channels.CustomBinding.Elements%2A>-Eigenschaft aufrufen.</span><span class="sxs-lookup"><span data-stu-id="a8f83-128">Then you can add the <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement> by calling `Insert` on the <xref:System.ServiceModel.Channels.CustomBinding.Elements%2A> property.</span></span>  
  
 <span data-ttu-id="a8f83-129">Nachdem Sie <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement> der Bindung hinzugefügt und diese konfiguriert haben, können Sie eine Instanz der WCF-Clientklasse erstellen, diese öffnen und ihre Methoden aufrufen.</span><span class="sxs-lookup"><span data-stu-id="a8f83-129">Once you have added the <xref:System.ServiceModel.Discovery.DiscoveryClientBindingElement> to your binding and configured it, you can create an instance of the WCF client class, open it, and call its methods.</span></span> <span data-ttu-id="a8f83-130">Im folgenden Beispiel wird der Discovery-Clientchannel verwendet, um einen WCF-Dienst zu ermitteln, der die `ICalculator`-Klasse implementiert (verwendet im WCF-Lernprogramm "Erste Schritte") und die dazugehörige `Add`-Methode aufruft.</span><span class="sxs-lookup"><span data-stu-id="a8f83-130">The following example uses the Discovery Client Channel to discover a WCF service that implements the `ICalculator` class (used in the Getting Started WCF tutorial) and calls its `Add` method.</span></span>  
  
```csharp
// Create the DiscoveryClientBindingElement  
DiscoveryClientBindingElement bindingElement = new DiscoveryClientBindingElement();  
// Search for a service that implements the ICalculator interface, attempting to open  
// the channel a maximum of 2 times  
bindingElement.FindCriteria = new FindCriteria(typeof(ICalculator)) { MaxResults = 2 };  
// Use the UdpDiscoveryEndpoint  
bindingElement.DiscoveryEndpoint = new UdpDiscoveryEndpoint();  
  
// The service uses the BasicHttpBinding, so use that and insert the DiscoveryClientBindingElement at the
// top of the stack  
CustomBinding binding = new CustomBinding(new BasicHttpBinding());  
binding.Elements.Insert(0,bindingElement);  
  
try  
{  
    // Create the WCF client and call a method  
    CalculatorClient client = new CalculatorClient(binding, new EndpointAddress("http://schemas.microsoft.com/dynamic"));  
    client.Open();  
    client.Add(1, 1);  
}  
catch (EndpointNotFoundException ex)  
{  
    Console.WriteLine("An exception occurred: " + ex.Message);  
}  
```  
  
## <a name="security-and-the-discovery-client-channel"></a><span data-ttu-id="a8f83-131">Sicherheit und der Discovery-Clientchannel</span><span class="sxs-lookup"><span data-stu-id="a8f83-131">Security and the Discovery Client Channel</span></span>  
 <span data-ttu-id="a8f83-132">Bei der Verwendung des Discovery-Clientchannels werden zwei Endpunkte angegeben.</span><span class="sxs-lookup"><span data-stu-id="a8f83-132">When using the discovery client channel, two endpoints are being specified.</span></span> <span data-ttu-id="a8f83-133">Einer wird für Suchnachrichten verwendet, normalerweise <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint>, und der andere ist der Anwendungsendpunkt.</span><span class="sxs-lookup"><span data-stu-id="a8f83-133">One is used for discovery messages, usually <xref:System.ServiceModel.Discovery.UdpDiscoveryEndpoint>, and the other is the application endpoint.</span></span> <span data-ttu-id="a8f83-134">Achten Sie beim Implementieren eines sicheren Diensts besonders auf die Sicherheit der beiden Endpunkte.</span><span class="sxs-lookup"><span data-stu-id="a8f83-134">When implementing a secure service, care must be taken to secure both endpoints.</span></span> <span data-ttu-id="a8f83-135">Weitere Informationen zur Sicherheit finden Sie unter [Sichern von Diensten und Clients](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md).</span><span class="sxs-lookup"><span data-stu-id="a8f83-135">For more information about security, see [Securing Services and Clients](../../../../docs/framework/wcf/feature-details/securing-services-and-clients.md).</span></span>
