---
title: Dienstidentität und Authentifizierung
description: Erfahren Sie mehr über die Endpunkt Identität eines Dienstanbieter, einen Wert, der von der Dienst-WSDL generiert wurde, die WCF zum Authentifizieren des Dienstanbieter verwendet.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- authentication [WCF], specifying the identity of a service
ms.assetid: a4c8f52c-5b30-45c4-a545-63244aba82be
ms.openlocfilehash: ae217b4a2c3432321c7ef2e663922a87b82acbea
ms.sourcegitcommit: 358a28048f36a8dca39a9fe6e6ac1f1913acadd5
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/23/2020
ms.locfileid: "85246570"
---
# <a name="service-identity-and-authentication"></a><span data-ttu-id="10b78-103">Dienstidentität und Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="10b78-103">Service Identity and Authentication</span></span>
<span data-ttu-id="10b78-104">Die *Endpunkt Identität* eines dienstangs ist ein Wert, der vom Service Web Services Description Language (WSDL) generiert wird.</span><span class="sxs-lookup"><span data-stu-id="10b78-104">A service's *endpoint identity* is a value generated from the service Web Services Description Language (WSDL).</span></span> <span data-ttu-id="10b78-105">Dieser an jeden Client weitergegebene Wert wird zum Authentifizieren des Diensts verwendet.</span><span class="sxs-lookup"><span data-stu-id="10b78-105">This value, propagated to any client, is used to authenticate the service.</span></span> <span data-ttu-id="10b78-106">Nachdem der Client eine Kommunikation mit einem Endpunkt initiiert und der Dienst sich gegenüber dem Client authentifiziert hat, vergleicht der Client den Wert der Endpunktidentität mit dem tatsächlichen Wert, den der Vorgang der Authentifizierung des Endpunkts zurückgegeben hat.</span><span class="sxs-lookup"><span data-stu-id="10b78-106">After the client initiates a communication to an endpoint and the service authenticates itself to the client, the client compares the endpoint identity value with the actual value the endpoint authentication process returned.</span></span> <span data-ttu-id="10b78-107">Stimmen sie überein, kann der Client sicher sein, dass er Kontakt zu dem erwarteten Dienstendpunkt hergestellt hat.</span><span class="sxs-lookup"><span data-stu-id="10b78-107">If they match, the client is assured it has contacted the expected service endpoint.</span></span> <span data-ttu-id="10b78-108">Dies dient als Schutz vor *Phishing* , indem verhindert wird, dass ein Client an einen von einem böswilligen Dienst gehosteten Endpunkt umgeleitet wird.</span><span class="sxs-lookup"><span data-stu-id="10b78-108">This functions as a protection against *phishing* by preventing a client from being redirected to an endpoint hosted by a malicious service.</span></span>  
  
 <span data-ttu-id="10b78-109">Eine Beispielanwendung, die die Identitäts Einstellung veranschaulicht, finden Sie unter [Beispiel für Dienst Identität](../samples/service-identity-sample.md).</span><span class="sxs-lookup"><span data-stu-id="10b78-109">For a sample application that demonstrates identity setting, see [Service Identity Sample](../samples/service-identity-sample.md).</span></span> <span data-ttu-id="10b78-110">Weitere Informationen zu Endpunkten und Endpunkt Adressen finden Sie unter [Adressen](endpoint-addresses.md).</span><span class="sxs-lookup"><span data-stu-id="10b78-110">For more information about endpoints and endpoint addresses, see [Addresses](endpoint-addresses.md).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="10b78-111">Wenn Sie NT&#160;LanMan (NTLM) für die Authentifizierung verwenden, wird die Dienstidentität nicht überprüft, weil unter NTLM der Client den Server nicht authentifizieren kann.</span><span class="sxs-lookup"><span data-stu-id="10b78-111">When you use NT LanMan (NTLM) for authentication, the service identity is not checked because, under NTLM, the client is unable to authenticate the server.</span></span> <span data-ttu-id="10b78-112">NTLM wird verwendet, wenn Computer Teil einer Windows-Arbeitsgruppe sind, oder sie eine ältere Version von Windows ausführen, die die Kerberos-Authentifizierung nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="10b78-112">NTLM is used when computers are part of a Windows workgroup, or when running an older version of Windows that does not support Kerberos authentication.</span></span>  
  
 <span data-ttu-id="10b78-113">Wenn der Client einen sicheren Kanal initiiert, um eine Nachricht an einen Dienst zu senden, authentifiziert die Windows Communication Foundation (WCF)-Infrastruktur den Dienst und sendet die Nachricht nur dann, wenn die Dienst Identität mit der Identität übereinstimmt, die in der vom Client verwendeten Endpunkt Adresse angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="10b78-113">When the client initiates a secure channel to send a message to a service over it, the Windows Communication Foundation (WCF) infrastructure authenticates the service, and only sends the message if the service identity matches the identity specified in the endpoint address the client uses.</span></span>  
  
 <span data-ttu-id="10b78-114">Der Vorgang der Identitätsverarbeitung umfasst die folgenden Phasen:</span><span class="sxs-lookup"><span data-stu-id="10b78-114">Identity processing consists of the following stages:</span></span>  
  
- <span data-ttu-id="10b78-115">Zur Entwurfszeit bestimmt der Cliententwickler die Identität des Diensts aus den (durch WSDL verfügbar gemachten) Metadaten der Endpunkte.</span><span class="sxs-lookup"><span data-stu-id="10b78-115">At design time, the client developer determines the service's identity from the endpoint's metadata (exposed through WSDL).</span></span>  
  
- <span data-ttu-id="10b78-116">Zur Laufzeit überprüft die Clientanwendung die Ansprüche der Sicherheitsanmeldeinformationen des Diensts, bevor irgendwelche Meldungen an den Dienst gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="10b78-116">At runtime, the client application checks the claims of the service's security credentials before sending any messages to the service.</span></span>  
  
 <span data-ttu-id="10b78-117">Die Identitätsverarbeitung auf dem Client entspricht der Clientauthentifizierung des Diensts.</span><span class="sxs-lookup"><span data-stu-id="10b78-117">Identity processing on the client is analogous to client authentication on the service.</span></span> <span data-ttu-id="10b78-118">Ein sicherer Dienst führt so lange keinen Code aus, bis die Anmeldeinformationen des Clients authentifiziert wurden.</span><span class="sxs-lookup"><span data-stu-id="10b78-118">A secure service does not execute code until the client's credentials have been authenticated.</span></span> <span data-ttu-id="10b78-119">Entsprechend sendet der Client so lange keine Nachrichten an den Dienst, bis die Anmeldeinformationen des Diensts auf der Grundlage dessen, was aus den Metadaten des Diensts im Voraus bekannt ist, authentifiziert wurden.</span><span class="sxs-lookup"><span data-stu-id="10b78-119">Likewise, the client does not send messages to the service until the service's credentials have been authenticated based on what is known in advance from the service's metadata.</span></span>  
  
 <span data-ttu-id="10b78-120">Die <xref:System.ServiceModel.EndpointAddress.Identity%2A>-Eigenschaft der <xref:System.ServiceModel.EndpointAddress>-Klasse stellt die Identität des Diensts dar, der vom Client aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="10b78-120">The <xref:System.ServiceModel.EndpointAddress.Identity%2A> property of the <xref:System.ServiceModel.EndpointAddress> class represents the identity of the service called by the client.</span></span> <span data-ttu-id="10b78-121">Der Dienst veröffentlicht die <xref:System.ServiceModel.EndpointAddress.Identity%2A> in seinen Metadaten.</span><span class="sxs-lookup"><span data-stu-id="10b78-121">The service publishes the <xref:System.ServiceModel.EndpointAddress.Identity%2A> in its metadata.</span></span> <span data-ttu-id="10b78-122">Wenn der Client Entwickler das [Service Model Metadata Utility Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md) für den Dienst Endpunkt ausführt, enthält die generierte Konfiguration den Wert der-Eigenschaft des dienstanders <xref:System.ServiceModel.EndpointAddress.Identity%2A> .</span><span class="sxs-lookup"><span data-stu-id="10b78-122">When the client developer runs the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md) against the service endpoint, the generated configuration contains the value of the service's <xref:System.ServiceModel.EndpointAddress.Identity%2A> property.</span></span> <span data-ttu-id="10b78-123">Die WCF-Infrastruktur (bei Konfiguration mit Sicherheit) überprüft, ob der Dienst die angegebene Identität besitzt.</span><span class="sxs-lookup"><span data-stu-id="10b78-123">The WCF infrastructure (if configured with security) verifies that the service possesses the identity specified.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="10b78-124">Die Metadaten enthalten die erwartete Identität des Diensts. Daher wird empfohlen, die Metadaten des Diensts auf sichere Weise verfügbar zu machen, indem Sie beispielsweise einen HTTPS-Endpunkt für den Dienst erstellen.</span><span class="sxs-lookup"><span data-stu-id="10b78-124">The metadata contains the expected identity of the service, so it is recommended that you expose the service metadata through secure means, for example, by creating an HTTPS endpoint for the service.</span></span> <span data-ttu-id="10b78-125">Weitere Informationen finden Sie unter Gewusst [wie: Sichern von Metadatenendpunkten](how-to-secure-metadata-endpoints.md).</span><span class="sxs-lookup"><span data-stu-id="10b78-125">For more information, see [How to: Secure Metadata Endpoints](how-to-secure-metadata-endpoints.md).</span></span>  
  
## <a name="identity-types"></a><span data-ttu-id="10b78-126">Identitätstypen</span><span class="sxs-lookup"><span data-stu-id="10b78-126">Identity Types</span></span>  
 <span data-ttu-id="10b78-127">Ein Dienst kann sechs Typen von Identitäten bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="10b78-127">A service can provide six types of identities.</span></span> <span data-ttu-id="10b78-128">Jeder Identitätstyp entspricht einem Element, das im `<identity>`-Element der Konfiguration enthalten sein kann.</span><span class="sxs-lookup"><span data-stu-id="10b78-128">Each identity type corresponds to an element that can be contained inside the `<identity>` element in configuration.</span></span> <span data-ttu-id="10b78-129">Der verwendete Typ hängt vom Szenario und den Sicherheitsanforderungen des Diensts ab.</span><span class="sxs-lookup"><span data-stu-id="10b78-129">The type used depends on the scenario and the service's security requirements.</span></span> <span data-ttu-id="10b78-130">In der folgenden Tabelle wird jeder dieser Identitätstypen beschrieben.</span><span class="sxs-lookup"><span data-stu-id="10b78-130">The following table describes each identity type.</span></span>  
  
|<span data-ttu-id="10b78-131">Identitätstyp</span><span class="sxs-lookup"><span data-stu-id="10b78-131">Identity type</span></span>|<span data-ttu-id="10b78-132">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="10b78-132">Description</span></span>|<span data-ttu-id="10b78-133">Typisches Szenario</span><span class="sxs-lookup"><span data-stu-id="10b78-133">Typical scenario</span></span>|  
|-------------------|-----------------|----------------------|  
|<span data-ttu-id="10b78-134">Domänennamenserver (DNS)</span><span class="sxs-lookup"><span data-stu-id="10b78-134">Domain Name System (DNS)</span></span>|<span data-ttu-id="10b78-135">Verwenden Sie dieses Element mit X.509-Zertifikaten oder Windows-Konten.</span><span class="sxs-lookup"><span data-stu-id="10b78-135">Use this element with X.509 certificates or Windows accounts.</span></span> <span data-ttu-id="10b78-136">Es vergleicht den in den Anmeldeinformationen angegebenen DNS-Namen mit dem in diesem Element angegebenen Wert.</span><span class="sxs-lookup"><span data-stu-id="10b78-136">It compares the DNS name specified in the credential with the value specified in this element.</span></span>|<span data-ttu-id="10b78-137">Eine DNS-Prüfung ermöglicht Ihnen, Zertifikate mit DNS- oder Antragstellernamen zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="10b78-137">A DNS check enables you to use certificates with DNS or subject names.</span></span> <span data-ttu-id="10b78-138">Wird ein Zertifikat erneut mit demselben DNS- oder Antragstellernamen ausgestellt, ist die Identitätsprüfung immer noch gültig.</span><span class="sxs-lookup"><span data-stu-id="10b78-138">If a certificate is reissued with the same DNS or subject name, then the identity check is still valid.</span></span> <span data-ttu-id="10b78-139">Bei der erneuten Ausstellung eines Zertifikats erhält es einen neuen RSA-Schlüssel, behält jedoch denselben DNS- oder Antragstellernamen.</span><span class="sxs-lookup"><span data-stu-id="10b78-139">When a certificate is reissued, it gets a new RSA key but retains the same DNS or subject name.</span></span> <span data-ttu-id="10b78-140">Dies bedeutet, dass Clients ihre Identitätsinformationen für den Dienst nicht aktualisieren müssen.</span><span class="sxs-lookup"><span data-stu-id="10b78-140">This means that clients do not have to update their identity information about the service.</span></span>|  
|<span data-ttu-id="10b78-141">Zertifikat</span><span class="sxs-lookup"><span data-stu-id="10b78-141">Certificate.</span></span> <span data-ttu-id="10b78-142">Der Standardwert, wenn `ClientCredentialType` auf Certificate festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="10b78-142">The default when `ClientCredentialType` is set to Certificate.</span></span>|<span data-ttu-id="10b78-143">Dieses Element gibt einen Base64-codierten X.509-Zertifikatswert für den Vergleich mit dem Client an.</span><span class="sxs-lookup"><span data-stu-id="10b78-143">This element specifies a Base64-encoded X.509 certificate value to compare with the client.</span></span><br /><br /> <span data-ttu-id="10b78-144">Verwenden Sie dieses Element auch, wenn Sie einen CardSpace als Anmelde Informationen verwenden, um den Dienst zu authentifizieren.</span><span class="sxs-lookup"><span data-stu-id="10b78-144">Also use this element when using a CardSpace as a credential to authenticate the service.</span></span>|<span data-ttu-id="10b78-145">Dieses Element schränkt die Authentifizierung auf ein einziges Zertifikat ein, dessen Fingerabdruckwert für die Authentifizierung verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="10b78-145">This element restricts authentication to a single certificate based upon its thumbprint value.</span></span> <span data-ttu-id="10b78-146">Dies ermöglicht eine strengere Authentifizierung, da Fingerabdruckwerte eindeutig sind.</span><span class="sxs-lookup"><span data-stu-id="10b78-146">This enables stricter authentication because thumbprint values are unique.</span></span> <span data-ttu-id="10b78-147">Damit ist eine Einschränkung verbunden: Wird das Zertifikat mit dem gleichen Antragstellernamen erneut ausgestellt, hat es auch einen neuen Fingerabdruck.</span><span class="sxs-lookup"><span data-stu-id="10b78-147">This comes with one caveat: If the certificate is reissued with the same Subject name, it also has a new Thumbprint.</span></span> <span data-ttu-id="10b78-148">Daher können Clients den Dienst so lange nicht prüfen, bis der neue Fingerabdruck bekannt ist.</span><span class="sxs-lookup"><span data-stu-id="10b78-148">Therefore, clients are not able to validate the service unless the new thumbprint is known.</span></span> <span data-ttu-id="10b78-149">Weitere Informationen zum Ermitteln des Fingerabdrucks eines Zertifikats finden Sie unter Gewusst [wie: Abrufen des](how-to-retrieve-the-thumbprint-of-a-certificate.md)Fingerabdrucks eines Zertifikats.</span><span class="sxs-lookup"><span data-stu-id="10b78-149">For more information about finding a certificate's thumbprint, see [How to: Retrieve the Thumbprint of a Certificate](how-to-retrieve-the-thumbprint-of-a-certificate.md).</span></span>|  
|<span data-ttu-id="10b78-150">Zertifikatsverweis</span><span class="sxs-lookup"><span data-stu-id="10b78-150">Certificate Reference</span></span>|<span data-ttu-id="10b78-151">Identisch mit der vorher beschriebenen Zertifikatsoption.</span><span class="sxs-lookup"><span data-stu-id="10b78-151">Identical to the Certificate option described previously.</span></span> <span data-ttu-id="10b78-152">Jedoch erlaubt Ihnen dieses Element, einen Zertifikatsnamen und den Speicherort anzugeben, von dem das Zertifikat abgerufen werden kann.</span><span class="sxs-lookup"><span data-stu-id="10b78-152">However, this element enables you to specify a certificate name and store location from which to retrieve the certificate.</span></span>|<span data-ttu-id="10b78-153">Entspricht dem vorher beschriebenen Zertifikatsszenario.</span><span class="sxs-lookup"><span data-stu-id="10b78-153">Same as the Certificate scenario described previously.</span></span><br /><br /> <span data-ttu-id="10b78-154">Der Vorteil besteht darin, dass sich der Speicherort des Zertifikats ändern kann.</span><span class="sxs-lookup"><span data-stu-id="10b78-154">The benefit is that the certificate store location can change.</span></span>|  
|<span data-ttu-id="10b78-155">RSA</span><span class="sxs-lookup"><span data-stu-id="10b78-155">RSA</span></span>|<span data-ttu-id="10b78-156">Dieses Element gibt einen RSA-Schlüsselwert für den Vergleich mit dem Client an.</span><span class="sxs-lookup"><span data-stu-id="10b78-156">This element specifies an RSA key value to compare with the client.</span></span> <span data-ttu-id="10b78-157">Dies ist der Zertifikatsoption ähnlich, statt des Fingerabdrucks des Zertifikats wird jedoch dessen RSA-Schlüssel verwendet.</span><span class="sxs-lookup"><span data-stu-id="10b78-157">This is similar to the certificate option but rather than using the certificate's thumbprint, the certificate's RSA key is used instead.</span></span>|<span data-ttu-id="10b78-158">Eine RSA-Prüfung erlaubt Ihnen, die Authentifizierung speziell auf den RSA-Schlüssel eines einzigen Zertifikats zu beschränken.</span><span class="sxs-lookup"><span data-stu-id="10b78-158">An RSA check enables you to specifically restrict authentication to a single certificate based upon its RSA key.</span></span> <span data-ttu-id="10b78-159">Dies ermöglicht eine strengere Authentifizierung eines bestimmten RSA-Schlüssels auf Kosten des Diensts, der nicht mehr mit vorhandenen Clients zusammenarbeitet, wenn sich der RSA-Schlüsselwert ändert.</span><span class="sxs-lookup"><span data-stu-id="10b78-159">This enables stricter authentication of a specific RSA key at the expense of the service, which no longer works with existing clients if the RSA key value changes.</span></span>|  
|<span data-ttu-id="10b78-160">Benutzerprinzipalname (User Principal Name, UPN).</span><span class="sxs-lookup"><span data-stu-id="10b78-160">User principal name (UPN).</span></span> <span data-ttu-id="10b78-161">Der Standard, wenn `ClientCredentialType` auf Windows festgelegt ist und der Dienstprozess nicht unter einem der Systemkonten ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="10b78-161">The default when the `ClientCredentialType` is set to Windows and the service process is not running under one of the system accounts.</span></span>|<span data-ttu-id="10b78-162">Dieses Element gibt den UPN an, unter dem der Dienst ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="10b78-162">This element specifies the UPN that the service is running under.</span></span> <span data-ttu-id="10b78-163">Weitere Informationen finden Sie im Abschnitt Kerberos-Protokoll und-Identität unter Überschreiben [der Identität eines Dienstanbieter für die Authentifizierung](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="10b78-163">See the Kerberos Protocol and Identity section of [Overriding the Identity of a Service for Authentication](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span></span>|<span data-ttu-id="10b78-164">Dies stellt sicher, dass der Dienst unter einem bestimmten Windows-Benutzerkonto ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="10b78-164">This ensures that the service is running under a specific Windows user account.</span></span> <span data-ttu-id="10b78-165">Das Benutzerkonto kann entweder das des momentan angemeldeten Benutzers sein, oder der des Diensts, der unter einem bestimmten Benutzerkonto ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="10b78-165">The user account can be either the current logged-on user or the service running under a particular user account.</span></span><br /><br /> <span data-ttu-id="10b78-166">Diese Einstellung nutzt die Vorteile der Kerberos-Sicherheit von Windows, wenn der Dienst unter einem Domänenkonto in einer Active Directory-Umgebung ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="10b78-166">This setting takes advantage of Windows Kerberos security if the service is running under a domain account within an Active Directory environment.</span></span>|  
|<span data-ttu-id="10b78-167">Dienstprinzipalname (Service Principal Name, SPN)</span><span class="sxs-lookup"><span data-stu-id="10b78-167">Service principal name (SPN).</span></span> <span data-ttu-id="10b78-168">Der Standard, wenn `ClientCredentialType` auf Windows festgelegt ist und der Dienstprozess unter einem der Systemkonten &#8211; LocalService, LocalSystem oder NetworkService &#8211; ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="10b78-168">The default when the `ClientCredentialType` is set to Windows and the service process is running under one of the system accounts—LocalService, LocalSystem, or NetworkService.</span></span>|<span data-ttu-id="10b78-169">Dieses Element gibt den dem Konto des Diensts zugeordneten SPN an.</span><span class="sxs-lookup"><span data-stu-id="10b78-169">This element specifies the SPN associated with the service's account.</span></span> <span data-ttu-id="10b78-170">Weitere Informationen finden Sie im Abschnitt Kerberos-Protokoll und-Identität unter Überschreiben [der Identität eines Dienstanbieter für die Authentifizierung](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="10b78-170">See the Kerberos Protocol and Identity section of [Overriding the Identity of a Service for Authentication](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span></span>|<span data-ttu-id="10b78-171">Dies stellt sicher, dass der SPN und das bestimmte, dem SPN zugeordnete Windows-Konto den Dienst identifizieren.</span><span class="sxs-lookup"><span data-stu-id="10b78-171">This ensures that the SPN and the specific Windows account associated with the SPN identify the service.</span></span><br /><br /> <span data-ttu-id="10b78-172">Sie können das Tool Setspn.exe verwenden, um ein Computerkonto dem Benutzerkonto des Diensts zuzuordnen.</span><span class="sxs-lookup"><span data-stu-id="10b78-172">You can use the Setspn.exe tool to associate a machine account for the service's user account.</span></span><br /><br /> <span data-ttu-id="10b78-173">Diese Einstellung nutzt die Vorteile der Kerberos-Sicherheit von Windows, wenn der Dienst unter einem der Systemkonten oder unter einem Domänenkonto ausgeführt wird, dem ein SPN-Name zugeordnet ist, und der Computer Mitglied einer Domäne in einer Active Directory-Umgebung ist.</span><span class="sxs-lookup"><span data-stu-id="10b78-173">This setting takes advantage of Windows Kerberos security if the service is running under one of the system accounts or under a domain account that has an associated SPN name with it and the computer is a member of a domain within an Active Directory environment.</span></span>|  
  
## <a name="specifying-identity-at-the-service"></a><span data-ttu-id="10b78-174">Angeben der Identität für einen Dienst</span><span class="sxs-lookup"><span data-stu-id="10b78-174">Specifying Identity at the Service</span></span>  
 <span data-ttu-id="10b78-175">In der Regel müssen Sie die Identität für einen Dienst nicht festlegen, da die Auswahl eines Clientanmeldeinformationstyps über den in den Dienstmetadaten angezeigten Identitätstyp entscheidet.</span><span class="sxs-lookup"><span data-stu-id="10b78-175">Typically, you do not have to set the identity on a service because the selection of a client credential type dictates the type of identity exposed in the service metadata.</span></span> <span data-ttu-id="10b78-176">Weitere Informationen zum Überschreiben oder angeben der Dienst Identität finden Sie unter Überschreiben [der Identität eines Dienstanbieter für die Authentifizierung](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="10b78-176">For more information about how to override or specify service identity, see [Overriding the Identity of a Service for Authentication](../extending/overriding-the-identity-of-a-service-for-authentication.md).</span></span>  
  
## <a name="using-the-identity-element-in-configuration"></a><span data-ttu-id="10b78-177">Verwenden des- \<identity> Elements in der Konfiguration</span><span class="sxs-lookup"><span data-stu-id="10b78-177">Using the \<identity> Element in Configuration</span></span>  
 <span data-ttu-id="10b78-178">Wenn Sie den Clientanmeldeinformationstyp in der zuvor gezeigten Bindung in `Certificate,` ändern, enthält die generierte WSDL ein serialisiertes Base64-X.509-Zertifikat als Identitätswert, wie im folgenden Code gezeigt.</span><span class="sxs-lookup"><span data-stu-id="10b78-178">If you change the client credential type in the binding previously shown to `Certificate,` then the generated WSDL contains a Base64 serialized X.509 certificate for the identity value as shown in the following code.</span></span> <span data-ttu-id="10b78-179">Dies ist der Standard für alle Clientanmeldeinformationstypen außer Windows.</span><span class="sxs-lookup"><span data-stu-id="10b78-179">This is the default for all client credential types other than Windows.</span></span>  

 <span data-ttu-id="10b78-180">Sie können den Wert der Standard Dienst Identität ändern oder den Typ der Identität ändern, indem Sie das- `<identity>` Element in der Konfiguration verwenden oder die Identität im Code festlegen.</span><span class="sxs-lookup"><span data-stu-id="10b78-180">You can change the value of the default service identity or change the type of the identity by using the `<identity>` element in configuration or by setting the identity in code.</span></span> <span data-ttu-id="10b78-181">Der folgende Konfigurationscode legt eine DNS-Identität (Domain Name System) mit dem Wert `contoso.com` fest.</span><span class="sxs-lookup"><span data-stu-id="10b78-181">The following configuration code sets a domain name system (DNS) identity with the value `contoso.com`.</span></span>  

## <a name="setting-identity-programmatically"></a><span data-ttu-id="10b78-182">Programmgesteuertes Festlegen der Identität</span><span class="sxs-lookup"><span data-stu-id="10b78-182">Setting Identity Programmatically</span></span>  
 <span data-ttu-id="10b78-183">Ihr Dienst muss eine Identität nicht explizit angeben, da Sie von WCF automatisch bestimmt wird.</span><span class="sxs-lookup"><span data-stu-id="10b78-183">Your service does not have to explicitly specify an identity, because WCF automatically determines it.</span></span> <span data-ttu-id="10b78-184">WCF ermöglicht es Ihnen jedoch, eine Identität für einen Endpunkt anzugeben, falls dies erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="10b78-184">However, WCF allows you to specify an identity on an endpoint, if required.</span></span> <span data-ttu-id="10b78-185">Mit dem folgenden Code wird ein neuer Dienstendpunkt mit einer bestimmten DNS-Identität hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="10b78-185">The following code adds a new service endpoint with a specific DNS identity.</span></span>  
  
 [!code-csharp[C_Identity#5](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_identity/cs/source.cs#5)]
 [!code-vb[C_Identity#5](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_identity/vb/source.vb#5)]  
  
## <a name="specifying-identity-at-the-client"></a><span data-ttu-id="10b78-186">Angeben der Identität für einen Client</span><span class="sxs-lookup"><span data-stu-id="10b78-186">Specifying Identity at the Client</span></span>  
 <span data-ttu-id="10b78-187">Zur Entwurfszeit verwendet ein Client Entwickler in der Regel das [Service Model Metadata Utility-Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md) , um die Client Konfiguration zu generieren.</span><span class="sxs-lookup"><span data-stu-id="10b78-187">At design time, a client developer typically uses the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md) to generate client configuration.</span></span> <span data-ttu-id="10b78-188">Die generierte Konfigurationsdatei (vorgesehen für die Verwendung durch den Client) enthält die Identität des Servers.</span><span class="sxs-lookup"><span data-stu-id="10b78-188">The generated configuration file (intended for use by the client) contains the server's identity.</span></span> <span data-ttu-id="10b78-189">Der folgende Code wurde z.&#160;B. von einem Dienst generiert, der eine DNS-Identität angibt, wie im vorangehenden Beispiel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="10b78-189">For example, the following code is generated from a service that specifies a DNS identity, as shown in the preceding example.</span></span> <span data-ttu-id="10b78-190">Beachten Sie, dass der Endpunktidentitätswert des Clients dem des Diensts entspricht.</span><span class="sxs-lookup"><span data-stu-id="10b78-190">Note that the client's endpoint identity value matches that of the service.</span></span> <span data-ttu-id="10b78-191">Wenn in diesem Fall der Client die Windows (Kerberos)-Anmeldeinformationen für den Dienst erhält, erwartet er den Wert `contoso.com`.</span><span class="sxs-lookup"><span data-stu-id="10b78-191">In this case, when the client receives the Windows (Kerberos) credentials for the service, it expects the value to be `contoso.com`.</span></span>  

 <span data-ttu-id="10b78-192">Wenn der Dienst statt Windows ein Zertifikat als Clientanmeldeinformationstyp angibt, wird erwartet, dass die DNS-Eigenschaft des Zertifikats den Wert `contoso.com` hat.</span><span class="sxs-lookup"><span data-stu-id="10b78-192">If, instead of Windows, the service specifies a certificate as the client credential type, then the certificate's DNS property is expected to be the value `contoso.com`.</span></span> <span data-ttu-id="10b78-193">(Wenn aber die DNS-Eigenschaft den Wert `null` hat, muss der Antragstellername des Zertifikats `contoso.com` lauten.)</span><span class="sxs-lookup"><span data-stu-id="10b78-193">(Or if the DNS property is `null`, the certificate's subject name must be `contoso.com`.)</span></span>  
  
#### <a name="using-a-specific-value-for-identity"></a><span data-ttu-id="10b78-194">Verwenden eines bestimmten Werts für die Identität</span><span class="sxs-lookup"><span data-stu-id="10b78-194">Using a Specific Value for Identity</span></span>  
 <span data-ttu-id="10b78-195">Die folgende Clientkonfigurationsdatei zeigt, wie erwartet wird, dass die Identität des Diensts ein bestimmter Wert ist.</span><span class="sxs-lookup"><span data-stu-id="10b78-195">The following client configuration file shows how the service's identity is expected to be a specific value.</span></span> <span data-ttu-id="10b78-196">Im folgenden Beispiel kann der Client mit zwei Endpunkten kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="10b78-196">In the following example, the client can communicate with two endpoints.</span></span> <span data-ttu-id="10b78-197">Das erste wird mit einem Zertifikatsfingerabdruck, der zweite mit dem RSA-Schlüssel eines Zertifikats identifiziert.</span><span class="sxs-lookup"><span data-stu-id="10b78-197">The first is identified with a certificate thumbprint and the second with a certificate RSA key.</span></span> <span data-ttu-id="10b78-198">Somit also durch ein Zertifikat, das nur ein privates/öffentliches Schlüsselpaar enthält, jedoch nicht von einer vertrauenswürdige Stelle ausgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="10b78-198">That is, a certificate that contains only a public key/private key pair, but is not issued by a trusted authority.</span></span>  

## <a name="identity-checking-at-run-time"></a><span data-ttu-id="10b78-199">Identitätsprüfung zur Laufzeit</span><span class="sxs-lookup"><span data-stu-id="10b78-199">Identity Checking at Run Time</span></span>  
 <span data-ttu-id="10b78-200">Zur Entwurfszeit bestimmt ein Cliententwickler die Identität des Servers durch dessen Metadaten.</span><span class="sxs-lookup"><span data-stu-id="10b78-200">At design time, a client developer determines the server's identity through its metadata.</span></span> <span data-ttu-id="10b78-201">Zur Laufzeit wird die Identitätsprüfung ausgeführt, bevor irgendwelche Endpunkte auf dem Dienst aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="10b78-201">At runtime, the identity check is performed before calling any endpoints on the service.</span></span>  
  
 <span data-ttu-id="10b78-202">Der Identitätswert ist an den von den Metadaten angegebenen Typ der Authentifizierung gebunden, mit anderen Worten, an den Typ der für den Dienst verwendeten Anmeldeinformationen.</span><span class="sxs-lookup"><span data-stu-id="10b78-202">The identity value is tied to the type of authentication specified by metadata; in other words, the type of credentials used for the service.</span></span>  
  
 <span data-ttu-id="10b78-203">Ist der Kanal für die Authentifizierung mithilfe von Secure Sockets Layer (SSL) auf Nachrichten- oder auf Transportebene mit X.509-Zertifikaten für die Authentifizierung konfiguriert, sind die folgenden Identitätswerte gültig:</span><span class="sxs-lookup"><span data-stu-id="10b78-203">If the channel is configured to authenticate using message- or transport-level Secure Sockets Layer (SSL) with X.509 certificates for authentication, the following identity values are valid:</span></span>  
  
- <span data-ttu-id="10b78-204">DNS</span><span class="sxs-lookup"><span data-stu-id="10b78-204">DNS.</span></span> <span data-ttu-id="10b78-205">WCF stellt sicher, dass das während des SSL-Handshakes bereitgestellte Zertifikat ein DNS-oder `CommonName` (CN)-Attribut enthält, das dem in der DNS-Identität auf dem Client angegebenen Wert entspricht.</span><span class="sxs-lookup"><span data-stu-id="10b78-205">WCF ensures that the certificate provided during the SSL handshake contains a DNS or `CommonName` (CN) attribute equal to the value specified in the DNS identity on the client.</span></span> <span data-ttu-id="10b78-206">Beachten Sie, dass diese Prüfungen zusätzlich zur Bestimmung der Gültigkeit des Serverzertifikats ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="10b78-206">Note that these checks are done in addition to determining the validity of the server certificate.</span></span> <span data-ttu-id="10b78-207">Standardmäßig überprüft WCF, ob das Serverzertifikat von einer vertrauenswürdigen Stamm Zertifizierungsstelle ausgestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="10b78-207">By default, WCF validates that the server certificate is issued by a trusted root authority.</span></span>  
  
- <span data-ttu-id="10b78-208">Zertifikat</span><span class="sxs-lookup"><span data-stu-id="10b78-208">Certificate.</span></span> <span data-ttu-id="10b78-209">Während des SSL-Handshakes stellt WCF sicher, dass der Remote Endpunkt genau den in der Identität angegebenen Zertifikat Wert bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="10b78-209">During the SSL handshake, WCF ensures that the remote endpoint provides the exact certificate value specified in the identity.</span></span>  
  
- <span data-ttu-id="10b78-210">Zertifikatsverweis.</span><span class="sxs-lookup"><span data-stu-id="10b78-210">Certificate Reference.</span></span> <span data-ttu-id="10b78-211">Ebenso wie Zertifikat.</span><span class="sxs-lookup"><span data-stu-id="10b78-211">Same as Certificate.</span></span>  
  
- <span data-ttu-id="10b78-212">RSA.</span><span class="sxs-lookup"><span data-stu-id="10b78-212">RSA.</span></span> <span data-ttu-id="10b78-213">Während des SSL-Handshakes stellt WCF sicher, dass der Remote Endpunkt genau den in der Identität angegebenen RSA-Schlüssel bereitstellt.</span><span class="sxs-lookup"><span data-stu-id="10b78-213">During the SSL handshake, WCF ensures that the remote endpoint provides the exact RSA key specified in the identity.</span></span>  
  
 <span data-ttu-id="10b78-214">Authentifiziert der Dienst mithilfe von SSL auf Nachrichten- oder auf Transportebene mit Windows-Anmeldeinformationen und handelt er die Anmeldeinformationen aus, sind die folgenden Identitätswerte gültig:</span><span class="sxs-lookup"><span data-stu-id="10b78-214">If the service authenticates using message- or transport-level SSL with a Windows credential for authentication, and negotiates the credential, the following identity values are valid:</span></span>  
  
- <span data-ttu-id="10b78-215">DNS</span><span class="sxs-lookup"><span data-stu-id="10b78-215">DNS.</span></span> <span data-ttu-id="10b78-216">Die Aushandlung übergibt den SPN des Diensts, damit der DNS-Name überprüft werden kann.</span><span class="sxs-lookup"><span data-stu-id="10b78-216">The negotiation passes the service's SPN so that the DNS name can be checked.</span></span> <span data-ttu-id="10b78-217">Der SPN hat die Form `host/<dns name>`.</span><span class="sxs-lookup"><span data-stu-id="10b78-217">The SPN is in the form `host/<dns name>`.</span></span>  
  
- <span data-ttu-id="10b78-218">SPN.</span><span class="sxs-lookup"><span data-stu-id="10b78-218">SPN.</span></span> <span data-ttu-id="10b78-219">Ein expliziter Dienst-SPN wird zurückgegeben, z.&#160;B. `host/myservice`.</span><span class="sxs-lookup"><span data-stu-id="10b78-219">An explicit service SPN is returned, for example, `host/myservice`.</span></span>  
  
- <span data-ttu-id="10b78-220">UPN.</span><span class="sxs-lookup"><span data-stu-id="10b78-220">UPN.</span></span> <span data-ttu-id="10b78-221">Der UPN des Dienstkontos.</span><span class="sxs-lookup"><span data-stu-id="10b78-221">The UPN of the service account.</span></span> <span data-ttu-id="10b78-222">Der UPN weist das Format auf `username` @ `domain` .</span><span class="sxs-lookup"><span data-stu-id="10b78-222">The UPN is in the form `username`@`domain`.</span></span> <span data-ttu-id="10b78-223">Wenn der Dienst z.&#160;B. mit einem Benutzerkonto ausgeführt wird, kann dies `username@contoso.com` sein.</span><span class="sxs-lookup"><span data-stu-id="10b78-223">For example, when the service is running in a user account, it may be `username@contoso.com`.</span></span>  
  
 <span data-ttu-id="10b78-224">Die programmgesteuerte Angabe der Identität (mithilfe der <xref:System.ServiceModel.EndpointAddress.Identity%2A>-Eigenschaft) ist optional.</span><span class="sxs-lookup"><span data-stu-id="10b78-224">Specifying the identity programmatically (using the <xref:System.ServiceModel.EndpointAddress.Identity%2A> property) is optional.</span></span> <span data-ttu-id="10b78-225">Wird keine Identität angegeben, und der Clientanmeldeinformationstyp ist Windows, wird als Standard ein SPN verwendet, dessen Wert auf den Hostnamen der Dienstendpunktadresse festgelegt ist, wobei dem Hostnamen das Zeichenfolgenliteral "host/" vorangestellt wird.</span><span class="sxs-lookup"><span data-stu-id="10b78-225">If no identity is specified, and the client credential type is Windows, the default is SPN with the value set to the hostname part of the service endpoint address prefixed with the "host/" literal.</span></span> <span data-ttu-id="10b78-226">Wenn keine Identität angegeben wird, und der Clientanmeldeinformationstyp ist ein Zertifikat, ist `Certificate` der Standard.</span><span class="sxs-lookup"><span data-stu-id="10b78-226">If no identity is specified, and the client credential type is a certificate, the default is `Certificate`.</span></span> <span data-ttu-id="10b78-227">Dies bezieht sich auf die Sicherheit sowohl auf der Nachrichtenebene als auch auf der Transportebene.</span><span class="sxs-lookup"><span data-stu-id="10b78-227">This applies to both message- and transport-level security.</span></span>  
  
## <a name="identity-and-custom-bindings"></a><span data-ttu-id="10b78-228">Identität und benutzerdefinierte Bindungen</span><span class="sxs-lookup"><span data-stu-id="10b78-228">Identity and Custom Bindings</span></span>  
 <span data-ttu-id="10b78-229">Da die Identität eines Diensts von dem verwendeten Bindungstyp abhängt, müssen Sie sicherstellen, dass bei der Erstellung einer benutzerdefinierten Bindung eine entsprechende Identität verfügbar gemacht wird.</span><span class="sxs-lookup"><span data-stu-id="10b78-229">Because the identity of a service depends on the binding type used, ensure that an appropriate identity is exposed when creating a custom binding.</span></span> <span data-ttu-id="10b78-230">Im folgenden Codebeispiel ist die verfügbar gemachte Identität z.&#160;B. nicht kompatibel mit dem Sicherheitstyp, weil die Identität für die sichere Konversations-Bootstrapbindung nicht mit der Identität für die Bindung am Endpunkt übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="10b78-230">For example, in the following code example, the identity exposed is not compatible with the security type, because the identity for the secure conversation bootstrap binding does not match the identity for the binding on the endpoint.</span></span> <span data-ttu-id="10b78-231">Die sicheren Konversationsbindung legt die DNS-Identität fest, während das <xref:System.ServiceModel.Channels.WindowsStreamSecurityBindingElement> die UPN- oder SPN-Identität festlegt.</span><span class="sxs-lookup"><span data-stu-id="10b78-231">The secure conversation binding sets the DNS identity, while the <xref:System.ServiceModel.Channels.WindowsStreamSecurityBindingElement> sets the UPN or SPN identity.</span></span>  
  
 [!code-csharp[C_Identity#8](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_identity/cs/source.cs#8)]
 [!code-vb[C_Identity#8](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_identity/vb/source.vb#8)]  
  
 <span data-ttu-id="10b78-232">Weitere Informationen zum ordnungsgemäßen Stapeln von Bindungs Elementen für eine benutzerdefinierte Bindung finden Sie unter [Erstellen benutzerdefinierter Bindungen](../extending/creating-user-defined-bindings.md).</span><span class="sxs-lookup"><span data-stu-id="10b78-232">For more information about how to stack binding elements correctly for a custom binding, see [Creating User-Defined Bindings](../extending/creating-user-defined-bindings.md).</span></span> <span data-ttu-id="10b78-233">Weitere Informationen zum Erstellen einer benutzerdefinierten Bindung mit <xref:System.ServiceModel.Channels.SecurityBindingElement> finden Sie unter Gewusst [wie: Erstellen eines SecurityBindingElement für einen angegebenen Authentifizierungsmodus](how-to-create-a-securitybindingelement-for-a-specified-authentication-mode.md).</span><span class="sxs-lookup"><span data-stu-id="10b78-233">For more information about creating a custom binding with the <xref:System.ServiceModel.Channels.SecurityBindingElement>, see [How to: Create a SecurityBindingElement for a Specified Authentication Mode](how-to-create-a-securitybindingelement-for-a-specified-authentication-mode.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="10b78-234">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="10b78-234">See also</span></span>

- [<span data-ttu-id="10b78-235">Vorgehensweise: Erstellen einer benutzerdefinierten Bindung mit dem SecurityBindingElement</span><span class="sxs-lookup"><span data-stu-id="10b78-235">How to: Create a Custom Binding Using the SecurityBindingElement</span></span>](how-to-create-a-custom-binding-using-the-securitybindingelement.md)
- [<span data-ttu-id="10b78-236">Vorgehensweise: Erstellen eines SecurityBindingElement für einen angegebenen Authentifizierungsmodus</span><span class="sxs-lookup"><span data-stu-id="10b78-236">How to: Create a SecurityBindingElement for a Specified Authentication Mode</span></span>](how-to-create-a-securitybindingelement-for-a-specified-authentication-mode.md)
- [<span data-ttu-id="10b78-237">Vorgehensweise: Erstellen einer benutzerdefinierten Clientidentitätsüberprüfung</span><span class="sxs-lookup"><span data-stu-id="10b78-237">How to: Create a Custom Client Identity Verifier</span></span>](../extending/how-to-create-a-custom-client-identity-verifier.md)
- [<span data-ttu-id="10b78-238">Wählen eines Typs von Anmeldeinformationen</span><span class="sxs-lookup"><span data-stu-id="10b78-238">Selecting a Credential Type</span></span>](selecting-a-credential-type.md)
- [<span data-ttu-id="10b78-239">Verwenden von Zertifikaten</span><span class="sxs-lookup"><span data-stu-id="10b78-239">Working with Certificates</span></span>](working-with-certificates.md)
- [<span data-ttu-id="10b78-240">ServiceModel Metadata Utility-Tool (Svcutil.exe)</span><span class="sxs-lookup"><span data-stu-id="10b78-240">ServiceModel Metadata Utility Tool (Svcutil.exe)</span></span>](../servicemodel-metadata-utility-tool-svcutil-exe.md)
- [<span data-ttu-id="10b78-241">Erstellen benutzerdefinierter Bindungen</span><span class="sxs-lookup"><span data-stu-id="10b78-241">Creating User-Defined Bindings</span></span>](../extending/creating-user-defined-bindings.md)
- [<span data-ttu-id="10b78-242">Vorgehensweise: Abrufen des Fingerabdrucks eines Zertifikats</span><span class="sxs-lookup"><span data-stu-id="10b78-242">How to: Retrieve the Thumbprint of a Certificate</span></span>](how-to-retrieve-the-thumbprint-of-a-certificate.md)
