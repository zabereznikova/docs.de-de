---
title: Sicherheitsaspekte für Nachrichtenprotokollierung
ms.date: 03/30/2017
ms.assetid: 21f513f2-815b-47f3-85a6-03c008510038
ms.openlocfilehash: 8594329fb27aa1d77a2baffee2a7e37ea0d009c4
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/26/2020
ms.locfileid: "96283769"
---
# <a name="security-concerns-for-message-logging"></a><span data-ttu-id="1c651-102">Sicherheitsaspekte für Nachrichtenprotokollierung</span><span class="sxs-lookup"><span data-stu-id="1c651-102">Security Concerns for Message Logging</span></span>

<span data-ttu-id="1c651-103">In diesem Thema wird beschrieben, wie Sie vertrauliche Daten davor schützen, in Nachrichtenprotokollen verfügbar gemacht zu werden, wie auch Ereignisse, die von der Nachrichtenprotokollierung generiert werden.</span><span class="sxs-lookup"><span data-stu-id="1c651-103">This topic describes how you can protect sensitive data from being exposed in message logs, as well as events generated by message logging.</span></span>  
  
## <a name="security-concerns"></a><span data-ttu-id="1c651-104">Sicherheitsaspekte</span><span class="sxs-lookup"><span data-stu-id="1c651-104">Security Concerns</span></span>  
  
### <a name="logging-sensitive-information"></a><span data-ttu-id="1c651-105">Protokollieren vertraulicher Informationen</span><span class="sxs-lookup"><span data-stu-id="1c651-105">Logging Sensitive Information</span></span>  

 <span data-ttu-id="1c651-106">Windows Communication Foundation (WCF) ändert keine Daten in anwendungsspezifischen Headern und Text.</span><span class="sxs-lookup"><span data-stu-id="1c651-106">Windows Communication Foundation (WCF) does not modify any data in application-specific headers and body.</span></span> <span data-ttu-id="1c651-107">WCF verfolgt auch keine persönlichen Informationen in anwendungsspezifischen Headern oder Textdaten nach.</span><span class="sxs-lookup"><span data-stu-id="1c651-107">WCF also does not track personal information in application-specific headers or body data.</span></span>  
  
 <span data-ttu-id="1c651-108">Bei aktivierter Nachrichtenprotokollierung sind persönliche Informationen in anwendungsspezifischen Headern, wie z. B. eine Abfragezeichenfolge, und Textdaten, wie z. B. eine Kreditkartennummer, u. U. in den Protokollen sichtbar.</span><span class="sxs-lookup"><span data-stu-id="1c651-108">When message logging is enabled, personal information in application-specific headers, such as, a query string; and body information, such as, a credit card number, can become visible in the logs.</span></span> <span data-ttu-id="1c651-109">Der Anwendungsbereitsteller ist für das Erzwingen einer Zugriffssteuerung für die Konfigurations- und Protokolldateien verantwortlich.</span><span class="sxs-lookup"><span data-stu-id="1c651-109">The application deployer is responsible for enforcing access control on the configuration and log files.</span></span> <span data-ttu-id="1c651-110">Wenn Informationen dieser Art nicht sichtbar sein sollen, sollten Sie die Protokollierung deaktivieren, oder filtern Sie einen Teil der Daten heraus, wenn Sie die Protokolle freigeben möchten.</span><span class="sxs-lookup"><span data-stu-id="1c651-110">If you do not want this kind of information to be visible, you should disable logging, or filter out part of the data if you want to share the logs.</span></span>  
  
 <span data-ttu-id="1c651-111">Mithilfe der folgenden Tipps können Sie verhindern, dass der Inhalt einer Protokolldatei unbeabsichtigt verfügbar gemacht wird:</span><span class="sxs-lookup"><span data-stu-id="1c651-111">The following tips can help you to prevent the content of a log file from being exposed unintentionally:</span></span>  
  
- <span data-ttu-id="1c651-112">Stellen Sie sicher, dass die Protokolldateien durch Access Control Lists (ACL oder Zugriffssteuerungslisten) sowohl bei im Internet gehosteten als auch bei selbst gehosteten Szenarien geschützt werden.</span><span class="sxs-lookup"><span data-stu-id="1c651-112">Ensure that the log files are protected by Access Control Lists (ACL) both in Web-host and self-host scenarios.</span></span>  
  
- <span data-ttu-id="1c651-113">Wählen Sie eine Dateierweiterung aus, die nicht leicht mit einer Webanforderung ausgegeben werden kann.</span><span class="sxs-lookup"><span data-stu-id="1c651-113">Choose a file extension that cannot be easily served using a Web request.</span></span> <span data-ttu-id="1c651-114">Die Dateierweiterung .xml ist z. B. nicht sicher.</span><span class="sxs-lookup"><span data-stu-id="1c651-114">For example, the .xml file extension is not a safe choice.</span></span> <span data-ttu-id="1c651-115">Sie finden im Administratorhandbuch von IIS (Internet Information Services) eine Liste aller Erweiterungen, die bereitgestellt werden können.</span><span class="sxs-lookup"><span data-stu-id="1c651-115">You can check the Internet Information Services (IIS) administration guide to see a list of extensions that can be served.</span></span>  
  
- <span data-ttu-id="1c651-116">Geben Sie einen absoluten Pfad für den Protokolldateispeicherort an, der sich außerhalb des öffentlichen vroot-Verzeichnisses des Webhosts befinden sollte, um einen Zugriff von externer Seite mithilfe eines Webbrowsers zu verhindern.</span><span class="sxs-lookup"><span data-stu-id="1c651-116">Specify an absolute path for the log file location, which should be outside of the Web host vroot public directory to prevent it from being accessed by an external party using a Web browser.</span></span>  
  
 <span data-ttu-id="1c651-117">Standardmäßig werden Schlüssel und personenbezogene Informationen (PII, personally identifiable information), wie z. B. Benutzername und Passwort, nicht in Ablaufverfolgungen und protokollierten Nachrichten protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1c651-117">By default, keys and personally identifiable information (PII) such as username and password are not logged in traces and logged messages.</span></span> <span data-ttu-id="1c651-118">Ein Computeradministrator kann jedoch das `enableLoggingKnownPII`-Attribut im `machineSettings`-Element der Datei Machine.config verwenden, um Anwendungen, die auf dem Computer ausgeführt werden, das Protokollieren personenbezogener Informationen (PII) zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="1c651-118">A machine administrator, however, can use the `enableLoggingKnownPII` attribute in the `machineSettings` element of the Machine.config file to permit applications running on the machine to log known personally identifiable information (PII).</span></span> <span data-ttu-id="1c651-119">Die folgende Konfiguration veranschaulicht diesen Vorgang:</span><span class="sxs-lookup"><span data-stu-id="1c651-119">The following configuration demonstrates how to do this:</span></span>  
  
```xml  
<configuration>  
   <system.serviceModel>  
      <machineSettings enableLoggingKnownPii="true"/>  
   </system.serviceModel>  
</configuration>
```  
  
 <span data-ttu-id="1c651-120">Ein Anwendungsbereitsteller kann daraufhin das `logKnownPii`-Attribut entweder in der Datei App.config oder in der Datei Web.config verwenden, um die PII-Protokollierung wie folgt zu ermöglichen:</span><span class="sxs-lookup"><span data-stu-id="1c651-120">An application deployer can then use the `logKnownPii` attribute in either the App.config or Web.config file to enable PII logging as follows:</span></span>  
  
```xml  
<system.diagnostics>  
  <sources>  
      <source name="System.ServiceModel.MessageLogging"  
        logKnownPii="true">  
        <listeners>  
                 <add name="messages"  
                 type="System.Diagnostics.XmlWriterTraceListener"  
                 initializeData="c:\logs\messages.svclog" />  
          </listeners>  
      </source>  
    </sources>  
</system.diagnostics>  
```  
  
 <span data-ttu-id="1c651-121">Nur wenn beide Einstellungen auf `true` festgelegt sind, wird die PII-Protokollierung aktiviert.</span><span class="sxs-lookup"><span data-stu-id="1c651-121">Only when both settings are `true` is PII logging enabled.</span></span> <span data-ttu-id="1c651-122">Die Kombination von zwei Schaltern ermöglicht, bekannte PII für jede Anwendung zu protokollieren.</span><span class="sxs-lookup"><span data-stu-id="1c651-122">The combination of two switches allows the flexibility to log known PII for each application.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="1c651-123">In [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] müssen das `logEntireMessage`-Flag und das `logKnownPii`-Flag in der Datei Web.config oder der Datei App.config auch auf `true` festgelegt werden, um die PII-Protokollierung zu ermöglichen, wie im folgenden Beispiel gezeigt: `<system.serviceModel><messageLogging logEntireMessage="true" logKnownPii="true" …`.</span><span class="sxs-lookup"><span data-stu-id="1c651-123">In [!INCLUDE[netfx_current_long](../../../../includes/netfx-current-long-md.md)] the `logEntireMessage` and `logKnownPii` flags must also be set to `true` in the Web.config file or the App.config file to enable PII logging, as show in the following example `<system.serviceModel><messageLogging logEntireMessage="true" logKnownPii="true" …`.</span></span>  
  
 <span data-ttu-id="1c651-124">Sie müssen berücksichtigen, dass nur die Attribute der ersten Quelle gelesen werden, wenn Sie zwei oder mehr benutzerdefinierte Quellen in einer Konfigurationsdatei angeben.</span><span class="sxs-lookup"><span data-stu-id="1c651-124">You should be aware that if you specify two or more custom sources in a configuration file, only the attributes of the first source are read.</span></span> <span data-ttu-id="1c651-125">Die anderen werden ignoriert.</span><span class="sxs-lookup"><span data-stu-id="1c651-125">The others are ignored.</span></span> <span data-ttu-id="1c651-126">Dies bedeutet, dass PII für die folgende Datei App.config nicht für beide Quellen protokolliert wird, obwohl die PII-Protokollierung explizit für die zweite Quelle aktiviert worden ist.</span><span class="sxs-lookup"><span data-stu-id="1c651-126">This means that, for the following App.config, file, PII is not logged for both sources even though PII logging is explicitly enabled for the second source.</span></span>  
  
```xml  
<system.diagnostics>  
   <sources>  
      <source name="System.ServiceModel.MessageLogging"  
              logKnownPii="false">  
              <listeners>  
                 <add name="messages"  
                      type="System.Diagnostics.XmlWriterTraceListener"  
                      initializeData="c:\logs\messages.svclog" />  
              </listeners>  
            </source>  
      <source name="System.ServiceModel"
              logKnownPii="true">  
              <listeners>  
                 <add name="traces"  
                      type="System.Diagnostics.XmlWriterTraceListener"  
                      initializeData="c:\logs\traces.svclog" />  
              </listeners>  
      </source>  
   </sources>  
</system.diagnostics>  
```  
  
 <span data-ttu-id="1c651-127">Wenn das `<machineSettings enableLoggingKnownPii="Boolean"/>`-Element außerhalb der Datei Machine.config vorhanden ist, löst das System einen <xref:System.Configuration.ConfigurationErrorsException> aus.</span><span class="sxs-lookup"><span data-stu-id="1c651-127">If the `<machineSettings enableLoggingKnownPii="Boolean"/>` element exists outside the Machine.config file, the system throws a <xref:System.Configuration.ConfigurationErrorsException>.</span></span>  
  
 <span data-ttu-id="1c651-128">Die Änderungen sind nur wirksam, wenn die Anwendung gestartet oder neu gestartet wird.</span><span class="sxs-lookup"><span data-stu-id="1c651-128">The changes are effective only when the application starts or restarts.</span></span> <span data-ttu-id="1c651-129">Ein Ereignis wird beim Start protokolliert, wenn beide Attribute auf `true` festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="1c651-129">An event is logged at startup when both attributes are set to `true`.</span></span> <span data-ttu-id="1c651-130">Ein Ereignis wird außerdem protokolliert, wenn `logKnownPii` auf `true` festgelegt wird, `enableLoggingKnownPii` jedoch `false` ist.</span><span class="sxs-lookup"><span data-stu-id="1c651-130">An event is also logged if `logKnownPii` is set to `true` but `enableLoggingKnownPii` is `false`.</span></span>  
  
 <span data-ttu-id="1c651-131">Der Computeradministrator und der Anwendungsbereitsteller sollten diese beiden Schalter mit großer Vorsicht verwenden.</span><span class="sxs-lookup"><span data-stu-id="1c651-131">The machine administrator and application deployer should exercise extreme caution when using these two switches.</span></span> <span data-ttu-id="1c651-132">Wenn die PII-Protokollierung aktiviert ist, werden Sicherheitsschlüssel und PII protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1c651-132">If PII logging is enabled, security keys and PII are logged.</span></span> <span data-ttu-id="1c651-133">Wenn sie deaktiviert ist, werden vertrauliche und anwendungsspezifische Daten immer noch in Nachrichtenheadern und -texten protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1c651-133">If it is disabled, sensitive and application-specific data is still logged in message headers and bodies.</span></span> <span data-ttu-id="1c651-134">Eine ausführlichere Erläuterung zum Datenschutz und zum Schutz von PII vor dem verfügbar machen finden Sie unter [Benutzerdaten Schutz](/previous-versions/dotnet/articles/aa480490(v=msdn.10)).</span><span class="sxs-lookup"><span data-stu-id="1c651-134">For a more thorough discussion about privacy and protecting PII from being exposed, see [User Privacy](/previous-versions/dotnet/articles/aa480490(v=msdn.10)).</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="1c651-135">PII wird nicht in falsch formatierten Nachrichten ausgeblendet.</span><span class="sxs-lookup"><span data-stu-id="1c651-135">PII is not hidden in malformed messages.</span></span> <span data-ttu-id="1c651-136">Solche Nachrichten werden ohne Änderung protokolliert.</span><span class="sxs-lookup"><span data-stu-id="1c651-136">Such messaged are logged as-is without any modification.</span></span> <span data-ttu-id="1c651-137">Vorher erwähnte Attribute haben keine Auswirkungen darauf.</span><span class="sxs-lookup"><span data-stu-id="1c651-137">Attributes mentioned previously have no effect on this.</span></span>  
  
### <a name="custom-trace-listener"></a><span data-ttu-id="1c651-138">Benutzerdefinierter Ablaufverfolgungslistener</span><span class="sxs-lookup"><span data-stu-id="1c651-138">Custom Trace Listener</span></span>  

 <span data-ttu-id="1c651-139">Das Hinzufügen eines benutzerdefinierten Ablaufverfolgungslisteners auf eine Ablaufverfolgungsquelle für Nachrichtenprotokollierung ist ein Recht, das dem Administrator vorbehalten sein sollte.</span><span class="sxs-lookup"><span data-stu-id="1c651-139">Adding a custom trace listener on the Message Logging trace source is a privilege that should be restricted to the administrator.</span></span> <span data-ttu-id="1c651-140">Grund hierfür ist, dass bösartige benutzerdefinierte Listener für das remote Senden von Nachrichten konfiguriert werden können, was zur Offenlegung vertraulicher Informationen führt.</span><span class="sxs-lookup"><span data-stu-id="1c651-140">This is because malicious custom listeners can be configured to send messages remotely, which leads to sensitive information disclosure.</span></span> <span data-ttu-id="1c651-141">Darüber hinaus sollten Sie eine angemessene Zugangskontrolle für die Nachrichtenprotokolle auf einem Remotecomputer erstellen, wenn Sie einen benutzerdefinierten Listener für das Senden von Nachrichten beispielsweise zu einer Remotedatenbank konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="1c651-141">In addition, if you configure a custom listener to send messages on the wire, such as, to a remote database, you should enforce proper access control on the message logs in the remote machine.</span></span>  
  
## <a name="events-triggered-by-message-logging"></a><span data-ttu-id="1c651-142">Von Nachrichtenprotokollierung ausgelöste Ereignisse</span><span class="sxs-lookup"><span data-stu-id="1c651-142">Events Triggered by Message Logging</span></span>  

 <span data-ttu-id="1c651-143">Im Folgenden werden alle Ereignisse aufgelistet, die von der Nachrichtenprotokollierung ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="1c651-143">The following lists all the events emitted by message logging.</span></span>  
  
- <span data-ttu-id="1c651-144">Nachrichtenprotokollierung ein: Dieses Ereignis wird ausgegeben, wenn Nachrichtenprotokollierung in der Konfiguration aktiviert wird, oder durch WMI.</span><span class="sxs-lookup"><span data-stu-id="1c651-144">Message logging on: This event is emitted when message logging is enabled in configuration, or through WMI.</span></span> <span data-ttu-id="1c651-145">Der Inhalt des Ereignisses ist "Die Nachrichtenprotokollierung wurde aktiviert".</span><span class="sxs-lookup"><span data-stu-id="1c651-145">The content of the event is "Message logging has been turned on.</span></span> <span data-ttu-id="1c651-146">Vertrauliche Informationen werden möglicherweise in Klartext protokolliert, auch wenn sie bei der Übertragung verschlüsselt waren (beispielsweise Nachrichtentext).</span><span class="sxs-lookup"><span data-stu-id="1c651-146">Sensitive information may be logged in clear text, even if they were encrypted on the wire, for example, message bodies."</span></span>  
  
- <span data-ttu-id="1c651-147">Nachrichtenprotokollierung aus: Dieses Ereignis wird ausgegeben, wenn Nachrichtenprotokollierung durch WMI deaktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="1c651-147">Message logging off: This event is emitted when message logging is disabled through WMI.</span></span> <span data-ttu-id="1c651-148">Der Inhalt des Ereignisses ist "Die Nachrichtenprotokollierung wurde deaktiviert".</span><span class="sxs-lookup"><span data-stu-id="1c651-148">The content of the event is "Message logging has been turned off."</span></span>  
  
- <span data-ttu-id="1c651-149">Protokollieren von bekannten PII ein: Dieses Ereignis wird ausgegeben, wenn das Protokollieren von bekanntem PII aktiviert ist.</span><span class="sxs-lookup"><span data-stu-id="1c651-149">Log Known PII On: This event is emitted when logging of known PII is enabled.</span></span> <span data-ttu-id="1c651-150">Dies geschieht, wenn das `enableLoggingKnownPii` -Attribut im- `machineSettings` Element der Machine.config Datei auf festgelegt ist `true` und das- `logKnownPii` Attribut des- `source` Elements entweder in der App.config-oder Web.config-Datei auf festgelegt ist `true` .</span><span class="sxs-lookup"><span data-stu-id="1c651-150">This happens when the `enableLoggingKnownPii` attribute in the `machineSettings` element of the Machine.config file is set to `true`, and the `logKnownPii` attribute of the `source` element in either the App.config or Web.config file is set to `true`.</span></span>  
  
- <span data-ttu-id="1c651-151">Protokollieren von bekannten PII nicht zugelassen: Dieses Ereignis wird ausgegeben, wenn das Protokollieren von bekanntem PII nicht zugelassen ist.</span><span class="sxs-lookup"><span data-stu-id="1c651-151">Log Known PII Not Allowed: This event is emitted when logging of known PII is not allowed.</span></span> <span data-ttu-id="1c651-152">Dies geschieht, wenn das- `logKnownPii` Attribut des- `source` Elements entweder in der App.config-oder Web.config-Datei auf festgelegt ist `true` , das- `enableLoggingKnownPii` Attribut im- `machineSettings` Element der Machine.config Datei jedoch auf festgelegt ist `false` .</span><span class="sxs-lookup"><span data-stu-id="1c651-152">This happens when the `logKnownPii` attribute of the `source` element in either the App.config or Web.config file is set to `true`, but the `enableLoggingKnownPii` attribute in the `machineSettings` element of the Machine.config file is set to `false`.</span></span> <span data-ttu-id="1c651-153">Es werden keine Ausnahmen ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="1c651-153">No exception is thrown.</span></span>  
  
 <span data-ttu-id="1c651-154">Diese Ereignisse können im Windows-integrierten Tool der Ereignisanzeige angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="1c651-154">These events can be viewed in the Event Viewer tool that comes with Windows.</span></span> <span data-ttu-id="1c651-155">Weitere Informationen hierzu finden Sie unter [Ereignisprotokollierung](./event-logging/index.md).</span><span class="sxs-lookup"><span data-stu-id="1c651-155">For more information on this, see [Event Logging](./event-logging/index.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1c651-156">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="1c651-156">See also</span></span>

- [<span data-ttu-id="1c651-157">Nachrichtenprotokollierung</span><span class="sxs-lookup"><span data-stu-id="1c651-157">Message Logging</span></span>](message-logging.md)
- [<span data-ttu-id="1c651-158">Sicherheitsaspekte und nützliche Tipps für die Ablaufverfolgung</span><span class="sxs-lookup"><span data-stu-id="1c651-158">Security Concerns and Useful Tips for Tracing</span></span>](./tracing/security-concerns-and-useful-tips-for-tracing.md)
