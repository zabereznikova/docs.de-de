---
title: "Aktivitätsablaufverfolgung in der Nachrichtensicherheit"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 68862534-3b2e-4270-b097-8121b12a2c97
caps.latest.revision: "7"
author: BrucePerlerMS
ms.author: bruceper
manager: mbaldwin
ms.openlocfilehash: 60156e284c55d765de417fe891185d1aba720816
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 10/18/2017
---
# <a name="activity-tracing-in-message-security"></a><span data-ttu-id="d6bfa-102">Aktivitätsablaufverfolgung in der Nachrichtensicherheit</span><span class="sxs-lookup"><span data-stu-id="d6bfa-102">Activity Tracing in Message Security</span></span>
<span data-ttu-id="d6bfa-103">In diesem Thema wird die Aktivitätsablaufverfolgung für die Sicherheitsverarbeitung beschrieben, die in den folgenden drei Phasen erfolgt.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-103">This topic describes activity tracing for security processing, which happens in the following three phases.</span></span>  
  
-   <span data-ttu-id="d6bfa-104">Aushandlung/SCT-Austausch.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-104">Negotiation/SCT exchange.</span></span> <span data-ttu-id="d6bfa-105">Das kann später auf der Transportebene stattfinden (über binären Datenaustausch) oder auf der Nachrichtenebene (über SOAP-Nachrichtenaustausch).</span><span class="sxs-lookup"><span data-stu-id="d6bfa-105">This can happen at the transport later (through binary data exchange) or message layer (through SOAP message exchanges).</span></span>  
  
-   <span data-ttu-id="d6bfa-106">Nachrichtenverschlüsselung/-entschlüsselung mit Signaturüberprüfung und Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-106">Message encryption/decryption, with signature verification and authentication.</span></span> <span data-ttu-id="d6bfa-107">Ablaufverfolgungen werden in der Umgebungsaktivität, in der Regel "Aktion verarbeiten", angezeigt.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-107">Traces appear in the ambient activity, typically "Process Action."</span></span>  
  
-   <span data-ttu-id="d6bfa-108">Autorisierung und Überprüfung.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-108">Authorization and verification.</span></span> <span data-ttu-id="d6bfa-109">Dies kann lokal geschehen oder bei der Kommunikation zwischen Endpunkten.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-109">This can happen locally or when communicating between endpoints.</span></span>  
  
## <a name="negotiationsct-exchange"></a><span data-ttu-id="d6bfa-110">Aushandlung/SCT-Austausch</span><span class="sxs-lookup"><span data-stu-id="d6bfa-110">Negotiation/SCT exchange</span></span>  
 <span data-ttu-id="d6bfa-111">In der Phase Aushandlung/SCT-Austausch werden zwei Aktivitätstypen auf dem Client erstellt: "Sicherheitssitzung einrichten" und "Sicherheitssitzung schließen".</span><span class="sxs-lookup"><span data-stu-id="d6bfa-111">In the negotiation/SCT exchange phase, two activity types are created on the client: "Set up Secure Session" and "Close Secure Session."</span></span> <span data-ttu-id="d6bfa-112">"Sicherheitssitzung einrichten" umfasst die Ablaufverfolgung für den RST/RSTR/SCT-Nachrichtenaustausch, während "Sicherheitssitzung schließen" die Ablaufverfolgung der Cancel-Nachricht einschließt.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-112">"Set up Secure Session" encompasses traces for the RST/RSTR/SCT message exchanges, while "Close Secure Session" includes traces for the Cancel message.</span></span>  
  
 <span data-ttu-id="d6bfa-113">Auf dem Server wird jede Anforderung/Antwort zu RST/RSTR/SCT in einer eigenen Aktivität angezeigt.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-113">On the server, each request/reply for the RST/RSTR/SCT appears in its own activity.</span></span> <span data-ttu-id="d6bfa-114">Wenn `propagateActivity` = `true` auf dem Server und Client Aktivitäten auf dem Server die gleiche ID haben, und in der "Sicherheitssitzung einrichten" bei der Anzeige über Service Trace Viewer zusammen angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-114">If `propagateActivity`=`true` on both the server and client, activities on the server have the same ID, and appear together in the "Setup Secure Session" when viewed through Service Trace Viewer.</span></span>  
  
 <span data-ttu-id="d6bfa-115">Dieses Aktivitätsablaufverfolgungsmodell ist bei der Benutzernamen-/Kennwortauthentifizierung, der Zertifikatsauthentifizierung und der NTLM-Authentifizierung wirksam.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-115">This activity tracing model is valid for user name/password authentication, certificate authentication, and NTLM authentication.</span></span>  
  
 <span data-ttu-id="d6bfa-116">In der folgenden Tabelle werden die Aktivitäten und Ablaufverfolgungen für die Aushandlung und den SCT-Austausch aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-116">The following table lists the activities and traces for negotiation and SCT exchange.</span></span>  
  
||<span data-ttu-id="d6bfa-117">Zeitpunkt von Aushandlung-/SCT-Austausch</span><span class="sxs-lookup"><span data-stu-id="d6bfa-117">Time when Negotiation/SCT exchange happens</span></span>|<span data-ttu-id="d6bfa-118">Aktivitäten</span><span class="sxs-lookup"><span data-stu-id="d6bfa-118">Activities</span></span>|<span data-ttu-id="d6bfa-119">Ablaufverfolgungen</span><span class="sxs-lookup"><span data-stu-id="d6bfa-119">Traces</span></span>|  
|-|-------------------------------------------------|----------------|------------|  
|<span data-ttu-id="d6bfa-120">Sicherer Transport</span><span class="sxs-lookup"><span data-stu-id="d6bfa-120">Secure Transport</span></span><br /><br /> <span data-ttu-id="d6bfa-121">(HTTPS, SSL)</span><span class="sxs-lookup"><span data-stu-id="d6bfa-121">(HTTPS, SSL)</span></span>|<span data-ttu-id="d6bfa-122">Bei der ersten empfangenen Nachricht.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-122">On first message received.</span></span>|<span data-ttu-id="d6bfa-123">Ablaufverfolgungen werden in der Umgebungsaktivität ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-123">Traces are emitted in the ambient activity.</span></span>|<span data-ttu-id="d6bfa-124">-Ablaufverfolgungen zu Austauschinformationen</span><span class="sxs-lookup"><span data-stu-id="d6bfa-124">-   Exchange traces</span></span><br /><span data-ttu-id="d6bfa-125">-Sicherer Kanal wurde hergestellt</span><span class="sxs-lookup"><span data-stu-id="d6bfa-125">-   Secure channel established</span></span><br /><span data-ttu-id="d6bfa-126">-Geheime Schlüssel wurden abgerufen.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-126">-   Share secrets obtained.</span></span>|  
|<span data-ttu-id="d6bfa-127">Sichere Nachrichtenebene</span><span class="sxs-lookup"><span data-stu-id="d6bfa-127">Secure Message Layer</span></span><br /><br /> <span data-ttu-id="d6bfa-128">(WSHTTP)</span><span class="sxs-lookup"><span data-stu-id="d6bfa-128">(WSHTTP)</span></span>|<span data-ttu-id="d6bfa-129">Bei der ersten empfangenen Nachricht.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-129">On first message received.</span></span>|<span data-ttu-id="d6bfa-130">Auf dem Client:</span><span class="sxs-lookup"><span data-stu-id="d6bfa-130">On the client:</span></span><br /><br /> <span data-ttu-id="d6bfa-131">-"Sicherheitssitzung einrichten" aus "Aktion verarbeiten" dieser ersten Nachricht für jede Anforderung/Antwort zu RST/RSTR/SCT.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-131">-   "Setup Secure Session" out of "Process Action" of that first message, for each request/reply for RST/RSTR/SCT.</span></span><br /><span data-ttu-id="d6bfa-132">-"Sicherheitssitzung schließen" für die CANCEL-Austausch aus der Aktivität"Proxy schließen."</span><span class="sxs-lookup"><span data-stu-id="d6bfa-132">-   "Close Secure Session" for the CANCEL exchange, out of the "Close Proxy activity."</span></span> <span data-ttu-id="d6bfa-133">Diese Aktivität kann aus einer anderen Umgebungsaktivität erfolgen, je nachdem, wann die Sicherheitssitzung geschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-133">This activity may happen out of some other ambient activity, depending on when the secure session is closed.</span></span><br /><br /> <span data-ttu-id="d6bfa-134">Auf dem Server:</span><span class="sxs-lookup"><span data-stu-id="d6bfa-134">On the server:</span></span><br /><br /> <span data-ttu-id="d6bfa-135">-Eine "Aktion verarbeiten"-Aktivität für jede Anforderung/Antwort zu RST/SCT/Cancel auf dem Server.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-135">-   One "Process Action" activity for each request/reply for RST/SCT/Cancel on the server.</span></span> <span data-ttu-id="d6bfa-136">Wenn `propagateActivity` = `true`RST/RSTR/SCT-Aktivitäten werden zusammengeführt, mit "Sicherheitssitzung einrichten" und "Abbrechen" ist mit der Aktivität, die vom Client "Schließen" zusammengeführt.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-136">If `propagateActivity`=`true`, RST/RSTR/SCT activities are merged with "Set up Security Session", and Cancel is merged with the "Close" activity from the client.</span></span><br /><br /> <span data-ttu-id="d6bfa-137">"Sicherheitssitzung einrichten" erfolgt in zwei Stufen:</span><span class="sxs-lookup"><span data-stu-id="d6bfa-137">There are two stages for "Set up Secure Session":</span></span><br /><br /> <span data-ttu-id="d6bfa-138">1.  Aushandlung der Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-138">1.  Authentication negotiation.</span></span> <span data-ttu-id="d6bfa-139">Dies ist optional, wenn der Client bereits über die richtigen Anmeldeinformationen verfügt.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-139">This is optional if the client already has the proper credentials.</span></span> <span data-ttu-id="d6bfa-140">Diese Stufe kann über den sicheren Transport oder über den Nachrichtenaustausch erfolgen.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-140">This phase can be done through secure transport, or through message exchanges.</span></span> <span data-ttu-id="d6bfa-141">In letzterem Fall, kann der RST-/RSTR-Austausch ein- oder zweimal stattfinden.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-141">In the latter case, 1 or 2 RST/RSTR exchanges can happen.</span></span> <span data-ttu-id="d6bfa-142">Bei diesem Austausch werden Ablaufverfolgungen in neuen zuvor entworfenen Anforderungs-/Antwortaktivitäten ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-142">For these exchanges, traces are emitted in new request/reply activities as previously designed.</span></span><br /><span data-ttu-id="d6bfa-143">2.  Einrichtung der Sicherheitssitzung (SCT), wobei ein RST/RSTR-Austausch erfolgt.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-143">2.  Secure session establishment (SCT), in which one RST/RSTR exchange happens here.</span></span> <span data-ttu-id="d6bfa-144">Dieser weist dieselben, bereits beschriebenen Umgebungsaktivitäten auf.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-144">This has the same ambient activities as described previously.</span></span>|<span data-ttu-id="d6bfa-145">-Ablaufverfolgungen zu Austauschinformationen</span><span class="sxs-lookup"><span data-stu-id="d6bfa-145">-   Exchange traces</span></span><br /><span data-ttu-id="d6bfa-146">-Sicherer Kanal wurde hergestellt</span><span class="sxs-lookup"><span data-stu-id="d6bfa-146">-   Secure channel established</span></span><br /><span data-ttu-id="d6bfa-147">-Geheime Schlüssel wurden abgerufen.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-147">-   Share secrets obtained.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="d6bfa-148">Im gemischten Sicherheitsmodus erfolgt die Aushandlung der Authentifizierung in einem binären Austausch, SCT erfolgt jedoch im Nachrichtenaustausch.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-148">In mixed security mode, negotiation authentication happens in binary exchanges, but SCT happens in message exchange.</span></span> <span data-ttu-id="d6bfa-149">Im reinen Transportmodus findet die Aushandlung nur beim Transport ohne weitere Aktivitäten statt.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-149">In pure transport mode, negotiation happens only in transport with no additional activities.</span></span>  
  
## <a name="message-encryption-and-decryption"></a><span data-ttu-id="d6bfa-150">Nachrichtenverschlüsselung und -entschlüsselung</span><span class="sxs-lookup"><span data-stu-id="d6bfa-150">Message Encryption and Decryption</span></span>  
 <span data-ttu-id="d6bfa-151">In der folgenden Tabelle werden die Aktivitäten und Ablaufverfolgungen für die Verschlüsselung/Entschlüsselung von Nachrichten und die Signaturauthentifizierung aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-151">The following table lists the activities and traces for message encryption/decryption, as well as signature authentication.</span></span>  
  
||<span data-ttu-id="d6bfa-152">Sicherer Transport</span><span class="sxs-lookup"><span data-stu-id="d6bfa-152">Secure Transport</span></span><br /><br /> <span data-ttu-id="d6bfa-153">(HTTPS, SSL) und sichere Nachrichtenebene</span><span class="sxs-lookup"><span data-stu-id="d6bfa-153">(HTTPS, SSL) and Secure Message Layer</span></span><br /><br /> <span data-ttu-id="d6bfa-154">(WSHTTP)</span><span class="sxs-lookup"><span data-stu-id="d6bfa-154">(WSHTTP)</span></span>|  
|-|---------------------------------------------------------------------------------|  
|<span data-ttu-id="d6bfa-155">Zeitpunkt der Nachrichtenverschlüsselung/-entschlüsselung sowie der Signatur als Nachricht Verschlüsselung/Entschlüsselung sowie die Signaturauthentifizierung</span><span class="sxs-lookup"><span data-stu-id="d6bfa-155">Time when message encryption/decryption, as well as signature authentication happens</span></span>|<span data-ttu-id="d6bfa-156">Beim Empfang der Nachricht</span><span class="sxs-lookup"><span data-stu-id="d6bfa-156">On message received</span></span>|  
|<span data-ttu-id="d6bfa-157">Aktivitäten</span><span class="sxs-lookup"><span data-stu-id="d6bfa-157">Activities</span></span>|<span data-ttu-id="d6bfa-158">Ablaufverfolgungen werden in der Aktivität "Aktion verarbeiten" auf dem Client und dem Server ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-158">Traces are emitted in the ProcessAction activity on the client and server.</span></span>|  
|<span data-ttu-id="d6bfa-159">Ablaufverfolgungen</span><span class="sxs-lookup"><span data-stu-id="d6bfa-159">Traces</span></span>|<span data-ttu-id="d6bfa-160">-SendSecurityHeader (Absender):</span><span class="sxs-lookup"><span data-stu-id="d6bfa-160">-   sendSecurityHeader (sender):</span></span><br /><span data-ttu-id="d6bfa-161">-Nachricht signieren</span><span class="sxs-lookup"><span data-stu-id="d6bfa-161">-   Sign message</span></span><br /><span data-ttu-id="d6bfa-162">-Verschlüsseln der Anforderungsdaten</span><span class="sxs-lookup"><span data-stu-id="d6bfa-162">-   Encrypt request data</span></span><br /><span data-ttu-id="d6bfa-163">-ReceiveSecurityHeader (Empfänger):</span><span class="sxs-lookup"><span data-stu-id="d6bfa-163">-   receiveSecurityHeader (receiver):</span></span><br /><span data-ttu-id="d6bfa-164">-Signatur wird überprüft.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-164">-   Verify signature</span></span><br /><span data-ttu-id="d6bfa-165">-Entschlüsseln der Antwortdaten</span><span class="sxs-lookup"><span data-stu-id="d6bfa-165">-   Decrypt response data</span></span><br /><span data-ttu-id="d6bfa-166">-Authentifizierung</span><span class="sxs-lookup"><span data-stu-id="d6bfa-166">-   Authentication</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="d6bfa-167">Im reinen Transportmodus findet die Verschlüsselung/Entschlüsselung nur beim Transport ohne weitere Aktivitäten statt.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-167">In pure transport mode, message encryption/decryption happens only in transport with no additional activities.</span></span>  
  
## <a name="authorization-and-verification"></a><span data-ttu-id="d6bfa-168">Autorisierung und Überprüfung.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-168">Authorization and Verification</span></span>  
 <span data-ttu-id="d6bfa-169">In der folgenden Tabelle werden die Aktivitäten und Ablaufverfolgungen für die Autorisierung aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-169">The following table lists the activities and traces for authorization.</span></span>  
  
||<span data-ttu-id="d6bfa-170">Zeitpunkt der Autorisierung</span><span class="sxs-lookup"><span data-stu-id="d6bfa-170">Time when authorization happens</span></span>|<span data-ttu-id="d6bfa-171">Aktivitäten</span><span class="sxs-lookup"><span data-stu-id="d6bfa-171">Activities</span></span>|<span data-ttu-id="d6bfa-172">Ablaufverfolgungen</span><span class="sxs-lookup"><span data-stu-id="d6bfa-172">Traces</span></span>|  
|-|-------------------------------------|----------------|------------|  
|<span data-ttu-id="d6bfa-173">Lokal (Standard)</span><span class="sxs-lookup"><span data-stu-id="d6bfa-173">Local (default)</span></span>|<span data-ttu-id="d6bfa-174">Nachdem die Nachricht auf den Server entschlüsselt wurde.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-174">After the message is decrypted on the server</span></span>|<span data-ttu-id="d6bfa-175">Ablaufverfolgungen werden in der Aktivität "Aktion verarbeiten" auf dem Server ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-175">Traces are emitted in the ProcessAction activity at the server.</span></span>|<span data-ttu-id="d6bfa-176">Für Benutzer autorisiert.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-176">User authorized.</span></span>|  
|<span data-ttu-id="d6bfa-177">Remoteelement</span><span class="sxs-lookup"><span data-stu-id="d6bfa-177">Remote</span></span>|<span data-ttu-id="d6bfa-178">Nachdem die Nachricht auf den Server entschlüsselt wurde.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-178">After the message is decrypted on the server</span></span>|<span data-ttu-id="d6bfa-179">Ablaufverfolgungen werden in einer neuen von der Aktivität "Aktion verarbeiten" aufgerufenen Aktivität ausgegeben.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-179">Traces are emitted in a new activity invoked by the ProcessAction activity.</span></span>|<span data-ttu-id="d6bfa-180">Für Benutzer autorisiert.</span><span class="sxs-lookup"><span data-stu-id="d6bfa-180">User authorized.</span></span>|
