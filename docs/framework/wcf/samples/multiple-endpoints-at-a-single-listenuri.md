---
title: Mehrere Endpunkte unter einem ListenUri
ms.date: 03/30/2017
ms.assetid: 911ffad4-4d47-4430-b7c2-79192ce6bcbd
ms.openlocfilehash: 09696ec8170915f29dae7510f8953565bcc67436
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 11/26/2020
ms.locfileid: "96260187"
---
# <a name="multiple-endpoints-at-a-single-listenuri"></a><span data-ttu-id="ca3b2-102">Mehrere Endpunkte unter einem ListenUri</span><span class="sxs-lookup"><span data-stu-id="ca3b2-102">Multiple Endpoints at a Single ListenUri</span></span>

<span data-ttu-id="ca3b2-103">In diesem Beispiel wird ein Dienst gezeigt, der mehrere Endpunkte unter einem einzelnen `ListenUri` hostet.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-103">This sample demonstrates a service that hosts multiple endpoints at a single `ListenUri`.</span></span> <span data-ttu-id="ca3b2-104">Dieses Beispiel basiert auf den ersten [Schritten, mit](getting-started-sample.md) denen ein Rechner Dienst implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-104">This sample is based on the [Getting Started](getting-started-sample.md) that implements a calculator service.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="ca3b2-105">Die Setupprozedur und die Buildanweisungen für dieses Beispiel befinden sich am Ende dieses Themas.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-105">The setup procedure and build instructions for this sample are located at the end of this topic.</span></span>  
  
 <span data-ttu-id="ca3b2-106">Wie im Beispiel für [mehrere Endpunkte](multiple-endpoints.md) gezeigt, kann ein Dienst mehrere Endpunkte hosten, die jeweils über unterschiedliche Adressen und möglicherweise auch unterschiedliche Bindungen verfügen.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-106">As demonstrated in the [Multiple Endpoints](multiple-endpoints.md) sample, a service can host multiple endpoints, each with different addresses and possibly also different bindings.</span></span> <span data-ttu-id="ca3b2-107">In diesem Beispiel wird gezeigt, dass mehrere Endpunkte auch bei der gleichen Adresse gehostet werden können.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-107">This sample shows that it is possible to host multiple endpoints at the same address.</span></span> <span data-ttu-id="ca3b2-108">Außerdem werden in diesem Beispiel die Unterschiede zwischen den beiden Arten der Adressen eines Dienstendpunkts dargestellt: `EndpointAddress` und `ListenUri`.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-108">This sample also demonstrates the differences between the two kinds of addresses that a service endpoint has: `EndpointAddress` and `ListenUri`.</span></span>  
  
 <span data-ttu-id="ca3b2-109">Die `EndpointAddress` ist die logische Adresse eines Diensts.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-109">The `EndpointAddress` is the logical address of a service.</span></span> <span data-ttu-id="ca3b2-110">An diese Adresse werden SOAP-Nachrichten adressiert.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-110">It is the address that SOAP messages are addressed to.</span></span> <span data-ttu-id="ca3b2-111">Der `ListenUri` ist die physische Adresse des Diensts.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-111">The `ListenUri` is the physical address of the service.</span></span> <span data-ttu-id="ca3b2-112">Er verfügt über die Informationen zu Port und Adresse, an denen der Dienst auf dem aktuellen Computer tatsächlich Nachrichten überwacht.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-112">It has the port and address information where the service endpoint actually listens for messages on the current machine.</span></span> <span data-ttu-id="ca3b2-113">In den meisten Fällen müssen diese Adressen nicht unterschiedlich sein. Wenn ein `ListenUri` nicht explizit angegeben ist, wird er standardmäßig auf den URI der `EndpointAddress` des Endpunkts festgelegt.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-113">In most cases, there is no need for these addresses to differ; when a `ListenUri` is not explicitly specified, it defaults to the URI of the `EndpointAddress` of the endpoint.</span></span> <span data-ttu-id="ca3b2-114">In einigen Fällen ist es jedoch nützlich, die Adressen zu unterscheiden, z.&#160;B. wenn Sie einen Router konfigurieren, der Nachrichten akzeptiert, die möglicherweise an eine Reihe verschiedener Dienste adressiert sind.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-114">In a few cases, it is useful to distinguish them, such as when configuring a router, which might accept messages addressed to a number of different services.</span></span>  
  
## <a name="service"></a><span data-ttu-id="ca3b2-115">Dienst</span><span class="sxs-lookup"><span data-stu-id="ca3b2-115">Service</span></span>  

 <span data-ttu-id="ca3b2-116">Der Dienst in diesem Beispiel besitzt zwei Verträge: `ICalculator` und `IEcho`.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-116">The service in this sample has two contracts, `ICalculator` and `IEcho`.</span></span> <span data-ttu-id="ca3b2-117">Zusätzlich zum üblichen `IMetadataExchange`-Endpunkt gibt es drei Anwendungsendpunkte, wie im folgenden Code gezeigt.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-117">In addition to the customary `IMetadataExchange` endpoint, there are three application endpoints, as shown in the following code.</span></span>  
  
```xml  
<endpoint address="urn:Stuff"  
        binding="wsHttpBinding"  
        contract="Microsoft.ServiceModel.Samples.ICalculator"
        listenUri="http://localhost/servicemodelsamples/service.svc" />  
<endpoint address="urn:Stuff"  
        binding="wsHttpBinding"  
        contract="Microsoft.ServiceModel.Samples.IEcho"
        listenUri="http://localhost/servicemodelsamples/service.svc" />  
<endpoint address="urn:OtherEcho"  
        binding="wsHttpBinding"  
        contract="Microsoft.ServiceModel.Samples.IEcho"
        listenUri="http://localhost/servicemodelsamples/service.svc" />  
```  
  
 <span data-ttu-id="ca3b2-118">Alle drei Endpunkte werden unter demselben `ListenUri` gehostet und verwenden dieselbe `binding`. Endpunkte unter demselben `ListenUri` müssen dieselbe Bindung besitzen, da sie gemeinsam einen einzigen Kanalstapel nutzen, der Nachrichten an dieser physischen Adresse des Computers überwacht.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-118">All three endpoints are hosted at the same `ListenUri` and use the same `binding` - endpoints at the same `ListenUri` must have the same binding, because they are sharing a single channel stack that listens for messages at that physical address on the machine.</span></span> <span data-ttu-id="ca3b2-119">Die `address` jedes Endpunkts ist ein URN. Obwohl Adressen in der Regel physische Speicherplätze darstellen, kann die Adresse eigentlich ein beliebiger URI sein, da die Adresse für den Abgleich und die Filterung verwendet wird, wie in diesem Beispiel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-119">The `address` of each endpoint is a URN; though typically addresses represent physical locations, in fact the address can be any kind of URI, because the address is used for matching and filtering purposes as is demonstrated in this sample.</span></span>  
  
 <span data-ttu-id="ca3b2-120">Da alle drei Endpunkte den gleichen nutzen `ListenUri` , wenn eine Nachricht dort eingeht, muss Windows Communication Foundation (WCF) entscheiden, für welchen Endpunkt die Nachricht bestimmt ist.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-120">Because all three endpoints share the same `ListenUri`, when a message arrives there, Windows Communication Foundation (WCF) must decide which endpoint the message is destined for.</span></span> <span data-ttu-id="ca3b2-121">Jeder Endpunkt besitzt einen Nachrichtenfilter, der aus zwei Teilen besteht: dem Adressfilter und dem Vertragsfilter.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-121">Each endpoint has a message filter that is comprised of two parts: the address filter and the contract filter.</span></span> <span data-ttu-id="ca3b2-122">Der Adressfilter gleicht `To` der SOAP-Nachricht mit der Adresse des Dienstendpunkts ab.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-122">The address filter matches the `To` of the SOAP message to the address of the service endpoint.</span></span> <span data-ttu-id="ca3b2-123">So sind beispielsweise nur an `To "Urn:OtherEcho"` adressierte Nachrichten für den dritten Endpunkt dieses Diensts vorgesehen.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-123">For example, only messages addressed `To "Urn:OtherEcho"` are candidates for the third endpoint of this service.</span></span> <span data-ttu-id="ca3b2-124">Der Vertragsfilter gleicht die den Vorgängen eines besonderen Vertrags zugeordneten Aktionen ab.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-124">The contract filter matches the Actions associated with the operations of a particular contract.</span></span> <span data-ttu-id="ca3b2-125">Nachrichten mit der Aktion von `IEcho`</span><span class="sxs-lookup"><span data-stu-id="ca3b2-125">For example, messages with the action of `IEcho`.</span></span> <span data-ttu-id="ca3b2-126">`Echo` stimmen beispielsweise mit den Vertragsfiltern des zweiten und dritten Endpunkts dieses Diensts überein, da beide Endpunkte den `IEcho`-Vertrag hosten.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-126">`Echo` matches the contract filters of both the second and third endpoints of this service, because both of those endpoints host the `IEcho` contract.</span></span>  
  
 <span data-ttu-id="ca3b2-127">Deshalb ermöglicht es die Kombination aus Adressfilter und Vertragsfilter, jede am `ListenUri` dieses Diensts eingehende Nachricht zum richtigen Endpunkt weiterzuleiten.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-127">Thus the combination of address filter and contract filter makes it possible to route each message that arrives at this service's `ListenUri` to the correct endpoint.</span></span> <span data-ttu-id="ca3b2-128">Der dritte Endpunkt wird von den anderen beiden unterschieden, da er Nachrichten akzeptiert, die von den anderen Endpunkten an eine andere Adresse gesendet wurden.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-128">The third endpoint is differentiated from the other two because it accepts messages sent to a different address from the other endpoints.</span></span> <span data-ttu-id="ca3b2-129">Der erste und der zweite Endpunkt werden anhand ihrer Verträge (die Aktion der eingehenden Nachricht) voneinander unterschieden.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-129">The first and second endpoints are differentiated from each other based on their contracts (the Action of the incoming message).</span></span>  
  
## <a name="client"></a><span data-ttu-id="ca3b2-130">Client</span><span class="sxs-lookup"><span data-stu-id="ca3b2-130">Client</span></span>  

 <span data-ttu-id="ca3b2-131">So wie Endpunkte auf dem Server zwei verschiedene Adressen besitzen, weisen Clientendpunkte auch zwei Adressen auf.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-131">Just as endpoints on the server have two different addresses, client endpoints also have two addresses.</span></span> <span data-ttu-id="ca3b2-132">Sowohl auf dem Server als auch auf dem Client lautet die logische Adresse `EndpointAddress`.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-132">On both server and client, the logical address is called the `EndpointAddress`.</span></span> <span data-ttu-id="ca3b2-133">Die physische Adresse wird jedoch auf dem Server `ListenUri` und auf dem Client `Via` genannt.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-133">But whereas the physical address is called the `ListenUri` on the server, on the client, the physical address is called the `Via`.</span></span>  
  
 <span data-ttu-id="ca3b2-134">Wie auf dem Server sind diese beiden Adressen standardmäßig identisch.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-134">As on the server, by default, these two addresses are the same.</span></span> <span data-ttu-id="ca3b2-135">Um einen `Via` auf dem Client anzugeben, der sich von der Adresse des Endpunkts unterscheidet, wird `ClientViaBehavior` verwendet:</span><span class="sxs-lookup"><span data-stu-id="ca3b2-135">To specify a `Via` on the client that is different from the endpoint's address, `ClientViaBehavior` is used:</span></span>  
  
```csharp  
Uri via = new Uri("http://localhost/ServiceModelSamples/service.svc");  
CalculatorClient calcClient = new CalculatorClient();  
calcClient.ChannelFactory.Endpoint.Behaviors.Add(  
        new ClientViaBehavior(via));  
```  
  
 <span data-ttu-id="ca3b2-136">Wie üblich kommt die Adresse aus der Clientkonfigurationsdatei, die von "Svcutil.exe" generiert wurde.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-136">As usual, the address comes from the client configuration file, which was generated by Svcutil.exe.</span></span> <span data-ttu-id="ca3b2-137">`Via` (entspricht `ListenUri` des Diensts) wird nicht in den Metadaten des Diensts angezeigt, weshalb diese Information dem Client out-of-band mitgeteilt werden muss (genauso wie die Metadatenadresse des Diensts).</span><span class="sxs-lookup"><span data-stu-id="ca3b2-137">The `Via` (which corresponds to the `ListenUri` of the service) does not appear in the service's metadata and so this information must be communicated to the client out-of-band (just like the service's metadata address).</span></span>  
  
 <span data-ttu-id="ca3b2-138">In diesem Beispiel sendet der Client Nachrichten an jeden der drei Endpunkte des Servers, um zu zeigen, dass er mit allen drei Endpunkten kommunizieren (und sie unterscheiden) kann, selbst dann, wenn sie alle denselben `Via` besitzen.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-138">The client in this sample sends messages to each of the server's three application endpoints, to demonstrate that it can communicate with (and differentiate) all three endpoints, even though they all have the same `Via`.</span></span>  
  
#### <a name="to-set-up-build-and-run-the-sample"></a><span data-ttu-id="ca3b2-139">So können Sie das Beispiel einrichten, erstellen und ausführen</span><span class="sxs-lookup"><span data-stu-id="ca3b2-139">To set up, build, and run the sample</span></span>  
  
1. <span data-ttu-id="ca3b2-140">Stellen Sie sicher, dass Sie das [einmalige Setup Verfahren für die Windows Communication Foundation Beispiele](one-time-setup-procedure-for-the-wcf-samples.md)ausgeführt haben.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-140">Ensure that you have performed the [One-Time Setup Procedure for the Windows Communication Foundation Samples](one-time-setup-procedure-for-the-wcf-samples.md).</span></span>  
  
2. <span data-ttu-id="ca3b2-141">Um die C#- oder Visual Basic .NET-Edition der Projektmappe zu erstellen, befolgen Sie die unter [Building the Windows Communication Foundation Samples](building-the-samples.md)aufgeführten Anweisungen.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-141">To build the C# or Visual Basic .NET edition of the solution, follow the instructions in [Building the Windows Communication Foundation Samples](building-the-samples.md).</span></span>  
  
3. <span data-ttu-id="ca3b2-142">Um das Beispiel in einer Konfiguration mit einem einzigen Computer oder Computer übergreifend auszuführen, befolgen Sie die Anweisungen unter [Ausführen der Windows Communication Foundation Beispiele](running-the-samples.md).</span><span class="sxs-lookup"><span data-stu-id="ca3b2-142">To run the sample in a single- or cross-machine configuration, follow the instructions in [Running the Windows Communication Foundation Samples](running-the-samples.md).</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="ca3b2-143">Bei einer computerübergreifenden Konfiguration müssen Sie "localhost" in der Datei "Client.cs" durch den Namen des Dienstcomputers ersetzen.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-143">For cross-machine, you must replace localhost in the Client.cs file with the name of the service machine.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="ca3b2-144">Die Beispiele sind möglicherweise bereits auf dem Computer installiert.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-144">The samples may already be installed on your machine.</span></span> <span data-ttu-id="ca3b2-145">Suchen Sie nach dem folgenden Verzeichnis (Standardverzeichnis), bevor Sie fortfahren.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-145">Check for the following (default) directory before continuing.</span></span>  
>
> `<InstallDrive>:\WF_WCF_Samples`  
>
> <span data-ttu-id="ca3b2-146">Wenn dieses Verzeichnis nicht vorhanden ist, wechseln Sie zu [Windows Communication Foundation (WCF) und Windows Workflow Foundation (WF)-Beispiele für .NET Framework 4](https://www.microsoft.com/download/details.aspx?id=21459) , um alle Windows Communication Foundation (WCF) und Beispiele herunterzuladen [!INCLUDE[wf1](../../../../includes/wf1-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="ca3b2-146">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://www.microsoft.com/download/details.aspx?id=21459) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="ca3b2-147">Dieses Beispiel befindet sich im folgenden Verzeichnis.</span><span class="sxs-lookup"><span data-stu-id="ca3b2-147">This sample is located in the following directory.</span></span>  
>
> `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\Services\MultipleEndpointsSingleUri`  
