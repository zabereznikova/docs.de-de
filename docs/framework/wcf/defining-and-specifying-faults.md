---
title: Definieren und Angeben von Fehlern
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- handling faults [WCF], specifying
- handling faults [WCF], defining
ms.assetid: c00c84f1-962d-46a7-b07f-ebc4f80fbfc1
ms.openlocfilehash: 10fc045cab995cca8d78e470d74ec9341e167308
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 03/12/2020
ms.locfileid: "79176694"
---
# <a name="defining-and-specifying-faults"></a><span data-ttu-id="c7d61-102">Definieren und Angeben von Fehlern</span><span class="sxs-lookup"><span data-stu-id="c7d61-102">Defining and Specifying Faults</span></span>
<span data-ttu-id="c7d61-103">SOAP-Fehler vermitteln Informationen zu Fehlerbedingungen auf interoperable Weise von einem Dienst an einen Client und bei Duplexkommunikation von einem Client an einen Dienst.</span><span class="sxs-lookup"><span data-stu-id="c7d61-103">SOAP faults convey error condition information from a service to a client and, in the duplex case, from a client to a service in an interoperable way.</span></span> <span data-ttu-id="c7d61-104">In diesem Thema wird beschrieben, wann und wie Sie benutzerdefinierten Fehlerinhalt definieren und wie Sie angeben, welche Vorgänge diesen zurückgeben können.</span><span class="sxs-lookup"><span data-stu-id="c7d61-104">This topic discusses when and how to define custom fault content and specify which operations can return them.</span></span> <span data-ttu-id="c7d61-105">Weitere Informationen dazu, wie ein Dienst oder Duplexclient diese Fehler senden kann und wie eine Client- oder Dienstanwendung diese Fehler verarbeitet, finden Sie unter [Senden und Empfangen](sending-and-receiving-faults.md)von Fehlern .</span><span class="sxs-lookup"><span data-stu-id="c7d61-105">For more information about how a service, or duplex client, can send those faults and how a client or service application handles these faults, see [Sending and Receiving Faults](sending-and-receiving-faults.md).</span></span> <span data-ttu-id="c7d61-106">Eine Übersicht über die Fehlerbehandlung in Windows Communication Foundation (WCF)-Anwendungen finden Sie unter [Angeben und Behandeln von Fehlern in Verträgen und Diensten](specifying-and-handling-faults-in-contracts-and-services.md).</span><span class="sxs-lookup"><span data-stu-id="c7d61-106">For an overview of error handling in Windows Communication Foundation (WCF) applications, see [Specifying and Handling Faults in Contracts and Services](specifying-and-handling-faults-in-contracts-and-services.md).</span></span>  
  
## <a name="overview"></a><span data-ttu-id="c7d61-107">Übersicht</span><span class="sxs-lookup"><span data-stu-id="c7d61-107">Overview</span></span>  
 <span data-ttu-id="c7d61-108">Bei deklarierten SOAP-Fehlern verfügt ein Vorgang über ein <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType>, das einen benutzerdefinierten SOAP-Fehlertyp angibt.</span><span class="sxs-lookup"><span data-stu-id="c7d61-108">Declared SOAP faults are those in which an operation has a <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> that specifies a custom SOAP fault type.</span></span> <span data-ttu-id="c7d61-109">Nicht deklarierte SOAP-Fehler sind Fehler, die nicht im Vertrag eines Vorgangs festgelegt sind.</span><span class="sxs-lookup"><span data-stu-id="c7d61-109">Undeclared SOAP faults are those that are not specified in the contract for an operation.</span></span> <span data-ttu-id="c7d61-110">Dieses Thema enthält Informationen zur Identifizierung der Fehlerbedingungen und zur Erstellung eines Fehlervertrags für Ihren Dienst, den Clients verwenden können, um die Fehlerbedingungen richtig zu verarbeiten, wenn sie anhand von benutzerdefinierten SOAP-Fehlern darüber informiert werden.</span><span class="sxs-lookup"><span data-stu-id="c7d61-110">This topic helps you identify those error conditions and create a fault contract for your service that clients can use to properly handle those error conditions when notified by custom SOAP faults.</span></span> <span data-ttu-id="c7d61-111">Die folgenden grundlegenden Aufgaben gelten in dieser Reihenfolge:</span><span class="sxs-lookup"><span data-stu-id="c7d61-111">The basic tasks are, in order:</span></span>  
  
1. <span data-ttu-id="c7d61-112">Definieren Sie die Fehlerbedingungen, über die ein Client Ihres Dienstes informiert werden sollte.</span><span class="sxs-lookup"><span data-stu-id="c7d61-112">Define the error conditions that a client of your service should know about.</span></span>  
  
2. <span data-ttu-id="c7d61-113">Definieren Sie für diese Fehlerbedingungen den benutzerdefinierten Inhalt der SOAP-Fehler.</span><span class="sxs-lookup"><span data-stu-id="c7d61-113">Define the custom content of the SOAP faults for those error conditions.</span></span>  
  
3. <span data-ttu-id="c7d61-114">Kennzeichnen Sie Ihre Vorgänge, damit die spezifischen SOAP-Fehler, die diese Vorgänge auslösen, für Clients in WSDL offengelegt werden.</span><span class="sxs-lookup"><span data-stu-id="c7d61-114">Mark your operations so that the specific SOAP faults that they throw are exposed to clients in WSDL.</span></span>  
  
### <a name="defining-error-conditions-that-clients-should-know-about"></a><span data-ttu-id="c7d61-115">Definieren von Fehlerbedingungen, über die Clients informiert werden sollen</span><span class="sxs-lookup"><span data-stu-id="c7d61-115">Defining Error Conditions That Clients Should Know About</span></span>  
 <span data-ttu-id="c7d61-116">SOAP-Fehler sind öffentlich beschriebene Meldungen, die Fehlerinformationen für einen besonderen Vorgang enthalten.</span><span class="sxs-lookup"><span data-stu-id="c7d61-116">SOAP faults are publicly described messages that carry fault information for a particular operation.</span></span> <span data-ttu-id="c7d61-117">Da sie zusammen mit anderen Vorgangsmeldungen in WSDL beschrieben sind, sind Clients darüber informiert und erwarten beim Aufrufen eines Vorgangs, dass sie diese ggf. verarbeiten müssen.</span><span class="sxs-lookup"><span data-stu-id="c7d61-117">Because they are described along with other operation messages in WSDL, clients know and, therefore, expect to handle such faults when invoking an operation.</span></span> <span data-ttu-id="c7d61-118">Da WCF-Dienste jedoch in verwaltetem Code geschrieben sind, bietet Ihnen die Entscheidung, welche Fehlerbedingungen im verwalteten Code in Fehler umgewandelt und an den Client zurückgegeben werden sollen, die Möglichkeit, Fehlerbedingungen und Fehler in Ihrem Dienst vom formalen Fehler zu trennen. Unterhaltung, die Sie mit einem Kunden führen.</span><span class="sxs-lookup"><span data-stu-id="c7d61-118">But because WCF services are written in managed code, deciding which error conditions in managed code are to be converted into faults and returned to the client provides you the opportunity to separate error conditions and bugs in your service from the formal error conversation you have with a client.</span></span>  
  
 <span data-ttu-id="c7d61-119">Das folgende Codebeispiel zeigt zum Beispiel einen Vorgang, bei dem zwei ganze Zahlen verwendet und eine weitere ganze Zahl zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="c7d61-119">For example, the following code example shows an operation that takes two integers and returns another integer.</span></span> <span data-ttu-id="c7d61-120">Hierbei können mehrere Ausnahmen ausgelöst werden. Beim Entwerfen des Fehlervertrags müssen Sie deshalb bestimmen, welche Fehlerbedingungen für Ihren Client wichtig sind.</span><span class="sxs-lookup"><span data-stu-id="c7d61-120">Several exceptions can be thrown here, so when designing the fault contract, you must determine which error conditions are important for your client.</span></span> <span data-ttu-id="c7d61-121">In diesem Fall muss der Dienst die <xref:System.DivideByZeroException?displayProperty=nameWithType>-Ausnahme erkennen.</span><span class="sxs-lookup"><span data-stu-id="c7d61-121">In this case, the service should detect the <xref:System.DivideByZeroException?displayProperty=nameWithType> exception.</span></span>  
  
```csharp  
[ServiceContract]  
public class CalculatorService  
{  
    [OperationContract]
    int Divide(int a, int b)  
    {  
      if (b==0) throw new Exception("Division by zero!");  
      return a/b;  
    }  
}  
```  
  
```vb
<ServiceContract> _
Public Class CalculatorService
    <OperationContract> _
    Public Function Divide(a As Integer, b As Integer) As Integer
        If b = 0 Then Throw New DivideByZeroException("Division by zero!")
        Return a / b
    End Function
End Class
```
  
 <span data-ttu-id="c7d61-122">Im obigen Beispiel kann der Vorgang entweder einen benutzerdefinierten SOAP-Fehler zurückgeben, der für die Division durch 0 gilt, einen benutzerdefinierten Fehler, der für mathematische Operationen gilt, aber Informationen zur Division durch 0 enthält, mehrere Fehler für verschiedene Fehlersituationen oder keinen SOAP-Fehler.</span><span class="sxs-lookup"><span data-stu-id="c7d61-122">In the preceding example the operation can either return a custom SOAP fault that is specific to dividing by zero, a custom fault that is specific to math operations but that contains information specific to dividing by zero, multiple faults for several different error situations, or no SOAP fault at all.</span></span>  
  
### <a name="define-the-content-of-error-conditions"></a><span data-ttu-id="c7d61-123">Definieren des Inhalts von Fehlerbedingungen</span><span class="sxs-lookup"><span data-stu-id="c7d61-123">Define the Content of Error Conditions</span></span>  
 <span data-ttu-id="c7d61-124">Nachdem eine Fehlerbedingung als Bedingung identifiziert wurde, die auf nützliche Weise einen benutzerdefinierten SOAP-Fehler zurückgeben kann, besteht der nächste Schritt darin, den Inhalt dieses Fehlers zu definieren und sicherzustellen, dass die Inhaltsstruktur serialisiert werden kann.</span><span class="sxs-lookup"><span data-stu-id="c7d61-124">Once an error condition has been identified as one that can usefully return a custom SOAP fault, the next step is to define the contents of that fault and ensure that the content structure can be serialized.</span></span> <span data-ttu-id="c7d61-125">Das Codebeispiel im vorherigen Abschnitt zeigt einen Fehler, der spezifisch für eine `Divide`-Operation ist. Wenn jedoch auch noch andere Operationen über den `Calculator`-Dienst durchgeführt werden, kann ein einzelner benutzerdefinierter SOAP-Fehler den Client über alle Rechnerfehlerbedingungen informieren, einschließlich `Divide`.</span><span class="sxs-lookup"><span data-stu-id="c7d61-125">The code example in the preceding section shows an error specific to a `Divide` operation, but if there are other operations on the `Calculator` service, then a single custom SOAP fault can inform the client of all calculator error conditions, `Divide` included.</span></span> <span data-ttu-id="c7d61-126">Das folgende Codebeispiel zeigt die Erstellung des benutzerdefinierten SOAP-Fehlers `MathFault`. Dieser Fehler kann Fehler für alle mathematischen Operationen melden, auch für `Divide`.</span><span class="sxs-lookup"><span data-stu-id="c7d61-126">The following code example shows the creation of a custom SOAP fault, `MathFault`, which can report errors made using all math operations, including `Divide`.</span></span> <span data-ttu-id="c7d61-127">Während die Klasse eine Operation (die `Operation`-Eigenschaft) und einen Wert angeben kann, der das Problem beschreibt (die `ProblemType`-Eigenschaft), müssen die Klasse und diese Eigenschaften serialisierbar sein, um per benutzerdefiniertem SOAP-Fehler an den Client übertragen zu werden.</span><span class="sxs-lookup"><span data-stu-id="c7d61-127">While the class can specify an operation (the `Operation` property) and a value that describes the problem (the `ProblemType` property), the class and these properties must be serializable to be transferred to the client in a custom SOAP fault.</span></span> <span data-ttu-id="c7d61-128">Aus diesem Grund werden die Attribute <xref:System.Runtime.Serialization.DataContractAttribute?displayProperty=nameWithType> und <xref:System.Runtime.Serialization.DataMemberAttribute?displayProperty=nameWithType> verwendet, um den Typ und seine Eigenschaften serialisierbar und so interoperabel wie möglich zu machen.</span><span class="sxs-lookup"><span data-stu-id="c7d61-128">Therefore, the <xref:System.Runtime.Serialization.DataContractAttribute?displayProperty=nameWithType> and <xref:System.Runtime.Serialization.DataMemberAttribute?displayProperty=nameWithType> attributes are used to make the type and its properties serializable and as interoperable as possible.</span></span>  
  
 [!code-csharp[Faults#2](../../../samples/snippets/csharp/VS_Snippets_CFX/faults/cs/service.cs#2)]
 [!code-vb[Faults#2](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faults/vb/service.vb#2)]  
  
 <span data-ttu-id="c7d61-129">Weitere Informationen dazu, wie Sie sicherstellen können, dass Ihre Daten serialisierbar sind, finden Sie unter [Angeben der Datenübertragung in Serviceverträgen](./feature-details/specifying-data-transfer-in-service-contracts.md).</span><span class="sxs-lookup"><span data-stu-id="c7d61-129">For more information about how to ensure your data is serializable, see [Specifying Data Transfer in Service Contracts](./feature-details/specifying-data-transfer-in-service-contracts.md).</span></span> <span data-ttu-id="c7d61-130">Eine Liste der Serialisierungsunterstützung finden <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType> Sie unter [Typen, die vom Data Contract Serializer unterstützt werden.](./feature-details/types-supported-by-the-data-contract-serializer.md)</span><span class="sxs-lookup"><span data-stu-id="c7d61-130">For a list of the serialization support that <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType> provides, see [Types Supported by the Data Contract Serializer](./feature-details/types-supported-by-the-data-contract-serializer.md).</span></span>  
  
### <a name="mark-operations-to-establish-the-fault-contract"></a><span data-ttu-id="c7d61-131">Markieren von Operationen, um den Fehlervertrag einzurichten</span><span class="sxs-lookup"><span data-stu-id="c7d61-131">Mark Operations to Establish the Fault Contract</span></span>  
 <span data-ttu-id="c7d61-132">Nachdem Sie eine serialisierbare Datenstruktur definiert haben, die als Teil eines benutzerdefinierten SOAP-Fehlers zurückgegeben wird, besteht der letzte Schritt darin, Ihren Operationsvertrag so zu kennzeichnen, dass er einen SOAP-Fehler dieses Typs auslöst.</span><span class="sxs-lookup"><span data-stu-id="c7d61-132">Once a serializable data structure that is returned as part of a custom SOAP fault is defined, the last step is to mark your operation contract as throwing a SOAP fault of that type.</span></span> <span data-ttu-id="c7d61-133">Verwenden Sie dazu das <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType>-Attribut, und übergeben Sie den Typ des benutzerdefinierten Datentyps, den Sie erstellt haben.</span><span class="sxs-lookup"><span data-stu-id="c7d61-133">To do this, use the <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> attribute and pass the type of the custom data type that you have constructed.</span></span> <span data-ttu-id="c7d61-134">Das folgende Codebeispiel zeigt, wie Sie das <xref:System.ServiceModel.FaultContractAttribute>-Attribut verwenden, um anzugeben, dass die `Divide`-Operation einen SOAP-Fehler vom Typ `MathFault` zurückgeben kann.</span><span class="sxs-lookup"><span data-stu-id="c7d61-134">The following code example shows how to use the <xref:System.ServiceModel.FaultContractAttribute> attribute to specify that the `Divide` operation can return a SOAP fault of type `MathFault`.</span></span> <span data-ttu-id="c7d61-135">Andere mathematische Operationen können jetzt auch angeben, dass sie einen `MathFault` zurückgeben können.</span><span class="sxs-lookup"><span data-stu-id="c7d61-135">Other math-based operations can now also specify that they can return a `MathFault`.</span></span>  
  
 [!code-csharp[Faults#1](../../../samples/snippets/csharp/VS_Snippets_CFX/faults/cs/service.cs#1)]
 [!code-vb[Faults#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/faults/vb/service.vb#1)]  
  
 <span data-ttu-id="c7d61-136">Eine Operation kann angeben, dass sie mehr als einen benutzerdefinierten Fehler zurückgibt, indem Sie diese mit mehr als einem <xref:System.ServiceModel.FaultContractAttribute>-Attribut versehen.</span><span class="sxs-lookup"><span data-stu-id="c7d61-136">An operation can specify that it returns more than one custom fault by marking that operation with more than one <xref:System.ServiceModel.FaultContractAttribute> attribute.</span></span>  
  
 <span data-ttu-id="c7d61-137">Der nächste Schritt zum Implementieren des Fehlervertrags in Ihrer Betriebsimplementierung wird im Thema [Senden und Empfangen](sending-and-receiving-faults.md)von Fehlern beschrieben.</span><span class="sxs-lookup"><span data-stu-id="c7d61-137">The next step, to implement the fault contract in your operation implementation, is described in the topic [Sending and Receiving Faults](sending-and-receiving-faults.md).</span></span>  
  
#### <a name="soap-wsdl-and-interoperability-considerations"></a><span data-ttu-id="c7d61-138">Überlegungen zu SOAP, WSDL und zur Interoperabilität</span><span class="sxs-lookup"><span data-stu-id="c7d61-138">SOAP, WSDL, and Interoperability Considerations</span></span>  
 <span data-ttu-id="c7d61-139">Unter bestimmten Umständen, besonders bei der Zusammenarbeit mit anderen Plattformen, kann es wichtig sein, die Art und Weise der Anzeige eines Fehlers in einer SOAP-Meldung bzw. seine Beschreibung in WSDL-Metadaten zu steuern.</span><span class="sxs-lookup"><span data-stu-id="c7d61-139">In some circumstances, especially when interoperating with other platforms, it may be important to control the way a fault appears in a SOAP message or the way it is described in the WSDL metadata.</span></span>  
  
 <span data-ttu-id="c7d61-140">Das <xref:System.ServiceModel.FaultContractAttribute>-Attribut verfügt über eine <xref:System.ServiceModel.FaultContractAttribute.Name%2A>-Eigenschaft, die die Steuerung des WSDL-Fehlerelementnamens ermöglicht, der in den Metadaten für diesen Fehler generiert wird.</span><span class="sxs-lookup"><span data-stu-id="c7d61-140">The <xref:System.ServiceModel.FaultContractAttribute> attribute has a <xref:System.ServiceModel.FaultContractAttribute.Name%2A> property that allows control of the WSDL fault element name that is generated in the metadata for that fault.</span></span>  
  
 <span data-ttu-id="c7d61-141">Gemäß SOAP-Standard kann ein Fehler die Elemente `Action`, `Code` und `Reason` aufweisen.</span><span class="sxs-lookup"><span data-stu-id="c7d61-141">According to the SOAP standard, a fault can have an `Action`, a `Code`, and a `Reason`.</span></span> <span data-ttu-id="c7d61-142">Die `Action` wird von der <xref:System.ServiceModel.FaultContractAttribute.Action%2A>-Eigenschaft gesteuert.</span><span class="sxs-lookup"><span data-stu-id="c7d61-142">The `Action` is controlled by the <xref:System.ServiceModel.FaultContractAttribute.Action%2A> property.</span></span> <span data-ttu-id="c7d61-143">Die <xref:System.ServiceModel.FaultException.Code%2A>-Eigenschaft und die <xref:System.ServiceModel.FaultException.Reason%2A>-Eigenschaften sind Eigenschaften der <xref:System.ServiceModel.FaultException?displayProperty=nameWithType>-Klasse, bei der es sich um die übergeordnete Klasse der generischen <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType> handelt.</span><span class="sxs-lookup"><span data-stu-id="c7d61-143">The <xref:System.ServiceModel.FaultException.Code%2A> property and <xref:System.ServiceModel.FaultException.Reason%2A> property are both properties of the <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> class, which is the parent class of the generic <xref:System.ServiceModel.FaultException%601?displayProperty=nameWithType>.</span></span> <span data-ttu-id="c7d61-144">Die `Code`-Eigenschaft enthält einen <xref:System.ServiceModel.FaultCode.SubCode%2A>-Member.</span><span class="sxs-lookup"><span data-stu-id="c7d61-144">The `Code` property includes a <xref:System.ServiceModel.FaultCode.SubCode%2A> member.</span></span>  
  
 <span data-ttu-id="c7d61-145">Beim Zugreifen auf andere Elemente als Dienste, die Fehler generieren, gelten bestimmte Einschränkungen.</span><span class="sxs-lookup"><span data-stu-id="c7d61-145">When accessing non-services that generate faults, certain limitations exist.</span></span> <span data-ttu-id="c7d61-146">WCF unterstützt nur Fehler mit Detailtypen, die im Schema beschrieben werden und die mit Datenverträgen kompatibel sind.</span><span class="sxs-lookup"><span data-stu-id="c7d61-146">WCF supports only faults with detail types that the schema describes and that are compatible with data contracts.</span></span> <span data-ttu-id="c7d61-147">Wie oben erwähnt, unterstützt WCF beispielsweise keine Fehler, die XML-Attribute in ihren Detailtypen verwenden, oder Fehler mit mehr als einem Element der obersten Ebene im Detailabschnitt.</span><span class="sxs-lookup"><span data-stu-id="c7d61-147">For example, as mentioned above, WCF does not support faults that use XML attributes in their detail types, or faults with more than one top-level element in the detail section.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c7d61-148">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="c7d61-148">See also</span></span>

- <xref:System.ServiceModel.FaultContractAttribute>
- <xref:System.Runtime.Serialization.DataContractAttribute>
- <xref:System.Runtime.Serialization.DataMemberAttribute>
- [<span data-ttu-id="c7d61-149">Angeben und Behandeln von Fehlern in Verträgen und Diensten</span><span class="sxs-lookup"><span data-stu-id="c7d61-149">Specifying and Handling Faults in Contracts and Services</span></span>](specifying-and-handling-faults-in-contracts-and-services.md)
- [<span data-ttu-id="c7d61-150">Senden und Empfangen von Fehlern</span><span class="sxs-lookup"><span data-stu-id="c7d61-150">Sending and Receiving Faults</span></span>](sending-and-receiving-faults.md)
- [<span data-ttu-id="c7d61-151">Vorgehensweise: Deklarieren von Fehlern in Dienstverträgen</span><span class="sxs-lookup"><span data-stu-id="c7d61-151">How to: Declare Faults in Service Contracts</span></span>](how-to-declare-faults-in-service-contracts.md)
- [<span data-ttu-id="c7d61-152">Grundlagen der Schutzebene</span><span class="sxs-lookup"><span data-stu-id="c7d61-152">Understanding Protection Level</span></span>](understanding-protection-level.md)
- [<span data-ttu-id="c7d61-153">Vorgehensweise: Festlegen der ProtectionLevel-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="c7d61-153">How to: Set the ProtectionLevel Property</span></span>](how-to-set-the-protectionlevel-property.md)
- [<span data-ttu-id="c7d61-154">Specifying Data Transfer in Service Contracts</span><span class="sxs-lookup"><span data-stu-id="c7d61-154">Specifying Data Transfer in Service Contracts</span></span>](./feature-details/specifying-data-transfer-in-service-contracts.md)
