---
title: 'Vorgehensweise: Endpunkte im Unternehmen sperren'
ms.date: 03/30/2017
ms.assetid: 1b7eaab7-da60-4cf7-9d6a-ec02709cf75d
ms.openlocfilehash: 35b9a1dbebce48823799689a581033d0483c3984
ms.sourcegitcommit: 7e2128d4a4c45b4274bea3b8e5760d4694569ca1
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 01/14/2020
ms.locfileid: "75937680"
---
# <a name="how-to-lock-down-endpoints-in-the-enterprise"></a><span data-ttu-id="2881b-102">Vorgehensweise: Endpunkte im Unternehmen sperren</span><span class="sxs-lookup"><span data-stu-id="2881b-102">How to: Lock Down Endpoints in the Enterprise</span></span>

<span data-ttu-id="2881b-103">Von Großunternehmen wird oft gefordert, dass Anwendungen unter Einhaltung der Sicherheitsrichtlinien der Unternehmen entwickelt werden.</span><span class="sxs-lookup"><span data-stu-id="2881b-103">Large enterprises often require that applications are developed in compliance with enterprise security policies.</span></span> <span data-ttu-id="2881b-104">Im folgenden Thema wird erläutert, wie Sie ein clientend Punkt Validierungs Steuerelement entwickeln und installieren, das zum Überprüfen aller auf Computern installierten Windows Communication Foundation (WCF)-Client Anwendungen verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="2881b-104">The following topic discusses how to develop and install a client endpoint validator that can be used to validate all Windows Communication Foundation (WCF) client applications installed on computers.</span></span>

<span data-ttu-id="2881b-105">In diesem Fall ist das Validierungs Steuerelement eine Client Bestätigung, da dieses Endpunkt Verhalten dem Client [\<commonbehavior >](../../configure-apps/file-schema/wcf/commonbehaviors.md) -Abschnitt in der Datei Machine. config hinzugefügt wird.</span><span class="sxs-lookup"><span data-stu-id="2881b-105">In this case, the validator is a client validator because this endpoint behavior is added to the client [\<commonBehaviors>](../../configure-apps/file-schema/wcf/commonbehaviors.md) section in the machine.config file.</span></span> <span data-ttu-id="2881b-106">WCF lädt allgemeine Endpunkt Verhalten nur für Client Anwendungen und lädt allgemeine Dienst Verhaltensweisen nur für Dienst Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="2881b-106">WCF loads common endpoint behaviors only for client applications and loads common service behaviors only for service applications.</span></span> <span data-ttu-id="2881b-107">Um diese Bestätigung für Dienstanwendungen installieren zu können, muss es sich bei der Bestätigung um ein Dienstverhalten handeln.</span><span class="sxs-lookup"><span data-stu-id="2881b-107">To install this same validator for service applications, the validator must be a service behavior.</span></span> <span data-ttu-id="2881b-108">Weitere Informationen finden Sie im Abschnitt [\<commonverhaltens>](../../configure-apps/file-schema/wcf/commonbehaviors.md) .</span><span class="sxs-lookup"><span data-stu-id="2881b-108">For more information, see the [\<commonBehaviors>](../../configure-apps/file-schema/wcf/commonbehaviors.md) section.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="2881b-109">Dienst-oder Endpunkt Verhaltensweisen, die nicht mit dem <xref:System.Security.AllowPartiallyTrustedCallersAttribute>-Attribut (APTCA) markiert sind, die dem [\<commonverhaltens>](../../configure-apps/file-schema/wcf/commonbehaviors.md) Abschnitt einer Konfigurationsdatei hinzugefügt werden, werden nicht ausgeführt, wenn die Anwendung in einer teilweise vertrauenswürdigen Umgebung ausgeführt wird. wenn dies auftritt, wird keine Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="2881b-109">Service or endpoint behaviors not marked with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> attribute (APTCA) that are added to the [\<commonBehaviors>](../../configure-apps/file-schema/wcf/commonbehaviors.md) section of a configuration file are not run when the application runs in a partial trust environment, and no exception is thrown when this occurs.</span></span> <span data-ttu-id="2881b-110">Um die Ausführung gemeinsamer Verhalten, wie z.&#160;B. Bestätigungen, zu erzwingen, müssen Sie einen der beiden folgenden Schritte ausführen:</span><span class="sxs-lookup"><span data-stu-id="2881b-110">To enforce the running of common behaviors such as validators, you must either:</span></span>
>
> - <span data-ttu-id="2881b-111">Markieren Sie das allgemeine Verhalten mit dem <xref:System.Security.AllowPartiallyTrustedCallersAttribute>-Attribut, damit es ausgeführt werden kann, wenn es als teilweise vertrauenswürdige Anwendung bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="2881b-111">Mark your common behavior with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> attribute so that it can run when deployed as a Partial Trust application.</span></span> <span data-ttu-id="2881b-112">Beachten Sie, dass auf dem Computer ein Registrierungseintrag festgelegt werden kann, um die Ausführung von mit APTCA markierten Assemblys zu verhindern.</span><span class="sxs-lookup"><span data-stu-id="2881b-112">Note that a registry entry can be set on the computer to prevent APTCA-marked assemblies from running..</span></span>
>
> - <span data-ttu-id="2881b-113">Stellen Sie sicher, dass die Anwendung, wenn die Anwendung als voll vertrauenswürdige Anwendung bereitgestellt wird, die Sicherheitseinstellungen für den Code Zugriff nicht ändern kann, um die Anwendung in einer teilweise vertrauenswürdigen Umgebung auszuführen.</span><span class="sxs-lookup"><span data-stu-id="2881b-113">Ensure that if the application is deployed as a fully-trusted application that users cannot modify the code-access security settings to run the application in a Partial Trust environment.</span></span> <span data-ttu-id="2881b-114">Wenn sie dies können, dann wird die benutzerdefinierte Bestätigung nicht ausgeführt, und es wird keine Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="2881b-114">If they can do so, the custom validator does not run and no exception is thrown.</span></span> <span data-ttu-id="2881b-115">Eine Möglichkeit, dies sicherzustellen, finden Sie unter der Option "`levelfinal`" mit dem [Code Zugriffs-Sicherheitsrichtlinien Tool (Caspol. exe)](../../tools/caspol-exe-code-access-security-policy-tool.md).</span><span class="sxs-lookup"><span data-stu-id="2881b-115">For one way to ensure this, see the `levelfinal` option using [Code Access Security Policy Tool (Caspol.exe)](../../tools/caspol-exe-code-access-security-policy-tool.md).</span></span>
>
> <span data-ttu-id="2881b-116">Weitere Informationen finden Sie unter [teilweise vertrauenswürdige Best Practices](../feature-details/partial-trust-best-practices.md) und [unterstützte Bereitstellungs Szenarien](../feature-details/supported-deployment-scenarios.md).</span><span class="sxs-lookup"><span data-stu-id="2881b-116">For more information, see [Partial Trust Best Practices](../feature-details/partial-trust-best-practices.md) and [Supported Deployment Scenarios](../feature-details/supported-deployment-scenarios.md).</span></span>

### <a name="to-create-the-endpoint-validator"></a><span data-ttu-id="2881b-117">So erstellen Sie eine Endpunktbestätigung</span><span class="sxs-lookup"><span data-stu-id="2881b-117">To create the endpoint validator</span></span>

1. <span data-ttu-id="2881b-118">Erstellen Sie ein <xref:System.ServiceModel.Description.IEndpointBehavior> mit den gewünschten Validierungsschritten in der <xref:System.ServiceModel.Description.IEndpointBehavior.Validate%2A>-Methode.</span><span class="sxs-lookup"><span data-stu-id="2881b-118">Create an <xref:System.ServiceModel.Description.IEndpointBehavior> with the desired validation steps in the <xref:System.ServiceModel.Description.IEndpointBehavior.Validate%2A> method.</span></span> <span data-ttu-id="2881b-119">Der folgende Code veranschaulicht dies.</span><span class="sxs-lookup"><span data-stu-id="2881b-119">The following code provides an example.</span></span> <span data-ttu-id="2881b-120">(Die `InternetClientValidatorBehavior` wird aus dem Beispiel zur [Sicherheits](../samples/security-validation.md) Überprüfung entnommen.)</span><span class="sxs-lookup"><span data-stu-id="2881b-120">(The `InternetClientValidatorBehavior` is taken from the [Security Validation](../samples/security-validation.md) sample.)</span></span>

    [!code-csharp[LockdownValidation#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/lockdownvalidation/cs/internetclientvalidatorbehavior.cs#2)]

2. <span data-ttu-id="2881b-121">Erstellen Sie ein neues <xref:System.ServiceModel.Configuration.BehaviorExtensionElement>, des die in Schritt 1 erstellte Endpunktbestätigung registriert.</span><span class="sxs-lookup"><span data-stu-id="2881b-121">Create new <xref:System.ServiceModel.Configuration.BehaviorExtensionElement> that registers the endpoint validator created in step 1.</span></span> <span data-ttu-id="2881b-122">Dies wird im folgenden Codebeispiel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="2881b-122">The following code example shows this.</span></span> <span data-ttu-id="2881b-123">(Der ursprüngliche Code für dieses Beispiel befindet sich im Beispiel zur [Sicherheits](../samples/security-validation.md) Überprüfung.)</span><span class="sxs-lookup"><span data-stu-id="2881b-123">(The original code for this example is in the [Security Validation](../samples/security-validation.md) sample.)</span></span>

    [!code-csharp[LockdownValidation#3](../../../../samples/snippets/csharp/VS_Snippets_CFX/lockdownvalidation/cs/internetclientvalidatorelement.cs#3)]

3. <span data-ttu-id="2881b-124">Stellen Sie sicher, dass die kompilierte Assembly mit einem starken Namen signiert wird.</span><span class="sxs-lookup"><span data-stu-id="2881b-124">Make sure the compiled assembly is signed with a strong name.</span></span> <span data-ttu-id="2881b-125">Weitere Informationen finden Sie unter [Strong Name-Tool (SN). EXE)](../../tools/sn-exe-strong-name-tool.md) und den Compilerbefehlen für Ihre Sprache.</span><span class="sxs-lookup"><span data-stu-id="2881b-125">For details, see the [Strong Name Tool (SN.EXE)](../../tools/sn-exe-strong-name-tool.md) and the compiler commands for your language.</span></span>

### <a name="to-install-the-validator-into-the-target-computer"></a><span data-ttu-id="2881b-126">So installieren Sie die Bestätigung auf dem Zielcomputer</span><span class="sxs-lookup"><span data-stu-id="2881b-126">To install the validator into the target computer</span></span>

1. <span data-ttu-id="2881b-127">Installieren Sie die Endpunktbestätigung mithilfe des entsprechenden Mechanismus.</span><span class="sxs-lookup"><span data-stu-id="2881b-127">Install the endpoint validator using the appropriate mechanism.</span></span> <span data-ttu-id="2881b-128">In einem Unternehmen kann dies die Verwendung der Gruppenrichtlinie und des Systems Management Server (SMS) sein.</span><span class="sxs-lookup"><span data-stu-id="2881b-128">In an enterprise, this can be using Group Policy and Systems Management Server (SMS).</span></span>

2. <span data-ttu-id="2881b-129">Installieren Sie die Assembly mit starkem Namen im globalen Assemblycache mithilfe von " [Gacutil. exe" (Tool für den globalen Assemblycache)](../../tools/gacutil-exe-gac-tool.md).</span><span class="sxs-lookup"><span data-stu-id="2881b-129">Install the strongly-named assembly into the global assembly cache using the [Gacutil.exe (Global Assembly Cache Tool)](../../tools/gacutil-exe-gac-tool.md).</span></span>

3. <span data-ttu-id="2881b-130">Verwenden Sie die <xref:System.Configuration?displayProperty=nameWithType>-Namespacetypen, um Folgendes durchzuführen:</span><span class="sxs-lookup"><span data-stu-id="2881b-130">Use the <xref:System.Configuration?displayProperty=nameWithType> namespace types to:</span></span>

    1. <span data-ttu-id="2881b-131">Fügen Sie die Erweiterung dem Abschnitt [\<verhalteextensions >](../../configure-apps/file-schema/wcf/behaviorextensions.md) mithilfe eines voll qualifizierten Typnamens hinzu, und Sperren Sie das Element.</span><span class="sxs-lookup"><span data-stu-id="2881b-131">Add the extension to the [\<behaviorExtensions>](../../configure-apps/file-schema/wcf/behaviorextensions.md) section using a fully-qualified type name and lock the element.</span></span>

         [!code-csharp[LockdownValidation#5](../../../../samples/snippets/csharp/VS_Snippets_CFX/lockdownvalidation/cs/hostapplication.cs#5)]

    2. <span data-ttu-id="2881b-132">Fügen Sie das Behavior-Element der `EndpointBehaviors`-Eigenschaft des [\<commonbehavior >](../../configure-apps/file-schema/wcf/commonbehaviors.md) -Abschnitts hinzu, und Sperren Sie das-Element.</span><span class="sxs-lookup"><span data-stu-id="2881b-132">Add the behavior element to the `EndpointBehaviors` property of the [\<commonBehaviors>](../../configure-apps/file-schema/wcf/commonbehaviors.md) section and lock the element.</span></span> <span data-ttu-id="2881b-133">(Um das Validierungs Steuerelement für den Dienst zu installieren, muss das Validierungs Steuerelement eine <xref:System.ServiceModel.Description.IServiceBehavior> sein und der `ServiceBehaviors`-Eigenschaft hinzugefügt werden.) Das folgende Codebeispiel zeigt die ordnungsgemäße Konfiguration nach den Schritten a.</span><span class="sxs-lookup"><span data-stu-id="2881b-133">(To install the validator on the service, the validator must be an <xref:System.ServiceModel.Description.IServiceBehavior> and added to the `ServiceBehaviors` property.) The following code example shows the proper configuration after steps a.</span></span> <span data-ttu-id="2881b-134">und b. Der einzige Unterschied ist, dass hier kein starker Name vergeben wird.</span><span class="sxs-lookup"><span data-stu-id="2881b-134">and b., with the sole exception that there is no strong name.</span></span>

        [!code-csharp[LockdownValidation#6](../../../../samples/snippets/csharp/VS_Snippets_CFX/lockdownvalidation/cs/hostapplication.cs#6)]

    3. <span data-ttu-id="2881b-135">Speichern Sie die Datei machine.config.</span><span class="sxs-lookup"><span data-stu-id="2881b-135">Save the machine.config file.</span></span> <span data-ttu-id="2881b-136">Das folgende Codebeispiel führt alle Aufgaben in Schritt 3 durch, speichert aber eine lokale Kopie der geänderten Datei machine.config.</span><span class="sxs-lookup"><span data-stu-id="2881b-136">The following code example performs all the tasks in step 3 but saves a copy of the modified machine.config file locally.</span></span>

        [!code-csharp[LockdownValidation#7](../../../../samples/snippets/csharp/VS_Snippets_CFX/lockdownvalidation/cs/hostapplication.cs#7)]

## <a name="example"></a><span data-ttu-id="2881b-137">Beispiel</span><span class="sxs-lookup"><span data-stu-id="2881b-137">Example</span></span>

<span data-ttu-id="2881b-138">Das folgende Codebeispiel veranschaulicht, wie ein gemeinsames Verhalten zu einer machine.config-Datei hinzugefügt und wie eine Kopie auf der Festplatte gespeichert wird.</span><span class="sxs-lookup"><span data-stu-id="2881b-138">The following code example shows how to add a common behavior to the machine.config file and save a copy to the disk.</span></span> <span data-ttu-id="2881b-139">Die `InternetClientValidatorBehavior` wird aus dem Beispiel zur [Sicherheits](../samples/security-validation.md) Überprüfung entnommen.</span><span class="sxs-lookup"><span data-stu-id="2881b-139">The `InternetClientValidatorBehavior` is taken from the [Security Validation](../samples/security-validation.md) sample.</span></span>

[!code-csharp[LockdownValidation#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/lockdownvalidation/cs/hostapplication.cs#1)]

## <a name="net-framework-security"></a><span data-ttu-id="2881b-140">.NET Framework-Sicherheit</span><span class="sxs-lookup"><span data-stu-id="2881b-140">.NET Framework Security</span></span>

<span data-ttu-id="2881b-141">Sie können darüber hinaus die Elemente der Konfigurationsdatei verschlüsseln.</span><span class="sxs-lookup"><span data-stu-id="2881b-141">You may also want to encrypt the configuration file elements.</span></span> <span data-ttu-id="2881b-142">Weitere Informationen finden Sie im Abschnitt "Siehe auch".</span><span class="sxs-lookup"><span data-stu-id="2881b-142">For more information, see the See Also section.</span></span>

## <a name="see-also"></a><span data-ttu-id="2881b-143">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="2881b-143">See also</span></span>

- <span data-ttu-id="2881b-144">[Verschlüsseln von Konfigurationsdatei Elementen mit DPAPI](https://docs.microsoft.com/previous-versions/msp-n-p/ff647398(v=pandp.10))</span><span class="sxs-lookup"><span data-stu-id="2881b-144">[Encrypting configuration file elements using DPAPI](https://docs.microsoft.com/previous-versions/msp-n-p/ff647398(v=pandp.10))</span></span>
- <span data-ttu-id="2881b-145">[Verschlüsseln von Konfigurationsdatei Elementen mit RSA](https://docs.microsoft.com/previous-versions/msp-n-p/ff650304(v=pandp.10))</span><span class="sxs-lookup"><span data-stu-id="2881b-145">[Encrypting configuration file elements using RSA](https://docs.microsoft.com/previous-versions/msp-n-p/ff650304(v=pandp.10))</span></span>
