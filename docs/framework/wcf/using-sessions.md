---
title: Verwenden von Sitzungen
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- sessions [WCF]
ms.assetid: 864ba12f-3331-4359-a359-6d6d387f1035
ms.openlocfilehash: 898e5688ae08a59415c8b3116665eec6cb4cf904
ms.sourcegitcommit: a885cc8c3e444ca6471348893d5373c6e9e49a47
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/06/2018
ms.locfileid: "43877374"
---
# <a name="using-sessions"></a><span data-ttu-id="c3b86-102">Verwenden von Sitzungen</span><span class="sxs-lookup"><span data-stu-id="c3b86-102">Using Sessions</span></span>
<span data-ttu-id="c3b86-103">In Windows Communication Foundation (WCF)-Anwendungen eine *Sitzung* korreliert eine Gruppe von Nachrichten in einer Konversation.</span><span class="sxs-lookup"><span data-stu-id="c3b86-103">In Windows Communication Foundation (WCF) applications, a *session* correlates a group of messages into a conversation.</span></span> <span data-ttu-id="c3b86-104">WCF--Sitzungen sind anders als das Session-Objekt, das in verfügbar [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] Anwendungen, unterstützen andere Verhaltensweisen und auf andere Weise gesteuert werden.</span><span class="sxs-lookup"><span data-stu-id="c3b86-104">WCF sessions are different than the session object available in [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] applications, support different behaviors, and are controlled in different ways.</span></span> <span data-ttu-id="c3b86-105">Dieses Thema beschreibt die Funktionen, mit denen Sitzungen in WCF-Anwendungen und deren Verwendung.</span><span class="sxs-lookup"><span data-stu-id="c3b86-105">This topic describes the features that sessions enable in WCF applications and how to use them.</span></span>  
  
## <a name="sessions-in-windows-communication-foundation-applications"></a><span data-ttu-id="c3b86-106">Sitzungen in Windows Communication Foundation-Anwendungen</span><span class="sxs-lookup"><span data-stu-id="c3b86-106">Sessions in Windows Communication Foundation Applications</span></span>  
 <span data-ttu-id="c3b86-107">Wenn ein Dienstvertrag angibt, dass er eine Sitzung benötigt, bedeutet dies, dass alle Aufrufe (das heißt der zugrunde liegende Nachrichtenaustausch, durch den die Aufrufe unterstützt werden) Teil derselben Konversation sein müssen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-107">When a service contract specifies that it requires a session, that contract is specifying that all calls (that is, the underlying message exchanges that support the calls) must be part of the same conversation.</span></span> <span data-ttu-id="c3b86-108">Falls in einem Vertrag angegeben wird, dass Sitzungen zwar erlaubt, aber nicht erforderlich sind, können Clients eine Verbindung herstellen und eine Sitzung aufbauen oder auch nicht.</span><span class="sxs-lookup"><span data-stu-id="c3b86-108">If a contract specifies that it allows sessions but does not require one, clients can connect and either establish a session or not establish a session.</span></span> <span data-ttu-id="c3b86-109">Wird eine Sitzung beendet und eine Nachricht über denselben Kanal gesendet, wird eine Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="c3b86-109">If the session ends and a message is sent through the same channel an exception is thrown.</span></span>  
  
 <span data-ttu-id="c3b86-110">WCF-Sitzungen haben die folgenden Hauptkonzepte:</span><span class="sxs-lookup"><span data-stu-id="c3b86-110">WCF sessions have the following main conceptual features:</span></span>  
  
-   <span data-ttu-id="c3b86-111">Sie werden explizit von der aufrufenden Anwendung (dem WCF-Client) initiiert und beendet.</span><span class="sxs-lookup"><span data-stu-id="c3b86-111">They are explicitly initiated and terminated by the calling application (the WCF client).</span></span>  
  
-   <span data-ttu-id="c3b86-112">Die während einer Sitzung gesendeten Nachrichten werden in der Reihenfolge verarbeitet, in der sie empfangen wurden.</span><span class="sxs-lookup"><span data-stu-id="c3b86-112">Messages delivered during a session are processed in the order in which they are received.</span></span>  
  
-   <span data-ttu-id="c3b86-113">Durch Sitzungen wird eine Gruppe von Nachrichten zu einer Konversation zusammengefasst.</span><span class="sxs-lookup"><span data-stu-id="c3b86-113">Sessions correlate a group of messages into a conversation.</span></span> <span data-ttu-id="c3b86-114">Es sind verschiedene Korrelationstypen möglich.</span><span class="sxs-lookup"><span data-stu-id="c3b86-114">Different types of correlation are possible.</span></span> <span data-ttu-id="c3b86-115">So werden zum Beispiel bei einem sitzungsbasierten Kanal Nachrichten auf Grundlage einer gemeinsamen Netzwerkverbindung zueinander in Beziehung gesetzt, bei einem anderen Kanal geschieht dies wiederum auf Grundlage eines gemeinsamen Tags im Nachrichtentext.</span><span class="sxs-lookup"><span data-stu-id="c3b86-115">For instance, one session-based channel may correlate messages based on a shared network connection while another session-based channel may correlate messages based on a shared tag in the message body.</span></span> <span data-ttu-id="c3b86-116">Die Funktionen, die von der Sitzung abgeleitet werden können, sind abhängig von der Art der Korrelation.</span><span class="sxs-lookup"><span data-stu-id="c3b86-116">The features that can be derived from the session depend on the nature of the correlation.</span></span>  
  
-   <span data-ttu-id="c3b86-117">Es ist kein allgemeiner Datenspeicher einer WCF-Sitzung zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="c3b86-117">There is no general data store associated with a WCF session.</span></span>  
  
 <span data-ttu-id="c3b86-118">Wenn Sie kennen die <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> -Klasse im [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] Anwendungen und die Funktionalität bietet, fallen Ihnen möglicherweise die folgenden Unterschiede zwischen dieser Art von Sitzung und WCF-Sitzungen:</span><span class="sxs-lookup"><span data-stu-id="c3b86-118">If you are familiar with the <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> class in [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] applications and the functionality it provides, you might notice the following differences between that kind of session and WCF sessions:</span></span>  
  
-   [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]<span data-ttu-id="c3b86-119"> -Sitzungen werden immer vom Server initiiert.</span><span class="sxs-lookup"><span data-stu-id="c3b86-119"> sessions are always server-initiated.</span></span>  
  
-   [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]<span data-ttu-id="c3b86-120"> -Sitzungen sind implizit nicht sortiert.</span><span class="sxs-lookup"><span data-stu-id="c3b86-120"> sessions are implicitly unordered.</span></span>  
  
-   [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]<span data-ttu-id="c3b86-121"> -Sitzungen stellen einen allgemeinen Datenspeicher für Anforderungen bereit.</span><span class="sxs-lookup"><span data-stu-id="c3b86-121"> sessions provide a general data storage mechanism across requests.</span></span>  
  
 <span data-ttu-id="c3b86-122">Dieses Thema beschreibt Folgendes:</span><span class="sxs-lookup"><span data-stu-id="c3b86-122">This topic describes:</span></span>  
  
-   <span data-ttu-id="c3b86-123">Das Standardausführungsverhalten bei Verwendung sitzungsbasierter Bindungen auf Dienstmodellebene</span><span class="sxs-lookup"><span data-stu-id="c3b86-123">The default execution behavior when using session-based bindings in the service model layer.</span></span>  
  
-   <span data-ttu-id="c3b86-124">Die Typen der Features, die die sitzungsbasierten, vom System bereitgestellten WCF-Bindungen bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-124">The types of features that the WCF session-based, system-provided bindings provide.</span></span>  
  
-   <span data-ttu-id="c3b86-125">Erstellen eines Vertrags, der eine Sitzungsanforderung deklariert</span><span class="sxs-lookup"><span data-stu-id="c3b86-125">How to create a contract that declares a session requirement.</span></span>  
  
-   <span data-ttu-id="c3b86-126">Verstehen und Steuern der Erstellung und Beendigung einer Sitzung sowie der Beziehung zwischen der Sitzung und der Dienstinstanz</span><span class="sxs-lookup"><span data-stu-id="c3b86-126">How to understand and control the creation and termination of the session and the relationship of the session to the service instance.</span></span>  
  
## <a name="default-execution-behavior-using-sessions"></a><span data-ttu-id="c3b86-127">Standardausführungsverhalten mit Sitzungen</span><span class="sxs-lookup"><span data-stu-id="c3b86-127">Default Execution Behavior Using Sessions</span></span>  
 <span data-ttu-id="c3b86-128">Eine Bindung, die eine Sitzung zu initiieren versucht, wird als *sitzungsbasierte* Bindung bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="c3b86-128">A binding that attempts to initiate a session is called a *session-based* binding.</span></span> <span data-ttu-id="c3b86-129">Dienstverträge geben an, dass sie sitzungsbasierte Bindungen erfordern, zulassen oder verweigern, indem sie die <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType>-Eigenschaft in der Dienstvertragschnittstelle (oder -klasse) auf einen der <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType>-Enumerationswerte festlegen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-129">Service contracts specify that they require, permit, or refuse session-based bindings by setting the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property on the service contract interface (or class) to one of the <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> enumeration values.</span></span> <span data-ttu-id="c3b86-130">Standardmäßig ist der Wert dieser Eigenschaft <xref:System.ServiceModel.SessionMode.Allowed>, das bedeutet, dass bei eines Clients eine sitzungsbasierte Bindung mit einer Implementierung des WCF-Dienst verwendet, der Dienst erstellt und verwendet die angegebene Sitzung.</span><span class="sxs-lookup"><span data-stu-id="c3b86-130">By default, the value of this property is <xref:System.ServiceModel.SessionMode.Allowed>, which means that if a client uses a session-based binding with a WCF service implementation, the service establishes and uses the session provided.</span></span>  
  
 <span data-ttu-id="c3b86-131">Wenn ein WCF-Dienst eine Clientsitzung akzeptiert, werden die folgenden Features standardmäßig aktiviert:</span><span class="sxs-lookup"><span data-stu-id="c3b86-131">When a WCF service accepts a client session, the following features are enabled by default:</span></span>  
  
1.  <span data-ttu-id="c3b86-132">Alle Aufrufe zwischen einem WCF-Clientobjekt werden von der gleichen Dienstinstanz verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="c3b86-132">All calls between a WCF client object are handled by the same service instance.</span></span>  
  
2.  <span data-ttu-id="c3b86-133">Andere sitzungsbasierte Bindungen stellen zusätzliche Funktionen bereit.</span><span class="sxs-lookup"><span data-stu-id="c3b86-133">Different session-based bindings provide additional features.</span></span>  
  
## <a name="system-provided-session-types"></a><span data-ttu-id="c3b86-134">Vom System bereitgestellte Sitzungstypen</span><span class="sxs-lookup"><span data-stu-id="c3b86-134">System-Provided Session Types</span></span>  
 <span data-ttu-id="c3b86-135">Eine sitzungsbasierte Bindung unterstützt die Standardzuordnung einer Dienstinstanz zu einer bestimmten Sitzung.</span><span class="sxs-lookup"><span data-stu-id="c3b86-135">A session-based binding supports the default association of a service instance with a particular session.</span></span> <span data-ttu-id="c3b86-136">Andere sitzungsbasierte Bindungen ermöglichen nicht nur die zuvor beschriebene sitzungsbasierte Instanziierungssteuerung, sondern unterstützen darüber hinaus andere Funktionen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-136">However, different session-based bindings support different features in addition to enabling the session-based instancing control previously described.</span></span>  
  
 <span data-ttu-id="c3b86-137">WCF stellt die folgenden Typen von sitzungsbasierten Verhaltens bereit:</span><span class="sxs-lookup"><span data-stu-id="c3b86-137">WCF provides the following types of session-based application behavior:</span></span>  
  
-   <span data-ttu-id="c3b86-138"><xref:System.ServiceModel.Channels.SecurityBindingElement?displayProperty=nameWithType> unterstützt sicherheitsbasierte Sitzungen, bei denen sich beide Kommunikationspartner auf eine bestimmte sichere Konversation verständigen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-138">The <xref:System.ServiceModel.Channels.SecurityBindingElement?displayProperty=nameWithType> supports security-based sessions, in which both ends of communication have agreed upon a specific secure conversation.</span></span> <span data-ttu-id="c3b86-139">Weitere Informationen finden Sie unter [Securing Services](../../../docs/framework/wcf/securing-services.md).</span><span class="sxs-lookup"><span data-stu-id="c3b86-139">For more information, see [Securing Services](../../../docs/framework/wcf/securing-services.md).</span></span> <span data-ttu-id="c3b86-140">Die <xref:System.ServiceModel.WSHttpBinding?displayProperty=nameWithType>-Bindung, bei der sowohl Sicherheitssitzungen als auch zuverlässige Sitzungen unterstützt werden, verwendet z.&#160;B. standardmäßig nur eine sichere Sitzung, die Nachrichten digital verschlüsselt und signiert.</span><span class="sxs-lookup"><span data-stu-id="c3b86-140">For example, the <xref:System.ServiceModel.WSHttpBinding?displayProperty=nameWithType> binding, which contains support for both security sessions and reliable sessions, by default uses only a secure session that encrypts and digitally signs messages.</span></span>  
  
-   <span data-ttu-id="c3b86-141">Die <xref:System.ServiceModel.NetTcpBinding?displayProperty=nameWithType>-Bindung unterstützt TCP/IP-basierte Sitzungen, um sicherzustellen, dass alle Nachrichten von der Verbindung auf Socketebene miteinander in Beziehung gesetzt werden.</span><span class="sxs-lookup"><span data-stu-id="c3b86-141">The <xref:System.ServiceModel.NetTcpBinding?displayProperty=nameWithType> binding supports TCP/IP-based sessions to ensure that all messages are correlated by the connection at the socket level.</span></span>  
  
-   <span data-ttu-id="c3b86-142">Das <xref:System.ServiceModel.Channels.ReliableSessionBindingElement?displayProperty=nameWithType>-Element, das die WS-ReliableMessaging-Spezifikation implementiert, bietet Unterstützung für zuverlässige Sitzungen, in denen Nachrichten so konfiguriert werden können, dass sie der Reihenfolge nach und genau einmal zugestellt werden, sodass der Empfang von Nachrichten sichergestellt wird, auch wenn sich diese während der Konversation durch mehrere Knoten bewegen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-142">The <xref:System.ServiceModel.Channels.ReliableSessionBindingElement?displayProperty=nameWithType> element, which implements the WS-ReliableMessaging specification, provides support for reliable sessions in which messages can be configured to be delivered in order and exactly once, ensuring messages are received even when messages travel across multiple nodes during the conversation.</span></span> <span data-ttu-id="c3b86-143">Weitere Informationen finden Sie unter [zuverlässige Sitzungen](../../../docs/framework/wcf/feature-details/reliable-sessions.md).</span><span class="sxs-lookup"><span data-stu-id="c3b86-143">For more information, see [Reliable Sessions](../../../docs/framework/wcf/feature-details/reliable-sessions.md).</span></span>  
  
-   <span data-ttu-id="c3b86-144">Die <xref:System.ServiceModel.NetMsmqBinding?displayProperty=nameWithType>-Bindung stellt MSMQ-Datagrammsitzungen bereit.</span><span class="sxs-lookup"><span data-stu-id="c3b86-144">The <xref:System.ServiceModel.NetMsmqBinding?displayProperty=nameWithType> binding provides MSMQ datagram sessions.</span></span> <span data-ttu-id="c3b86-145">Weitere Informationen finden Sie unter [Warteschlangen in WCF](../../../docs/framework/wcf/feature-details/queues-in-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="c3b86-145">For more information, see [Queues in WCF](../../../docs/framework/wcf/feature-details/queues-in-wcf.md).</span></span>  
  
 <span data-ttu-id="c3b86-146">Durch Festlegen der <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> -Eigenschaft wird nicht der vom Vertrag angeforderte Typ der Sitzung angegeben, sondern nur, dass eine Sitzung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="c3b86-146">Setting the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> property does not specify the type of session the contract requires, only that it requires one.</span></span>  
  
## <a name="creating-a-contract-that-requires-a-session"></a><span data-ttu-id="c3b86-147">Erstellen eines Vertrags, der eine Sitzung erfordert</span><span class="sxs-lookup"><span data-stu-id="c3b86-147">Creating a Contract That Requires a Session</span></span>  
 <span data-ttu-id="c3b86-148">Beim Erstellen eines Vertrags, der eine Sitzung erfordert, wird angegeben, dass die gesamte Gruppe von Vorgängen, die der Dienstvertrag deklariert, innerhalb derselben Sitzung ausgeführt werden muss und dass Nachrichten der Reihenfolge nach zugestellt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-148">Creating a contract that requires a session states that the group of operations that the service contract declares must all be executed within the same session and that messages must be delivered in order.</span></span> <span data-ttu-id="c3b86-149">Zum Bestätigen der Ebene der Sitzungsunterstützung, die ein Dienstvertrag erfordert, legen Sie die <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType>-Eigenschaft der Dienstvertragschnittstelle oder -klasse auf den Wert der <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType>-Enumeration fest. Damit geben Sie an, ob der Vertrag:</span><span class="sxs-lookup"><span data-stu-id="c3b86-149">To assert the level of session support that a service contract requires, set the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property on your service contract interface or class to the value of the <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> enumeration to specify whether the contract:</span></span>  
  
-   <span data-ttu-id="c3b86-150">Eine Sitzung erfordert.</span><span class="sxs-lookup"><span data-stu-id="c3b86-150">Requires a session.</span></span>  
  
-   <span data-ttu-id="c3b86-151">Es einem Client ermöglicht, eine Sitzung aufzubauen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-151">Allows a client to establish a session.</span></span>  
  
-   <span data-ttu-id="c3b86-152">Eine Sitzung verhindert.</span><span class="sxs-lookup"><span data-stu-id="c3b86-152">Prohibits a session.</span></span>  
  
 <span data-ttu-id="c3b86-153">Durch Festlegen der <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> -Eigenschaft wird allerdings nicht der vom Vertrag angeforderte Typ des sitzungsbasierten Verhaltens angegeben.</span><span class="sxs-lookup"><span data-stu-id="c3b86-153">Setting the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> property does not, however, specify the type of session-based behavior the contract requires.</span></span> <span data-ttu-id="c3b86-154">Sie weist WCF an, die zur Laufzeit zu bestätigen, die die Bindung (die den Kommunikationskanal erstellt) konfiguriert, für den Dienst ist, ist dies nicht, oder eine Sitzung aufbauen kann beim Implementieren eines Diensts.</span><span class="sxs-lookup"><span data-stu-id="c3b86-154">It instructs WCF to confirm at runtime that the configured binding (which creates the communication channel) for the service does, does not, or can establish a session when implementing a service.</span></span> <span data-ttu-id="c3b86-155">Die Bindung kann diese Anforderung wiederum mit einem beliebigen, von ihr gewählten Typ eines sitzungsbasierten Verhaltens erfüllen &#8211; Sicherheit, Transport, Zuverlässigkeit oder eine Kombination daraus.</span><span class="sxs-lookup"><span data-stu-id="c3b86-155">Again, the binding can satisfy that requirement with any type of session-based behavior it chooses—security, transport, reliable, or some combination.</span></span> <span data-ttu-id="c3b86-156">Das genaue Verhalten hängt vom ausgewählten <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType>-Wert ab.</span><span class="sxs-lookup"><span data-stu-id="c3b86-156">The exact behavior depends on the <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> value selected.</span></span> <span data-ttu-id="c3b86-157">Wenn die konfigurierte Bindung des Diensts nicht dem Wert von <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A>entspricht, wird eine Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="c3b86-157">If the configured binding of the service does not conform to the value of <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A>, an exception is thrown.</span></span> <span data-ttu-id="c3b86-158">Bindungen und die von ihnen erstellten Kanäle, die Sitzungen unterstützen, werden als sitzungsbasiert bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="c3b86-158">Bindings and the channels they create that support sessions are said to be session-based.</span></span>  
  
 <span data-ttu-id="c3b86-159">Der folgende Dienstvertrag gibt an, dass alle Vorgänge in `ICalculatorSession` innerhalb einer Sitzung ausgetauscht werden müssen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-159">The following service contract specifies that all operations in the `ICalculatorSession` must be exchanged within a session.</span></span> <span data-ttu-id="c3b86-160">Mit Ausnahme der `Equals` -Methode gibt keiner der Vorgänge einen Wert an den Aufrufer zurück.</span><span class="sxs-lookup"><span data-stu-id="c3b86-160">None of the operations returns a value to the caller except the `Equals` method.</span></span> <span data-ttu-id="c3b86-161">Die `Equals` -Methode verwendet jedoch keine Parameter und kann daher nur einen Wert ungleich 0 (null) innerhalb der Sitzung zurückgeben, in der Daten bereits an die anderen Vorgänge übergeben wurden.</span><span class="sxs-lookup"><span data-stu-id="c3b86-161">However, the `Equals` method takes no parameters and, therefore, can only return a non-zero value inside a session in which data has already been passed to the other operations.</span></span> <span data-ttu-id="c3b86-162">Dieser Vertrag erfordert, dass eine Sitzung ordnungsgemäß funktioniert.</span><span class="sxs-lookup"><span data-stu-id="c3b86-162">This contract requires a session to function properly.</span></span> <span data-ttu-id="c3b86-163">Ist keine Sitzung einem bestimmten Client zugeordnet, kann die Dienstinstanz nicht ermitteln, welche Daten dieser Client bereits gesendet hat.</span><span class="sxs-lookup"><span data-stu-id="c3b86-163">Without a session associated with a specific client, the service instance has no way of knowing what previous data this client has sent.</span></span>  
  
 [!code-csharp[S_Service_Session#1](../../../samples/snippets/csharp/VS_Snippets_CFX/s_service_session/cs/service.cs#1)]
 [!code-vb[S_Service_Session#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/s_service_session/vb/service.vb#1)]  
  
 <span data-ttu-id="c3b86-164">Wenn ein Dienst eine Sitzung zulässt, wird die Sitzung aufgebaut und verwendet, wenn der Client eine Sitzung initiiert, andernfalls wird keine Sitzung aufgebaut.</span><span class="sxs-lookup"><span data-stu-id="c3b86-164">If a service allows a session, then a session is established and used if the client initiates one; otherwise, no session is established.</span></span>  
  
## <a name="sessions-and-service-instances"></a><span data-ttu-id="c3b86-165">Sitzungen und Dienstinstanzen</span><span class="sxs-lookup"><span data-stu-id="c3b86-165">Sessions and Service Instances</span></span>  
 <span data-ttu-id="c3b86-166">Wenn Sie das standardinstanziierungsverhalten in WCF verwenden, werden alle Aufrufe zwischen einem WCF-Objekt von der gleichen Dienstinstanz behandelt.</span><span class="sxs-lookup"><span data-stu-id="c3b86-166">If you use the default instancing behavior in WCF, all calls between a WCF client object are handled by the same service instance.</span></span> <span data-ttu-id="c3b86-167">Daher können Sie sich eine Sitzung auf Anwendungsebene so vorstellen, dass sie ein Anwendungsverhalten ermöglicht, das dem lokalen Aufrufverhalten ähnlich ist.</span><span class="sxs-lookup"><span data-stu-id="c3b86-167">Therefore, at the application level, you can think of a session as enabling application behavior similar to local call behavior.</span></span> <span data-ttu-id="c3b86-168">Wenn Sie zum Beispiel ein lokales Objekt erstellen:</span><span class="sxs-lookup"><span data-stu-id="c3b86-168">For example, when you create a local object:</span></span>  
  
-   <span data-ttu-id="c3b86-169">Wird ein Konstruktor aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-169">A constructor is called.</span></span>  
  
-   <span data-ttu-id="c3b86-170">Alle nachfolgenden Aufrufe an den Objektverweis für WCF-Client werden von der gleichen Objektinstanz verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="c3b86-170">All subsequent calls made to the WCF client object reference are processed by the same object instance.</span></span>  
  
-   <span data-ttu-id="c3b86-171">Wird ein Destruktor aufgerufen, wenn der Objektverweis gelöscht wird.</span><span class="sxs-lookup"><span data-stu-id="c3b86-171">A destructor is called when the object reference is destroyed.</span></span>  
  
 <span data-ttu-id="c3b86-172">Sitzungen ermöglichen ein ähnliches Verhalten zwischen Clients und Diensten, solange das Standardverhalten der Dienstinstanz verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="c3b86-172">Sessions enable a similar behavior between clients and services as long as the default service instance behavior is used.</span></span> <span data-ttu-id="c3b86-173">Wenn ein Dienstvertrag Sitzungen erfordert oder unterstützt, kann mindestens ein Vorgang durch Festlegen der <xref:System.ServiceModel.OperationContractAttribute.IsInitiating%2A> -Eigenschaft und der <xref:System.ServiceModel.OperationContractAttribute.IsTerminating%2A> -Eigenschaft zum Initiieren oder Beenden einer Sitzung angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="c3b86-173">If a service contract requires or supports sessions, one or more contract operations can be marked as initiating or terminating a session by setting the <xref:System.ServiceModel.OperationContractAttribute.IsInitiating%2A> and <xref:System.ServiceModel.OperationContractAttribute.IsTerminating%2A> properties.</span></span>  
  
 <span data-ttu-id="c3b86-174">*Initiierungsvorgänge* sind Vorgänge, die als erster Vorgang einer neuen Sitzung aufgerufen werden müssen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-174">*Initiating operations* are those that must be called as the first operation of a new session.</span></span> <span data-ttu-id="c3b86-175">Nicht-Initiierungsvorgänge können nur aufgerufen werden, nachdem mindestens ein Initiierungsvorgang aufgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="c3b86-175">Non-initiating operations can be called only after at least one initiating operation has been called.</span></span> <span data-ttu-id="c3b86-176">Sie können folglich eine Art Sitzungskonstruktor für den Dienst erstellen, indem Sie Initiierungsvorgänge deklarieren, die dazu gedacht sind, Eingaben von Clients anzunehmen, die sich für den Anfang der Dienstinstanz eignen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-176">You can therefore create a kind of session constructor for your service by declaring initiating operations designed to take input from clients appropriate to the beginning of the service instance.</span></span> <span data-ttu-id="c3b86-177">(Der Zustand ist jedoch der Sitzung zugeordnet, nicht dem Dienstobjekt.)</span><span class="sxs-lookup"><span data-stu-id="c3b86-177">(The state is associated with the session, however, and not the service object.)</span></span>  
  
 <span data-ttu-id="c3b86-178">*Beendigungsvorgänge*sind dagegen Vorgänge, die als letzte Nachricht in einer vorhandenen Sitzung aufgerufen werden müssen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-178">*Terminating operations*, conversely, are those that must be called as the last message in an existing session.</span></span> <span data-ttu-id="c3b86-179">Im Standardfall verwendet WCF das Dienstobjekt und seinen Kontext wieder, nachdem die Sitzung, der der Dienst zugeordnet war, geschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="c3b86-179">In the default case, WCF recycles the service object and its context after the session with which the service was associated is closed.</span></span> <span data-ttu-id="c3b86-180">Sie können folglich eine Art Destruktor erstellen, indem Sie Beendigungsvorgänge deklarieren, die zum Ausführen einer Funktion gedacht sind, die sich für das Ende der Dienstinstanz eignet.</span><span class="sxs-lookup"><span data-stu-id="c3b86-180">You can, therefore, create a kind of destructor by declaring terminating operations designed to perform a function appropriate to the end of the service instance.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c3b86-181">Das Standardverhalten ist lokalen Konstruktoren und Destruktoren ähnlich, aber eben nur ähnlich.</span><span class="sxs-lookup"><span data-stu-id="c3b86-181">Although the default behavior bears a resemblance to local constructors and destructors, it is only a resemblance.</span></span> <span data-ttu-id="c3b86-182">Ein WCF-Dienstvorgang kann ein initiierungs- oder Beendigungsvorgang oder beides gleichzeitig sein.</span><span class="sxs-lookup"><span data-stu-id="c3b86-182">Any WCF service operation can be an initiating or terminating operation, or both at the same time.</span></span> <span data-ttu-id="c3b86-183">Außerdem können Initiierungsvorgänge im Standardfall beliebig oft in einer beliebigen Reihenfolge aufgerufen werden, nachdem der erste Vorgang aufgerufen wurde. Es werden keine zusätzlichen Sitzungen erstellt, sobald die Sitzung aufgebaut und einer Instanz zugeordnet wurde, es sei denn, Sie steuern die Lebensdauer der Dienstinstanz explizit (durch Bearbeiten des <xref:System.ServiceModel.InstanceContext?displayProperty=nameWithType>-Objekts).</span><span class="sxs-lookup"><span data-stu-id="c3b86-183">In addition, in the default case, initiating operations can be called any number of times in any order; no additional sessions are created once the session is established and associated with an instance unless you explicitly control the lifetime of the service instance (by manipulating the <xref:System.ServiceModel.InstanceContext?displayProperty=nameWithType> object).</span></span> <span data-ttu-id="c3b86-184">Der Zustand wird schließlich der Sitzung zugeordnet, nicht dem Dienstobjekt.</span><span class="sxs-lookup"><span data-stu-id="c3b86-184">Finally, the state is associated with the session and not the service object.</span></span>  
  
 <span data-ttu-id="c3b86-185">Z. B. die `ICalculatorSession` Vertrag, der im vorherigen Beispiel verwendet der WCF-Client den ersten Aufruf Objekt muss die `Clear` Vorgang vor allen anderen Vorgängen, und dass die Sitzung mit dieser WCF-Clientobjekts sollte beim Aufrufen der Beenden`Equals` Vorgang.</span><span class="sxs-lookup"><span data-stu-id="c3b86-185">For example, the `ICalculatorSession` contract used in the preceding example requires that the WCF client object first call the `Clear` operation prior to any other operation and that the session with this WCF client object should terminate when it calls the `Equals` operation.</span></span> <span data-ttu-id="c3b86-186">Das folgende Codebeispiel zeigt einen Vertrag, der diese Anforderungen erzwingt.</span><span class="sxs-lookup"><span data-stu-id="c3b86-186">The following code example shows a contract that enforces these requirements.</span></span> <span data-ttu-id="c3b86-187">`Clear` muss zuerst aufgerufen werden, um eine Sitzung zu initiieren. Diese Sitzung endet, wenn `Equals` aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="c3b86-187">`Clear` must be called first to initiate a session, and that session ends when `Equals` is called.</span></span>  
  
 [!code-csharp[SCA.IsInitiatingIsTerminating#1](../../../samples/snippets/csharp/VS_Snippets_CFX/sca.isinitiatingisterminating/cs/service.cs#1)]
 [!code-vb[SCA.IsInitiatingIsTerminating#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/sca.isinitiatingisterminating/vb/service.vb#1)]  
  
 <span data-ttu-id="c3b86-188">Dienste starten keine Sitzungen mit Clients.</span><span class="sxs-lookup"><span data-stu-id="c3b86-188">Services do not start sessions with clients.</span></span> <span data-ttu-id="c3b86-189">In WCF-Clientanwendungen ist Sie eine direkte Beziehung zwischen der Lebensdauer des sitzungsbasierten Kanals und die Lebensdauer der Sitzung vorhanden.</span><span class="sxs-lookup"><span data-stu-id="c3b86-189">In WCF client applications, a direct relationship exists between the lifetime of the session-based channel and the lifetime of the session itself.</span></span> <span data-ttu-id="c3b86-190">Aus diesem Grund erstellen Clients neue Sitzungen, indem sie neue sitzungsbasierte Kanäle erstellen, und beenden bestehende Sitzungen, indem sie sitzungsbasierte Kanäle ordnungsgemäß schließen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-190">As such, clients create new sessions by creating new session-based channels and tear down existing sessions by closing session-based channels gracefully.</span></span> <span data-ttu-id="c3b86-191">Ein Client startet eine Sitzung mit einem Dienstendpunkt, indem er einen der folgenden Vorgänge aufruft:</span><span class="sxs-lookup"><span data-stu-id="c3b86-191">A client starts a session with a service endpoint by calling one of the following:</span></span>  
  
-   <span data-ttu-id="c3b86-192"><xref:System.ServiceModel.ICommunicationObject.Open%2A?displayProperty=nameWithType> auf dem Kanal, das durch einen Aufruf an <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType> zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="c3b86-192"><xref:System.ServiceModel.ICommunicationObject.Open%2A?displayProperty=nameWithType> on the channel returned by a call to <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>.</span></span>  
  
-   <span data-ttu-id="c3b86-193"><xref:System.ServiceModel.ClientBase%601.Open%2A?displayProperty=nameWithType> für das vom WCF-Clientobjekt den [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span><span class="sxs-lookup"><span data-stu-id="c3b86-193"><xref:System.ServiceModel.ClientBase%601.Open%2A?displayProperty=nameWithType> on the WCF client object generated by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span></span>  
  
-   <span data-ttu-id="c3b86-194">Einen initiierungsvorgang an einem Typ eines WCF-Clientobjekts (standardmäßig alle Vorgänge initiierungsvorgänge).</span><span class="sxs-lookup"><span data-stu-id="c3b86-194">An initiating operation on either type of WCF client object (by default, all operations are initiating).</span></span> <span data-ttu-id="c3b86-195">Wenn der erste Vorgang aufgerufen wird, wird der Kanal des WCF-Clientobjekts automatisch und initiiert eine Sitzung.</span><span class="sxs-lookup"><span data-stu-id="c3b86-195">When the first operation is called, the WCF client object automatically opens the channel and initiates a session.</span></span>  
  
 <span data-ttu-id="c3b86-196">Ein Client beendet eine Sitzung in der Regel mit einem Dienstendpunkt, indem er einen der folgenden Vorgänge aufruft:</span><span class="sxs-lookup"><span data-stu-id="c3b86-196">Typically a client ends a session with a service endpoint by calling one of the following:</span></span>  
  
-   <span data-ttu-id="c3b86-197"><xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType> auf dem Kanal, das durch einen Aufruf an <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType> zurückgegeben wurde.</span><span class="sxs-lookup"><span data-stu-id="c3b86-197"><xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType> on the channel returned by a call to <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>.</span></span>  
  
-   <span data-ttu-id="c3b86-198"><xref:System.ServiceModel.ClientBase%601.Close%2A?displayProperty=nameWithType> für das WCF-Clientobjekt von Svcutil.exe generiert wurde.</span><span class="sxs-lookup"><span data-stu-id="c3b86-198"><xref:System.ServiceModel.ClientBase%601.Close%2A?displayProperty=nameWithType> on the WCF client object generated by Svcutil.exe.</span></span>  
  
-   <span data-ttu-id="c3b86-199">Einen Beendigungsvorgang für einen Typ eines WCF-Clientobjekts (Standardmäßig sind Vorgänge nie Beendigungsvorgänge, der Vertrag muss einen Beendigungsvorgang explizit angeben).</span><span class="sxs-lookup"><span data-stu-id="c3b86-199">A terminating operation on either type of WCF client object (by default, no operations are terminating; the contract must explicitly specify a terminating operation).</span></span> <span data-ttu-id="c3b86-200">Wenn der erste Vorgang aufgerufen wird, wird der Kanal des WCF-Clientobjekts automatisch und initiiert eine Sitzung.</span><span class="sxs-lookup"><span data-stu-id="c3b86-200">When the first operation is called, the WCF client object automatically opens the channel and initiates a session.</span></span>  
  
 <span data-ttu-id="c3b86-201">Beispiele finden Sie unter [Vorgehensweise: Erstellen eines Diensts, der Sitzungen erfordert](../../../docs/framework/wcf/feature-details/how-to-create-a-service-that-requires-sessions.md) sowie unter [Default Service Behavior](../../../docs/framework/wcf/samples/default-service-behavior.md) und [Instancing](../../../docs/framework/wcf/samples/instancing.md) .</span><span class="sxs-lookup"><span data-stu-id="c3b86-201">For examples, see [How to: Create a Service That Requires Sessions](../../../docs/framework/wcf/feature-details/how-to-create-a-service-that-requires-sessions.md) as well as the [Default Service Behavior](../../../docs/framework/wcf/samples/default-service-behavior.md) and [Instancing](../../../docs/framework/wcf/samples/instancing.md) samples.</span></span>  
  
 <span data-ttu-id="c3b86-202">Weitere Informationen zu Clients und Sitzungen finden Sie unter [Zugriff auf Dienste, die mithilfe eines WCF-Clients](../../../docs/framework/wcf/feature-details/accessing-services-using-a-client.md).</span><span class="sxs-lookup"><span data-stu-id="c3b86-202">For more information about clients and sessions, see [Accessing Services Using a WCF Client](../../../docs/framework/wcf/feature-details/accessing-services-using-a-client.md).</span></span>  
  
## <a name="sessions-interact-with-instancecontext-settings"></a><span data-ttu-id="c3b86-203">Interaktion von Sitzungen und InstanceContext-Einstellungen</span><span class="sxs-lookup"><span data-stu-id="c3b86-203">Sessions Interact with InstanceContext Settings</span></span>  
 <span data-ttu-id="c3b86-204">Zwischen der <xref:System.ServiceModel.SessionMode>-Enumeration in einem Vertrag und der <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType>-Eigenschaft gibt es eine Interaktion, durch die die Zuordnung zwischen Kanälen und bestimmten Dienstobjekten gesteuert wird.</span><span class="sxs-lookup"><span data-stu-id="c3b86-204">There is an interaction between the <xref:System.ServiceModel.SessionMode> enumeration in a contract and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property, which controls the association between channels and specific service objects.</span></span> <span data-ttu-id="c3b86-205">Weitere Informationen finden Sie unter [Sessions, Instancing und Parallelität](../../../docs/framework/wcf/feature-details/sessions-instancing-and-concurrency.md).</span><span class="sxs-lookup"><span data-stu-id="c3b86-205">For more information, see [Sessions, Instancing, and Concurrency](../../../docs/framework/wcf/feature-details/sessions-instancing-and-concurrency.md).</span></span>  
  
### <a name="sharing-instancecontext-objects"></a><span data-ttu-id="c3b86-206">Freigeben von InstanceContext-Objekten</span><span class="sxs-lookup"><span data-stu-id="c3b86-206">Sharing InstanceContext Objects</span></span>  
 <span data-ttu-id="c3b86-207">Sie können auch steuern, welcher sitzungsbasierte Kanal oder Aufruf welchem <xref:System.ServiceModel.InstanceContext> -Objekt zugeordnet wird, indem Sie diese Zuordnung selbst vornehmen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-207">You can also control which session-based channel or call is associated with which <xref:System.ServiceModel.InstanceContext> object by performing that association yourself.</span></span> <span data-ttu-id="c3b86-208">Ein vollständiges Beispiel finden Sie unter [InstanceContextSharing](https://msdn.microsoft.com/library/4a6a46d7-b7d7-4bb5-a0dd-03ffa3cbc230).</span><span class="sxs-lookup"><span data-stu-id="c3b86-208">For a complete example, see [InstanceContextSharing](https://msdn.microsoft.com/library/4a6a46d7-b7d7-4bb5-a0dd-03ffa3cbc230).</span></span>  
  
## <a name="sessions-and-streaming"></a><span data-ttu-id="c3b86-209">Sitzungen und Streaming</span><span class="sxs-lookup"><span data-stu-id="c3b86-209">Sessions and Streaming</span></span>  
 <span data-ttu-id="c3b86-210">Wenn Sie eine große Menge der zu übertragenden Daten verfügen, ist der streamingübertragungsmodus in WCF eine praktische Alternative zum Standardverhalten von Puffern und Verarbeiten von Nachrichten im Arbeitsspeicher in ihrer Gesamtheit an.</span><span class="sxs-lookup"><span data-stu-id="c3b86-210">When you have a large amount of data to transfer, the streaming transfer mode in WCF is a feasible alternative to the default behavior of buffering and processing messages in memory in their entirety.</span></span> <span data-ttu-id="c3b86-211">Möglicherweise tritt beim Streaming von Aufrufen mit einer sitzungsbasierten Bindung ein unerwartetes Verhalten auf.</span><span class="sxs-lookup"><span data-stu-id="c3b86-211">You may get unexpected behavior when streaming calls with a session-based binding.</span></span> <span data-ttu-id="c3b86-212">Alle Streamingaufrufe erfolgen über einen einzigen Kanal (den Datagrammkanal), der keine Sitzungen unterstützt, selbst wenn die verwendete Bindung für die Verwendung von Sitzungen konfiguriert ist.</span><span class="sxs-lookup"><span data-stu-id="c3b86-212">All streaming calls are made through a single channel (the datagram channel) that does not support sessions even if the binding being used is configured to use sessions.</span></span> <span data-ttu-id="c3b86-213">Wenn mehrere Clients über eine sitzungsbasierte Bindung Streamingaufrufe an das gleiche Dienstobjekt senden und der Parallelitätsmodus des Dienstobjekts auf "single" und sein Instanzkontextmodus auf `PerSession`festgelegt ist, müssen alle Aufrufe den Datagrammkanal passieren, sodass immer nur jeweils ein Aufruf verarbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="c3b86-213">If multiple clients make streaming calls to the same service object over a session-based binding, and the service object's concurrency mode is set to single and its instance context mode is set to `PerSession`, all calls must go through the datagram channel and so only one call is processed at a time.</span></span> <span data-ttu-id="c3b86-214">Bei einem oder mehreren Clients kommt es dabei unter Umständen zu einem Timeout. Sie können dieses Problem umgehen, indem Sie entweder den `InstanceContextMode` des Dienstobjekts auf `PerCall` oder die Parallelität auf "multiple" festlegen.</span><span class="sxs-lookup"><span data-stu-id="c3b86-214">One or more clients may then time out. You can work around this issue by either setting the service object's `InstanceContextMode` to `PerCall` or Concurrency to multiple.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c3b86-215">MaxConcurrentSessions hat in diesem Fall keine Auswirkungen, da nur eine Sitzung verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="c3b86-215">MaxConcurrentSessions have no effect in this case because there is only one "session" available.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c3b86-216">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="c3b86-216">See Also</span></span>  
 <xref:System.ServiceModel.OperationContractAttribute.IsInitiating%2A>  
 <xref:System.ServiceModel.OperationContractAttribute.IsTerminating%2A>
